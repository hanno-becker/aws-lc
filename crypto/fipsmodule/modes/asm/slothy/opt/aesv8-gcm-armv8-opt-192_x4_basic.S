// Copyright (c) 2022, ARM Inc.

// Permission to use, copy, modify, and/or distribute this software for any
// purpose with or without fee is hereby granted, provided that the above
// copyright notice and this permission notice appear in all copies.

// THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
// WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
// MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
// SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
// WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
// OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
// CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. */

// Author: Hanno Becker <hannobecker@posteo.de>

// This file was derived from the assembly generated from aesv8-gcm-armv8.pl,
// written by Fangming Fang <fangming.fang@arm.com> for the OpenSSL project,
// and derived from https: // github.com/ARM-software/AArch64cryptolib, original
// author Samuel Lee <Samuel.Lee@arm.com>.

// The code below is a 'clean' AArch64 implementation of AES-GCM emphasizing
// the logic of the computation. It is meant as the input to manual audits /
// formal verification, as well as automated micro-optimization such as done
// by the SLOTHY superoptimizer (https: // github.com/slothy-optimizer/slothy).

#if !defined(__has_feature)
#define __has_feature(x) 0
#endif
#if __has_feature(memory_sanitizer) && !defined(OPENSSL_NO_ASM)
#define OPENSSL_NO_ASM
#endif

#include <openssl/asm_base.h>

#if !defined(OPENSSL_NO_ASM) && defined(__AARCH64EL__)
#if defined(__ELF__)
#include <openssl/boringssl_prefix_symbols_asm.h>
#include <openssl/arm_arch.h>
.arch   armv8-a+crypto
.text
.globl  aes_gcm_enc_kernel_slothy_base_192
.hidden aes_gcm_enc_kernel_slothy_base_192
.type   aes_gcm_enc_kernel_slothy_base_192,%function
#elif defined(__APPLE__)
#if defined(BORINGSSL_PREFIX)
#include <boringssl_prefix_symbols_asm.h>
#endif
#include <openssl/arm_arch.h>
.text
.globl	_aes_gcm_enc_kernel_slothy_base_192
.private_extern	_aes_gcm_enc_kernel_slothy_base_192
#else
#error Unknown configuration
#endif

#if __ARM_MAX_ARCH__ >= 8

// Arguments
input    .req x0
len_bits .req x1
output   .req x2
tag_ptr  .req x3
ivec     .req x4
key      .req x5
Htable   .req x6

byte_len .req x15

constant_temp .req x25

count           .req x1
full_blocks     .req x7
remainder       .req x9
unroll          .req x10

aes_st    .req v0
aes_st_q  .req q0

res       .req v0
res_q     .req q0

ghash_hi    .req v9
ghash_lo    .req v8
ghash_mid   .req v10
ghash_mid_d .req d10

ghash_tmp   .req v11
ghash_tmp_d .req d11

ghash_mod   .req v7
ghash_mod_d .req d7

modulo_tmp0 .req v0
modulo_tmp1 .req v1

Ht1q    .req q12
Ht2q    .req q13
Ht12q   .req q14

Ht1    .req v12
Ht2    .req v13
Ht12   .req v14

Ht3q    .req Ht1q
Ht4q    .req Ht2q
Ht34q   .req Ht12q

Ht3    .req Ht1
Ht4    .req Ht2
Ht34   .req Ht12

rk0q   .req q18
rk1q   .req q19
rk2q   .req q20
rk3q   .req q21
rk4q   .req q22
rk5q   .req q23
rk6q   .req q24
rk7q   .req q25
rk8q   .req q26
rk9q   .req q27
rk10q  .req q28

rk11q  .req q15
rk12q  .req q16
rk13q  .req q17
rk14q  .req q2

rk0    .req v18
rk1    .req v19
rk2    .req v20
rk3    .req v21
rk4    .req v22
rk5    .req v23
rk6    .req v24
rk7    .req v25
rk8    .req v26
rk9    .req v27
rk10   .req v28

rk11   .req v15
rk12   .req v16
rk13   .req v17
rk14   .req v2

plain   .req v29
plain_q .req q29

rctr_inc   .req v30
rtmp_ctr   .req v31
rtmp_ctr_q .req q31

tag    .req v11
tag_q  .req q11

#define UNROLL 4

#define STACK_SIZE_GPRS  (6*16)
#define STACK_SIZE_VREGS (4*16)
#define STACK_SIZE  (STACK_SIZE_GPRS + STACK_SIZE_VREGS)

#define STACK_BASE_GPRS  (0)
#define STACK_BASE_VREGS (STACK_SIZE_GPRS)

/********************************************************************/
/*                 Generic preamble/postamble macros                */
/********************************************************************/

.macro save_vregs
        stp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        stp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        stp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        stp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro restore_vregs
        ldp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        ldp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        ldp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        ldp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro save_gprs
        stp x19, x20, [sp, #(STACK_BASE_GPRS + 16*0)]
        stp x21, x22, [sp, #(STACK_BASE_GPRS + 16*1)]
        stp x23, x24, [sp, #(STACK_BASE_GPRS + 16*2)]
        stp x25, x26, [sp, #(STACK_BASE_GPRS + 16*3)]
        stp x27, x28, [sp, #(STACK_BASE_GPRS + 16*4)]
        stp x29, x30, [sp, #(STACK_BASE_GPRS + 16*5)]
.endm

.macro restore_gprs
        ldp x19, x20, [sp, #(STACK_BASE_GPRS + 16*0)]
        ldp x21, x22, [sp, #(STACK_BASE_GPRS + 16*1)]
        ldp x23, x24, [sp, #(STACK_BASE_GPRS + 16*2)]
        ldp x25, x26, [sp, #(STACK_BASE_GPRS + 16*3)]
        ldp x27, x28, [sp, #(STACK_BASE_GPRS + 16*4)]
        ldp x29, x30, [sp, #(STACK_BASE_GPRS + 16*5)]
.endm

// Derive number of iterations of unrolled loop and single-block loop
.macro prepare_loop_counts
        mov  unroll, #UNROLL
        // Number of AES Blocks (16b each)
        lsr  full_blocks, byte_len, #4
        // Number of iterations of the unrolled loop
        udiv count, full_blocks, unroll
        // Number of iterations for the tail loop handling 1 block each
        msub remainder, count, unroll, full_blocks
.endm

/********************************************************************/
/*                       AES related macros                         */
/********************************************************************/

.macro load_iv
        ldr     rtmp_ctr_q, [ivec]

        // set up counter increment
 mov	constant_temp, #0x100000000
 movi	rctr_inc.16b,  #0x0
 fmov	rctr_inc.d[1], constant_temp

        rev32   rtmp_ctr.16b, rtmp_ctr.16b
.endm

// Increase AES counter
.macro aes_ctr_inc
        add    rtmp_ctr.4s, rtmp_ctr.4s, rctr_inc.4s
.endm

// Increase AES counter and initialize new AES state
.macro next_ctr_init_aes aes_st
        rev32  \aes_st\().16b, rtmp_ctr.16b
        aes_ctr_inc
.endm

// A single AES round
// Prevent SLOTHY from unfolding because uArchs tend to fuse AESMC+AESE
.macro aesr data, key // @slothy:no-unfold
        aese  \data, \key
        aesmc \data, \data
.endm

.macro aesr_0_8 data, key
        aesr \data\().16b, \key\()0.16b
        aesr \data\().16b, \key\()1.16b
        aesr \data\().16b, \key\()2.16b
        aesr \data\().16b, \key\()3.16b
        aesr \data\().16b, \key\()4.16b
        aesr \data\().16b, \key\()5.16b
        aesr \data\().16b, \key\()6.16b
        aesr \data\().16b, \key\()7.16b
        aesr \data\().16b, \key\()8.16b
.endm

.macro aesr_9_10 data, key
        aesr \data\().16b, \key\()9.16b
        aesr \data\().16b, \key\()10.16b
.endm

.macro aesr_11_12 data, key
        aesr \data\().16b, \key\()11.16b
        aesr \data\().16b, \key\()12.16b
.endm

// Destructs inA
.macro eor3 out, inA, inB, inC
        eor \inA, \inA, \inB
        eor \out, \inA, \inC
.endm

.macro aesr_final aes_st, plain, out
        aese \aes_st\().16b, rk11.16b
        eor3 \out\().16b, \plain\().16b, rk12.16b, \aes_st\().16b
.endm

.macro aes_full_block aes_st, input, output
        next_ctr_init_aes \aes_st
        aesr_0_8   \aes_st\(), rk
        aesr_9_10  \aes_st\(), rk
        aesr_final \aes_st, \input, \output
.endm

.macro load_round_key i
        ldr rk\i\()q, [key, #((\i)*16)]
.endm

.macro load_round_keys
        load_round_key 0
        load_round_key 1
        load_round_key 2
        load_round_key 3
        load_round_key 4
        load_round_key 5
        load_round_key 6
        load_round_key 7
        load_round_key 8
        load_round_key 9
        load_round_key 10
        load_round_key 11
        load_round_key 12
.endm

/********************************************************************/
/*       Loading of H-table (precomputed H-powers for GHASH)        */
/********************************************************************/

// This has to be synchronized with the H-table generation

.macro load_h1 dst, dst_q
        ldr \dst_q, [Htable]
.endm

.macro load_h2 dst, dst_q
        ldr \dst_q, [Htable, #32]
.endm

.macro load_h3 dst, dst_q
        ldr \dst_q, [Htable, #48]
.endm

.macro load_h4 dst, dst_q
        ldr \dst_q, [Htable, #80]
.endm

.macro load_h12 dst, dst_q
        ldr \dst_q, [Htable, #16]
.endm

.macro load_h34 dst, dst_q
        ldr \dst_q, [Htable, #64]
.endm

.macro load_full_htable
        load_h1  Ht1,  Ht1q
        load_h2  Ht2,  Ht2q
        load_h3  Ht3,  Ht3q
        load_h4  Ht4,  Ht4q
        load_h12 Ht12, Ht12q
        load_h34 Ht34, Ht34q
.endm

.macro load_htable_12
        load_h1  Ht1,  Ht1q
        load_h2  Ht2,  Ht2q
        load_h12 Ht12, Ht12q
.endm

.macro load_htable_34
        load_h3  Ht3,  Ht3q
        load_h4  Ht4,  Ht4q
        load_h34 Ht34, Ht34q
.endm

/********************************************************************/
/*                    Macros for GHASH udpate                       */
/********************************************************************/

.macro ghash_init_0 input, Hk, Hk_mid, tag
        rev64 \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_mid.1q, ghash_tmp.1d, \Hk_mid\().1d
.endm

.macro ghash_init_1 input, Hk, Hk_mid, tag
        rev64 \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_mid.1q, ghash_tmp.2d, \Hk_mid\().2d
.endm

.macro ghash_acc_0 input, Hk, Hk_mid
        rev64   \input\().16b, \input\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_tmp.1q, ghash_tmp.1d, \Hk_mid\().1d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_acc_1 input, Hk, Hk_mid
        rev64   \input\().16b, \input\().16b

        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_tmp.1q, ghash_tmp.2d, \Hk_mid\().2d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_finalize tag
        eor        modulo_tmp0.16b, ghash_lo.16b,  ghash_hi.16b
        pmull      modulo_tmp1.1q,  ghash_hi.1d,   ghash_mod.1d
        ext        ghash_hi.16b,    ghash_hi.16b,  ghash_hi.16b, #8
        eor        ghash_mid.16b,   ghash_mid.16b, modulo_tmp0.16b
        eor        modulo_tmp1.16b, ghash_hi.16b,  modulo_tmp1.16b
        eor        ghash_mid.16b,   ghash_mid.16b, modulo_tmp1.16b
        pmull      ghash_hi.1q,     ghash_mid.1d,  ghash_mod.1d
        eor        ghash_lo.16b,    ghash_lo.16b,  ghash_hi.16b
        ext        ghash_mid.16b,   ghash_mid.16b, ghash_mid.16b, #8
        eor        \tag\().16b,     ghash_lo.16b,  ghash_mid.16b
        ext        \tag\().16b, \tag\().16b, \tag\().16b, #8
.endm

.macro load_tag
        ldr      tag_q, [tag_ptr]
        rev64    tag.16b, tag.16b
.endm

.macro prepare_ghash
        // Prepare constant for modular reduction
        movi ghash_mod.8b, #0xc2
        shl  ghash_mod_d, ghash_mod_d, #56
.endm

/********************************************************************/
/*                            Core routine                          */
/********************************************************************/

.align        4
_aes_gcm_enc_kernel_slothy_base_192:
aes_gcm_enc_kernel_slothy_base_192:
#ifdef BORINGSSL_DISPATCH_TEST
        adrp  x9,_BORINGSSL_function_hit@PAGE
        add   x9, x9, _BORINGSSL_function_hit@PAGEOFF
        mov   w10, #1
        strb  w10, [x9,#2] // kFlag_aes_gcm_enc_kernel
#endif

        AARCH64_VALID_CALL_TARGET
        sub sp, sp, #STACK_SIZE

Lenc_preamble_start:
        save_gprs
        save_vregs

        lsr byte_len, len_bits, #3

        load_round_keys
        load_tag
        load_iv

        prepare_loop_counts
        prepare_ghash

Lenc_preamble_end:

        cbz count, Lloop_unrolled_end
        cmp count, #1
        b.eq Lloop_unrolled_start_iter_1
                                                 // Instructions:    101
                                                 // Expected cycles: 61
                                                 // Expected IPC:    1.66
                                                 // ------------------- expected cycle count ------------------->
                                                 // 0                        25                       50
                                                 // |------------------------|------------------------|----------
        ldr q1, [x6, #48]                        // *............................................................
        add v14.4S, v31.4S, v30.4S               // *............................................................
        rev32 v8.16B, v31.16B                    // .*...........................................................
        ldr q17, [x0, #32]                       // .*...........................................................
        rev32 v0.16B, v14.16B                    // ..*..........................................................
        add v14.4S, v14.4S, v30.4S               // ..*..........................................................
        aesr v8.16b, v18.16b                     // ...*.........................................................
        ldr q10, [x0], #(4*16)                   // ...*.........................................................
        aesr v0.16b, v18.16b                     // ....*........................................................
        rev32 v13.16B, v14.16B                   // ....*........................................................
        aesr v8.16b, v19.16b                     // .....*.......................................................
        ldr q6, [x6, #32]                        // .....*.......................................................
        eor v17.16B, v17.16B, v16.16B            // ......*......................................................
        aesr v0.16b, v19.16b                     // ......*......................................................
        aesr v8.16b, v20.16b                     // .......*.....................................................
        ldr q3, [x6, #16]                        // .......*.....................................................
        add v14.4S, v14.4S, v30.4S               // ........*....................................................
        aesr v0.16b, v20.16b                     // ........*....................................................
        eor v10.16B, v10.16B, v16.16B            // .........*...................................................
        aesr v8.16b, v21.16b                     // .........*...................................................
        aesr v0.16b, v21.16b                     // ..........*..................................................
        ldr q2, [x0, #-48]                       // ..........*..................................................
        aesr v8.16b, v22.16b                     // ...........*.................................................
        ldr q5, [x6]                             // ...........*.................................................
        aesr v0.16b, v22.16b                     // ............*................................................
        ldr q9, [x6, #80]                        // ............*................................................
        aesr v8.16b, v23.16b                     // .............*...............................................
        rev32 v4.16B, v14.16B                    // .............*...............................................
        eor v29.16B, v2.16B, v16.16B             // ..............*..............................................
        aesr v0.16b, v23.16b                     // ..............*..............................................
        add v31.4S, v14.4S, v30.4S               // ...............*.............................................
        aesr v8.16b, v24.16b                     // ...............*.............................................
        aesr v0.16b, v24.16b                     // ................*............................................
        ldr q12, [x0, #-16]                      // ................*............................................
        aesr v8.16b, v25.16b                     // .................*...........................................
        rev32 v14.16B, v31.16B                   // .................*...........................................
        aesr v0.16b, v25.16b                     // ..................*..........................................
        ldr q2, [x6, #64]                        // ..................*..........................................
        aesr v8.16b, v26.16b                     // ...................*.........................................
        eor v12.16B, v12.16B, v16.16B            // ....................*........................................
        aesr v0.16b, v26.16b                     // ....................*........................................
        aesr v8.16b, v27.16b                     // .....................*.......................................
        aesr v0.16b, v27.16b                     // ......................*......................................
        aesr v8.16b, v28.16b                     // .......................*.....................................
        aesr v0.16b, v28.16b                     // ........................*....................................
        aese v8.16b, v15.16b                     // .........................*...................................
        aese v0.16b, v15.16b                     // ..........................*..................................
        aesr v13.16b, v18.16b                    // ...........................*.................................
        eor v8.16B, v10.16B, v8.16B              // ...........................*.................................
        aesr v4.16b, v18.16b                     // ............................*................................
        eor v0.16B, v29.16B, v0.16B              // ............................*................................
        aesr v13.16b, v19.16b                    // .............................*...............................
        rev64 v10.16B, v8.16B                    // .............................*...............................
        aesr v4.16b, v19.16b                     // ..............................*..............................
        rev64 v29.16B, v0.16B                    // ..............................*..............................
        eor v10.16B, v10.16B, v11.16B            // ...............................*.............................
        aesr v13.16b, v20.16b                    // ...............................*.............................
        str q8, [x2], #(4*16)                    // ................................*............................
        pmull2 v8.1q, v29.2d, v1.2d              // ................................*............................
        pmull v1.1q, v29.1d, v1.1d               // .................................*...........................
        mov d11, v29.d[1]                        // .................................*...........................
        str q0, [x2, #-48]                       // ..................................*..........................
        aesr v13.16b, v21.16b                    // ..................................*..........................
        aesr v4.16b, v20.16b                     // ...................................*.........................
        ext v0.16B, v10.16B, v10.16B, #8         // ...................................*.........................
        eor v29.8B, v11.8B, v29.8B               // ....................................*........................
        aesr v13.16b, v22.16b                    // ....................................*........................
        aesr v4.16b, v21.16b                     // .....................................*.......................
        eor v11.16B, v0.16B, v10.16B             // .....................................*.......................
        aesr v13.16b, v23.16b                    // ......................................*......................
        aesr v4.16b, v22.16b                     // .......................................*.....................
        aesr v13.16b, v24.16b                    // ........................................*....................
        aesr v4.16b, v23.16b                     // .........................................*...................
        aesr v13.16b, v25.16b                    // ..........................................*..................
        aesr v4.16b, v24.16b                     // ...........................................*.................
        aesr v13.16b, v26.16b                    // ............................................*................
        aesr v4.16b, v25.16b                     // .............................................*...............
        aesr v13.16b, v27.16b                    // ..............................................*..............
        aesr v4.16b, v26.16b                     // ...............................................*.............
        aesr v13.16b, v28.16b                    // ................................................*............
        aesr v4.16b, v27.16b                     // .................................................*...........
        aese v13.16b, v15.16b                    // ..................................................*..........
        pmull v0.1q, v10.1d, v9.1d               // ...................................................*.........
        eor v13.16B, v17.16B, v13.16B            // ....................................................*........
        pmull2 v17.1q, v10.2d, v9.2d             // ....................................................*........
        eor v0.16B, v0.16B, v1.16B               // .....................................................*.......
        aesr v4.16b, v28.16b                     // .....................................................*.......
        aesr v14.16b, v18.16b                    // ......................................................*......
        rev64 v10.16B, v13.16B                   // ......................................................*......
        str q13, [x2, #-32]                      // .......................................................*.....
        aese v4.16b, v15.16b                     // .......................................................*.....
        pmull v9.1q, v10.1d, v6.1d               // ........................................................*....
        ext v13.16B, v10.16B, v10.16B, #8        // ........................................................*....
        pmull2 v6.1q, v10.2d, v6.2d              // .........................................................*...
        eor v1.16B, v12.16B, v4.16B              // .........................................................*...
        eor v4.16B, v17.16B, v8.16B              // ..........................................................*..
        aesr v14.16b, v19.16b                    // ..........................................................*..
        pmull v8.1q, v29.1d, v2.1d               // ...........................................................*.
        rev64 v17.16B, v1.16B                    // ...........................................................*.
        eor v12.16B, v0.16B, v9.16B              // ............................................................*
        aesr v14.16b, v20.16b                    // ............................................................*

        // original source code
        // rev32 V<ssa_53>.16B, v31.16B                                // ..*..................................................................................................
        // aesr V<ssa_53>.16b, v18.16b                                 // ......*..............................................................................................
        // aesr V<ssa_53>.16b, v19.16b                                 // ..........*..........................................................................................
        // aesr V<ssa_53>.16b, v20.16b                                 // ..............*......................................................................................
        // aesr V<ssa_53>.16b, v21.16b                                 // ...................*.................................................................................
        // aesr V<ssa_53>.16b, v22.16b                                 // ......................*..............................................................................
        // add V<ssa_78>.4S, v31.4S, v30.4S                            // .*...................................................................................................
        // aesr V<ssa_53>.16b, v23.16b                                 // ..........................*..........................................................................
        // rev32 V<ssa_81>.16B, V<ssa_78>.16B                          // ....*................................................................................................
        // aesr V<ssa_81>.16b, v18.16b                                 // ........*............................................................................................
        // add V<ssa_85>.4S, V<ssa_78>.4S, v30.4S                      // .....*...............................................................................................
        // aesr V<ssa_53>.16b, v24.16b                                 // ...............................*.....................................................................
        // aesr V<ssa_81>.16b, v19.16b                                 // .............*.......................................................................................
        // aesr V<ssa_53>.16b, v25.16b                                 // ..................................*..................................................................
        // ldr Q<ssa_87>, [x0, #32]                                    // ...*.................................................................................................
        // aesr V<ssa_81>.16b, v20.16b                                 // .................*...................................................................................
        // aesr V<ssa_53>.16b, v26.16b                                 // ......................................*..............................................................
        // rev32 V<ssa_89>.16B, V<ssa_85>.16B                          // .........*...........................................................................................
        // aesr V<ssa_53>.16b, v27.16b                                 // .........................................*...........................................................
        // ldr Q<ssa_91>, [x0], #(4*16)                                // .......*.............................................................................................
        // aesr V<ssa_81>.16b, v21.16b                                 // ....................*................................................................................
        // ldr Q<ssa_92>, [x6, #32]                                    // ...........*.........................................................................................
        // aesr V<ssa_53>.16b, v28.16b                                 // ...........................................*.........................................................
        // ldr q3, [x6, #16]                                           // ...............*.....................................................................................
        // add V<ssa_93>.4S, V<ssa_85>.4S, v30.4S                      // ................*....................................................................................
        // aesr V<ssa_81>.16b, v22.16b                                 // ........................*............................................................................
        // eor V<ssa_94>.16B, V<ssa_91>.16B, v16.16B                   // ..................*..................................................................................
        // aese V<ssa_53>.16b, v15.16b                                 // .............................................*.......................................................
        // aesr V<ssa_81>.16b, v23.16b                                 // .............................*.......................................................................
        // ldr Q<ssa_95>, [x0, #-48]                                   // .....................*...............................................................................
        // eor V<ssa_96>.16B, V<ssa_94>.16B, V<ssa_53>.16B             // ................................................*....................................................
        // aesr V<ssa_89>.16b, v18.16b                                 // ...............................................*.....................................................
        // aesr V<ssa_81>.16b, v24.16b                                 // ................................*....................................................................
        // aesr V<ssa_89>.16b, v19.16b                                 // ...................................................*.................................................
        // ldr q5, [x6]                                                // .......................*.............................................................................
        // aesr V<ssa_81>.16b, v25.16b                                 // ....................................*................................................................
        // aesr V<ssa_89>.16b, v20.16b                                 // ........................................................*............................................
        // ldr Q<ssa_99>, [x6, #80]                                    // .........................*...........................................................................
        // aesr V<ssa_81>.16b, v26.16b                                 // ........................................*............................................................
        // aesr V<ssa_89>.16b, v21.16b                                 // ..............................................................*......................................
        // rev32 V<ssa_101>.16B, V<ssa_93>.16B                         // ...........................*.........................................................................
        // aesr V<ssa_81>.16b, v27.16b                                 // ..........................................*..........................................................
        // aesr V<ssa_101>.16b, v18.16b                                // .................................................*...................................................
        // str Q<ssa_96>, [x2], #(4*16)                                // .........................................................*...........................................
        // aesr V<ssa_81>.16b, v28.16b                                 // ............................................*........................................................
        // eor V<ssa_104>.16B, V<ssa_95>.16B, v16.16B                  // ............................*........................................................................
        // aesr V<ssa_101>.16b, v19.16b                                // .....................................................*...............................................
        // add v31.4S, V<ssa_93>.4S, v30.4S                            // ..............................*......................................................................
        // aese V<ssa_81>.16b, v15.16b                                 // ..............................................*......................................................
        // eor V<ssa_105>.16B, V<ssa_87>.16B, v16.16B                  // ............*........................................................................................
        // aesr V<ssa_101>.16b, v20.16b                                // ...............................................................*.....................................
        // eor V<ssa_106>.16B, V<ssa_104>.16B, V<ssa_81>.16B           // ..................................................*..................................................
        // aesr V<ssa_101>.16b, v21.16b                                // ...................................................................*.................................
        // aesr V<ssa_89>.16b, v22.16b                                 // ..................................................................*..................................
        // aesr V<ssa_101>.16b, v22.16b                                // ......................................................................*..............................
        // rev64 V<ssa_110>.16B, V<ssa_106>.16B                        // ......................................................*..............................................
        // str Q<ssa_106>, [x2, #-48]                                  // .............................................................*.......................................
        // aesr V<ssa_89>.16b, v23.16b                                 // .....................................................................*...............................
        // aesr V<ssa_101>.16b, v23.16b                                // ........................................................................*............................
        // aesr V<ssa_89>.16b, v24.16b                                 // .......................................................................*.............................
        // ldr Q<ssa_112>, [x6, #48]                                   // *....................................................................................................
        // rev64 V<ssa_113>.16B, V<ssa_96>.16B                         // ....................................................*................................................
        // aesr V<ssa_101>.16b, v24.16b                                // ..........................................................................*..........................
        // aesr V<ssa_89>.16b, v25.16b                                 // .........................................................................*...........................
        // aesr V<ssa_101>.16b, v25.16b                                // ............................................................................*........................
        // ldr Q<ssa_115>, [x0, #-16]                                  // .................................*...................................................................
        // eor V<ssa_116>.16B, V<ssa_113>.16B, v11.16B                 // .......................................................*.............................................
        // aesr V<ssa_89>.16b, v26.16b                                 // ...........................................................................*.........................
        // aesr V<ssa_101>.16b, v26.16b                                // ..............................................................................*......................
        // mov D<ssa_117>, V<ssa_110>.d[1]                             // ............................................................*........................................
        // aesr V<ssa_89>.16b, v27.16b                                 // .............................................................................*.......................
        // ext V<ssa_118>.16B, V<ssa_116>.16B, V<ssa_116>.16B, #8      // ................................................................*....................................
        // aesr V<ssa_101>.16b, v27.16b                                // ................................................................................*....................
        // eor v11.16B, V<ssa_118>.16B, V<ssa_116>.16B                 // ....................................................................*................................
        // aesr V<ssa_89>.16b, v28.16b                                 // ...............................................................................*.....................
        // eor V<ssa_119>.16B, V<ssa_115>.16B, v16.16B                 // .......................................*.............................................................
        // aesr V<ssa_101>.16b, v28.16b                                // ......................................................................................*..............
        // aese V<ssa_89>.16b, v15.16b                                 // .................................................................................*...................
        // rev32 v14.16B, v31.16B                                      // ...................................*.................................................................
        // aese V<ssa_101>.16b, v15.16b                                // ..........................................................................................*..........
        // ldr q2, [x6, #64]                                           // .....................................*...............................................................
        // eor V<ssa_120>.16B, V<ssa_105>.16B, V<ssa_89>.16B           // ...................................................................................*.................
        // pmull V<ssa_121>.1q, V<ssa_116>.1d, V<ssa_99>.1d            // ..................................................................................*..................
        // eor v1.16B, V<ssa_119>.16B, V<ssa_101>.16B                  // ..............................................................................................*......
        // pmull2 V<ssa_122>.1q, V<ssa_110>.2d, V<ssa_112>.2d          // ..........................................................*..........................................
        // pmull2 V<ssa_123>.1q, V<ssa_116>.2d, V<ssa_99>.2d           // ....................................................................................*................
        // eor V<ssa_124>.8B, V<ssa_117>.8B, V<ssa_110>.8B             // .................................................................*...................................
        // pmull V<ssa_125>.1q, V<ssa_110>.1d, V<ssa_112>.1d           // ...........................................................*.........................................
        // rev64 v10.16B, V<ssa_120>.16B                               // ........................................................................................*............
        // eor v4.16B, V<ssa_123>.16B, V<ssa_122>.16B                  // ...............................................................................................*.....
        // pmull v8.1q, V<ssa_124>.1d, v2.1d                           // .................................................................................................*...
        // aesr v14.16b, v18.16b                                       // .......................................................................................*.............
        // eor V<ssa_126>.16B, V<ssa_121>.16B, V<ssa_125>.16B          // .....................................................................................*...............
        // str Q<ssa_120>, [x2, #-32]                                  // .........................................................................................*...........
        // pmull V<ssa_127>.1q, v10.1d, V<ssa_92>.1d                   // ...........................................................................................*.........
        // aesr v14.16b, v19.16b                                       // ................................................................................................*....
        // rev64 v17.16B, v1.16B                                       // ..................................................................................................*..
        // pmull2 v6.1q, v10.2d, V<ssa_92>.2d                          // .............................................................................................*.......
        // eor v12.16B, V<ssa_126>.16B, V<ssa_127>.16B                 // ...................................................................................................*.
        // aesr v14.16b, v20.16b                                       // ....................................................................................................*
        // ext v13.16B, v10.16B, v10.16B, #8                           // ............................................................................................*........

        sub count, count, #2
cbz count, Lloop_unrolled_start_postamble
Lloop_unrolled_start:
                                                 // Instructions:    123
                                                 // Expected cycles: 62
                                                 // Expected IPC:    1.98
                                                 // ------------------- expected cycle count -------------------->
                                                 // 0                        25                       50
                                                 // |------------------------|------------------------|-----------
        eor v4.16B, v4.16B, v6.16B               // l.............................................................
        pmull v29.1q, v17.1d, v5.1d              // l.............................................................
        eor v9.16B, v13.16B, v10.16B             // .l............................................................
        pmull2 v10.1q, v17.2d, v5.2d             // .l............................................................
        eor v12.16B, v12.16B, v29.16B            // ..l...........................................................
        aesr v14.16b, v21.16b                    // ..*...........................................................
        eor v10.16B, v4.16B, v10.16B             // ...l..........................................................
        pmull2 v5.1q, v11.2d, v2.2d              // ...l..........................................................
        aesr v14.16b, v22.16b                    // ....*.........................................................
        add v2.4S, v31.4S, v30.4S                // ....*.........................................................
        pmull2 v9.1q, v9.2d, v3.2d               // .....l........................................................
        eor v31.16B, v12.16B, v10.16B            // .....l........................................................
        aesr v14.16b, v23.16b                    // ......*.......................................................
        rev32 v0.16B, v2.16B                     // ......*.......................................................
        ext v13.16B, v10.16B, v10.16B, #8        // .......l......................................................
        pmull v10.1q, v10.1d, v7.1d              // .......l......................................................
        aesr v0.16b, v18.16b                     // ........*.....................................................
        mov d6, v17.d[1]                         // ........l.....................................................
        add v11.4S, v2.4S, v30.4S                // .........*....................................................
        aesr v14.16b, v24.16b                    // .........*....................................................
        eor v29.8B, v6.8B, v17.8B                // ..........l...................................................
        aesr v0.16b, v19.16b                     // ..........*...................................................
        aesr v14.16b, v25.16b                    // ...........*..................................................
        ldr q6, [x0, #32]                        // ...........*..................................................
        eor v2.16B, v13.16B, v10.16B             // ............l.................................................
        aesr v0.16b, v20.16b                     // ............*.................................................
        aesr v14.16b, v26.16b                    // .............*................................................
        rev32 v10.16B, v11.16B                   // .............*................................................
        pmull v13.1q, v29.1d, v3.1d              // ..............l...............................................
        str q1, [x2, #-16]                       // ..............l...............................................
        aesr v14.16b, v27.16b                    // ...............*..............................................
        ldr q1, [x0], #(4*16)                    // ...............*..............................................
        aesr v0.16b, v21.16b                     // ................*.............................................
        ldr q29, [x6, #32]                       // ................*.............................................
        aesr v14.16b, v28.16b                    // .................*............................................
        ldr q3, [x6, #16]                        // .................*............................................
        add v17.4S, v11.4S, v30.4S               // ..................*...........................................
        aesr v0.16b, v22.16b                     // ..................*...........................................
        eor v4.16B, v1.16B, v16.16B              // ...................*..........................................
        aese v14.16b, v15.16b                    // ...................*..........................................
        aesr v0.16b, v23.16b                     // ....................*.........................................
        ldr q1, [x0, #-48]                       // ....................*.........................................
        eor v11.16B, v4.16B, v14.16B             // .....................*........................................
        aesr v10.16b, v18.16b                    // .....................*........................................
        aesr v0.16b, v24.16b                     // ......................*.......................................
        eor v14.16B, v5.16B, v8.16B              // ......................l.......................................
        aesr v10.16b, v19.16b                    // .......................*......................................
        ldr q5, [x6]                             // .......................*......................................
        eor v9.16B, v14.16B, v9.16B              // ........................l.....................................
        aesr v0.16b, v25.16b                     // ........................*.....................................
        aesr v10.16b, v20.16b                    // .........................*....................................
        ldr q4, [x6, #80]                        // .........................*....................................
        eor v14.16B, v9.16B, v13.16B             // ..........................l...................................
        aesr v0.16b, v26.16b                     // ..........................*...................................
        aesr v10.16b, v21.16b                    // ...........................*..................................
        rev32 v8.16B, v17.16B                    // ...........................*..................................
        eor v31.16B, v14.16B, v31.16B            // ............................l.................................
        aesr v0.16b, v27.16b                     // ............................*.................................
        aesr v8.16b, v18.16b                     // .............................*................................
        str q11, [x2], #(4*16)                   // .............................*................................
        eor v9.16B, v31.16B, v2.16B              // ..............................l...............................
        aesr v0.16b, v28.16b                     // ..............................*...............................
        eor v1.16B, v1.16B, v16.16B              // ...............................*..............................
        aesr v8.16b, v19.16b                     // ...............................*..............................
        add v31.4S, v17.4S, v30.4S               // ................................*.............................
        aese v0.16b, v15.16b                     // ................................*.............................
        eor v6.16B, v6.16B, v16.16B              // .................................*............................
        aesr v8.16b, v20.16b                     // .................................*............................
        eor v14.16B, v1.16B, v0.16B              // ..................................*...........................
        pmull v17.1q, v9.1d, v7.1d               // ..................................l...........................
        ext v13.16B, v9.16B, v9.16B, #8          // ...................................l..........................
        aesr v8.16b, v21.16b                     // ...................................*..........................
        aesr v10.16b, v22.16b                    // ....................................*.........................
        eor v9.16B, v12.16B, v17.16B             // ....................................l.........................
        aesr v8.16b, v22.16b                     // .....................................*........................
        rev64 v12.16B, v14.16B                   // .....................................*........................
        str q14, [x2, #-48]                      // ......................................*.......................
        aesr v10.16b, v23.16b                    // ......................................*.......................
        aesr v8.16b, v23.16b                     // .......................................*......................
        eor v14.16B, v9.16B, v13.16B             // .......................................l......................
        aesr v10.16b, v24.16b                    // ........................................*.....................
        ldr q17, [x6, #48]                       // ........................................*.....................
        rev64 v9.16B, v11.16B                    // .........................................*....................
        aesr v8.16b, v24.16b                     // .........................................*....................
        aesr v10.16b, v25.16b                    // ..........................................*...................
        ext v11.16B, v14.16B, v14.16B, #8        // ..........................................l...................
        aesr v8.16b, v25.16b                     // ...........................................*..................
        ldr q14, [x0, #-16]                      // ...........................................*..................
        eor v13.16B, v9.16B, v11.16B             // ............................................*.................
        aesr v10.16b, v26.16b                    // ............................................*.................
        aesr v8.16b, v26.16b                     // .............................................*................
        mov d9, v12.d[1]                         // .............................................*................
        aesr v10.16b, v27.16b                    // ..............................................*...............
        ext v1.16B, v13.16B, v13.16B, #8         // ..............................................*...............
        aesr v8.16b, v27.16b                     // ...............................................*..............
        eor v11.16B, v1.16B, v13.16B             // ................................................*.............
        aesr v10.16b, v28.16b                    // ................................................*.............
        eor v1.16B, v14.16B, v16.16B             // .................................................*............
        aesr v8.16b, v28.16b                     // .................................................*............
        aese v10.16b, v15.16b                    // ..................................................*...........
        rev32 v14.16B, v31.16B                   // ..................................................e...........
        aese v8.16b, v15.16b                     // ...................................................*..........
        ldr q2, [x6, #64]                        // ...................................................*..........
        eor v0.16B, v6.16B, v10.16B              // ....................................................*.........
        pmull v6.1q, v13.1d, v4.1d               // ....................................................*.........
        eor v1.16B, v1.16B, v8.16B               // .....................................................*........
        pmull2 v8.1q, v12.2d, v17.2d             // .....................................................*........
        pmull2 v4.1q, v13.2d, v4.2d              // ......................................................*.......
        eor v9.8B, v9.8B, v12.8B                 // ......................................................*.......
        pmull v13.1q, v12.1d, v17.1d             // .......................................................*......
        rev64 v10.16B, v0.16B                    // .......................................................*......
        eor v4.16B, v4.16B, v8.16B               // ........................................................*.....
        pmull v8.1q, v9.1d, v2.1d                // ........................................................*.....
        aesr v14.16b, v18.16b                    // .........................................................e....
        eor v12.16B, v6.16B, v13.16B             // .........................................................*....
        str q0, [x2, #-32]                       // ..........................................................*...
        pmull v13.1q, v10.1d, v29.1d             // ..........................................................*...
        aesr v14.16b, v19.16b                    // ...........................................................e..
        rev64 v17.16B, v1.16B                    // ...........................................................*..
        pmull2 v6.1q, v10.2d, v29.2d             // ............................................................*.
        eor v12.16B, v12.16B, v13.16B            // ............................................................*.
        aesr v14.16b, v20.16b                    // .............................................................e
        ext v13.16B, v10.16B, v10.16B, #8        // .............................................................*

        // original source code
        // ldr q29, [x0], #(4*16)                          // .......................|..............................*...........................................................................................|..............................*......................................................
        // rev32  v0.16b, v31.16b                          // e......................|...................................................................................................e......................|.....................................................................................
        // add    v31.4s, v31.4s, v30.4s                   // .......................|........*.................................................................................................................|........*............................................................................
        // aesr v0.16b, v18.16b                            // .............e.........|................................................................................................................e.........|.....................................................................................
        // aesr v0.16b, v19.16b                            // .................e.....|....................................................................................................................e.....|.....................................................................................
        // aesr v0.16b, v20.16b                            // .....................e.|........................................................................................................................e.|.....................................................................................
        // aesr v0.16b, v21.16b                            // .......................|....*.....................................................................................................................|....*................................................................................
        // aesr v0.16b, v22.16b                            // .......................|.......*..................................................................................................................|.......*.............................................................................
        // aesr v0.16b, v23.16b                            // .......................|...........*..............................................................................................................|...........*.........................................................................
        // aesr v0.16b, v24.16b                            // .......................|..................*.......................................................................................................|..................*..................................................................
        // aesr v0.16b, v25.16b                            // .......................|.....................*....................................................................................................|.....................*...............................................................
        // aesr v0.16b, v26.16b                            // .......................|.........................*................................................................................................|.........................*...........................................................
        // aesr v0.16b, v27.16b                            // .......................|.............................*............................................................................................|.............................*.......................................................
        // aesr v0.16b, v28.16b                            // .......................|.................................*........................................................................................|.................................*...................................................
        // aese v0.16b, v15.16b                            // .......................|......................................*...................................................................................|......................................*..............................................
        // eor v29.16b, v29.16b, v16.16b                   // .......................|.....................................*....................................................................................|.....................................*...............................................
        // eor v0.16b, v29.16b, v0.16b                     // .......................|.........................................*................................................................................|.........................................*...........................................
        // str q0, [x2], #(4*16)                           // .......................|..........................................................*...............................................................|..........................................................*..........................
        // ldr q12, [x6, #48]                              // .......................|................................................................................*.........................................|................................................................................*....
        // ldr q13, [x6, #80]                              // .......................|..................................................*.......................................................................|..................................................*..................................
        // ldr q14, [x6, #64]                              // ..*....................|.....................................................................................................*....................|.....................................................................................
        // rev64 v0.16b, v0.16b                            // .......................|.................................................................................*........................................|.................................................................................*...
        // eor   v0.16b, v0.16b, v11.16b                   // .......................|.......................................................................................*..................................|.....................................................................................
        // pmull   v8.1q, v0.1d, v13.1d                    // ....*..................|.......................................................................................................*..................|.....................................................................................
        // pmull2  v9.1q, v0.2d, v13.2d                    // .......*...............|..........................................................................................................*...............|.....................................................................................
        // ext     v11.16b, v0.16b, v0.16b, #8             // .......................|............................................................................................*.............................|.....................................................................................
        // eor     v11.16b, v11.16b, v0.16b                // .......................|..............................................................................................*...........................|.....................................................................................
        // pmull2  v10.1q, v11.2d, v14.2d                  // .......................|......l...................................................................................................................|......l..............................................................................
        // ldr q29, [x0, #(-3*16)]                         // .......................|........................................*.................................................................................|........................................*............................................
        // rev32  v0.16b, v31.16b                          // .......................|............*.............................................................................................................|............*........................................................................
        // add    v31.4s, v31.4s, v30.4s                   // .......................|.................*........................................................................................................|.................*...................................................................
        // aesr v0.16b, v18.16b                            // .......................|...............*..........................................................................................................|...............*.....................................................................
        // aesr v0.16b, v19.16b                            // .......................|....................*.....................................................................................................|....................*................................................................
        // aesr v0.16b, v20.16b                            // .......................|........................*.................................................................................................|........................*............................................................
        // aesr v0.16b, v21.16b                            // .......................|...............................*..........................................................................................|...............................*.....................................................
        // aesr v0.16b, v22.16b                            // .......................|....................................*.....................................................................................|....................................*................................................
        // aesr v0.16b, v23.16b                            // .......................|.......................................*..................................................................................|.......................................*.............................................
        // aesr v0.16b, v24.16b                            // .......................|...........................................*..............................................................................|...........................................*.........................................
        // aesr v0.16b, v25.16b                            // .......................|................................................*.........................................................................|................................................*....................................
        // aesr v0.16b, v26.16b                            // .......................|....................................................*.....................................................................|....................................................*................................
        // aesr v0.16b, v27.16b                            // .......................|........................................................*.................................................................|........................................................*............................
        // aesr v0.16b, v28.16b                            // .......................|............................................................*.............................................................|............................................................*........................
        // aese v0.16b, v15.16b                            // .......................|................................................................*.........................................................|................................................................*....................
        // eor v29.16b, v29.16b, v16.16b                   // .......................|.............................................................*............................................................|.............................................................*.......................
        // eor v0.16b, v29.16b, v0.16b                     // .......................|...................................................................*......................................................|...................................................................*.................
        // str q0, [x2, #(-3*16)]                          // .......................|...........................................................................*..............................................|...........................................................................*.........
        // rev64   v0.16b, v0.16b                          // .......................|..........................................................................*...............................................|..........................................................................*..........
        // pmull   v11.1q, v0.1d, v12.1d                   // .........*.............|............................................................................................................*.............|.....................................................................................
        // eor     v8.16b, v8.16b, v11.16b                 // ..............*........|.................................................................................................................*........|.....................................................................................
        // pmull2  v11.1q, v0.2d, v12.2d                   // ......*................|.........................................................................................................*................|.....................................................................................
        // eor     v9.16b, v9.16b, v11.16b                 // ...........*...........|..............................................................................................................*...........|.....................................................................................
        // mov     d11, v0.d[1]                            // .......................|..........................................................................................*...............................|.....................................................................................
        // eor     v11.8b, v11.8b, v0.8b                   // ........*..............|...........................................................................................................*..............|.....................................................................................
        // pmull   v11.1q, v11.1d, v14.1d                  // ............*..........|...............................................................................................................*..........|.....................................................................................
        // eor     v10.16b, v10.16b, v11.16b               // .......................|............................................l.............................................................................|............................................l........................................
        // ldr q29, [x0, #(-2*16)]                         // .......................|......................*...................................................................................................|......................*..............................................................
        // rev32  v0.16b, v31.16b                          // .......................|..........................*...............................................................................................|..........................*..........................................................
        // add    v31.4s, v31.4s, v30.4s                   // .......................|...................................*......................................................................................|...................................*.................................................
        // aesr v0.16b, v18.16b                            // .......................|..........................................*...............................................................................|..........................................*..........................................
        // aesr v0.16b, v19.16b                            // .......................|.............................................*............................................................................|.............................................*.......................................
        // aesr v0.16b, v20.16b                            // .......................|.................................................*........................................................................|.................................................*...................................
        // aesr v0.16b, v21.16b                            // .......................|.....................................................*....................................................................|.....................................................*...............................
        // aesr v0.16b, v22.16b                            // .......................|.......................................................................*..................................................|.......................................................................*.............
        // aesr v0.16b, v23.16b                            // .......................|............................................................................*.............................................|............................................................................*........
        // aesr v0.16b, v24.16b                            // .......................|...............................................................................*..........................................|...............................................................................*.....
        // aesr v0.16b, v25.16b                            // .......................|...................................................................................*......................................|...................................................................................*.
        // aesr v0.16b, v26.16b                            // .......................|........................................................................................*.................................|.....................................................................................
        // aesr v0.16b, v27.16b                            // .......................|...........................................................................................*..............................|.....................................................................................
        // aesr v0.16b, v28.16b                            // .......................|...............................................................................................*..........................|.....................................................................................
        // aese v0.16b, v15.16b                            // .......................|..................................................................................................*.......................|.....................................................................................
        // eor v29.16b, v29.16b, v16.16b                   // .......................|.................................................................*........................................................|.................................................................*...................
        // eor v0.16b, v29.16b, v0.16b                     // ...*...................|......................................................................................................*...................|.....................................................................................
        // str q0, [x2, #(-2*16)]                          // ...............*.......|..................................................................................................................*.......|.....................................................................................
        // ldr q12, [x6]                                   // .......................|..............................................*...........................................................................|..............................................*......................................
        // ldr q13, [x6, #32]                              // .......................|................................*.........................................................................................|................................*....................................................
        // ldr q14, [x6, #16]                              // .......................|..................................*.......................................................................................|..................................*..................................................
        // rev64   v0.16b, v0.16b                          // ..........*............|.............................................................................................................*............|.....................................................................................
        // pmull   v11.1q, v0.1d, v13.1d                   // ................*......|...................................................................................................................*......|.....................................................................................
        // eor     v8.16b, v8.16b, v11.16b                 // ....................*..|.......................................................................................................................*..|.....................................................................................
        // pmull2  v11.1q, v0.2d, v13.2d                   // ...................*...|......................................................................................................................*...|.....................................................................................
        // eor     v9.16b, v9.16b, v11.16b                 // .......................l..........................................................................................................................l.....................................................................................
        // ext     v11.16b, v0.16b, v0.16b, #8             // ......................*|.........................................................................................................................*|.....................................................................................
        // eor     v11.16b, v11.16b, v0.16b                // .......................|.l........................................................................................................................|.l...................................................................................
        // pmull2  v11.1q, v11.2d, v14.2d                  // .......................|.........l................................................................................................................|.........l...........................................................................
        // eor     v10.16b, v10.16b, v11.16b               // .......................|...............................................l..........................................................................|...............................................l.....................................
        // ldr q29, [x0, #(-1*16)]                         // .......................|......................................................................................*...................................|.....................................................................................
        // rev32  v0.16b, v31.16b                          // .......................|......................................................*...................................................................|......................................................*..............................
        // add    v31.4s, v31.4s, v30.4s                   // .......................|...............................................................*..........................................................|...............................................................*.....................
        // aesr v0.16b, v18.16b                            // .......................|.........................................................*................................................................|.........................................................*...........................
        // aesr v0.16b, v19.16b                            // .......................|..............................................................*...........................................................|..............................................................*......................
        // aesr v0.16b, v20.16b                            // .......................|..................................................................*.......................................................|..................................................................*..................
        // aesr v0.16b, v21.16b                            // .......................|......................................................................*...................................................|......................................................................*..............
        // aesr v0.16b, v22.16b                            // .......................|.........................................................................*................................................|.........................................................................*...........
        // aesr v0.16b, v23.16b                            // .......................|.............................................................................*............................................|.............................................................................*.......
        // aesr v0.16b, v24.16b                            // .......................|..................................................................................*.......................................|..................................................................................*..
        // aesr v0.16b, v25.16b                            // .......................|.....................................................................................*....................................|.....................................................................................
        // aesr v0.16b, v26.16b                            // .......................|.........................................................................................*................................|.....................................................................................
        // aesr v0.16b, v27.16b                            // .......................|.............................................................................................*............................|.....................................................................................
        // aesr v0.16b, v28.16b                            // .......................|.................................................................................................*........................|.....................................................................................
        // aese v0.16b, v15.16b                            // .*.....................|....................................................................................................*.....................|.....................................................................................
        // eor v29.16b, v29.16b, v16.16b                   // .......................|................................................................................................*.........................|.....................................................................................
        // eor v0.16b, v29.16b, v0.16b                     // .....*.................|........................................................................................................*.................|.....................................................................................
        // str q0, [x2, #(-1*16)]                          // .......................|............................l.............................................................................................|............................l........................................................
        // rev64   v0.16b, v0.16b                          // ..................*....|.....................................................................................................................*....|.....................................................................................
        // pmull   v11.1q, v0.1d, v12.1d                   // .......................|l.........................................................................................................................|l....................................................................................
        // eor     v8.16b, v8.16b, v11.16b                 // .......................|...l......................................................................................................................|...l.................................................................................
        // pmull2  v11.1q, v0.2d, v12.2d                   // .......................|..l.......................................................................................................................|..l..................................................................................
        // eor     v9.16b, v9.16b, v11.16b                 // .......................|.....l....................................................................................................................|.....l...............................................................................
        // mov     d11, v0.d[1]                            // .......................|................l.........................................................................................................|................l....................................................................
        // eor     v11.8b, v11.8b, v0.8b                   // .......................|...................l......................................................................................................|...................l.................................................................
        // pmull   v11.1q, v11.1d, v14.1d                  // .......................|...........................l..............................................................................................|...........................l.........................................................
        // eor     v10.16b, v10.16b, v11.16b               // .......................|...................................................l......................................................................|...................................................l.................................
        // eor        v0.16b, v8.16b,  v9.16b              // .......................|..........l...............................................................................................................|..........l..........................................................................
        // pmull      v1.1q,  v9.1d,   v7.1d               // .......................|..............l...........................................................................................................|..............l......................................................................
        // ext        v9.16b,    v9.16b,  v9.16b, #8       // .......................|.............l............................................................................................................|.............l.......................................................................
        // eor        v10.16b,   v10.16b, v0.16b           // .......................|.......................................................l..................................................................|.......................................................l.............................
        // eor        v1.16b, v9.16b,  v1.16b              // .......................|.......................l..................................................................................................|.......................l.............................................................
        // eor        v10.16b,   v10.16b, v1.16b           // .......................|...........................................................l..............................................................|...........................................................l.........................
        // pmull      v9.1q,     v10.1d,  v7.1d            // .......................|....................................................................l.....................................................|....................................................................l................
        // eor        v8.16b,    v8.16b,  v9.16b           // .......................|........................................................................l.................................................|........................................................................l............
        // ext        v10.16b,   v10.16b, v10.16b, #8      // .......................|.....................................................................l....................................................|.....................................................................l...............
        // eor        v11.16b,     v8.16b,  v10.16b        // .......................|..............................................................................l...........................................|..............................................................................l......
        // ext        v11.16b, v11.16b, v11.16b, #8        // .......................|....................................................................................l.....................................|....................................................................................l

        sub count, count, #1
        cbnz count, Lloop_unrolled_start
Lloop_unrolled_start_postamble:// end of loop kernel
                                                 // Instructions:    145
                                                 // Expected cycles: 80
                                                 // Expected IPC:    1.81
                                                 // ---------------------------- expected cycle count ----------------------------->
                                                 // 0                        25                       50                       75
                                                 // |------------------------|------------------------|------------------------|----
        pmull2 v2.1q, v11.2d, v2.2d              // *...............................................................................
        add v29.4S, v31.4S, v30.4S               // *...............................................................................
        pmull2 v11.1q, v17.2d, v5.2d             // .*..............................................................................
        eor v0.16B, v13.16B, v10.16B             // .*..............................................................................
        pmull v5.1q, v17.1d, v5.1d               // ..*.............................................................................
        rev32 v10.16B, v29.16B                   // ..*.............................................................................
        pmull2 v0.1q, v0.2d, v3.2d               // ...*............................................................................
        mov d13, v17.d[1]                        // ...*............................................................................
        eor v31.16B, v4.16B, v6.16B              // ....*...........................................................................
        aesr v10.16b, v18.16b                    // ....*...........................................................................
        aesr v14.16b, v21.16b                    // .....*..........................................................................
        eor v13.8B, v13.8B, v17.8B               // .....*..........................................................................
        eor v11.16B, v31.16B, v11.16B            // ......*.........................................................................
        aesr v10.16b, v19.16b                    // ......*.........................................................................
        pmull v3.1q, v13.1d, v3.1d               // .......*........................................................................
        eor v17.16B, v2.16B, v8.16B              // .......*........................................................................
        ext v13.16B, v11.16B, v11.16B, #8        // ........*.......................................................................
        aesr v10.16b, v20.16b                    // ........*.......................................................................
        pmull v4.1q, v11.1d, v7.1d               // .........*......................................................................
        add v8.4S, v29.4S, v30.4S                // .........*......................................................................
        eor v6.16B, v12.16B, v5.16B              // ..........*.....................................................................
        aesr v10.16b, v21.16b                    // ..........*.....................................................................
        aesr v14.16b, v22.16b                    // ...........*....................................................................
        eor v12.16B, v13.16B, v4.16B             // ...........*....................................................................
        rev32 v5.16B, v8.16B                     // ............*...................................................................
        aesr v10.16b, v22.16b                    // ............*...................................................................
        aesr v14.16b, v23.16b                    // .............*..................................................................
        eor v0.16B, v17.16B, v0.16B              // .............*..................................................................
        add v13.4S, v8.4S, v30.4S                // ..............*.................................................................
        aesr v10.16b, v23.16b                    // ..............*.................................................................
        aesr v14.16b, v24.16b                    // ...............*................................................................
        eor v8.16B, v0.16B, v3.16B               // ...............*................................................................
        eor v2.16B, v6.16B, v11.16B              // ................*...............................................................
        aesr v10.16b, v24.16b                    // ................*...............................................................
        aesr v5.16b, v18.16b                     // .................*..............................................................
        rev32 v4.16B, v13.16B                    // .................*..............................................................
        ldr q3, [x0, #32]                        // ..................*.............................................................
        aesr v10.16b, v25.16b                    // ..................*.............................................................
        eor v11.16B, v8.16B, v2.16B              // ...................*............................................................
        aesr v4.16b, v18.16b                     // ...................*............................................................
        ldr q0, [x0], #(4*16)                    // ....................*...........................................................
        aesr v10.16b, v26.16b                    // ....................*...........................................................
        eor v9.16B, v11.16B, v12.16B             // .....................*..........................................................
        aesr v14.16b, v25.16b                    // .....................*..........................................................
        aesr v10.16b, v27.16b                    // ......................*.........................................................
        ldr q31, [x0, #-48]                      // ......................*.........................................................
        ldr q2, [x6, #16]                        // .......................*........................................................
        pmull v17.1q, v9.1d, v7.1d               // .......................*........................................................
        ldr q29, [x6, #80]                       // ........................*.......................................................
        aesr v14.16b, v26.16b                    // ........................*.......................................................
        eor v8.16B, v0.16B, v16.16B              // .........................*......................................................
        aesr v10.16b, v28.16b                    // .........................*......................................................
        aesr v5.16b, v19.16b                     // ..........................*.....................................................
        eor v12.16B, v31.16B, v16.16B            // ..........................*.....................................................
        aese v10.16b, v15.16b                    // ...........................*....................................................
        ldr q11, [x0, #-16]                      // ...........................*....................................................
        aesr v14.16b, v27.16b                    // ............................*...................................................
        add v31.4S, v13.4S, v30.4S               // ............................*...................................................
        eor v3.16B, v3.16B, v16.16B              // .............................*..................................................
        aesr v5.16b, v20.16b                     // .............................*..................................................
        aesr v14.16b, v28.16b                    // ..............................*.................................................
        ext v9.16B, v9.16B, v9.16B, #8           // ..............................*.................................................
        aesr v4.16b, v19.16b                     // ...............................*................................................
        eor v0.16B, v11.16B, v16.16B             // ...............................*................................................
        eor v17.16B, v6.16B, v17.16B             // ................................*...............................................
        aesr v5.16b, v21.16b                     // ................................*...............................................
        aese v14.16b, v15.16b                    // .................................*..............................................
        ldr q13, [x6, #32]                       // .................................*..............................................
        eor v6.16B, v17.16B, v9.16B              // ..................................*.............................................
        aesr v5.16b, v22.16b                     // ..................................*.............................................
        aesr v4.16b, v20.16b                     // ...................................*............................................
        eor v11.16B, v8.16B, v14.16B             // ...................................*............................................
        ext v14.16B, v6.16B, v6.16B, #8          // ....................................*...........................................
        aesr v5.16b, v23.16b                     // ....................................*...........................................
        aesr v4.16b, v21.16b                     // .....................................*..........................................
        str q1, [x2, #-16]                       // .....................................*..........................................
        rev64 v1.16B, v11.16B                    // ......................................*.........................................
        aesr v5.16b, v24.16b                     // ......................................*.........................................
        aesr v4.16b, v22.16b                     // .......................................*........................................
        str q11, [x2], #(4*16)                   // .......................................*........................................
        eor v6.16B, v1.16B, v14.16B              // ........................................*.......................................
        aesr v5.16b, v25.16b                     // ........................................*.......................................
        ldr q9, [x6, #48]                        // .........................................*......................................
        aesr v4.16b, v23.16b                     // .........................................*......................................
        eor v14.16B, v12.16B, v10.16B            // ..........................................*.....................................
        aesr v5.16b, v26.16b                     // ..........................................*.....................................
        aesr v4.16b, v24.16b                     // ...........................................*....................................
        ldr q12, [x6]                            // ...........................................*....................................
        rev64 v10.16B, v14.16B                   // ............................................*...................................
        aesr v5.16b, v27.16b                     // ............................................*...................................
        aesr v4.16b, v25.16b                     // .............................................*..................................
        str q14, [x2, #-48]                      // .............................................*..................................
        ext v17.16B, v6.16B, v6.16B, #8          // ..............................................*.................................
        aesr v5.16b, v28.16b                     // ..............................................*.................................
        aesr v4.16b, v26.16b                     // ...............................................*................................
        mov d1, v10.d[1]                         // ...............................................*................................
        eor v17.16B, v17.16B, v6.16B             // ................................................*...............................
        aese v5.16b, v15.16b                     // ................................................*...............................
        aesr v4.16b, v27.16b                     // .................................................*..............................
        eor v1.8B, v1.8B, v10.8B                 // .................................................*..............................
        pmull2 v14.1q, v6.2d, v29.2d             // ..................................................*.............................
        eor v11.16B, v3.16B, v5.16B              // ..................................................*.............................
        aesr v4.16b, v28.16b                     // ...................................................*............................
        ldr q3, [x6, #64]                        // ...................................................*............................
        rev64 v5.16B, v11.16B                    // ....................................................*...........................
        pmull v6.1q, v6.1d, v29.1d               // ....................................................*...........................
        str q11, [x2, #-32]                      // .....................................................*..........................
        aese v4.16b, v15.16b                     // .....................................................*..........................
        ext v29.16B, v5.16B, v5.16B, #8          // ......................................................*.........................
        pmull2 v11.1q, v10.2d, v9.2d             // ......................................................*.........................
        pmull v8.1q, v10.1d, v9.1d               // .......................................................*........................
        eor v10.16B, v0.16B, v4.16B              // .......................................................*........................
        pmull v4.1q, v5.1d, v13.1d               // ........................................................*.......................
        eor v14.16B, v14.16B, v11.16B            // ........................................................*.......................
        eor v0.16B, v6.16B, v8.16B               // .........................................................*......................
        pmull2 v13.1q, v5.2d, v13.2d             // .........................................................*......................
        pmull2 v11.1q, v17.2d, v3.2d             // ..........................................................*.....................
        rev64 v6.16B, v10.16B                    // ..........................................................*.....................
        eor v8.16B, v29.16B, v5.16B              // ...........................................................*....................
        eor v14.16B, v14.16B, v13.16B            // ...........................................................*....................
        eor v0.16B, v0.16B, v4.16B               // ............................................................*...................
        pmull v1.1q, v1.1d, v3.1d                // ............................................................*...................
        mov d9, v6.d[1]                          // .............................................................*..................
        pmull v5.1q, v6.1d, v12.1d               // .............................................................*..................
        eor v4.16B, v11.16B, v1.16B              // ..............................................................*.................
        pmull2 v17.1q, v6.2d, v12.2d             // ..............................................................*.................
        eor v13.8B, v9.8B, v6.8B                 // ...............................................................*................
        pmull2 v29.1q, v8.2d, v2.2d              // ...............................................................*................
        eor v0.16B, v0.16B, v5.16B               // ................................................................*...............
        eor v14.16B, v14.16B, v17.16B            // ................................................................*...............
        eor v1.16B, v4.16B, v29.16B              // .................................................................*..............
        pmull v17.1q, v13.1d, v2.1d              // .................................................................*..............
        pmull v3.1q, v14.1d, v7.1d               // ..................................................................*.............
        ext v13.16B, v14.16B, v14.16B, #8        // ..................................................................*.............
        eor v8.16B, v1.16B, v17.16B              // ...................................................................*............
        eor v5.16B, v0.16B, v14.16B              // ...................................................................*............
        eor v14.16B, v13.16B, v3.16B             // ....................................................................*...........
        eor v29.16B, v8.16B, v5.16B              // .....................................................................*..........
        eor v14.16B, v29.16B, v14.16B            // .......................................................................*........
        pmull v1.1q, v14.1d, v7.1d               // .........................................................................*......
        ext v4.16B, v14.16B, v14.16B, #8         // .........................................................................*......
        eor v1.16B, v0.16B, v1.16B               // ...........................................................................*....
        eor v8.16B, v1.16B, v4.16B               // .............................................................................*..
        str q10, [x2, #-16]                      // ...............................................................................*
        ext v11.16B, v8.16B, v8.16B, #8          // ...............................................................................*

        // original source code
        // eor V<ssa_0>.16B, v4.16B, v6.16B                            // ........*........................................................................................................................................
        // pmull V<ssa_1>.1q, v17.1d, v5.1d                            // ....*............................................................................................................................................
        // eor V<ssa_2>.16B, v13.16B, v10.16B                          // ...*.............................................................................................................................................
        // pmull2 V<ssa_3>.1q, v17.2d, v5.2d                           // ..*..............................................................................................................................................
        // eor V<ssa_4>.16B, v12.16B, V<ssa_1>.16B                     // ....................*............................................................................................................................
        // aesr v14.16b, v21.16b                                       // ..........*......................................................................................................................................
        // eor V<ssa_5>.16B, V<ssa_0>.16B, V<ssa_3>.16B                // ............*....................................................................................................................................
        // pmull2 V<ssa_6>.1q, v11.2d, v2.2d                           // *................................................................................................................................................
        // aesr v14.16b, v22.16b                                       // ......................*..........................................................................................................................
        // add V<ssa_7>.4S, v31.4S, v30.4S                             // .*...............................................................................................................................................
        // pmull2 V<ssa_8>.1q, V<ssa_2>.2d, v3.2d                      // ......*..........................................................................................................................................
        // eor V<ssa_9>.16B, V<ssa_4>.16B, V<ssa_5>.16B                // ................................*................................................................................................................
        // aesr v14.16b, v23.16b                                       // ..........................*......................................................................................................................
        // rev32 V<ssa_10>.16B, V<ssa_7>.16B                           // .....*...........................................................................................................................................
        // ext V<ssa_11>.16B, V<ssa_5>.16B, V<ssa_5>.16B, #8           // ................*................................................................................................................................
        // pmull V<ssa_12>.1q, V<ssa_5>.1d, v7.1d                      // ..................*..............................................................................................................................
        // aesr V<ssa_10>.16b, v18.16b                                 // .........*.......................................................................................................................................
        // mov D<ssa_13>, v17.d[1]                                     // .......*.........................................................................................................................................
        // add V<ssa_14>.4S, V<ssa_7>.4S, v30.4S                       // ...................*.............................................................................................................................
        // aesr v14.16b, v24.16b                                       // ..............................*..................................................................................................................
        // eor V<ssa_15>.8B, V<ssa_13>.8B, v17.8B                      // ...........*.....................................................................................................................................
        // aesr V<ssa_10>.16b, v19.16b                                 // .............*...................................................................................................................................
        // aesr v14.16b, v25.16b                                       // ...........................................*.....................................................................................................
        // ldr Q<ssa_16>, [x0, #32]                                    // ....................................*............................................................................................................
        // eor V<ssa_17>.16B, V<ssa_11>.16B, V<ssa_12>.16B             // .......................*.........................................................................................................................
        // aesr V<ssa_10>.16b, v20.16b                                 // .................*...............................................................................................................................
        // aesr v14.16b, v26.16b                                       // .................................................*...............................................................................................
        // rev32 V<ssa_18>.16B, V<ssa_14>.16B                          // ........................*........................................................................................................................
        // pmull V<ssa_19>.1q, V<ssa_15>.1d, v3.1d                     // ..............*..................................................................................................................................
        // str q1, [x2, #-16]                                          // ...........................................................................*.....................................................................
        // aesr v14.16b, v27.16b                                       // ........................................................*........................................................................................
        // ldr Q<ssa_20>, [x0], #(4*16)                                // ........................................*........................................................................................................
        // aesr V<ssa_10>.16b, v21.16b                                 // .....................*...........................................................................................................................
        // ldr Q<ssa_21>, [x6, #32]                                    // ...................................................................*.............................................................................
        // aesr v14.16b, v28.16b                                       // ............................................................*....................................................................................
        // ldr Q<ssa_22>, [x6, #16]                                    // ..............................................*..................................................................................................
        // add V<ssa_23>.4S, V<ssa_14>.4S, v30.4S                      // ............................*....................................................................................................................
        // aesr V<ssa_10>.16b, v22.16b                                 // .........................*.......................................................................................................................
        // eor V<ssa_24>.16B, V<ssa_20>.16B, v16.16B                   // ..................................................*..............................................................................................
        // aese v14.16b, v15.16b                                       // ..................................................................*..............................................................................
        // aesr V<ssa_10>.16b, v23.16b                                 // .............................*...................................................................................................................
        // ldr Q<ssa_25>, [x0, #-48]                                   // .............................................*...................................................................................................
        // eor V<ssa_26>.16B, V<ssa_24>.16B, v14.16B                   // .......................................................................*.........................................................................
        // aesr V<ssa_18>.16b, v18.16b                                 // ..................................*..............................................................................................................
        // aesr V<ssa_10>.16b, v24.16b                                 // .................................*...............................................................................................................
        // eor V<ssa_27>.16B, V<ssa_6>.16B, v8.16B                     // ...............*.................................................................................................................................
        // aesr V<ssa_18>.16b, v19.16b                                 // ....................................................*............................................................................................
        // ldr Q<ssa_28>, [x6]                                         // .......................................................................................*.........................................................
        // eor V<ssa_29>.16B, V<ssa_27>.16B, V<ssa_8>.16B              // ...........................*.....................................................................................................................
        // aesr V<ssa_10>.16b, v25.16b                                 // .....................................*...........................................................................................................
        // aesr V<ssa_18>.16b, v20.16b                                 // ...........................................................*.....................................................................................
        // ldr Q<ssa_30>, [x6, #80]                                    // ................................................*................................................................................................
        // eor V<ssa_31>.16B, V<ssa_29>.16B, V<ssa_19>.16B             // ...............................*.................................................................................................................
        // aesr V<ssa_10>.16b, v26.16b                                 // .........................................*.......................................................................................................
        // aesr V<ssa_18>.16b, v21.16b                                 // .................................................................*...............................................................................
        // rev32 V<ssa_32>.16B, V<ssa_23>.16B                          // ...................................*.............................................................................................................
        // eor V<ssa_33>.16B, V<ssa_31>.16B, V<ssa_9>.16B              // ......................................*..........................................................................................................
        // aesr V<ssa_10>.16b, v27.16b                                 // ............................................*....................................................................................................
        // aesr V<ssa_32>.16b, v18.16b                                 // .......................................*.........................................................................................................
        // str Q<ssa_26>, [x2], #(4*16)                                // ...............................................................................*.................................................................
        // eor V<ssa_34>.16B, V<ssa_33>.16B, V<ssa_17>.16B             // ..........................................*......................................................................................................
        // aesr V<ssa_10>.16b, v28.16b                                 // ...................................................*.............................................................................................
        // eor V<ssa_35>.16B, V<ssa_25>.16B, v16.16B                   // .....................................................*...........................................................................................
        // aesr V<ssa_32>.16b, v19.16b                                 // ..............................................................*..................................................................................
        // add v31.4S, V<ssa_23>.4S, v30.4S                            // .........................................................*.......................................................................................
        // aese V<ssa_10>.16b, v15.16b                                 // ......................................................*..........................................................................................
        // eor V<ssa_37>.16B, V<ssa_16>.16B, v16.16B                   // ..........................................................*......................................................................................
        // aesr V<ssa_32>.16b, v20.16b                                 // ......................................................................*..........................................................................
        // eor V<ssa_38>.16B, V<ssa_35>.16B, V<ssa_10>.16B             // ....................................................................................*............................................................
        // pmull V<ssa_39>.1q, V<ssa_34>.1d, v7.1d                     // ...............................................*.................................................................................................
        // ext V<ssa_40>.16B, V<ssa_34>.16B, V<ssa_34>.16B, #8         // .............................................................*...................................................................................
        // aesr V<ssa_32>.16b, v21.16b                                 // ..........................................................................*......................................................................
        // aesr V<ssa_18>.16b, v22.16b                                 // .....................................................................*...........................................................................
        // eor V<ssa_41>.16B, V<ssa_4>.16B, V<ssa_39>.16B              // ................................................................*................................................................................
        // aesr V<ssa_32>.16b, v22.16b                                 // ..............................................................................*..................................................................
        // rev64 V<ssa_42>.16B, V<ssa_38>.16B                          // ........................................................................................*........................................................
        // str Q<ssa_38>, [x2, #-48]                                   // ...........................................................................................*.....................................................
        // aesr V<ssa_18>.16b, v23.16b                                 // .........................................................................*.......................................................................
        // aesr V<ssa_32>.16b, v23.16b                                 // ...................................................................................*.............................................................
        // eor V<ssa_43>.16B, V<ssa_41>.16B, V<ssa_40>.16B             // ....................................................................*............................................................................
        // aesr V<ssa_18>.16b, v24.16b                                 // .............................................................................*...................................................................
        // ldr Q<ssa_44>, [x6, #48]                                    // ..................................................................................*..............................................................
        // rev64 V<ssa_45>.16B, V<ssa_26>.16B                          // ............................................................................*....................................................................
        // aesr V<ssa_32>.16b, v24.16b                                 // ......................................................................................*..........................................................
        // aesr V<ssa_18>.16b, v25.16b                                 // .................................................................................*...............................................................
        // ext V<ssa_46>.16B, V<ssa_43>.16B, V<ssa_43>.16B, #8         // ........................................................................*........................................................................
        // aesr V<ssa_32>.16b, v25.16b                                 // ..........................................................................................*......................................................
        // ldr Q<ssa_47>, [x0, #-16]                                   // .......................................................*.........................................................................................
        // eor V<ssa_48>.16B, V<ssa_45>.16B, V<ssa_46>.16B             // ................................................................................*................................................................
        // aesr V<ssa_18>.16b, v26.16b                                 // .....................................................................................*...........................................................
        // aesr V<ssa_32>.16b, v26.16b                                 // ..............................................................................................*..................................................
        // mov D<ssa_49>, V<ssa_42>.d[1]                               // ...............................................................................................*.................................................
        // aesr V<ssa_18>.16b, v27.16b                                 // .........................................................................................*.......................................................
        // ext V<ssa_50>.16B, V<ssa_48>.16B, V<ssa_48>.16B, #8         // ............................................................................................*....................................................
        // aesr V<ssa_32>.16b, v27.16b                                 // ..................................................................................................*..............................................
        // eor V<ssa_51>.16B, V<ssa_50>.16B, V<ssa_48>.16B             // ................................................................................................*................................................
        // aesr V<ssa_18>.16b, v28.16b                                 // .............................................................................................*...................................................
        // eor V<ssa_52>.16B, V<ssa_47>.16B, v16.16B                   // ...............................................................*.................................................................................
        // aesr V<ssa_32>.16b, v28.16b                                 // ......................................................................................................*..........................................
        // aese V<ssa_18>.16b, v15.16b                                 // .................................................................................................*...............................................
        // aese V<ssa_32>.16b, v15.16b                                 // ...........................................................................................................*.....................................
        // ldr Q<ssa_54>, [x6, #64]                                    // .......................................................................................................*.........................................
        // eor V<ssa_55>.16B, V<ssa_37>.16B, V<ssa_18>.16B             // .....................................................................................................*...........................................
        // pmull V<ssa_56>.1q, V<ssa_48>.1d, V<ssa_30>.1d              // .........................................................................................................*.......................................
        // eor V<ssa_57>.16B, V<ssa_52>.16B, V<ssa_32>.16B             // ...............................................................................................................*.................................
        // pmull2 V<ssa_58>.1q, V<ssa_42>.2d, V<ssa_44>.2d             // .............................................................................................................*...................................
        // pmull2 V<ssa_59>.1q, V<ssa_48>.2d, V<ssa_30>.2d             // ....................................................................................................*............................................
        // eor V<ssa_60>.8B, V<ssa_49>.8B, V<ssa_42>.8B                // ...................................................................................................*.............................................
        // pmull V<ssa_61>.1q, V<ssa_42>.1d, V<ssa_44>.1d              // ..............................................................................................................*..................................
        // rev64 V<ssa_62>.16B, V<ssa_55>.16B                          // ........................................................................................................*........................................
        // eor V<ssa_63>.16B, V<ssa_59>.16B, V<ssa_58>.16B             // .................................................................................................................*...............................
        // pmull V<ssa_64>.1q, V<ssa_60>.1d, V<ssa_54>.1d              // .........................................................................................................................*.......................
        // eor V<ssa_65>.16B, V<ssa_56>.16B, V<ssa_61>.16B             // ..................................................................................................................*..............................
        // str Q<ssa_55>, [x2, #-32]                                   // ..........................................................................................................*......................................
        // pmull V<ssa_66>.1q, V<ssa_62>.1d, V<ssa_21>.1d              // ................................................................................................................*................................
        // rev64 V<ssa_67>.16B, V<ssa_57>.16B                          // .....................................................................................................................*...........................
        // pmull2 V<ssa_68>.1q, V<ssa_62>.2d, V<ssa_21>.2d             // ...................................................................................................................*.............................
        // eor V<ssa_69>.16B, V<ssa_65>.16B, V<ssa_66>.16B             // ........................................................................................................................*........................
        // ext V<ssa_70>.16B, V<ssa_62>.16B, V<ssa_62>.16B, #8         // ............................................................................................................*....................................
        // eor V<ssa_71>.16B, V<ssa_63>.16B, V<ssa_68>.16B             // .......................................................................................................................*.........................
        // pmull V<ssa_72>.1q, V<ssa_67>.1d, V<ssa_28>.1d              // ...........................................................................................................................*.....................
        // eor V<ssa_73>.16B, V<ssa_70>.16B, V<ssa_62>.16B             // ......................................................................................................................*..........................
        // pmull2 V<ssa_74>.1q, V<ssa_67>.2d, V<ssa_28>.2d             // .............................................................................................................................*...................
        // eor V<ssa_75>.16B, V<ssa_69>.16B, V<ssa_72>.16B             // ................................................................................................................................*................
        // eor V<ssa_76>.16B, V<ssa_71>.16B, V<ssa_74>.16B             // .................................................................................................................................*...............
        // pmull2 V<ssa_77>.1q, V<ssa_51>.2d, V<ssa_54>.2d             // ....................................................................................................................*............................
        // pmull2 V<ssa_79>.1q, V<ssa_73>.2d, V<ssa_22>.2d             // ...............................................................................................................................*.................
        // eor V<ssa_80>.16B, V<ssa_75>.16B, V<ssa_76>.16B             // .......................................................................................................................................*.........
        // ext V<ssa_82>.16B, V<ssa_76>.16B, V<ssa_76>.16B, #8         // .....................................................................................................................................*...........
        // pmull V<ssa_83>.1q, V<ssa_76>.1d, v7.1d                     // ....................................................................................................................................*............
        // mov D<ssa_84>, V<ssa_67>.d[1]                               // ..........................................................................................................................*......................
        // eor V<ssa_86>.8B, V<ssa_84>.8B, V<ssa_67>.8B                // ..............................................................................................................................*..................
        // eor V<ssa_88>.16B, V<ssa_82>.16B, V<ssa_83>.16B             // ........................................................................................................................................*........
        // pmull V<ssa_90>.1q, V<ssa_86>.1d, V<ssa_22>.1d              // ...................................................................................................................................*.............
        // str Q<ssa_57>, [x2, #-16]                                   // ...............................................................................................................................................*.
        // eor V<ssa_97>.16B, V<ssa_77>.16B, V<ssa_64>.16B             // ............................................................................................................................*....................
        // eor V<ssa_98>.16B, V<ssa_97>.16B, V<ssa_79>.16B             // ..................................................................................................................................*..............
        // eor V<ssa_100>.16B, V<ssa_98>.16B, V<ssa_90>.16B            // ......................................................................................................................................*..........
        // eor V<ssa_102>.16B, V<ssa_100>.16B, V<ssa_80>.16B           // .........................................................................................................................................*.......
        // eor V<ssa_103>.16B, V<ssa_102>.16B, V<ssa_88>.16B           // ..........................................................................................................................................*......
        // pmull V<ssa_107>.1q, V<ssa_103>.1d, v7.1d                   // ...........................................................................................................................................*.....
        // ext V<ssa_108>.16B, V<ssa_103>.16B, V<ssa_103>.16B, #8      // ............................................................................................................................................*....
        // eor V<ssa_109>.16B, V<ssa_75>.16B, V<ssa_107>.16B           // .............................................................................................................................................*...
        // eor V<ssa_111>.16B, V<ssa_109>.16B, V<ssa_108>.16B          // ..............................................................................................................................................*..
        // ext v11.16B, V<ssa_111>.16B, V<ssa_111>.16B, #8             // ................................................................................................................................................*

        b Lloop_unrolled_start_end
Lloop_unrolled_start_iter_1:


        ldr q29, [x0], #(4*16)
        rev32  v0.16b, v31.16b
        add    v31.4s, v31.4s, v30.4s
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aesr v0.16b, v27.16b
        aesr v0.16b, v28.16b
        aese v0.16b, v15.16b
        eor v29.16b, v29.16b, v16.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2], #(4*16)

        ldr q12, [x6, #48]
        ldr q13, [x6, #80]
        ldr q14, [x6, #64]
        rev64 v0.16b, v0.16b
        eor   v0.16b, v0.16b, v11.16b
        // Low product
        pmull   v8.1q, v0.1d, v13.1d
        // High product
        pmull2  v9.1q, v0.2d, v13.2d
        // Middle product
        ext     v11.16b, v0.16b, v0.16b, #8
        eor     v11.16b, v11.16b, v0.16b
        pmull2  v10.1q, v11.2d, v14.2d

        ldr q29, [x0, #(-3*16)]
        rev32  v0.16b, v31.16b
        add    v31.4s, v31.4s, v30.4s
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aesr v0.16b, v27.16b
        aesr v0.16b, v28.16b
        aese v0.16b, v15.16b
        eor v29.16b, v29.16b, v16.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(-3*16)]

        rev64   v0.16b, v0.16b
        // Low product
        pmull   v11.1q, v0.1d, v12.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v12.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        mov     d11, v0.d[1]
        eor     v11.8b, v11.8b, v0.8b
        pmull   v11.1q, v11.1d, v14.1d
        eor     v10.16b, v10.16b, v11.16b

        ldr q29, [x0, #(-2*16)]
        rev32  v0.16b, v31.16b
        add    v31.4s, v31.4s, v30.4s
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aesr v0.16b, v27.16b
        aesr v0.16b, v28.16b
        aese v0.16b, v15.16b
        eor v29.16b, v29.16b, v16.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(-2*16)]

        ldr q12, [x6]
        ldr q13, [x6, #32]
        ldr q14, [x6, #16]
        rev64   v0.16b, v0.16b

        // Low product
        pmull   v11.1q, v0.1d, v13.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v13.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        ext     v11.16b, v0.16b, v0.16b, #8
        eor     v11.16b, v11.16b, v0.16b
        pmull2  v11.1q, v11.2d, v14.2d
        eor     v10.16b, v10.16b, v11.16b

        ldr q29, [x0, #(-1*16)]
        rev32  v0.16b, v31.16b
        add    v31.4s, v31.4s, v30.4s
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aesr v0.16b, v27.16b
        aesr v0.16b, v28.16b
        aese v0.16b, v15.16b
        eor v29.16b, v29.16b, v16.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(-1*16)]

        rev64   v0.16b, v0.16b
        // Low product
        pmull   v11.1q, v0.1d, v12.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v12.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        mov     d11, v0.d[1]
        eor     v11.8b, v11.8b, v0.8b
        pmull   v11.1q, v11.1d, v14.1d
        eor     v10.16b, v10.16b, v11.16b

        eor        v0.16b, v8.16b,  v9.16b
        pmull      v1.1q,  v9.1d,   v7.1d
        ext        v9.16b,    v9.16b,  v9.16b, #8
        eor        v10.16b,   v10.16b, v0.16b
        eor        v1.16b, v9.16b,  v1.16b
        eor        v10.16b,   v10.16b, v1.16b
        pmull      v9.1q,     v10.1d,  v7.1d
        eor        v8.16b,    v8.16b,  v9.16b
        ext        v10.16b,   v10.16b, v10.16b, #8
        eor        v11.16b,     v8.16b,  v10.16b
        ext        v11.16b, v11.16b, v11.16b, #8

Lloop_unrolled_start_iter_1_end:
Lloop_unrolled_start_end:
Lloop_unrolled_end:

        load_htable_12

        cbz remainder, Lloop_1x_end
Lloop_1x_start:

        ldr plain_q, [input], #16
        aes_full_block aes_st, plain, res
        str res_q, [output], #16
        ghash_init_0 res, Ht1, Ht12, tag

        ghash_finalize tag

        sub remainder, remainder, #1
        cbnz remainder, Lloop_1x_start
Lloop_1x_end:

        // Return number of bytes processed
        mov x0, byte_len
        // Store new authentication tag
        rev64 tag.16b, tag.16b
        str tag_q, [tag_ptr]
        // Store updated counter
        rev32 rtmp_ctr.16b, rtmp_ctr.16b
        str rtmp_ctr_q, [ivec]

        restore_vregs
        restore_gprs

Lenc_postamble_end:
        add sp, sp, #STACK_SIZE

        ret

#endif
#endif  // !OPENSSL_NO_ASM && defined(__AARCH64EL__) && defined(__APPLE__)
#if defined(__ELF__)
// See https: // www.airs.com/blog/archives/518.
.section .note.GNU-stack,"",%progbits
#endif