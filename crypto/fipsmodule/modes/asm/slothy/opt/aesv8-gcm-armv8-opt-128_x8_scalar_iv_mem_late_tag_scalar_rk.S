// Copyright (c) 2022, ARM Inc.

// Permission to use, copy, modify, and/or distribute this software for any
// purpose with or without fee is hereby granted, provided that the above
// copyright notice and this permission notice appear in all copies.

// THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
// WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
// MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
// SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
// WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
// OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
// CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. */

// Author: Hanno Becker <hannobecker@posteo.de>

// This file was derived from the assembly generated from aesv8-gcm-armv8.pl,
// written by Fangming Fang <fangming.fang@arm.com> for the OpenSSL project,
// and derived from https: // github.com/ARM-software/AArch64cryptolib, original
// author Samuel Lee <Samuel.Lee@arm.com>.

// The code below is a 'clean' AArch64 implementation of AES-GCM emphasizing
// the logic of the computation. It is meant as the input to manual audits /
// formal verification, as well as automated micro-optimization such as done
// by the SLOTHY superoptimizer (https: // github.com/slothy-optimizer/slothy).

#if !defined(__has_feature)
#define __has_feature(x) 0
#endif
#if __has_feature(memory_sanitizer) && !defined(OPENSSL_NO_ASM)
#define OPENSSL_NO_ASM
#endif

#include <openssl/asm_base.h>

#if !defined(OPENSSL_NO_ASM) && defined(__AARCH64EL__)
#if defined(__ELF__)
#include <openssl/boringssl_prefix_symbols_asm.h>
#include <openssl/arm_arch.h>
.arch   armv8-a+crypto
.text
.globl  aes_gcm_enc_kernel_slothy_base_128
.hidden aes_gcm_enc_kernel_slothy_base_128
.type   aes_gcm_enc_kernel_slothy_base_128,%function
#elif defined(__APPLE__)
#if defined(BORINGSSL_PREFIX)
#include <boringssl_prefix_symbols_asm.h>
#endif
#include <openssl/arm_arch.h>
.text
.globl	_aes_gcm_enc_kernel_slothy_base_128
.private_extern	_aes_gcm_enc_kernel_slothy_base_128
#else
#error Unknown configuration
#endif

#if __ARM_MAX_ARCH__ >= 8

// Arguments
input    .req x0
len_bits .req x1
output   .req x2
tag_ptr  .req x3
ivec     .req x4
key      .req x5
Htable   .req x6

byte_len .req x15

constant_temp .req x25

count           .req x1
full_blocks     .req x7
remainder       .req x16
unroll          .req x10

ctr_tmp   .req x14
ctr_tmp_w .req w14

ivec_0_63    .req x11
ivec_64_96   .req x12
ivec_64_96_w .req w12

ctr      .req w13
ctr_x    .req x13

aes_st    .req v0
aes_st_q  .req q0
aes_st_d  .req d0

res       .req v0
res_q     .req q0

ghash_hi    .req v9
ghash_lo    .req v8
ghash_mid   .req v10
ghash_mid_d .req d10

ghash_tmp   .req v11
ghash_tmp_d .req d11

ghash_mod   .req v7
ghash_mod_d .req d7

modulo_tmp0 .req v0
modulo_tmp1 .req v1

Ht1q   .req q12
Ht2q   .req q13
Ht12q  .req q14

Ht1    .req v12
Ht2    .req v13
Ht12   .req v14

Ht3q   .req q15
Ht4q   .req q16
Ht34q  .req q17

Ht3    .req v15
Ht4    .req v16
Ht34   .req v17

Ht5q   .req q15
Ht6q   .req q16
Ht56q  .req q17

Ht5    .req v15
Ht6    .req v16
Ht56   .req v17

Ht7q   .req q15
Ht8q   .req q16
Ht78q  .req q17

Ht7    .req v15
Ht8    .req v16
Ht78   .req v17

rk0q   .req q18
rk1q   .req q19
rk2q   .req q20
rk3q   .req q21
rk4q   .req q22
rk5q   .req q23
rk6q   .req q24
rk7q   .req q25
rk8q   .req q26
rk9q   .req q27
rk10q  .req q28

rk10_lo .req x20
rk10_hi .req x21

rk0    .req v18
rk1    .req v19
rk2    .req v20
rk3    .req v21
rk4    .req v22
rk5    .req v23
rk6    .req v24
rk7    .req v25
rk8    .req v26
rk9    .req v27
rk10   .req v28

plain   .req v29
plain_q .req q29

plain_lo .req x22
plain_hi .req x23

tag    .req v30
tag_q  .req q30

#define UNROLL 8

#define STACK_SIZE_GPRS  (6*16)
#define STACK_SIZE_VREGS (4*16)
#define STACK_SIZE  (STACK_SIZE_GPRS + STACK_SIZE_VREGS + UNROLL*16)

#define STACK_BASE_GPRS  (0)
#define STACK_BASE_VREGS (STACK_SIZE_GPRS)
#define STACK_BASE_AES_ST (STACK_SIZE_GPRS + STACK_SIZE_VREGS)

/********************************************************************/
/*                 Generic preamble/postamble macros                */
/********************************************************************/

.macro save_vregs
        stp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        stp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        stp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        stp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro restore_vregs
        ldp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        ldp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        ldp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        ldp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro save_gprs
        stp x19, x20, [sp, #(STACK_BASE_GPRS + 16*0)]
        stp x21, x22, [sp, #(STACK_BASE_GPRS + 16*1)]
        stp x23, x24, [sp, #(STACK_BASE_GPRS + 16*2)]
        stp x25, x26, [sp, #(STACK_BASE_GPRS + 16*3)]
        stp x27, x28, [sp, #(STACK_BASE_GPRS + 16*4)]
        stp x29, x30, [sp, #(STACK_BASE_GPRS + 16*5)]
.endm

.macro restore_gprs
        ldp x19, x20, [sp, #(STACK_BASE_GPRS + 16*0)]
        ldp x21, x22, [sp, #(STACK_BASE_GPRS + 16*1)]
        ldp x23, x24, [sp, #(STACK_BASE_GPRS + 16*2)]
        ldp x25, x26, [sp, #(STACK_BASE_GPRS + 16*3)]
        ldp x27, x28, [sp, #(STACK_BASE_GPRS + 16*4)]
        ldp x29, x30, [sp, #(STACK_BASE_GPRS + 16*5)]
.endm

// Derive number of iterations of unrolled loop and single-block loop
.macro prepare_loop_counts
        mov  unroll, #UNROLL
        // Number of AES Blocks (16b each)
        lsr  full_blocks, byte_len, #4
        // Number of iterations of the unrolled loop
        udiv count, full_blocks, unroll
        // Number of iterations for the tail loop handling 1 block each
        msub remainder, count, unroll, full_blocks
.endm

/********************************************************************/
/*                       AES related macros                         */
/********************************************************************/

.macro load_iv
        ldp        ivec_0_63, ivec_64_96, [ivec]
        lsr        ctr_x, ivec_64_96, #32
        rev        ctr, ctr
        orr        ivec_64_96_w, ivec_64_96_w, ivec_64_96_w // clear top 32 bit
.endm

.macro next_ctr_init_aes aes_st, loc
        add        ctr_tmp_w, ctr, #\loc
        rev        ctr_tmp_w, ctr_tmp_w
        orr        ctr_tmp, ivec_64_96, ctr_tmp, lsl #32
        stp        ivec_0_63, ctr_tmp, [sp, #(STACK_BASE_AES_ST + \loc*16)] // @slothy:writes=stack_\loc
        ldr        \aes_st\()_q, [sp, #(STACK_BASE_AES_ST + \loc*16)]       // @slothy:reads=stack_\loc
.endm

// A single AES round
// Prevent SLOTHY from unfolding because uArchs tend to fuse AESMC+AESE
.macro aesr data, key // @slothy:no-unfold
        aese  \data, \key
        aesmc \data, \data
.endm

.macro aesr_0_8 data, key
        aesr \data\().16b, \key\()0.16b
        aesr \data\().16b, \key\()1.16b
        aesr \data\().16b, \key\()2.16b
        aesr \data\().16b, \key\()3.16b
        aesr \data\().16b, \key\()4.16b
        aesr \data\().16b, \key\()5.16b
        aesr \data\().16b, \key\()6.16b
        aesr \data\().16b, \key\()7.16b
        aesr \data\().16b, \key\()8.16b
.endm

.macro aesr_9_10 data, key
        aesr \data\().16b, \key\()9.16b
        aesr \data\().16b, \key\()10.16b
.endm

.macro aesr_11_12 data, key
        aesr \data\().16b, \key\()11.16b
        aesr \data\().16b, \key\()12.16b
.endm

// Destructs inA
.macro eor3 out, inA, inB, inC
        eor \inA, \inA, \inB
        eor \out, \inA, \inC
.endm

.macro aesr_final aes_st, plain, out, loc
        aese \aes_st\().16b, rk9.16b
        eor \plain\()_lo, \plain\()_lo, rk10_lo
        eor \plain\()_hi, \plain\()_hi, rk10_hi
        stp \plain\()_lo, \plain\()_hi, [sp, #(STACK_BASE_AES_ST + \loc*16)] // @slothy:writes=stack_\loc
        ldr \plain\()_q, [sp, #(STACK_BASE_AES_ST + \loc*16)]       // @slothy:reads=stack_\loc
        eor \out\().16b, \plain\().16b, \aes_st\().16b
.endm

.macro aes_full_block aes_st, input, output, loc
        next_ctr_init_aes \aes_st, \loc
        aesr_0_8 \aes_st\(), rk
        aesr_final \aes_st, \input, \output, \loc
.endm

.macro load_round_key i
        ldr rk\i\()q, [key, #((\i)*16)]
.endm

.macro load_round_key_scalar i
        ldp rk\i\()_lo, rk\i\()_hi, [key, #((\i)*16)]
.endm

.macro load_round_keys
        load_round_key 0
        load_round_key 1
        load_round_key 2
        load_round_key 3
        load_round_key 4
        load_round_key 5
        load_round_key 6
        load_round_key 7
        load_round_key 8
        load_round_key 9
        load_round_key_scalar 10
.endm

/********************************************************************/
/*       Loading of H-table (precomputed H-powers for GHASH)        */
/********************************************************************/

// This has to be synchronized with the H-table generation

.macro load_h1 dst, dst_q
        ldr \dst_q, [Htable]
.endm

.macro load_h2 dst, dst_q
        ldr \dst_q, [Htable, #32]
.endm

.macro load_h3 dst, dst_q
        ldr \dst_q, [Htable, #48]
.endm

.macro load_h4 dst, dst_q
        ldr \dst_q, [Htable, #80]
.endm

.macro load_h5 dst, dst_q
        ldr \dst_q, [Htable, #96]
.endm

.macro load_h6 dst, dst_q
        ldr \dst_q, [Htable, #128]
.endm

.macro load_h7 dst, dst_q
        ldr \dst_q, [Htable, #144]
.endm

.macro load_h8 dst, dst_q
        ldr \dst_q, [Htable, #176]
.endm

.macro load_h12 dst, dst_q
        ldr \dst_q, [Htable, #16]
.endm

.macro load_h34 dst, dst_q
        ldr \dst_q, [Htable, #64]
.endm

.macro load_h56 dst, dst_q
        ldr \dst_q, [Htable, #112]
.endm

.macro load_h78 dst, dst_q
        ldr \dst_q, [Htable, #160]
.endm

.macro load_full_htable
        load_h1  Ht1,  Ht1q
        load_h2  Ht2,  Ht2q
        load_h3  Ht3,  Ht3q
        load_h4  Ht4,  Ht4q
        load_h5  Ht5,  Ht5q
        load_h6  Ht6,  Ht6q
        load_h12 Ht12, Ht12q
        load_h34 Ht34, Ht34q
        load_h56 Ht56, Ht56q
.endm

.macro load_htable_12
        load_h1  Ht1,  Ht1q
        load_h2  Ht2,  Ht2q
        load_h12 Ht12, Ht12q
.endm

.macro load_htable_34
        load_h3  Ht3,  Ht3q
        load_h4  Ht4,  Ht4q
        load_h34 Ht34, Ht34q
.endm

.macro load_htable_56
        load_h5  Ht5,  Ht5q
        load_h6  Ht6,  Ht6q
        load_h56 Ht56, Ht56q
.endm

.macro load_htable_78
        load_h7  Ht7,  Ht7q
        load_h8  Ht8,  Ht8q
        load_h78 Ht78, Ht78q
.endm

/********************************************************************/
/*                    Macros for GHASH udpate                       */
/********************************************************************/

.macro ghash_init_0 input, Hk, Hk_mid
        rev64 \input\().16b, \input\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_mid.1q, ghash_tmp.1d, \Hk_mid\().1d
.endm

.macro ghash_init_1 input, Hk, Hk_mid
        rev64 \input\().16b, \input\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_mid.1q, ghash_tmp.2d, \Hk_mid\().2d
.endm

.macro ghash_acc_0 input, Hk, Hk_mid
        rev64   \input\().16b, \input\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_tmp.1q, ghash_tmp.1d, \Hk_mid\().1d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_acc_1 input, Hk, Hk_mid
        rev64   \input\().16b, \input\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_tmp.1q, ghash_tmp.2d, \Hk_mid\().2d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_init_with_tag_0 input, Hk, Hk_mid, tag
        rev64 \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_mid.1q, ghash_tmp.1d, \Hk_mid\().1d
.endm

.macro ghash_init_with_tag_1 input, Hk, Hk_mid, tag
        rev64 \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_mid.1q, ghash_tmp.2d, \Hk_mid\().2d
.endm

.macro ghash_acc_with_tag_0 input, Hk, Hk_mid, tag
        rev64   \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_tmp.1q, ghash_tmp.1d, \Hk_mid\().1d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_acc_with_tag_1 input, Hk, Hk_mid, tag
        rev64   \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_tmp.1q, ghash_tmp.2d, \Hk_mid\().2d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_finalize tag
        eor        modulo_tmp0.16b, ghash_lo.16b,  ghash_hi.16b
        pmull      modulo_tmp1.1q,  ghash_hi.1d,   ghash_mod.1d
        ext        ghash_hi.16b,    ghash_hi.16b,  ghash_hi.16b, #8
        eor        ghash_mid.16b,   ghash_mid.16b, modulo_tmp0.16b
        eor        modulo_tmp1.16b, ghash_hi.16b,  modulo_tmp1.16b
        eor        ghash_mid.16b,   ghash_mid.16b, modulo_tmp1.16b
        pmull      ghash_hi.1q,     ghash_mid.1d,  ghash_mod.1d
        eor        ghash_lo.16b,    ghash_lo.16b,  ghash_hi.16b
        ext        ghash_mid.16b,   ghash_mid.16b, ghash_mid.16b, #8
        eor        \tag\().16b,     ghash_lo.16b,  ghash_mid.16b
        ext        \tag\().16b, \tag\().16b, \tag\().16b, #8
.endm

.macro load_tag
        ldr      tag_q, [tag_ptr]
        rev64    tag.16b, tag.16b
.endm

.macro prepare_ghash
        // Prepare constant for modular reduction
        movi ghash_mod.8b, #0xc2
        shl  ghash_mod_d, ghash_mod_d, #56
.endm

/********************************************************************/
/*                            Core routine                          */
/********************************************************************/

.align        4
_aes_gcm_enc_kernel_slothy_base_128:
aes_gcm_enc_kernel_slothy_base_128:
#ifdef BORINGSSL_DISPATCH_TEST
        adrp  x9,_BORINGSSL_function_hit@PAGE
        add   x9, x9, _BORINGSSL_function_hit@PAGEOFF
        mov   w10, #1
        strb  w10, [x9,#2] // kFlag_aes_gcm_enc_kernel
#endif

        AARCH64_VALID_CALL_TARGET
        sub sp, sp, #STACK_SIZE

Lenc_preamble_start:
        save_gprs
        save_vregs

        lsr byte_len, len_bits, #3

        load_round_keys
        load_tag
        load_iv

        prepare_loop_counts
        prepare_ghash

Lenc_preamble_end:

        cbz count, Lloop_unrolled_end
        add w30, w13, #6                                    // ................................*.............................................................................................................................................................................................................................................
        add w26, w13, #4                                    // .................................................................................................*............................................................................................................................................................................
        rev w17, w30                                        // .................................*............................................................................................................................................................................................................................................
        rev w30, w26                                        // ..................................................................................................*...........................................................................................................................................................................
        add w19, w13, #5                                    // ...............................................................*..............................................................................................................................................................................................................
        orr x26, x12, x17, lsl #32                          // ..................................*...........................................................................................................................................................................................................................................
        orr x22, x12, x30, lsl #32                          // ...................................................................................................*..........................................................................................................................................................................
        rev w30, w19                                        // ................................................................*.............................................................................................................................................................................................................
        stp x11, x26, [sp, #STACK_BASE_AES_ST + 96]         // ...................................*.......................................................................................................................................................................................................................................... // @slothy:writes=stack_6
        stp x11, x22, [sp, #STACK_BASE_AES_ST + 64]         // ....................................................................................................*......................................................................................................................................................................... // @slothy:writes=stack_4
        ldr q10, [sp, #STACK_BASE_AES_ST + 96]              // ....................................*......................................................................................................................................................................................................................................... // @slothy:reads=stack_6
        add w29, w13, #7                                    // .*............................................................................................................................................................................................................................................................................
        ldr q9, [sp, #STACK_BASE_AES_ST + 64]               // .....................................................................................................*........................................................................................................................................................................ // @slothy:reads=stack_4
        orr x27, x12, x30, lsl #32                          // .................................................................*............................................................................................................................................................................................................
        rev w30, w29                                        // ..*...........................................................................................................................................................................................................................................................................
        orr x14, x12, x30, lsl #32                          // ...*..........................................................................................................................................................................................................................................................................
        stp x11, x27, [sp, #STACK_BASE_AES_ST + 80]         // ..................................................................*........................................................................................................................................................................................................... // @slothy:writes=stack_5
        stp x11, x14, [sp, #STACK_BASE_AES_ST + 112]        // ....*......................................................................................................................................................................................................................................................................... // @slothy:writes=stack_7
        aesr v10.16b, v18.16b                               // .....................................*........................................................................................................................................................................................................................................
        ldr q17, [sp, #STACK_BASE_AES_ST + 80]              // ...................................................................*.......................................................................................................................................................................................................... // @slothy:reads=stack_5
        aesr v9.16b, v18.16b                                // ......................................................................................................*.......................................................................................................................................................................
        ldr q4, [sp, #STACK_BASE_AES_ST + 112]              // .....*........................................................................................................................................................................................................................................................................ // @slothy:reads=stack_7
        aesr v10.16b, v19.16b                               // ......................................*.......................................................................................................................................................................................................................................
        aesr v9.16b, v19.16b                                // .......................................................................................................*......................................................................................................................................................................
        aesr v17.16b, v18.16b                               // ....................................................................*.........................................................................................................................................................................................................
        aesr v4.16b, v18.16b                                // ......*.......................................................................................................................................................................................................................................................................
        aesr v10.16b, v20.16b                               // .......................................*......................................................................................................................................................................................................................................
        aesr v17.16b, v19.16b                               // .....................................................................*........................................................................................................................................................................................................
        aesr v10.16b, v21.16b                               // ........................................*.....................................................................................................................................................................................................................................
        aesr v17.16b, v20.16b                               // ......................................................................*.......................................................................................................................................................................................................
        aesr v10.16b, v22.16b                               // .........................................*....................................................................................................................................................................................................................................
        aesr v17.16b, v21.16b                               // .......................................................................*......................................................................................................................................................................................................
        aesr v10.16b, v23.16b                               // ..........................................*...................................................................................................................................................................................................................................
        aesr v17.16b, v22.16b                               // ........................................................................*.....................................................................................................................................................................................................
        ldp x30, x25, [x0, #64]                             // ................................................................................................*.............................................................................................................................................................................
        aesr v10.16b, v24.16b                               // ...........................................*..................................................................................................................................................................................................................................
        aesr v17.16b, v23.16b                               // .........................................................................*....................................................................................................................................................................................................
        ldr q31, [x6, #64]                                  // ......................................................................................*.......................................................................................................................................................................................
        aesr v10.16b, v25.16b                               // ............................................*.................................................................................................................................................................................................................................
        ldr q5, [x6, #48]                                   // ....................................................................................*.........................................................................................................................................................................................
        aesr v17.16b, v24.16b                               // ..........................................................................*...................................................................................................................................................................................................
        eor x14, x30, x20                                   // ................................................................................................................*.............................................................................................................................................................
        eor x27, x25, x21                                   // .................................................................................................................*............................................................................................................................................................
        aesr v4.16b, v19.16b                                // .......*......................................................................................................................................................................................................................................................................
        stp x14, x27, [sp, #STACK_BASE_AES_ST + 64]         // ..................................................................................................................*........................................................................................................................................................... // @slothy:writes=stack_4
        ldp x26, x17, [x0, #96]                             // ...............................*..............................................................................................................................................................................................................................................
        aesr v10.16b, v26.16b                               // .............................................*................................................................................................................................................................................................................................
        ldr q12, [sp, #STACK_BASE_AES_ST + 64]              // ...................................................................................................................*.......................................................................................................................................................... // @slothy:reads=stack_4
        aesr v4.16b, v20.16b                                // ........*.....................................................................................................................................................................................................................................................................
        ldp x25, x29, [x0, #48]                             // ...............................................................................................................................*..............................................................................................................................................
        aesr v17.16b, v25.16b                               // ...........................................................................*..................................................................................................................................................................................................
        ldp x27, x30, [x0, #80]                             // ..............................................................*...............................................................................................................................................................................................................
        add w19, w13, #3                                    // ................................................................................................................................*.............................................................................................................................................
        ldr q14, [x6, #80]                                  // .....................................................................................*........................................................................................................................................................................................
        aesr v4.16b, v21.16b                                // .........*....................................................................................................................................................................................................................................................................
        eor x14, x17, x21                                   // ................................................*.............................................................................................................................................................................................................................
        eor x17, x26, x20                                   // ...............................................*..............................................................................................................................................................................................................................
        aese v10.16b, v27.16b                               // ..............................................*...............................................................................................................................................................................................................................
        ldp x23, x26, [x0, #112]                            // *.............................................................................................................................................................................................................................................................................
        stp x17, x14, [sp, #STACK_BASE_AES_ST + 96]         // .................................................*............................................................................................................................................................................................................................ // @slothy:writes=stack_6
        aesr v4.16b, v22.16b                                // ..........*...................................................................................................................................................................................................................................................................
        ldr q6, [sp, #STACK_BASE_AES_ST + 96]               // ..................................................*........................................................................................................................................................................................................................... // @slothy:reads=stack_6
        aesr v9.16b, v20.16b                                // ........................................................................................................*.....................................................................................................................................................................
        eor x30, x30, x21                                   // ...............................................................................*..............................................................................................................................................................................................
        eor x17, x27, x20                                   // ..............................................................................*...............................................................................................................................................................................................
        ldr q29, [x6, #32]                                  // .......................*......................................................................................................................................................................................................................................................
        aesr v4.16b, v23.16b                                // ...........*..................................................................................................................................................................................................................................................................
        stp x17, x30, [sp, #STACK_BASE_AES_ST + 80]         // ................................................................................*............................................................................................................................................................................................. // @slothy:writes=stack_5
        ldr q11, [sp, #STACK_BASE_AES_ST + 80]              // .................................................................................*............................................................................................................................................................................................ // @slothy:reads=stack_5
        aesr v17.16b, v26.16b                               // ............................................................................*.................................................................................................................................................................................................
        ldp x17, x10, [x0, #32]                             // .................................................................................................................................................................*............................................................................................................
        eor x8, x25, x20                                    // ...............................................................................................................................................*..............................................................................................................................
        eor v10.16B, v6.16B, v10.16B                        // ...................................................*..........................................................................................................................................................................................................................
        aesr v9.16b, v21.16b                                // .........................................................................................................*....................................................................................................................................................................
        eor x28, x29, x21                                   // ................................................................................................................................................*.............................................................................................................................
        add w29, w13, #2                                    // ..................................................................................................................................................................*...........................................................................................................
        aese v17.16b, v27.16b                               // .............................................................................*................................................................................................................................................................................................
        ldr q15, [x6]                                       // ......................*.......................................................................................................................................................................................................................................................
        rev w29, w29                                        // ...................................................................................................................................................................*..........................................................................................................
        rev64 v3.16B, v10.16B                               // .....................................................*........................................................................................................................................................................................................................
        aesr v4.16b, v24.16b                                // ............*.................................................................................................................................................................................................................................................................
        orr x29, x12, x29, lsl #32                          // ....................................................................................................................................................................*.........................................................................................................
        eor v17.16B, v11.16B, v17.16B                       // ..................................................................................*...........................................................................................................................................................................................
        aesr v9.16b, v22.16b                                // ..........................................................................................................*...................................................................................................................................................................
        eor x14, x10, x21                                   // ..................................................................................................................................................................................*...........................................................................................
        stp x11, x29, [sp, #STACK_BASE_AES_ST + 32]         // .....................................................................................................................................................................*........................................................................................................ // @slothy:writes=stack_2
        pmull2 v1.1q, v3.2d, v29.2d                         // ........................................................*.....................................................................................................................................................................................................................
        ext v2.16B, v3.16B, v3.16B, #8                      // ..........................................................*...................................................................................................................................................................................................................
        rev w19, w19                                        // .................................................................................................................................*............................................................................................................................................
        aesr v4.16b, v25.16b                                // .............*................................................................................................................................................................................................................................................................
        rev64 v28.16B, v17.16B                              // .......................................................................................*......................................................................................................................................................................................
        eor x30, x26, x21                                   // .................*............................................................................................................................................................................................................................................................
        orr x26, x12, x19, lsl #32                          // ..................................................................................................................................*...........................................................................................................................................
        eor v8.16B, v2.16B, v3.16B                          // ...........................................................*..................................................................................................................................................................................................................
        aesr v9.16b, v23.16b                                // ...........................................................................................................*..................................................................................................................................................................
        eor x19, x23, x20                                   // ................*.............................................................................................................................................................................................................................................................
        stp x11, x26, [sp, #STACK_BASE_AES_ST + 48]         // ...................................................................................................................................*.......................................................................................................................................... // @slothy:writes=stack_3
        pmull v11.1q, v3.1d, v29.1d                         // ......................................................*.......................................................................................................................................................................................................................
        stp x19, x30, [sp, #STACK_BASE_AES_ST + 112]        // ..................*........................................................................................................................................................................................................................................................... // @slothy:writes=stack_7
        pmull2 v16.1q, v28.2d, v5.2d                        // ..........................................................................................*...................................................................................................................................................................................
        ldr q3, [sp, #STACK_BASE_AES_ST + 48]               // ....................................................................................................................................*......................................................................................................................................... // @slothy:reads=stack_3
        eor x17, x17, x20                                   // .................................................................................................................................................................................*............................................................................................
        str q10, [x2, #96]                                  // ....................................................*.........................................................................................................................................................................................................................
        aesr v4.16b, v26.16b                                // ..............*...............................................................................................................................................................................................................................................................
        add w26, w13, #0                                    // ...................................................................................................................................................................................................................................*..........................................
        ldr q10, [sp, #STACK_BASE_AES_ST + 112]             // ...................*.......................................................................................................................................................................................................................................................... // @slothy:reads=stack_7
        aesr v9.16b, v24.16b                                // ............................................................................................................*.................................................................................................................................................................
        ldp x19, x23, [x0, #16]                             // ................................................................................................................................................................................................*.............................................................................
        rev w26, w26                                        // ....................................................................................................................................................................................................................................*.........................................
        aese v4.16b, v27.16b                                // ...............*..............................................................................................................................................................................................................................................................
        ldr q6, [sp, #STACK_BASE_AES_ST + 32]               // ......................................................................................................................................................................*....................................................................................................... // @slothy:reads=stack_2
        orr x22, x12, x26, lsl #32                          // .....................................................................................................................................................................................................................................*........................................
        aesr v9.16b, v25.16b                                // .............................................................................................................*................................................................................................................................................................
        aesr v3.16b, v18.16b                                // .....................................................................................................................................*........................................................................................................................................
        str q17, [x2, #80]                                  // ...................................................................................*..........................................................................................................................................................................................
        stp x8, x28, [sp, #STACK_BASE_AES_ST + 48]          // .................................................................................................................................................*............................................................................................................................ // @slothy:writes=stack_3
        aesr v9.16b, v26.16b                                // ..............................................................................................................*...............................................................................................................................................................
        eor v2.16B, v10.16B, v4.16B                         // ....................*.........................................................................................................................................................................................................................................................
        eor x29, x23, x21                                   // .................................................................................................................................................................................................................*............................................................
        eor x30, x19, x20                                   // ................................................................................................................................................................................................................*.............................................................
        ldr q0, [x6, #16]                                   // ........................*.....................................................................................................................................................................................................................................................
        aesr v6.16b, v18.16b                                // .......................................................................................................................................................................*......................................................................................................
        stp x30, x29, [sp, #STACK_BASE_AES_ST + 16]         // ..................................................................................................................................................................................................................*........................................................... // @slothy:writes=stack_1
        aesr v3.16b, v19.16b                                // ......................................................................................................................................*.......................................................................................................................................
        rev64 v29.16B, v2.16B                               // .........................*....................................................................................................................................................................................................................................................
        add w19, w13, #1                                    // .................................................................................................................................................................................................*............................................................................
        ldr q13, [sp, #STACK_BASE_AES_ST + 16]              // ...................................................................................................................................................................................................................*.......................................................... // @slothy:reads=stack_1
        aese v9.16b, v27.16b                                // ...............................................................................................................*..............................................................................................................................................................
        stp x11, x22, [sp, #STACK_BASE_AES_ST]              // ......................................................................................................................................................................................................................................*....................................... // @slothy:writes=stack_0
        rev w19, w19                                        // ..................................................................................................................................................................................................*...........................................................................
        mov d4, v29.d[1]                                    // ............................*.................................................................................................................................................................................................................................................
        aesr v6.16b, v19.16b                                // ........................................................................................................................................................................*.....................................................................................................
        orr x8, x12, x19, lsl #32                           // ...................................................................................................................................................................................................*..........................................................................
        aesr v3.16b, v20.16b                                // .......................................................................................................................................*......................................................................................................................................
        eor v9.16B, v12.16B, v9.16B                         // ....................................................................................................................*.........................................................................................................................................................
        sub count, count, #1
cbz count, Lloop_unrolled_start_postamble
Lloop_unrolled_start:
                                                            // Instructions:    270
                                                            // Expected cycles: 67
                                                            // Expected IPC:    4.03
        // ----- original position ---->
        pmull2 v10.1q, v29.2d, v15.2d                       // ..........*...................................................................................................................................................................................................................................................................
        ldr q12, [sp, #STACK_BASE_AES_ST]                   // ...............*.............................................................................................................................................................................................................................................................. // @slothy:reads=stack_0
        add w13, w13, #UNROLL                               // ...*..........................................................................................................................................................................................................................................................................
        stp x11, x8, [sp, #STACK_BASE_AES_ST + 16]          // ..*........................................................................................................................................................................................................................................................................... // @slothy:writes=stack_1
        rev64 v17.16B, v9.16B                               // ..............*...............................................................................................................................................................................................................................................................
        aesr v3.16b, v21.16b                                // ......*.......................................................................................................................................................................................................................................................................
        add w8, w13, #6                                     // .......................................................................................................................................*......................................................................................................................................
        add w24, w13, #7                                    // ..................................................................................................................................................*...........................................................................................................................
        eor v4.8B, v4.8B, v29.8B                            // *.............................................................................................................................................................................................................................................................................
        pmull v15.1q, v29.1d, v15.1d                        // .....*........................................................................................................................................................................................................................................................................
        rev w22, w24                                        // .....................................................................................................................................................*........................................................................................................................
        rev w29, w8                                         // .........................................................................................................................................*....................................................................................................................................
        eor v1.16B, v10.16B, v1.16B                         // ....................................*.........................................................................................................................................................................................................................................
        pmull2 v29.1q, v17.2d, v14.2d                       // ....................*.........................................................................................................................................................................................................................................................
        orr x28, x12, x22, lsl #32                          // ......................................................................................................................................................*.......................................................................................................................
        orr x23, x12, x29, lsl #32                          // ............................................................................................................................................*.................................................................................................................................
        aesr v12.16b, v18.16b                               // ............................*.................................................................................................................................................................................................................................................
        eor v10.16B, v15.16B, v11.16B                       // .........*....................................................................................................................................................................................................................................................................
        stp x11, x23, [sp, #STACK_BASE_AES_ST + 96]         // ...............................................................................................................................................*.............................................................................................................................. // @slothy:writes=stack_6
        add w26, w13, #4                                    // ........................................................................................................................................*.....................................................................................................................................
        pmull v11.1q, v17.1d, v14.1d                        // ......................*.......................................................................................................................................................................................................................................................
        ext v15.16B, v17.16B, v17.16B, #8                   // .......................*......................................................................................................................................................................................................................................................
        add w24, w13, #5                                    // ...........................................................................................................................................*..................................................................................................................................
        rev w10, w26                                        // ..........................................................................................................................................*...................................................................................................................................
        eor v1.16B, v1.16B, v16.16B                         // .......................................*......................................................................................................................................................................................................................................
        aesr v12.16b, v19.16b                               // ...................................*..........................................................................................................................................................................................................................................
        ldp x30, x29, [x0], #(8*16)                         // ........*.....................................................................................................................................................................................................................................................................
        rev w22, w24                                        // ..............................................................................................................................................*...............................................................................................................................
        pmull v14.1q, v4.1d, v0.1d                          // ................*.............................................................................................................................................................................................................................................................
        eor v4.16B, v15.16B, v17.16B                        // ...........................*..................................................................................................................................................................................................................................................
        ldp x8, x24, [x0, #64]                              // .........................................................................................................................................................................*....................................................................................................
        eor v15.16B, v1.16B, v29.16B                        // ...........................................*..................................................................................................................................................................................................................................
        aesr v12.16b, v20.16b                               // ........................................*.....................................................................................................................................................................................................................................
        orr x25, x12, x22, lsl #32                          // ....................................................................................................................................................*.........................................................................................................................
        pmull2 v4.1q, v4.2d, v31.2d                         // ................................*.............................................................................................................................................................................................................................................
        ldr q1, [sp, #STACK_BASE_AES_ST + 16]               // ..........................*................................................................................................................................................................................................................................................... // @slothy:reads=stack_1
        orr x22, x12, x10, lsl #32                          // .............................................................................................................................................*................................................................................................................................
        aesr v12.16b, v21.16b                               // ............................................*.................................................................................................................................................................................................................................
        ldr q16, [x6, #112]                                 // ....................................................*.........................................................................................................................................................................................................................
        str q2, [x2, #112]                                  // ....*.........................................................................................................................................................................................................................................................................
        pmull2 v0.1q, v8.2d, v0.2d                          // .............*................................................................................................................................................................................................................................................................
        ldr q2, [x6, #96]                                   // ..............................*...............................................................................................................................................................................................................................................
        aesr v12.16b, v22.16b                               // ................................................*.............................................................................................................................................................................................................................
        ldp x19, x26, [x0, #96]                             // ....................................................................................................................................................................................*.........................................................................................
        eor v0.16B, v14.16B, v0.16B                         // ..................................*...........................................................................................................................................................................................................................................
        aesr v1.16b, v18.16b                                // .................................*............................................................................................................................................................................................................................................
        stp x11, x25, [sp, #STACK_BASE_AES_ST + 80]         // .......................................................................................................................................................*...................................................................................................................... // @slothy:writes=stack_5
        aesr v12.16b, v23.16b                               // ...................................................*..........................................................................................................................................................................................................................
        str q9, [x2, #64]                                   // ...........*..................................................................................................................................................................................................................................................................
        aesr v1.16b, v19.16b                                // .....................................*........................................................................................................................................................................................................................................
        stp x11, x28, [sp, #STACK_BASE_AES_ST + 112]        // ........................................................................................................................................................*..................................................................................................................... // @slothy:writes=stack_7
        aesr v12.16b, v24.16b                               // ........................................................*.....................................................................................................................................................................................................................
        stp x17, x14, [sp, #STACK_BASE_AES_ST + 32]         // ........................*..................................................................................................................................................................................................................................................... // @slothy:writes=stack_2
        eor x14, x30, x20                                   // .................*............................................................................................................................................................................................................................................................
        aesr v1.16b, v20.16b                                // .........................................*....................................................................................................................................................................................................................................
        mov d17, v28.d[1]                                   // .......*......................................................................................................................................................................................................................................................................
        eor x28, x29, x21                                   // ..................*...........................................................................................................................................................................................................................................................
        ldr q8, [sp, #STACK_BASE_AES_ST + 48]               // ...............................................................*.............................................................................................................................................................................................................. // @slothy:reads=stack_3
        aesr v12.16b, v25.16b                               // ..........................................................*...................................................................................................................................................................................................................
        stp x14, x28, [sp, #STACK_BASE_AES_ST]              // .....................*........................................................................................................................................................................................................................................................ // @slothy:writes=stack_0
        aesr v1.16b, v21.16b                                // ..............................................*...............................................................................................................................................................................................................................
        eor v17.8B, v17.8B, v28.8B                          // ...................*..........................................................................................................................................................................................................................................................
        ldr q9, [sp, #STACK_BASE_AES_ST]                    // ..................................................*........................................................................................................................................................................................................................... // @slothy:reads=stack_0
        aesr v12.16b, v26.16b                               // ............................................................*.................................................................................................................................................................................................................
        pmull v31.1q, v17.1d, v31.1d                        // .........................*....................................................................................................................................................................................................................................................
        ldr q17, [sp, #STACK_BASE_AES_ST + 80]              // ..........................................................................................................................................................*................................................................................................................... // @slothy:reads=stack_5
        aese v12.16b, v27.16b                               // ..............................................................*...............................................................................................................................................................................................................
        stp x11, x22, [sp, #STACK_BASE_AES_ST + 64]         // ................................................................................................................................................*............................................................................................................................. // @slothy:writes=stack_4
        aesr v6.16b, v20.16b                                // .*............................................................................................................................................................................................................................................................................
        eor x7, x26, x21                                    // ..............................................................................................................................................................................................*...............................................................................
        add w26, w13, #3                                    // ...........................................................................................................................................................................................*..................................................................................
        eor x14, x8, x20                                    // ................................................................................................................................................................................*.............................................................................................
        aesr v3.16b, v22.16b                                // .............................*................................................................................................................................................................................................................................................
        eor v14.16B, v0.16B, v31.16B                        // ......................................*.......................................................................................................................................................................................................................................
        ldp x22, x25, [x0, #80]                             // ..........................................................................................................................................................................................*...................................................................................
        add w27, w13, #2                                    // ..................................................................................................................................................................................................................*...........................................................
        aesr v6.16b, v21.16b                                // ...................................................................*..........................................................................................................................................................................................................
        eor v12.16B, v9.16B, v12.16B                        // ..................................................................*...........................................................................................................................................................................................................
        eor x19, x19, x20                                   // ...............................................................................................................................................................................................*..............................................................................
        rev w29, w27                                        // .....................................................................................................................................................................................................................*........................................................
        aesr v3.16b, v23.16b                                // .....................................................................*........................................................................................................................................................................................................
        ldr q9, [x6, #128]                                  // .....................................................*........................................................................................................................................................................................................................
        orr x27, x12, x29, lsl #32                          // ........................................................................................................................................................................................................................*.....................................................
        ldp x17, x29, [x0, #16]                             // ..................................................................................................................................................................................................................................................*...........................
        aesr v6.16b, v22.16b                                // .......................................................................*......................................................................................................................................................................................................
        rev64 v29.16B, v12.16B                              // ......................................................................*.......................................................................................................................................................................................................
        ldp x28, x10, [x0, #112]                            // .................................................................................................................................................................................................*............................................................................
        aesr v3.16b, v24.16b                                // ........................................................................*.....................................................................................................................................................................................................
        eor v4.16B, v14.16B, v4.16B                         // ..........................................*...................................................................................................................................................................................................................................
        eor x23, x24, x21                                   // .................................................................................................................................................................................*............................................................................................
        aesr v6.16b, v23.16b                                // ...........................................................................*..................................................................................................................................................................................................
        eor v14.16B, v29.16B, v30.16B                       // ..........................................................................*...................................................................................................................................................................................................
        aesr v3.16b, v25.16b                                // .............................................................................*................................................................................................................................................................................................
        ldr q0, [sp, #STACK_BASE_AES_ST + 32]               // .............................................*................................................................................................................................................................................................................................ // @slothy:reads=stack_2
        eor x30, x17, x20                                   // ..............................................................................................................................................................................................................................................................*...............
        eor x17, x29, x21                                   // .............................................................................................................................................................................................................................................................*................
        aesr v6.16b, v24.16b                                // .................................................................................*............................................................................................................................................................................................
        ldr q30, [sp, #STACK_BASE_AES_ST + 112]             // ............................................................................................................................................................*................................................................................................................. // @slothy:reads=stack_7
        aesr v3.16b, v26.16b                                // ..................................................................................*...........................................................................................................................................................................................
        ext v29.16B, v14.16B, v14.16B, #8                   // ...............................................................................*..............................................................................................................................................................................................
        stp x30, x17, [sp, #STACK_BASE_AES_ST + 16]         // .................................................................................................................................................................................................................................................................*............ // @slothy:writes=stack_1
        str q12, [x2], #(8*16)                              // ................................................................................*.............................................................................................................................................................................................
        aesr v6.16b, v25.16b                                // ....................................................................................*.........................................................................................................................................................................................
        aese v3.16b, v27.16b                                // ......................................................................................*.......................................................................................................................................................................................
        stp x11, x27, [sp, #STACK_BASE_AES_ST + 32]         // ............................................................................................................................................................................................................................*................................................. // @slothy:writes=stack_2
        eor v29.16B, v29.16B, v14.16B                       // ...................................................................................*..........................................................................................................................................................................................
        aesr v6.16b, v26.16b                                // ........................................................................................*.....................................................................................................................................................................................
        eor v3.16B, v8.16B, v3.16B                          // ..........................................................................................*...................................................................................................................................................................................
        pmull v28.1q, v28.1d, v5.1d                         // ............*.................................................................................................................................................................................................................................................................
        ldr q31, [x6, #160]                                 // ............................................................................................*.................................................................................................................................................................................
        aesr v1.16b, v22.16b                                // .................................................*............................................................................................................................................................................................................................
        eor v8.16B, v10.16B, v28.16B                        // ...............................................*..............................................................................................................................................................................................................................
        aese v6.16b, v27.16b                                // ...........................................................................................*..................................................................................................................................................................................
        rev64 v12.16B, v3.16B                               // ..............................................................................................*...............................................................................................................................................................................
        aesr v30.16b, v18.16b                               // ................................................................................................................................................................*.............................................................................................................
        aesr v17.16b, v18.16b                               // ...............................................................................................................................................................*..............................................................................................................
        eor v28.16B, v0.16B, v6.16B                         // ...............................................................................................*..............................................................................................................................................................................
        mov d10, v12.d[1]                                   // .................................................................................................*............................................................................................................................................................................
        pmull2 v5.1q, v12.2d, v2.2d                         // ..................................................................................................*...........................................................................................................................................................................
        rev64 v0.16B, v28.16B                               // ....................................................................................................*.........................................................................................................................................................................
        pmull v2.1q, v12.1d, v2.1d                          // ...................................................................................................*..........................................................................................................................................................................
        eor v6.8B, v10.8B, v12.8B                           // ......................................................................................................*.......................................................................................................................................................................
        aesr v17.16b, v19.16b                               // ..................................................................................................................................................................*...........................................................................................................
        pmull2 v10.1q, v0.2d, v9.2d                         // ........................................................................................................*.....................................................................................................................................................................
        str q28, [x2, #-96]                                 // ...............................................................................................................................*..............................................................................................................................................
        aesr v1.16b, v23.16b                                // ......................................................*.......................................................................................................................................................................................................................
        ext v12.16B, v0.16B, v0.16B, #8                     // .......................................................................................................*......................................................................................................................................................................
        eor v15.16B, v15.16B, v5.16B                        // .....................................................................................................*........................................................................................................................................................................
        pmull v28.1q, v0.1d, v9.1d                          // ...........................................................................................................*..................................................................................................................................................................
        eor v9.16B, v12.16B, v0.16B                         // ............................................................................................................*.................................................................................................................................................................
        pmull v12.1q, v6.1d, v16.1d                         // ..........................................................................................................*...................................................................................................................................................................
        eor v0.16B, v15.16B, v10.16B                        // .............................................................................................................*................................................................................................................................................................
        aesr v1.16b, v24.16b                                // .........................................................*....................................................................................................................................................................................................................
        ldr q10, [sp, #STACK_BASE_AES_ST + 96]              // .................................................................................................................................................*............................................................................................................................ // @slothy:reads=stack_6
        pmull2 v15.1q, v9.2d, v16.2d                        // ................................................................................................................*.............................................................................................................................................................
        aesr v10.16b, v18.16b                               // .........................................................................................................................................................*....................................................................................................................
        eor v11.16B, v8.16B, v11.16B                        // .......................................................*......................................................................................................................................................................................................................
        ldp x8, x24, [x0, #32]                              // .............................................................................................................................................................................................................*................................................................
        rev w26, w26                                        // ...............................................................................................................................................................................................................................*..............................................
        str q3, [x2, #-80]                                  // ..............................................................................................................................*...............................................................................................................................................
        aesr v1.16b, v25.16b                                // ...........................................................*..................................................................................................................................................................................................................
        eor x28, x28, x20                                   // ......................................................................................................................................................................................................................................*.......................................
        orr x26, x12, x26, lsl #32                          // ...................................................................................................................................................................................................................................*..........................................
        pmull2 v5.1q, v29.2d, v31.2d                        // ......................................................................................................................*.......................................................................................................................................................
        eor v11.16B, v11.16B, v2.16B                        // .........................................................................................................*....................................................................................................................................................................
        stp x11, x26, [sp, #STACK_BASE_AES_ST + 48]         // .......................................................................................................................................................................................................................................*...................................... // @slothy:writes=stack_3
        eor x25, x25, x21                                   // ......................................................................................................................................................................................................*.......................................................................
        aesr v1.16b, v26.16b                                // .............................................................*................................................................................................................................................................................................................
        ldr q6, [x6, #176]                                  // ................................................................*.............................................................................................................................................................................................................
        eor x26, x22, x20                                   // .......................................................................................................................................................................................................*......................................................................
        add w27, w13, #0                                    // ...............................................................................................................................................................................................................................................*..............................
        eor v9.16B, v4.16B, v12.16B                         // ..............................................................................................................*...............................................................................................................................................................
        aesr v10.16b, v19.16b                               // .............................................................................................................................................................*................................................................................................................
        stp x19, x7, [sp, #STACK_BASE_AES_ST + 96]          // ..................................................................................................................................................................................................*........................................................................... // @slothy:writes=stack_6
        rev w17, w27                                        // ...................................................................................................................................................................................................................................................*..........................
        ldr q16, [x6, #144]                                 // ...............................*..............................................................................................................................................................................................................................................
        aese v1.16b, v27.16b                                // .................................................................*............................................................................................................................................................................................................
        orr x17, x12, x17, lsl #32                          // ......................................................................................................................................................................................................................................................*.......................
        eor x29, x10, x21                                   // ..................................................................................................................................................................................................................................*...........................................
        eor v9.16B, v9.16B, v15.16B                         // ...................................................................................................................*..........................................................................................................................................................
        aesr v10.16b, v20.16b                               // .................................................................................................................................................................*............................................................................................................
        stp x11, x17, [sp, #STACK_BASE_AES_ST]              // .......................................................................................................................................................................................................................................................................*...... // @slothy:writes=stack_0
        stp x28, x29, [sp, #STACK_BASE_AES_ST + 112]        // .........................................................................................................................................................................................................................................*.................................... // @slothy:writes=stack_7
        pmull v29.1q, v14.1d, v6.1d                         // .........................................................................................*....................................................................................................................................................................................
        eor v1.16B, v13.16B, v1.16B                         // ....................................................................*.........................................................................................................................................................................................................
        add w19, w13, #1                                    // ....................................................................................................................................................................................................................................................................*.........
        eor x17, x8, x20                                    // ............................................................................................................................................................................................................................................*.................................
        eor v13.16B, v11.16B, v28.16B                       // ...............................................................................................................*..............................................................................................................................................................
        aesr v10.16b, v21.16b                               // ...................................................................................................................................................................*..........................................................................................................
        rev w19, w19                                        // ........................................................................................................................................................................................................................................................................*.....
        ldp x30, x10, [x0, #48]                             // ........................................................................................................................................................................................*.....................................................................................
        rev64 v4.16B, v1.16B                                // .........................................................................*....................................................................................................................................................................................................
        pmull2 v2.1q, v14.2d, v6.2d                         // ..............................................................................*...............................................................................................................................................................................................
        orr x8, x12, x19, lsl #32                           // ...........................................................................................................................................................................................................................................................................*..
        stp x26, x25, [sp, #STACK_BASE_AES_ST + 80]         // ..........................................................................................................................................................................................................*................................................................... // @slothy:writes=stack_5
        aesr v10.16b, v22.16b                               // .....................................................................................................................................................................*........................................................................................................
        ldr q15, [sp, #STACK_BASE_AES_ST + 96]              // ....................................................................................................................................................................................................*......................................................................... // @slothy:reads=stack_6
        mov d28, v4.d[1]                                    // .....................................................................................*........................................................................................................................................................................................
        pmull2 v11.1q, v4.2d, v16.2d                        // ................................................................................................*.............................................................................................................................................................................
        pmull v8.1q, v4.1d, v16.1d                          // .............................................................................................*................................................................................................................................................................................
        ldr q12, [sp, #STACK_BASE_AES_ST + 64]              // ...................................................................................................................................................*.......................................................................................................................... // @slothy:reads=stack_4
        eor x29, x10, x21                                   // .................................................................................................................................................................................................................*............................................................
        eor x28, x30, x20                                   // ..............................................................................................................................................................................................................*...............................................................
        aesr v10.16b, v23.16b                               // .......................................................................................................................................................................*......................................................................................................
        eor v14.16B, v0.16B, v11.16B                        // ..................................................................................................................*...........................................................................................................................................................
        stp x14, x23, [sp, #STACK_BASE_AES_ST + 64]         // ...................................................................................................................................................................................*.......................................................................................... // @slothy:writes=stack_4
        eor x14, x24, x21                                   // ...........................................................................................................................................................................................................................*..................................................
        aesr v30.16b, v19.16b                               // ..................................................................................................................................................................................*...........................................................................................
        eor v8.16B, v13.16B, v8.16B                         // ....................................................................................................................*.........................................................................................................................................................
        eor v11.8B, v28.8B, v4.8B                           // .......................................................................................*......................................................................................................................................................................................
        aesr v10.16b, v24.16b                               // ..........................................................................................................................................................................*...................................................................................................
        eor v8.16B, v8.16B, v29.16B                         // ........................................................................................................................*.....................................................................................................................................................
        aesr v30.16b, v20.16b                               // .......................................................................................................................................................................................*......................................................................................
        pmull v11.1q, v11.1d, v31.1d                        // .................................................................................................................*............................................................................................................................................................
        eor v3.16B, v14.16B, v2.16B                         // .....................................................................................................................*........................................................................................................................................................
        aesr v10.16b, v25.16b                               // .............................................................................................................................................................................*................................................................................................
        ldr q6, [sp, #STACK_BASE_AES_ST + 32]               // .....................................................................................................................................................................................................................................................*........................ // @slothy:reads=stack_2
        eor v31.16B, v9.16B, v11.16B                        // .......................................................................................................................*......................................................................................................................................................
        pmull v4.1q, v3.1d, v7.1d                           // .........................................................................................................................*.................................................................................................................................................... // @slothy:late
        aesr v12.16b, v18.16b                               // ...........................................................................................................................................................*..................................................................................................................
        eor v11.16B, v8.16B, v3.16B                         // ...........................................................................................................................*.................................................................................................................................................. // @slothy:late
        aesr v10.16b, v26.16b                               // .....................................................................................................................................................................................*........................................................................................
        eor v31.16B, v31.16B, v5.16B                        // ............................................................................................................................*.................................................................................................................................................
        aesr v12.16b, v19.16b                               // ..............................................................................................................................................................*...............................................................................................................
        ext v2.16B, v3.16B, v3.16B, #8                      // ..........................................................................................................................*................................................................................................................................................... // @slothy:late
        eor v28.16B, v31.16B, v11.16B                       // ................................................................................................................................*............................................................................................................................................. // @slothy:late
        aesr v17.16b, v20.16b                               // ....................................................................................................................................................................*.........................................................................................................
        aesr v12.16b, v20.16b                               // .....................................................................................................................................................................................................*........................................................................
        eor v13.16B, v2.16B, v4.16B                         // .............................................................................................................................*................................................................................................................................................ // @slothy:late
        ldr q11, [x6, #32]                                  // ........................................................................................................................................................................................................*.....................................................................
        aesr v17.16b, v21.16b                               // ......................................................................................................................................................................*.......................................................................................................
        eor v2.16B, v28.16B, v13.16B                        // .................................................................................................................................*............................................................................................................................................ // @slothy:late
        aese v10.16b, v27.16b                               // ................................................................................................................................................................................................*.............................................................................
        ldr q3, [sp, #STACK_BASE_AES_ST + 48]               // ...........................................................................................................................................................................................................................................*.................................. // @slothy:reads=stack_3
        aesr v12.16b, v21.16b                               // ................................................................................................................................................................................................................*.............................................................
        stp x28, x29, [sp, #STACK_BASE_AES_ST + 48]         // ..........................................................................................................................................................................................................................................................*................... // @slothy:writes=stack_3
        pmull v31.1q, v2.1d, v7.1d                          // ..................................................................................................................................*........................................................................................................................................... // @slothy:late
        ext v13.16B, v2.16B, v2.16B, #8                     // ...................................................................................................................................*.......................................................................................................................................... // @slothy:late
        eor v29.16B, v15.16B, v10.16B                       // ...............................................................................................................................................................................................................*..............................................................
        aesr v12.16b, v22.16b                               // ..........................................................................................................................................................................................................................*...................................................
        eor v31.16B, v8.16B, v31.16B                        // ....................................................................................................................................*......................................................................................................................................... // @slothy:late
        aesr v17.16b, v22.16b                               // ........................................................................................................................................................................*.....................................................................................................
        aesr v12.16b, v23.16b                               // .....................................................................................................................................................................................................................................*........................................
        rev64 v10.16B, v29.16B                              // ......................................................................................................................................................................................................................*.......................................................
        aesr v17.16b, v23.16b                               // ...........................................................................................................................................................................*..................................................................................................
        eor v4.16B, v31.16B, v13.16B                        // .....................................................................................................................................*........................................................................................................................................ // @slothy:late
        ext v31.16B, v10.16B, v10.16B, #8                   // ..............................................................................................................................................................................................................................*...............................................
        aesr v30.16b, v21.16b                               // .............................................................................................................................................................................................*................................................................................
        aesr v17.16b, v24.16b                               // ...............................................................................................................................................................................*..............................................................................................
        str q1, [x2, #-112]                                 // ............................................................................*.................................................................................................................................................................................................
        aesr v30.16b, v22.16b                               // ...................................................................................................................................................................................................*..........................................................................
        ldr q15, [x6]                                       // ....................................................................................................................................................................................................................*.........................................................
        aesr v17.16b, v25.16b                               // .........................................................................................................................................................................................*....................................................................................
        ldr q9, [sp, #STACK_BASE_AES_ST + 80]               // ...........................................................................................................................................................................................................*.................................................................. // @slothy:reads=stack_5
        eor v8.16B, v31.16B, v10.16B                        // ....................................................................................................................................................................................................................................*.........................................
        pmull2 v1.1q, v10.2d, v11.2d                        // .............................................................................................................................................................................................................................*................................................
        ldr q14, [x6, #80]                                  // ............................................................................................................................................................................................*.................................................................................
        aesr v30.16b, v23.16b                               // .........................................................................................................................................................................................................*....................................................................
        aesr v6.16b, v18.16b                                // ................................................................................................................................................................................................................................................................*.............
        ldr q0, [x6, #16]                                   // ...............................................................................................................................................................................................................................................................*..............
        aesr v30.16b, v24.16b                               // .......................................................................................................................................................................................................................*......................................................
        ldr q5, [x6, #48]                                   // ..............................................................................................................................................................................*...............................................................................................
        aesr v17.16b, v26.16b                               // ............................................................................................................................................................................................................*.................................................................
        ldr q13, [sp, #STACK_BASE_AES_ST + 112]             // ................................................................................................................................................................................................................................................*............................. // @slothy:reads=stack_7
        aesr v30.16b, v25.16b                               // ................................................................................................................................................................................................................................*.............................................
        str q29, [x2, #96]                                  // .............................................................................................................................................................................................................................................*................................
        aese v17.16b, v27.16b                               // ...................................................................................................................................................................................................................*..........................................................
        aesr v30.16b, v26.16b                               // ..............................................................................................................................................................................................................................................*...............................
        aesr v12.16b, v24.16b                               // .................................................................................................................................................................................................................................................*............................
        eor v2.16B, v9.16B, v17.16B                         // .........................................................................................................................................................................................................................*....................................................
        aese v30.16b, v27.16b                               // ....................................................................................................................................................................................................................................................*.........................
        ldr q31, [x6, #64]                                  // ............................................................................................................................................................................*.................................................................................................
        rev64 v28.16B, v2.16B                               // .................................................................................................................................................................................................................................*............................................
        aesr v12.16b, v25.16b                               // .......................................................................................................................................................................................................................................................*......................
        str q2, [x2, #80]                                   // .........................................................................................................................................................................................................................................................*....................
        aesr v3.16b, v18.16b                                // ........................................................................................................................................................................................................................................................*.....................
        pmull2 v16.1q, v28.2d, v5.2d                        // ..........................................................................................................................................................................................................................................*...................................
        ldr q9, [sp, #STACK_BASE_AES_ST + 64]               // ......................................................................................................................................................................................*....................................................................................... // @slothy:reads=stack_4
        eor v2.16B, v13.16B, v30.16B                        // ............................................................................................................................................................................................................................................................*.................
        aesr v12.16b, v26.16b                               // ...........................................................................................................................................................................................................................................................*..................
        aesr v3.16b, v19.16b                                // ..................................................................................................................................................................................................................................................................*...........
        ldr q13, [sp, #STACK_BASE_AES_ST + 16]              // .....................................................................................................................................................................................................................................................................*........ // @slothy:reads=stack_1
        rev64 v29.16B, v2.16B                               // ...................................................................................................................................................................................................................................................................*..........
        aese v12.16b, v27.16b                               // ......................................................................................................................................................................................................................................................................*.......
        ext v30.16B, v4.16B, v4.16B, #8                     // ......................................................................................................................................*....................................................................................................................................... // @slothy:late
        aesr v6.16b, v19.16b                                // ..........................................................................................................................................................................................................................................................................*...
        mov d4, v29.d[1]                                    // .........................................................................................................................................................................................................................................................................*....
        pmull v11.1q, v10.1d, v11.1d                        // ........................................................................................................................................................................................................................................*.....................................
        aesr v3.16b, v20.16b                                // ............................................................................................................................................................................................................................................................................*.
        eor v9.16B, v9.16B, v12.16B                         // .............................................................................................................................................................................................................................................................................*

        // original source code
        // eor v10.8B, v4.8B, v29.8B // ..*.................................................................
        // aesr v6.16b, v20.16b // .................*..................................................
        // stp x11, x8, [sp, #STACK_BASE_AES_ST + 16] // *...................................................................
        // add w13, w13, #UNROLL // *...................................................................
        // str q2, [x2, #112] // .........*..........................................................
        // pmull v12.1q, v29.1d, v15.1d // ..*.................................................................
        // aesr v3.16b, v21.16b // .*..................................................................
        // mov d17, v28.d[1] // .............*......................................................
        // ldp x26, x19, [x0], #(8*16) // ......*.............................................................
        // eor v4.16B, v12.16B, v11.16B // ....*...............................................................
        // pmull2 v29.1q, v29.2d, v15.2d // *...................................................................
        // str q9, [x2, #64] // ............*.......................................................
        // pmull v11.1q, v28.1d, v5.1d // ...........................*........................................
        // pmull2 v2.1q, v8.2d, v0.2d // ..........*.........................................................
        // rev64 v12.16B, v9.16B // .*..................................................................
        // ldr q9, [sp, #STACK_BASE_AES_ST] // *...................................................................
        // pmull v8.1q, v10.1d, v0.1d // .......*............................................................
        // eor x26, x26, x20 // .............*......................................................
        // eor x19, x19, x21 // ..............*.....................................................
        // eor v17.8B, v17.8B, v28.8B // ...............*....................................................
        // pmull2 v15.1q, v12.2d, v14.2d // ...*................................................................
        // stp x26, x19, [sp, #STACK_BASE_AES_ST] // ..............*.....................................................
        // pmull v0.1q, v12.1d, v14.1d // .....*..............................................................
        // ext v28.16B, v12.16B, v12.16B, #8 // .....*..............................................................
        // stp x17, x14, [sp, #STACK_BASE_AES_ST + 32] // .............*......................................................
        // pmull v14.1q, v17.1d, v31.1d // ................*...................................................
        // ldr q5, [sp, #STACK_BASE_AES_ST + 16] // ........*...........................................................
        // eor v12.16B, v28.16B, v12.16B // .......*............................................................
        // aesr v9.16b, v18.16b // ....*...............................................................
        // aesr v3.16b, v22.16b // ..................*.................................................
        // ldr q10, [x6, #96] // ..........*.........................................................
        // ldr q17, [x6, #144] // ......................................*.............................
        // pmull2 v31.1q, v12.2d, v31.2d // ........*...........................................................
        // aesr v5.16b, v18.16b // ...........*........................................................
        // eor v12.16B, v8.16B, v2.16B // ...........*........................................................
        // aesr v9.16b, v19.16b // ......*.............................................................
        // eor v28.16B, v29.16B, v1.16B // ...*................................................................
        // aesr v5.16b, v19.16b // ............*.......................................................
        // eor v12.16B, v12.16B, v14.16B // ..................*.................................................
        // eor v28.16B, v28.16B, v16.16B // ......*.............................................................
        // aesr v9.16b, v20.16b // ........*...........................................................
        // aesr v5.16b, v20.16b // .............*......................................................
        // eor v14.16B, v12.16B, v31.16B // ......................*.............................................
        // eor v2.16B, v28.16B, v15.16B // .......*............................................................
        // aesr v9.16b, v21.16b // .........*..........................................................
        // ldr q29, [sp, #STACK_BASE_AES_ST + 32] // .......................*............................................
        // aesr v5.16b, v21.16b // ...............*....................................................
        // eor v4.16B, v4.16B, v11.16B // ...........................*........................................
        // aesr v9.16b, v22.16b // ..........*.........................................................
        // aesr v5.16b, v22.16b // ...........................*........................................
        // ldr q1, [sp, #STACK_BASE_AES_ST] // ...............*....................................................
        // aesr v9.16b, v23.16b // ...........*........................................................
        // ldr q16, [x6, #112] // .........*..........................................................
        // ldr q8, [x6, #128] // ....................*...............................................
        // aesr v5.16b, v23.16b // ...............................*....................................
        // eor v28.16B, v4.16B, v0.16B // ..................................*.................................
        // aesr v9.16b, v24.16b // ............*.......................................................
        // aesr v5.16b, v24.16b // .................................*..................................
        // aesr v9.16b, v25.16b // ..............*.....................................................
        // aesr v5.16b, v25.16b // ...................................*................................
        // aesr v9.16b, v26.16b // ...............*....................................................
        // aesr v5.16b, v26.16b // ....................................*...............................
        // aese v9.16b, v27.16b // ................*...................................................
        // ldr q4, [sp, #STACK_BASE_AES_ST + 48] // ..............*.....................................................
        // ldr q0, [x6, #176] // .....................................*..............................
        // aese v5.16b, v27.16b // .......................................*............................
        // eor v1.16B, v1.16B, v9.16B // ...................*................................................
        // aesr v6.16b, v21.16b // ...................*................................................
        // eor v31.16B, v13.16B, v5.16B // .........................................*..........................
        // aesr v3.16b, v23.16b // ....................*...............................................
        // rev64 v12.16B, v1.16B // .....................*..............................................
        // aesr v6.16b, v22.16b // .....................*..............................................
        // aesr v3.16b, v24.16b // .....................*..............................................
        // rev64 v15.16B, v31.16B // ..........................................*.........................
        // eor v30.16B, v12.16B, v30.16B // ......................*.............................................
        // aesr v6.16b, v23.16b // ......................*.............................................
        // str q31, [x2, #16] // .........................................................*..........
        // aesr v3.16b, v25.16b // .......................*............................................
        // pmull2 v11.1q, v30.2d, v0.2d // ...........................................*........................
        // ext v31.16B, v30.16B, v30.16B, #8 // ........................*...........................................
        // str q1, [x2], #(8*16) // .........................*..........................................
        // aesr v6.16b, v24.16b // ........................*...........................................
        // aesr v3.16b, v26.16b // ........................*...........................................
        // eor v5.16B, v31.16B, v30.16B // ..........................*.........................................
        // aesr v6.16b, v25.16b // .........................*..........................................
        // mov d31, v15.d[1] // ............................................*.......................
        // aese v3.16b, v27.16b // .........................*..........................................
        // eor v13.8B, v31.8B, v15.8B // ...............................................*....................
        // aesr v6.16b, v26.16b // ..........................*.........................................
        // pmull v1.1q, v30.1d, v0.1d // ........................................*...........................
        // eor v3.16B, v4.16B, v3.16B // ..........................*.........................................
        // aese v6.16b, v27.16b // ............................*.......................................
        // ldr q4, [x6, #160] // ...........................*........................................
        // pmull v12.1q, v15.1d, v17.1d // ............................................*.......................
        // rev64 v0.16B, v3.16B // ............................*.......................................
        // eor v6.16B, v29.16B, v6.16B // .............................*......................................
        // pmull2 v15.1q, v15.2d, v17.2d // ............................................*.......................
        // mov d9, v0.d[1] // .............................*......................................
        // pmull2 v30.1q, v0.2d, v10.2d // .............................*......................................
        // pmull v31.1q, v0.1d, v10.1d // ..............................*.....................................
        // rev64 v10.16B, v6.16B // .............................*......................................
        // eor v2.16B, v2.16B, v30.16B // ...............................*....................................
        // eor v30.8B, v9.8B, v0.8B // ..............................*.....................................
        // ext v9.16B, v10.16B, v10.16B, #8 // ...............................*....................................
        // pmull2 v29.1q, v10.2d, v8.2d // ..............................*.....................................
        // eor v31.16B, v28.16B, v31.16B // ....................................*...............................
        // pmull v28.1q, v30.1d, v16.1d // ................................*...................................
        // pmull v30.1q, v10.1d, v8.1d // ................................*...................................
        // eor v9.16B, v9.16B, v10.16B // ................................*...................................
        // eor v8.16B, v2.16B, v29.16B // ................................*...................................
        // eor v28.16B, v14.16B, v28.16B // .....................................*..............................
        // eor v30.16B, v31.16B, v30.16B // .........................................*..........................
        // pmull2 v31.1q, v9.2d, v16.2d // .................................*..................................
        // pmull v2.1q, v13.1d, v4.1d // ................................................*...................
        // eor v15.16B, v8.16B, v15.16B // ..............................................*.....................
        // eor v31.16B, v28.16B, v31.16B // .......................................*............................
        // eor v30.16B, v30.16B, v12.16B // ...............................................*....................
        // eor v28.16B, v15.16B, v11.16B // ................................................*...................
        // pmull2 v12.1q, v5.2d, v4.2d // ...................................*................................
        // eor v15.16B, v31.16B, v2.16B // .................................................*..................
        // eor v11.16B, v30.16B, v1.16B // ...............................................*....................
        // pmull v30.1q, v28.1d, v7.1d // .................................................*..................
        // ext v2.16B, v28.16B, v28.16B, #8 // ...................................................*................
        // eor v31.16B, v11.16B, v28.16B // ..................................................*.................
        // eor v15.16B, v15.16B, v12.16B // ..................................................*.................
        // eor v12.16B, v2.16B, v30.16B // ....................................................*...............
        // str q3, [x2, #-80] // ..................................*.................................
        // str q6, [x2, #-96] // ...............................*....................................
        // eor v31.16B, v15.16B, v31.16B // ...................................................*................
        // eor v31.16B, v31.16B, v12.16B // ....................................................*...............
        // pmull v13.1q, v31.1d, v7.1d // ......................................................*.............
        // ext v31.16B, v31.16B, v31.16B, #8 // ......................................................*.............
        // eor v15.16B, v11.16B, v13.16B // .......................................................*............
        // eor v31.16B, v15.16B, v31.16B // ........................................................*...........
        // ext v30.16B, v31.16B, v31.16B, #8 // ..................................................................*.
        // add w30, w13, #6 // .*..................................................................
        // add w26, w13, #4 // ....*...............................................................
        // rev w17, w30 // ..*.................................................................
        // rev w30, w26 // .....*..............................................................
        // add w19, w13, #5 // .....*..............................................................
        // orr x26, x12, x17, lsl #32 // ...*................................................................
        // orr x22, x12, x30, lsl #32 // .........*..........................................................
        // rev w30, w19 // ......*.............................................................
        // stp x11, x26, [sp, #STACK_BASE_AES_ST + 96] // ....*...............................................................
        // stp x11, x22, [sp, #STACK_BASE_AES_ST + 64] // ................*...................................................
        // ldr q10, [sp, #STACK_BASE_AES_ST + 96] // .................................*..................................
        // add w29, w13, #7 // .*..................................................................
        // ldr q9, [sp, #STACK_BASE_AES_ST + 64] // .............................................*......................
        // orr x27, x12, x30, lsl #32 // ........*...........................................................
        // rev w30, w29 // ..*.................................................................
        // orr x14, x12, x30, lsl #32 // ...*................................................................
        // stp x11, x27, [sp, #STACK_BASE_AES_ST + 80] // ...........*........................................................
        // stp x11, x14, [sp, #STACK_BASE_AES_ST + 112] // ............*.......................................................
        // aesr v10.16b, v18.16b // .................................*..................................
        // ldr q17, [sp, #STACK_BASE_AES_ST + 80] // ................*...................................................
        // aesr v9.16b, v18.16b // .................................................*..................
        // ldr q4, [sp, #STACK_BASE_AES_ST + 112] // ........................*...........................................
        // aesr v10.16b, v19.16b // ......................................*.............................
        // aesr v9.16b, v19.16b // ..................................................*.................
        // aesr v17.16b, v18.16b // ............................*.......................................
        // aesr v4.16b, v18.16b // ............................*.......................................
        // aesr v10.16b, v20.16b // ........................................*...........................
        // aesr v17.16b, v19.16b // ..............................*.....................................
        // aesr v10.16b, v21.16b // ..........................................*.........................
        // aesr v17.16b, v20.16b // ...................................................*................
        // aesr v10.16b, v22.16b // ...........................................*........................
        // aesr v17.16b, v21.16b // ....................................................*...............
        // aesr v10.16b, v23.16b // .............................................*......................
        // aesr v17.16b, v22.16b // .......................................................*............
        // ldp x30, x25, [x0, #64] // .......*............................................................
        // aesr v10.16b, v24.16b // ...............................................*....................
        // aesr v17.16b, v23.16b // ........................................................*...........
        // ldr q31, [x6, #64] // ..............................................................*.....
        // aesr v10.16b, v25.16b // ................................................*...................
        // ldr q5, [x6, #48] // ............................................................*.......
        // aesr v17.16b, v24.16b // .........................................................*..........
        // eor x14, x30, x20 // .................*..................................................
        // eor x27, x25, x21 // ......................*.............................................
        // aesr v4.16b, v19.16b // ..............................................*.....................
        // stp x14, x27, [sp, #STACK_BASE_AES_ST + 64] // ..............................................*.....................
        // ldp x26, x17, [x0, #96] // ..........*.........................................................
        // aesr v10.16b, v26.16b // ..................................................*.................
        // ldr q12, [sp, #STACK_BASE_AES_ST + 64] // ................................................................*...
        // aesr v4.16b, v20.16b // ................................................*...................
        // ldp x25, x29, [x0, #48] // ..........................................*.........................
        // aesr v17.16b, v25.16b // ..........................................................*.........
        // ldp x27, x30, [x0, #80] // ..................*.................................................
        // add w19, w13, #3 // .................*..................................................
        // ldr q14, [x6, #80] // ...........................................................*........
        // aesr v4.16b, v21.16b // ........................................................*...........
        // eor x14, x17, x21 // .................*..................................................
        // eor x17, x26, x20 // ...................*................................................
        // aese v10.16b, v27.16b // .....................................................*..............
        // ldp x23, x26, [x0, #112] // .....................*..............................................
        // stp x17, x14, [sp, #STACK_BASE_AES_ST + 96] // ......................................*.............................
        // aesr v4.16b, v22.16b // .........................................................*..........
        // ldr q6, [sp, #STACK_BASE_AES_ST + 96] // ............................................*.......................
        // aesr v9.16b, v20.16b // ...................................................*................
        // eor x30, x30, x21 // ....................................*...............................
        // eor x17, x27, x20 // .....................................*..............................
        // ldr q29, [x6, #32] // ....................................................*...............
        // aesr v4.16b, v23.16b // ...........................................................*........
        // stp x17, x30, [sp, #STACK_BASE_AES_ST + 80] // ...........................................*........................
        // ldr q11, [sp, #STACK_BASE_AES_ST + 80] // ..........................................................*.........
        // aesr v17.16b, v26.16b // ............................................................*.......
        // ldp x17, x10, [x0, #32] // ..................................*.................................
        // eor x8, x25, x20 // .............................................*......................
        // eor v10.16B, v6.16B, v10.16B // ......................................................*.............
        // aesr v9.16b, v21.16b // .....................................................*..............
        // eor x28, x29, x21 // .............................................*......................
        // add w29, w13, #2 // ..................*.................................................
        // aese v17.16b, v27.16b // .............................................................*......
        // ldr q15, [x6] // .........................................................*..........
        // rev w29, w29 // ...................*................................................
        // rev64 v3.16B, v10.16B // .......................................................*............
        // aesr v4.16b, v24.16b // ............................................................*.......
        // orr x29, x12, x29, lsl #32 // ....................*...............................................
        // eor v17.16B, v11.16B, v17.16B // ..............................................................*.....
        // aesr v9.16b, v22.16b // ......................................................*.............
        // eor x14, x10, x21 // ..............................................*.....................
        // stp x11, x29, [sp, #STACK_BASE_AES_ST + 32] // ..........................*.........................................
        // pmull2 v1.1q, v3.2d, v29.2d // ..........................................................*.........
        // ext v2.16B, v3.16B, v3.16B, #8 // ........................................................*...........
        // rev w19, w19 // ..................................*.................................
        // aesr v4.16b, v25.16b // .............................................................*......
        // rev64 v28.16B, v17.16B // ...............................................................*....
        // eor x30, x26, x21 // .......................................*............................
        // orr x26, x12, x19, lsl #32 // ...................................*................................
        // eor v8.16B, v2.16B, v3.16B // ..........................................................*.........
        // aesr v9.16b, v23.16b // .......................................................*............
        // eor x19, x23, x20 // ...................................*................................
        // stp x11, x26, [sp, #STACK_BASE_AES_ST + 48] // ....................................*...............................
        // pmull v11.1q, v3.1d, v29.1d // ..................................................................*.
        // stp x19, x30, [sp, #STACK_BASE_AES_ST + 112] // ........................................*...........................
        // pmull2 v16.1q, v28.2d, v5.2d // ................................................................*...
        // ldr q3, [sp, #STACK_BASE_AES_ST + 48] // .....................................................*..............
        // eor x17, x17, x20 // .........................................*..........................
        // str q10, [x2, #96] // .............................................................*......
        // aesr v4.16b, v26.16b // .............................................................*......
        // add w26, w13, #0 // .....................................*..............................
        // ldr q10, [sp, #STACK_BASE_AES_ST + 112] // ............................................................*.......
        // aesr v9.16b, v24.16b // ..............................................................*.....
        // ldp x19, x23, [x0, #16] // ....................*...............................................
        // rev w26, w26 // ......................................*.............................
        // aese v4.16b, v27.16b // ..............................................................*.....
        // ldr q6, [sp, #STACK_BASE_AES_ST + 32] // .................................................*..................
        // orr x22, x12, x26, lsl #32 // .......................................*............................
        // aesr v9.16b, v25.16b // ...............................................................*....
        // aesr v3.16b, v18.16b // ...............................................................*....
        // str q17, [x2, #80] // ...............................................................*....
        // stp x8, x28, [sp, #STACK_BASE_AES_ST + 48] // .....................................................*..............
        // aesr v9.16b, v26.16b // ................................................................*...
        // eor v2.16B, v10.16B, v4.16B // ................................................................*...
        // eor x29, x23, x21 // .......................*............................................
        // eor x30, x19, x20 // .......................*............................................
        // ldr q0, [x6, #16] // ...........................................................*........
        // aesr v6.16b, v18.16b // ...........................................................*........
        // stp x30, x29, [sp, #STACK_BASE_AES_ST + 16] // .........................*..........................................
        // aesr v3.16b, v19.16b // .................................................................*..
        // rev64 v29.16B, v2.16B // .................................................................*..
        // add w19, w13, #1 // .........................................*..........................
        // ldr q13, [sp, #STACK_BASE_AES_ST + 16] // .................................................................*..
        // aese v9.16b, v27.16b // .................................................................*..
        // stp x11, x22, [sp, #STACK_BASE_AES_ST] // ........................................*...........................
        // rev w19, w19 // ..........................................*.........................
        // mov d4, v29.d[1] // ..................................................................*.
        // aesr v6.16b, v19.16b // ..................................................................*.
        // orr x8, x12, x19, lsl #32 // ...........................................*........................
        // aesr v3.16b, v20.16b // _..................................................................*
        // eor v9.16B, v12.16B, v9.16B // _..................................................................*

        sub count, count, #1
        cbnz count, Lloop_unrolled_start
Lloop_unrolled_start_postamble:// end of loop kernel
        eor v10.8B, v4.8B, v29.8B                           // .............................*................................................................................................................................................................................................................................................
        aesr v6.16b, v20.16b                                // .........................................................................................................................................................................*....................................................................................................
        stp x11, x8, [sp, #STACK_BASE_AES_ST + 16]          // ....................................................................................................................................................................................................*......................................................................... // @slothy:writes=stack_1
        add w13, w13, #UNROLL                               // .............................................................................................................................................................................................................................................................................*
        str q2, [x2, #112]                                  // .....................*........................................................................................................................................................................................................................................................
        pmull v12.1q, v29.1d, v15.1d                        // ..........................*...................................................................................................................................................................................................................................................
        aesr v3.16b, v21.16b                                // ........................................................................................................................................*.....................................................................................................................................
        mov d17, v28.d[1]                                   // ............................................................................................*.................................................................................................................................................................................
        ldp x26, x19, [x0], #(8*16)                         // ..................................................................................................................................................................................................................................*...........................................
        eor v4.16B, v12.16B, v11.16B                        // .......................................................*......................................................................................................................................................................................................................
        pmull2 v29.1q, v29.2d, v15.2d                       // ...........................*..................................................................................................................................................................................................................................................
        str q9, [x2, #64]                                   // .....................................................................................................................*........................................................................................................................................................
        pmull v11.1q, v28.1d, v5.1d                         // ........................................................................................*.....................................................................................................................................................................................
        pmull2 v2.1q, v8.2d, v0.2d                          // ............................................................*.................................................................................................................................................................................................................
        rev64 v12.16B, v9.16B                               // ......................................................................................................................*.......................................................................................................................................................
        ldr q9, [sp, #STACK_BASE_AES_ST]                    // .......................................................................................................................................................................................................................................*...................................... // @slothy:reads=stack_0
        pmull v8.1q, v10.1d, v0.1d                          // ..............................*...............................................................................................................................................................................................................................................
        eor x26, x26, x20                                   // ..................................................................................................................................................................................................................................................*...........................
        eor x19, x19, x21                                   // ...................................................................................................................................................................................................................................................*..........................
        eor v17.8B, v17.8B, v28.8B                          // .............................................................................................*................................................................................................................................................................................
        pmull2 v15.1q, v12.2d, v14.2d                       // .........................................................................................................................*....................................................................................................................................................
        stp x26, x19, [sp, #STACK_BASE_AES_ST]              // ....................................................................................................................................................................................................................................................*......................... // @slothy:writes=stack_0
        pmull v0.1q, v12.1d, v14.1d                         // .......................................................................................................................*......................................................................................................................................................
        ext v28.16B, v12.16B, v12.16B, #8                   // ...........................................................................................................................*..................................................................................................................................................
        stp x17, x14, [sp, #STACK_BASE_AES_ST + 32]         // ...................................................................................................................................................................................*.......................................................................................... // @slothy:writes=stack_2
        pmull v14.1q, v17.1d, v31.1d                        // ..............................................................................................*...............................................................................................................................................................................
        ldr q5, [sp, #STACK_BASE_AES_ST + 16]               // .....................................................................................................................................................................................................*........................................................................ // @slothy:reads=stack_1
        eor v12.16B, v28.16B, v12.16B                       // ............................................................................................................................*.................................................................................................................................................
        aesr v9.16b, v18.16b                                // ........................................................................................................................................................................................................................................*.....................................
        aesr v3.16b, v22.16b                                // .........................................................................................................................................*....................................................................................................................................
        ldr q10, [x6, #96]                                  // .....................................................................................................................................................*........................................................................................................................
        ldr q17, [x6, #144]                                 // ......................................................................................................................................................................................................................*.......................................................
        pmull2 v31.1q, v12.2d, v31.2d                       // .............................................................................................................................*................................................................................................................................................
        aesr v5.16b, v18.16b                                // ......................................................................................................................................................................................................*.......................................................................
        eor v12.16B, v8.16B, v2.16B                         // .............................................................*................................................................................................................................................................................................................
        aesr v9.16b, v19.16b                                // .........................................................................................................................................................................................................................................*....................................
        eor v28.16B, v29.16B, v1.16B                        // .........................................................*....................................................................................................................................................................................................................
        aesr v5.16b, v19.16b                                // .......................................................................................................................................................................................................*......................................................................
        eor v12.16B, v12.16B, v14.16B                       // ...............................................................................................*..............................................................................................................................................................................
        eor v28.16B, v28.16B, v16.16B                       // ...........................................................................................*..................................................................................................................................................................................
        aesr v9.16b, v20.16b                                // ..........................................................................................................................................................................................................................................*...................................
        aesr v5.16b, v20.16b                                // ........................................................................................................................................................................................................*.....................................................................
        eor v14.16B, v12.16B, v31.16B                       // ..............................................................................................................................*...............................................................................................................................................
        eor v2.16B, v28.16B, v15.16B                        // ..........................................................................................................................*...................................................................................................................................................
        aesr v9.16b, v21.16b                                // ...........................................................................................................................................................................................................................................*..................................
        ldr q29, [sp, #STACK_BASE_AES_ST + 32]              // ....................................................................................................................................................................................*......................................................................................... // @slothy:reads=stack_2
        aesr v5.16b, v21.16b                                // .........................................................................................................................................................................................................*....................................................................
        eor v4.16B, v4.16B, v11.16B                         // .........................................................................................*....................................................................................................................................................................................
        aesr v9.16b, v22.16b                                // ............................................................................................................................................................................................................................................*.................................
        aesr v5.16b, v22.16b                                // ..........................................................................................................................................................................................................*...................................................................
        ldr q1, [sp, #STACK_BASE_AES_ST]                    // .....................................................................................................................................................................................................................................................*........................ // @slothy:reads=stack_0
        aesr v9.16b, v23.16b                                // .............................................................................................................................................................................................................................................*................................
        ldr q16, [x6, #112]                                 // .......................................................................................................................................................*......................................................................................................................
        ldr q8, [x6, #128]                                  // ......................................................................................................................................................*.......................................................................................................................
        aesr v5.16b, v23.16b                                // ...........................................................................................................................................................................................................*..................................................................
        eor v28.16B, v4.16B, v0.16B                         // ........................................................................................................................*.....................................................................................................................................................
        aesr v9.16b, v24.16b                                // ..............................................................................................................................................................................................................................................*...............................
        aesr v5.16b, v24.16b                                // ............................................................................................................................................................................................................*.................................................................
        aesr v9.16b, v25.16b                                // ...............................................................................................................................................................................................................................................*..............................
        aesr v5.16b, v25.16b                                // .............................................................................................................................................................................................................*................................................................
        aesr v9.16b, v26.16b                                // ................................................................................................................................................................................................................................................*.............................
        aesr v5.16b, v26.16b                                // ..............................................................................................................................................................................................................*...............................................................
        aese v9.16b, v27.16b                                // .................................................................................................................................................................................................................................................*............................
        ldr q4, [sp, #STACK_BASE_AES_ST + 48]               // ..................................................................................................................................................*........................................................................................................................... // @slothy:reads=stack_3
        ldr q0, [x6, #176]                                  // .......................................................................................................................................................................................................................*......................................................
        aese v5.16b, v27.16b                                // ...............................................................................................................................................................................................................*..............................................................
        eor v1.16B, v1.16B, v9.16B                          // ......................................................................................................................................................................................................................................................*.......................
        aesr v6.16b, v21.16b                                // ..........................................................................................................................................................................*...................................................................................................
        eor v31.16B, v13.16B, v5.16B                        // ....................................................................................................................................................................................................................*.........................................................
        aesr v3.16b, v23.16b                                // ..........................................................................................................................................*...................................................................................................................................
        rev64 v12.16B, v1.16B                               // ........................................................................................................................................................................................................................................................*.....................
        aesr v6.16b, v22.16b                                // ...........................................................................................................................................................................*..................................................................................................
        aesr v3.16b, v24.16b                                // ...........................................................................................................................................*..................................................................................................................................
        rev64 v15.16B, v31.16B                              // .........................................................................................................................................................................................................................*....................................................
        eor v30.16B, v12.16B, v30.16B                       // .........................................................................................................................................................................................................................................................*....................
        aesr v6.16b, v23.16b                                // ............................................................................................................................................................................*.................................................................................................
        str q31, [x2, #16]                                  // .....................................................................................................................................................................................................................*........................................................
        aesr v3.16b, v25.16b                                // ............................................................................................................................................*.................................................................................................................................
        pmull2 v11.1q, v30.2d, v0.2d                        // ............................................................................................................................................................................................................................................................*.................
        ext v31.16B, v30.16B, v30.16B, #8                   // ..............................................................................................................................................................................................................................................................*...............
        str q1, [x2], #(8*16)                               // .......................................................................................................................................................................................................................................................*......................
        aesr v6.16b, v24.16b                                // .............................................................................................................................................................................*................................................................................................
        aesr v3.16b, v26.16b                                // .............................................................................................................................................*................................................................................................................................
        eor v5.16B, v31.16B, v30.16B                        // ...............................................................................................................................................................................................................................................................*..............
        aesr v6.16b, v25.16b                                // ..............................................................................................................................................................................*...............................................................................................
        mov d31, v15.d[1]                                   // ..............................................................................................................................................................................................................................*...............................................
        aese v3.16b, v27.16b                                // ..............................................................................................................................................*...............................................................................................................................
        eor v13.8B, v31.8B, v15.8B                          // ...............................................................................................................................................................................................................................*..............................................
        aesr v6.16b, v26.16b                                // ...............................................................................................................................................................................*..............................................................................................
        pmull v1.1q, v30.1d, v0.1d                          // ..........................................................................................................................................................................................................................................................*...................
        eor v3.16B, v4.16B, v3.16B                          // ...................................................................................................................................................*..........................................................................................................................
        aese v6.16b, v27.16b                                // ................................................................................................................................................................................*.............................................................................................
        ldr q4, [x6, #160]                                  // ........................................................................................................................................................................................................................*.....................................................
        pmull v12.1q, v15.1d, v17.1d                        // ..........................................................................................................................................................................................................................*...................................................
        rev64 v0.16B, v3.16B                                // ........................................................................................................................................................*.....................................................................................................................
        eor v6.16B, v29.16B, v6.16B                         // .....................................................................................................................................................................................*........................................................................................
        pmull2 v15.1q, v15.2d, v17.2d                       // ............................................................................................................................................................................................................................*.................................................
        mov d9, v0.d[1]                                     // .............................................................................................................................................................*................................................................................................................
        pmull2 v30.1q, v0.2d, v10.2d                        // ...........................................................................................................................................................*..................................................................................................................
        pmull v31.1q, v0.1d, v10.1d                         // .........................................................................................................................................................*....................................................................................................................
        rev64 v10.16B, v6.16B                               // .......................................................................................................................................................................................*......................................................................................
        eor v2.16B, v2.16B, v30.16B                         // ............................................................................................................................................................*.................................................................................................................
        eor v30.8B, v9.8B, v0.8B                            // ..............................................................................................................................................................*...............................................................................................................
        ext v9.16B, v10.16B, v10.16B, #8                    // ............................................................................................................................................................................................*.................................................................................
        pmull2 v29.1q, v10.2d, v8.2d                        // ..........................................................................................................................................................................................*...................................................................................
        eor v31.16B, v28.16B, v31.16B                       // ..........................................................................................................................................................*...................................................................................................................
        pmull v28.1q, v30.1d, v16.1d                        // ...............................................................................................................................................................*..............................................................................................................
        pmull v30.1q, v10.1d, v8.1d                         // ........................................................................................................................................................................................*.....................................................................................
        eor v9.16B, v9.16B, v10.16B                         // .............................................................................................................................................................................................*................................................................................
        eor v8.16B, v2.16B, v29.16B                         // ...........................................................................................................................................................................................*..................................................................................
        eor v28.16B, v14.16B, v28.16B                       // ................................................................................................................................................................*.............................................................................................................
        eor v30.16B, v31.16B, v30.16B                       // .........................................................................................................................................................................................*....................................................................................
        pmull2 v31.1q, v9.2d, v16.2d                        // ..............................................................................................................................................................................................*...............................................................................
        pmull v2.1q, v13.1d, v4.1d                          // ................................................................................................................................................................................................................................*.............................................
        eor v15.16B, v8.16B, v15.16B                        // .............................................................................................................................................................................................................................*................................................
        eor v31.16B, v28.16B, v31.16B                       // ...............................................................................................................................................................................................*..............................................................................
        eor v30.16B, v30.16B, v12.16B                       // ...........................................................................................................................................................................................................................*..................................................
        eor v28.16B, v15.16B, v11.16B                       // .............................................................................................................................................................................................................................................................*................
        pmull2 v12.1q, v5.2d, v4.2d                         // ................................................................................................................................................................................................................................................................*.............
        eor v15.16B, v31.16B, v2.16B                        // .................................................................................................................................................................................................................................*............................................
        eor v11.16B, v30.16B, v1.16B                        // ...........................................................................................................................................................................................................................................................*..................
        pmull v30.1q, v28.1d, v7.1d                         // ...................................................................................................................................................................................................................................................................*.......... // @slothy:late
        ext v2.16B, v28.16B, v28.16B, #8                    // ....................................................................................................................................................................................................................................................................*......... // @slothy:late
        eor v31.16B, v11.16B, v28.16B                       // ..................................................................................................................................................................................................................................................................*........... // @slothy:late
        eor v15.16B, v15.16B, v12.16B                       // .................................................................................................................................................................................................................................................................*............
        eor v12.16B, v2.16B, v30.16B                        // ......................................................................................................................................................................................................................................................................*....... // @slothy:late
        str q3, [x2, #-80]                                  // ....................................................................................................................................................*.........................................................................................................................
        str q6, [x2, #-96]                                  // ......................................................................................................................................................................................*.......................................................................................
        eor v31.16B, v15.16B, v31.16B                       // .....................................................................................................................................................................................................................................................................*........ // @slothy:late
        eor v31.16B, v31.16B, v12.16B                       // .......................................................................................................................................................................................................................................................................*...... // @slothy:late
        pmull v13.1q, v31.1d, v7.1d                         // ........................................................................................................................................................................................................................................................................*..... // @slothy:late
        ext v31.16B, v31.16B, v31.16B, #8                   // ..........................................................................................................................................................................................................................................................................*... // @slothy:late
        eor v15.16B, v11.16B, v13.16B                       // .........................................................................................................................................................................................................................................................................*.... // @slothy:late
        eor v31.16B, v15.16B, v31.16B                       // ...........................................................................................................................................................................................................................................................................*.. // @slothy:late
        ext v30.16B, v31.16B, v31.16B, #8                   // ............................................................................................................................................................................................................................................................................*. // @slothy:late
        b Lloop_unrolled_start_end
Lloop_unrolled_start_end:
Lloop_unrolled_end:

        load_htable_12
        cbz remainder, Lloop_1x_end
Lloop_1x_start:

        ldp plain_lo, plain_hi, [input], #16
        aes_full_block aes_st, plain, res, 0
        str res_q, [output], #16
        ghash_init_with_tag_0 res, Ht1, Ht12, tag

        ghash_finalize tag

        add ctr, ctr, #1
        sub remainder, remainder, #1
        cbnz remainder, Lloop_1x_start
Lloop_1x_end:

        // Return number of bytes processed
        mov x0, byte_len
        // Store new authentication tag
        rev64 tag.16b, tag.16b
        str tag_q, [tag_ptr]

        // Store updated counter
        // rev32 rtmp_ctr.16b, rtmp_ctr.16b
        // str rtmp_ctr_q, [ivec]
        rev ctr_tmp_w, ctr
        str ctr_tmp_w, [ivec, #12]

        restore_vregs
        restore_gprs

Lenc_postamble_end:
        add sp, sp, #STACK_SIZE

        ret

#endif
#endif  // !OPENSSL_NO_ASM && defined(__AARCH64EL__) && defined(__APPLE__)
#if defined(__ELF__)
// See https: // www.airs.com/blog/archives/518.
.section .note.GNU-stack,"",%progbits
#endif