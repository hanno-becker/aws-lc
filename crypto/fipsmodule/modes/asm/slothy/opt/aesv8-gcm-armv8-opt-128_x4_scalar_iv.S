// Copyright (c) 2022, ARM Inc.

// Permission to use, copy, modify, and/or distribute this software for any
// purpose with or without fee is hereby granted, provided that the above
// copyright notice and this permission notice appear in all copies.

// THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
// WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
// MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
// SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
// WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
// OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
// CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. */

// Author: Hanno Becker <hannobecker@posteo.de>

// This file was derived from the assembly generated from aesv8-gcm-armv8.pl,
// written by Fangming Fang <fangming.fang@arm.com> for the OpenSSL project,
// and derived from https: // github.com/ARM-software/AArch64cryptolib, original
// author Samuel Lee <Samuel.Lee@arm.com>.

// The code below is a 'clean' AArch64 implementation of AES-GCM emphasizing
// the logic of the computation. It is meant as the input to manual audits /
// formal verification, as well as automated micro-optimization such as done
// by the SLOTHY superoptimizer (https: // github.com/slothy-optimizer/slothy).

#if !defined(__has_feature)
#define __has_feature(x) 0
#endif
#if __has_feature(memory_sanitizer) && !defined(OPENSSL_NO_ASM)
#define OPENSSL_NO_ASM
#endif

#include <openssl/asm_base.h>

#if !defined(OPENSSL_NO_ASM) && defined(__AARCH64EL__)
#if defined(__ELF__)
#include <openssl/boringssl_prefix_symbols_asm.h>
#include <openssl/arm_arch.h>
.arch   armv8-a+crypto
.text
.globl  aes_gcm_enc_kernel_slothy_base_128
.hidden aes_gcm_enc_kernel_slothy_base_128
.type   aes_gcm_enc_kernel_slothy_base_128,%function
#elif defined(__APPLE__)
#if defined(BORINGSSL_PREFIX)
#include <boringssl_prefix_symbols_asm.h>
#endif
#include <openssl/arm_arch.h>
.text
.globl	_aes_gcm_enc_kernel_slothy_base_128
.private_extern	_aes_gcm_enc_kernel_slothy_base_128
#else
#error Unknown configuration
#endif

#if __ARM_MAX_ARCH__ >= 8

// Arguments
input    .req x0
len_bits .req x1
output   .req x2
tag_ptr  .req x3
ivec     .req x4
key      .req x5
Htable   .req x6

byte_len .req x15

constant_temp .req x25

count           .req x1
full_blocks     .req x7
remainder       .req x30
unroll          .req x10

ctr_tmp   .req x14
ctr_tmp_w .req w14

ivec_0_63    .req x11
ivec_64_96   .req x12
ivec_64_96_w .req w12

ctr      .req w13
ctr_x    .req x13

aes_st    .req v0
aes_st_q  .req q0
aes_st_d  .req d0

res       .req v0
res_q     .req q0

ghash_hi    .req v9
ghash_lo    .req v8
ghash_mid   .req v10
ghash_mid_d .req d10

ghash_tmp   .req v11
ghash_tmp_d .req d11

ghash_mod   .req v7
ghash_mod_d .req d7

modulo_tmp0 .req v0
modulo_tmp1 .req v1

Ht1q    .req q12
Ht2q    .req q13
Ht12q   .req q14

Ht1    .req v12
Ht2    .req v13
Ht12   .req v14

Ht3q    .req Ht1q
Ht4q    .req Ht2q
Ht34q   .req Ht12q

Ht3    .req Ht1
Ht4    .req Ht2
Ht34   .req Ht12

Ht5q    .req Ht1q
Ht6q    .req Ht2q
Ht56q   .req Ht12q

Ht5    .req Ht1
Ht6    .req Ht2
Ht56   .req Ht12

Ht7q    .req Ht1q
Ht8q    .req Ht2q
Ht78q   .req Ht12q

Ht7    .req Ht1
Ht8    .req Ht2
Ht78   .req Ht12

rk0q   .req q18
rk1q   .req q19
rk2q   .req q20
rk3q   .req q21
rk4q   .req q22
rk5q   .req q23
rk6q   .req q24
rk7q   .req q25
rk8q   .req q26
rk9q   .req q27
rk10q  .req q28

rk0    .req v18
rk1    .req v19
rk2    .req v20
rk3    .req v21
rk4    .req v22
rk5    .req v23
rk6    .req v24
rk7    .req v25
rk8    .req v26
rk9    .req v27
rk10   .req v28

plain   .req v29
plain_q .req q29

rctr_inc   .req v30
rtmp_ctr   .req v31
rtmp_ctr_q .req q31

tag    .req v11
tag_q  .req q11

#define UNROLL 4

#define STACK_SIZE_GPRS  (6*16)
#define STACK_SIZE_VREGS (4*16)
#define STACK_SIZE  (STACK_SIZE_GPRS + STACK_SIZE_VREGS + UNROLL*16)

#define STACK_BASE_GPRS  (0)
#define STACK_BASE_VREGS (STACK_SIZE_GPRS)
#define STACK_BASE_AES_ST (STACK_SIZE_GPRS + STACK_SIZE_VREGS)

/********************************************************************/
/*                 Generic preamble/postamble macros                */
/********************************************************************/

.macro save_vregs
        stp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        stp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        stp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        stp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro restore_vregs
        ldp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        ldp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        ldp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        ldp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro save_gprs
        stp x19, x20, [sp, #(STACK_BASE_GPRS + 16*0)]
        stp x21, x22, [sp, #(STACK_BASE_GPRS + 16*1)]
        stp x23, x24, [sp, #(STACK_BASE_GPRS + 16*2)]
        stp x25, x26, [sp, #(STACK_BASE_GPRS + 16*3)]
        stp x27, x28, [sp, #(STACK_BASE_GPRS + 16*4)]
        stp x29, x30, [sp, #(STACK_BASE_GPRS + 16*5)]
.endm

.macro restore_gprs
        ldp x19, x20, [sp, #(STACK_BASE_GPRS + 16*0)]
        ldp x21, x22, [sp, #(STACK_BASE_GPRS + 16*1)]
        ldp x23, x24, [sp, #(STACK_BASE_GPRS + 16*2)]
        ldp x25, x26, [sp, #(STACK_BASE_GPRS + 16*3)]
        ldp x27, x28, [sp, #(STACK_BASE_GPRS + 16*4)]
        ldp x29, x30, [sp, #(STACK_BASE_GPRS + 16*5)]
.endm

// Derive number of iterations of unrolled loop and single-block loop
.macro prepare_loop_counts
        mov  unroll, #UNROLL
        // Number of AES Blocks (16b each)
        lsr  full_blocks, byte_len, #4
        // Number of iterations of the unrolled loop
        udiv count, full_blocks, unroll
        // Number of iterations for the tail loop handling 1 block each
        msub remainder, count, unroll, full_blocks
.endm

/********************************************************************/
/*                       AES related macros                         */
/********************************************************************/

.macro load_iv
        ldp        ivec_0_63, ivec_64_96, [ivec]
        lsr        ctr_x, ivec_64_96, #32
        rev        ctr, ctr
        orr        ivec_64_96_w, ivec_64_96_w, ivec_64_96_w // clear top 32 bit
.endm

// .macro load_iv
// ldr     rtmp_ctr_q, [ivec]

// set up counter increment
// mov	constant_temp, #0x100000000
// movi	rctr_inc.16b,  #0x0
// fmov	rctr_inc.d[1], constant_temp

// rev32   rtmp_ctr.16b, rtmp_ctr.16b
// .endm

// Increase AES counter
.macro aes_ctr_inc
        add    rtmp_ctr.4s, rtmp_ctr.4s, rctr_inc.4s
.endm

.macro next_ctr_init_aes aes_st
        rev        ctr_tmp_w, ctr
        orr        ctr_tmp, ivec_64_96, ctr_tmp, lsl #32
        fmov       \aes_st\()_d, ivec_0_63
        fmov       \aes_st\().d[1], ctr_tmp
        add        ctr, ctr, #1
.endm

// Increase AES counter and initialize new AES state
// .macro next_ctr_init_aes aes_st
// rev32  \aes_st\().16b, rtmp_ctr.16b
// aes_ctr_inc
// .endm

// A single AES round
// Prevent SLOTHY from unfolding because uArchs tend to fuse AESMC+AESE
.macro aesr data, key // @slothy:no-unfold
        aese  \data, \key
        aesmc \data, \data
.endm

.macro aesr_0_8 data, key
        aesr \data\().16b, \key\()0.16b
        aesr \data\().16b, \key\()1.16b
        aesr \data\().16b, \key\()2.16b
        aesr \data\().16b, \key\()3.16b
        aesr \data\().16b, \key\()4.16b
        aesr \data\().16b, \key\()5.16b
        aesr \data\().16b, \key\()6.16b
        aesr \data\().16b, \key\()7.16b
        aesr \data\().16b, \key\()8.16b
.endm

.macro aesr_9_10 data, key
        aesr \data\().16b, \key\()9.16b
        aesr \data\().16b, \key\()10.16b
.endm

.macro aesr_11_12 data, key
        aesr \data\().16b, \key\()11.16b
        aesr \data\().16b, \key\()12.16b
.endm

// Destructs inA
.macro eor3 out, inA, inB, inC
        eor \inA, \inA, \inB
        eor \out, \inA, \inC
.endm

.macro aesr_final aes_st, plain, out
        aese \aes_st\().16b, rk9.16b
        eor3 \out\().16b, \plain\().16b, rk10.16b, \aes_st\().16b
.endm

.macro aes_full_block aes_st, input, output
        next_ctr_init_aes \aes_st
        aesr_0_8 \aes_st\(), rk
        aesr_final \aes_st, \input, \output
.endm

.macro load_round_key i
        ldr rk\i\()q, [key, #((\i)*16)]
.endm

.macro load_round_keys
        load_round_key 0
        load_round_key 1
        load_round_key 2
        load_round_key 3
        load_round_key 4
        load_round_key 5
        load_round_key 6
        load_round_key 7
        load_round_key 8
        load_round_key 9
        load_round_key 10
.endm

/********************************************************************/
/*       Loading of H-table (precomputed H-powers for GHASH)        */
/********************************************************************/

// This has to be synchronized with the H-table generation

.macro load_h1 dst, dst_q
        ldr \dst_q, [Htable]
.endm

.macro load_h2 dst, dst_q
        ldr \dst_q, [Htable, #32]
.endm

.macro load_h3 dst, dst_q
        ldr \dst_q, [Htable, #48]
.endm

.macro load_h4 dst, dst_q
        ldr \dst_q, [Htable, #80]
.endm

.macro load_h5 dst, dst_q
        ldr \dst_q, [Htable, #96]
.endm

.macro load_h6 dst, dst_q
        ldr \dst_q, [Htable, #128]
.endm

.macro load_h7 dst, dst_q
        ldr \dst_q, [Htable, #144]
.endm

.macro load_h8 dst, dst_q
        ldr \dst_q, [Htable, #176]
.endm

.macro load_h12 dst, dst_q
        ldr \dst_q, [Htable, #16]
.endm

.macro load_h34 dst, dst_q
        ldr \dst_q, [Htable, #64]
.endm

.macro load_h56 dst, dst_q
        ldr \dst_q, [Htable, #112]
.endm

.macro load_h78 dst, dst_q
        ldr \dst_q, [Htable, #160]
.endm

.macro load_full_htable
        load_h1  Ht1,  Ht1q
        load_h2  Ht2,  Ht2q
        load_h3  Ht3,  Ht3q
        load_h4  Ht4,  Ht4q
        load_h5  Ht5,  Ht5q
        load_h6  Ht6,  Ht6q
        load_h12 Ht12, Ht12q
        load_h34 Ht34, Ht34q
        load_h56 Ht56, Ht56q
.endm

.macro load_htable_12
        load_h1  Ht1,  Ht1q
        load_h2  Ht2,  Ht2q
        load_h12 Ht12, Ht12q
.endm

.macro load_htable_34
        load_h3  Ht3,  Ht3q
        load_h4  Ht4,  Ht4q
        load_h34 Ht34, Ht34q
.endm

.macro load_htable_56
        load_h5  Ht5,  Ht5q
        load_h6  Ht6,  Ht6q
        load_h56 Ht56, Ht56q
.endm

.macro load_htable_78
        load_h7  Ht7,  Ht7q
        load_h8  Ht8,  Ht8q
        load_h78 Ht78, Ht78q
.endm

/********************************************************************/
/*                    Macros for GHASH udpate                       */
/********************************************************************/

.macro ghash_init_0 input, Hk, Hk_mid, tag
        rev64 \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_mid.1q, ghash_tmp.1d, \Hk_mid\().1d
.endm

.macro ghash_init_1 input, Hk, Hk_mid, tag
        rev64 \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_mid.1q, ghash_tmp.2d, \Hk_mid\().2d
.endm

.macro ghash_acc_0 input, Hk, Hk_mid
        rev64   \input\().16b, \input\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_tmp.1q, ghash_tmp.1d, \Hk_mid\().1d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_acc_1 input, Hk, Hk_mid
        rev64   \input\().16b, \input\().16b

        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_tmp.1q, ghash_tmp.2d, \Hk_mid\().2d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_finalize tag
        eor        modulo_tmp0.16b, ghash_lo.16b,  ghash_hi.16b
        pmull      modulo_tmp1.1q,  ghash_hi.1d,   ghash_mod.1d
        ext        ghash_hi.16b,    ghash_hi.16b,  ghash_hi.16b, #8
        eor        ghash_mid.16b,   ghash_mid.16b, modulo_tmp0.16b
        eor        modulo_tmp1.16b, ghash_hi.16b,  modulo_tmp1.16b
        eor        ghash_mid.16b,   ghash_mid.16b, modulo_tmp1.16b
        pmull      ghash_hi.1q,     ghash_mid.1d,  ghash_mod.1d
        eor        ghash_lo.16b,    ghash_lo.16b,  ghash_hi.16b
        ext        ghash_mid.16b,   ghash_mid.16b, ghash_mid.16b, #8
        eor        \tag\().16b,     ghash_lo.16b,  ghash_mid.16b
        ext        \tag\().16b, \tag\().16b, \tag\().16b, #8
.endm

.macro load_tag
        ldr      tag_q, [tag_ptr]
        rev64    tag.16b, tag.16b
.endm

.macro prepare_ghash
        // Prepare constant for modular reduction
        movi ghash_mod.8b, #0xc2
        shl  ghash_mod_d, ghash_mod_d, #56
.endm

/********************************************************************/
/*                            Core routine                          */
/********************************************************************/

.align        4
_aes_gcm_enc_kernel_slothy_base_128:
aes_gcm_enc_kernel_slothy_base_128:
#ifdef BORINGSSL_DISPATCH_TEST
        adrp  x9,_BORINGSSL_function_hit@PAGE
        add   x9, x9, _BORINGSSL_function_hit@PAGEOFF
        mov   w10, #1
        strb  w10, [x9,#2] // kFlag_aes_gcm_enc_kernel
#endif

        AARCH64_VALID_CALL_TARGET
        sub sp, sp, #STACK_SIZE

Lenc_preamble_start:
        save_gprs
        save_vregs

        lsr byte_len, len_bits, #3

        load_round_keys
        load_tag
        load_iv

        prepare_loop_counts
        prepare_ghash

Lenc_preamble_end:

        cbz count, Lloop_unrolled_end
        cmp count, #1
        b.eq Lloop_unrolled_start_iter_1
        // Instructions:    122
        // Expected cycles: 60
        // Expected IPC:    2.033333333333333
        fmov d6, x11                             // *...........................................................
        add w9, w13, #1                          // *...........................................................
        rev w23, w13                             // *...........................................................
        fmov d10, x11                            // .*..........................................................
        ldr q13, [x0, #32]                       // .*..........................................................
        add w24, w9, #1                          // .*..........................................................
        orr x23, x12, x23, lsl #32               // .*..........................................................
        ldr q31, [x6, #64]                       // ..*.........................................................
        rev w9, w9                               // ..*.........................................................
        rev w10, w24                             // ..*.........................................................
        add w24, w24, #1                         // ..*.........................................................
        fmov v6.d[1], x23                        // ...*........................................................
        ldr q9, [x0, #48]                        // ...*........................................................
        orr x23, x12, x10, lsl #32               // ...*........................................................
        rev w10, w24                             // ...*........................................................
        fmov v10.d[1], x23                       // ....*.......................................................
        ldr q17, [x0], #(4*16)                   // ....*.......................................................
        add w24, w24, #1                         // ....*.......................................................
        orr x10, x12, x10, lsl #32               // ....*.......................................................
        fmov d3, x11                             // .....*......................................................
        ldr q29, [x0, #-48]                      // .....*......................................................
        orr x9, x12, x9, lsl #32                 // .....*......................................................
        add w29, w24, #1                         // .....*......................................................
        eor v13.16B, v13.16B, v28.16B            // ......*.....................................................
        aesr v6.16b, v18.16b                     // ......*.....................................................
        add w23, w29, #1                         // ......*.....................................................
        rev w28, w24                             // ......*.....................................................
        aesr v10.16b, v18.16b                    // .......*....................................................
        fmov d2, x11                             // .......*....................................................
        add w22, w23, #1                         // .......*....................................................
        rev w23, w23                             // .......*....................................................
        fmov v3.d[1], x9                         // ........*...................................................
        aesr v6.16b, v19.16b                     // ........*...................................................
        orr x9, x12, x23, lsl #32                // ........*...................................................
        rev w23, w22                             // ........*...................................................
        eor v9.16B, v9.16B, v28.16B              // .........*..................................................
        aesr v10.16b, v19.16b                    // .........*..................................................
        orr x24, x12, x23, lsl #32               // .........*..................................................
        fmov v2.d[1], x10                        // ..........*.................................................
        aesr v6.16b, v20.16b                     // ..........*.................................................
        aesr v3.16b, v18.16b                     // ...........*................................................
        ldr q14, [x6, #48]                       // ...........*................................................
        eor v5.16B, v17.16B, v28.16B             // ............*...............................................
        aesr v6.16b, v21.16b                     // ............*...............................................
        aesr v3.16b, v19.16b                     // .............*..............................................
        ldr q4, [x6]                             // .............*..............................................
        eor v12.16B, v29.16B, v28.16B            // ..............*.............................................
        aesr v6.16b, v22.16b                     // ..............*.............................................
        aesr v3.16b, v20.16b                     // ...............*............................................
        ldr q29, [x6, #80]                       // ...............*............................................
        aesr v6.16b, v23.16b                     // ................*...........................................
        ldr q30, [x0, #32]                       // ................*...........................................
        aesr v3.16b, v21.16b                     // .................*..........................................
        fmov d17, x11                            // .................*..........................................
        aesr v6.16b, v24.16b                     // ..................*.........................................
        ldr q1, [x6, #16]                        // ..................*.........................................
        aesr v3.16b, v22.16b                     // ...................*........................................
        ldr q15, [x6, #32]                       // ...................*........................................
        fmov v17.d[1], x9                        // ....................*.......................................
        aesr v6.16b, v25.16b                     // ....................*.......................................
        aesr v3.16b, v23.16b                     // .....................*......................................
        aesr v6.16b, v26.16b                     // ......................*.....................................
        aesr v3.16b, v24.16b                     // .......................*....................................
        aese v6.16b, v27.16b                     // ........................*...................................
        aesr v3.16b, v25.16b                     // .........................*..................................
        aesr v10.16b, v20.16b                    // ..........................*.................................
        eor v5.16B, v5.16B, v6.16B               // ..........................*.................................
        fmov d6, x11                             // ...........................*................................
        aesr v3.16b, v26.16b                     // ...........................*................................
        aesr v10.16b, v21.16b                    // ............................*...............................
        rev64 v0.16B, v5.16B                     // ............................*...............................
        str q5, [x2], #(4*16)                    // .............................*..............................
        aese v3.16b, v27.16b                     // .............................*..............................
        eor v0.16B, v0.16B, v11.16B              // ..............................*.............................
        aesr v10.16b, v22.16b                    // ..............................*.............................
        aesr v2.16b, v18.16b                     // ...............................*............................
        eor v3.16B, v12.16B, v3.16B              // ...............................*............................
        aesr v10.16b, v23.16b                    // ................................*...........................
        ext v5.16B, v0.16B, v0.16B, #8           // ................................*...........................
        aesr v2.16b, v19.16b                     // .................................*..........................
        rev64 v11.16B, v3.16B                    // .................................*..........................
        str q3, [x2, #-48]                       // ..................................*.........................
        aesr v10.16b, v24.16b                    // ..................................*.........................
        aesr v2.16b, v20.16b                     // ...................................*........................
        mov d3, v11.d[1]                         // ...................................*........................
        eor v5.16B, v5.16B, v0.16B               // ....................................*.......................
        aesr v10.16b, v25.16b                    // ....................................*.......................
        aesr v2.16b, v21.16b                     // .....................................*......................
        eor v3.8B, v3.8B, v11.8B                 // .....................................*......................
        pmull2 v5.1q, v5.2d, v31.2d              // ......................................*.....................
        pmull v12.1q, v3.1d, v31.1d              // .......................................*....................
        aesr v10.16b, v26.16b                    // ........................................*...................
        aesr v2.16b, v22.16b                     // .........................................*..................
        aese v10.16b, v27.16b                    // ..........................................*.................
        aesr v2.16b, v23.16b                     // ...........................................*................
        eor v10.16B, v13.16B, v10.16B            // ............................................*...............
        aesr v17.16b, v18.16b                    // ............................................*...............
        aesr v2.16b, v24.16b                     // .............................................*..............
        pmull2 v3.1q, v11.2d, v14.2d             // ..............................................*.............
        str q10, [x2, #-32]                      // ..............................................*.............
        rev64 v16.16B, v10.16B                   // ...............................................*............
        aesr v2.16b, v25.16b                     // ...............................................*............
        pmull v11.1q, v11.1d, v14.1d             // ................................................*...........
        aesr v2.16b, v26.16b                     // .................................................*..........
        ext v10.16B, v16.16B, v16.16B, #8        // .................................................*..........
        aesr v17.16b, v19.16b                    // ..................................................*.........
        aese v2.16b, v27.16b                     // ...................................................*........
        eor v10.16B, v10.16B, v16.16B            // ...................................................*........
        aesr v17.16b, v20.16b                    // ....................................................*.......
        eor v13.16B, v9.16B, v2.16B              // .....................................................*......
        pmull v8.1q, v0.1d, v29.1d               // .....................................................*......
        aesr v17.16b, v21.16b                    // ......................................................*.....
        pmull2 v31.1q, v0.2d, v29.2d             // .......................................................*....
        rev64 v29.16B, v13.16B                   // .......................................................*....
        str q13, [x2, #-16]                      // ........................................................*...
        pmull v13.1q, v16.1d, v15.1d             // ........................................................*...
        mov d2, v29.d[1]                         // .........................................................*..
        pmull v9.1q, v29.1d, v4.1d               // .........................................................*..
        pmull2 v4.1q, v29.2d, v4.2d              // ..........................................................*.
        fmov d0, x11                             // ..........................................................*.
        pmull2 v14.1q, v10.2d, v1.2d             // ...........................................................*
        eor v10.8B, v2.8B, v29.8B                // ...........................................................*

        // original source code
        // add W<ssa_7>, w13, #1                                  // .*........................................................................................................................
        // rev W<ssa_8>, w13                                      // ..*.......................................................................................................................
        // add W<ssa_10>, W<ssa_7>, #1                            // .....*....................................................................................................................
        // rev W<ssa_12>, W<ssa_10>                               // .........*................................................................................................................
        // add W<ssa_13>, W<ssa_10>, #1                           // ..........*...............................................................................................................
        // rev W<ssa_15>, W<ssa_13>                               // ..............*...........................................................................................................
        // orr X<ssa_16>, x12, X<ssa_12>, lsl #32                 // .............*............................................................................................................
        // orr X<ssa_18>, x12, X<ssa_15>, lsl #32                 // ..................*.......................................................................................................
        // ldr Q<ssa_45>, [x0, #32]                               // ....*.....................................................................................................................
        // fmov D<ssa_48>, x11                                    // ...*......................................................................................................................
        // fmov V<ssa_48>.d[1], X<ssa_16>                         // ...............*..........................................................................................................
        // aesr V<ssa_48>.16b, v18.16b                            // ...........................*..............................................................................................
        // aesr V<ssa_48>.16b, v19.16b                            // ....................................*.....................................................................................
        // aesr V<ssa_48>.16b, v20.16b                            // .................................................................*........................................................
        // aesr V<ssa_48>.16b, v21.16b                            // .....................................................................*....................................................
        // fmov d6, x11                                           // *.........................................................................................................................
        // fmov D<ssa_76>, x11                                    // ...................*......................................................................................................
        // fmov D<ssa_79>, x11                                    // ............................*.............................................................................................
        // rev W<ssa_80>, W<ssa_7>                                // ........*.................................................................................................................
        // orr X<ssa_81>, x12, X<ssa_8>, lsl #32                  // ......*...................................................................................................................
        // fmov v6.d[1], X<ssa_81>                                // ...........*..............................................................................................................
        // aesr V<ssa_48>.16b, v22.16b                            // ..........................................................................*...............................................
        // add W<ssa_82>, W<ssa_13>, #1                           // .................*........................................................................................................
        // orr X<ssa_83>, x12, X<ssa_80>, lsl #32                 // .....................*....................................................................................................
        // fmov V<ssa_76>.d[1], X<ssa_83>                         // ...............................*..........................................................................................
        // fmov V<ssa_79>.d[1], X<ssa_18>                         // ......................................*...................................................................................
        // aesr V<ssa_48>.16b, v23.16b                            // .............................................................................*............................................
        // add w29, W<ssa_82>, #1                                 // ......................*...................................................................................................
        // rev w28, W<ssa_82>                                     // ..........................*...............................................................................................
        // aesr v6.16b, v18.16b                                   // ........................*.................................................................................................
        // add W<ssa_86>, w29, #1                                 // .........................*................................................................................................
        // aesr V<ssa_76>.16b, v18.16b                            // ........................................*.................................................................................
        // rev W<ssa_88>, W<ssa_86>                               // ..............................*...........................................................................................
        // add w22, W<ssa_86>, #1                                 // .............................*............................................................................................
        // aesr V<ssa_79>.16b, v18.16b                            // ...........................................................................*..............................................
        // rev W<ssa_90>, w22                                     // ..................................*.......................................................................................
        // orr X<ssa_91>, x12, X<ssa_88>, lsl #32                 // .................................*........................................................................................
        // aesr V<ssa_76>.16b, v19.16b                            // ............................................*.............................................................................
        // ldr Q<ssa_92>, [x6, #64]                               // .......*..................................................................................................................
        // orr x24, x12, X<ssa_90>, lsl #32                       // .....................................*....................................................................................
        // aesr V<ssa_79>.16b, v19.16b                            // ...............................................................................*..........................................
        // aesr V<ssa_76>.16b, v20.16b                            // ................................................*.........................................................................
        // aesr v6.16b, v19.16b                                   // ................................*.........................................................................................
        // ldr Q<ssa_95>, [x0, #48]                               // ............*.............................................................................................................
        // aesr V<ssa_76>.16b, v21.16b                            // ....................................................*.....................................................................
        // aesr V<ssa_79>.16b, v20.16b                            // ...................................................................................*......................................
        // aesr V<ssa_76>.16b, v22.16b                            // ........................................................*.................................................................
        // ldr Q<ssa_98>, [x0], #(4*16)                           // ................*.........................................................................................................
        // aesr V<ssa_79>.16b, v21.16b                            // .......................................................................................*..................................
        // ldr Q<ssa_99>, [x0, #-48]                              // ....................*.....................................................................................................
        // aesr V<ssa_76>.16b, v23.16b                            // ............................................................*.............................................................
        // eor V<ssa_100>.16B, V<ssa_95>.16B, v28.16B             // ...................................*......................................................................................
        // aesr V<ssa_79>.16b, v22.16b                            // ............................................................................................*.............................
        // aesr V<ssa_76>.16b, v24.16b                            // ..............................................................*...........................................................
        // aesr V<ssa_79>.16b, v23.16b                            // ..............................................................................................*...........................
        // ldr Q<ssa_102>, [x6, #48]                              // .........................................*................................................................................
        // eor V<ssa_103>.16B, V<ssa_98>.16B, v28.16B             // ..........................................*...............................................................................
        // aesr V<ssa_76>.16b, v25.16b                            // ................................................................*.........................................................
        // ldr Q<ssa_104>, [x6]                                   // .............................................*............................................................................
        // aesr V<ssa_79>.16b, v24.16b                            // .................................................................................................*........................
        // eor V<ssa_105>.16B, V<ssa_45>.16B, v28.16B             // .......................*..................................................................................................
        // aesr V<ssa_76>.16b, v26.16b                            // ....................................................................*.....................................................
        // aesr V<ssa_79>.16b, v25.16b                            // .....................................................................................................*....................
        // aese V<ssa_76>.16b, v27.16b                            // ........................................................................*.................................................
        // eor V<ssa_107>.16B, V<ssa_99>.16B, v28.16B             // ..............................................*...........................................................................
        // aesr V<ssa_79>.16b, v26.16b                            // .......................................................................................................*..................
        // aesr v6.16b, v20.16b                                   // .......................................*..................................................................................
        // eor V<ssa_109>.16B, V<ssa_107>.16B, V<ssa_76>.16B      // ............................................................................*.............................................
        // aese V<ssa_79>.16b, v27.16b                            // ..........................................................................................................*...............
        // aesr V<ssa_48>.16b, v24.16b                            // ..................................................................................*.......................................
        // rev64 V<ssa_111>.16B, V<ssa_109>.16B                   // ................................................................................*.........................................
        // eor V<ssa_112>.16B, V<ssa_100>.16B, V<ssa_79>.16B      // .............................................................................................................*............
        // aesr v6.16b, v21.16b                                   // ...........................................*..............................................................................
        // aesr V<ssa_48>.16b, v25.16b                            // ......................................................................................*...................................
        // mov D<ssa_113>, V<ssa_111>.d[1]                        // ....................................................................................*.....................................
        // aesr v6.16b, v22.16b                                   // ...............................................*..........................................................................
        // aesr V<ssa_48>.16b, v26.16b                            // ...........................................................................................*..............................
        // eor V<ssa_115>.8B, V<ssa_113>.8B, V<ssa_111>.8B        // ........................................................................................*.................................
        // rev64 V<ssa_116>.16B, V<ssa_112>.16B                   // .................................................................................................................*........
        // aesr v6.16b, v23.16b                                   // ..................................................*.......................................................................
        // pmull v12.1q, V<ssa_115>.1d, V<ssa_92>.1d              // ..........................................................................................*...............................
        // str Q<ssa_109>, [x2, #16]                              // .................................................................................*........................................
        // aesr v6.16b, v24.16b                                   // ......................................................*...................................................................
        // str Q<ssa_112>, [x2, #48]                              // ..................................................................................................................*.......
        // aese V<ssa_48>.16b, v27.16b                            // .............................................................................................*............................
        // ldr Q<ssa_117>, [x6, #80]                              // .................................................*........................................................................
        // aesr v6.16b, v25.16b                                   // ...........................................................*..............................................................
        // ldr q30, [x0, #32]                                     // ...................................................*......................................................................
        // eor V<ssa_118>.16B, V<ssa_105>.16B, V<ssa_48>.16B      // ...............................................................................................*..........................
        // fmov d17, x11                                          // .....................................................*....................................................................
        // aesr v6.16b, v26.16b                                   // .............................................................*............................................................
        // pmull2 v4.1q, V<ssa_116>.2d, V<ssa_104>.2d             // ......................................................................................................................*...
        // str Q<ssa_118>, [x2, #32]                              // ...................................................................................................*......................
        // aese v6.16b, v27.16b                                   // ...............................................................*..........................................................
        // fmov v17.d[1], X<ssa_91>                               // ..........................................................*...............................................................
        // eor V<ssa_122>.16B, V<ssa_103>.16B, v6.16B             // ..................................................................*.......................................................
        // pmull v9.1q, V<ssa_116>.1d, V<ssa_104>.1d              // .....................................................................................................................*....
        // rev64 v16.16B, V<ssa_118>.16B                          // ....................................................................................................*.....................
        // rev64 V<ssa_124>.16B, V<ssa_122>.16B                   // ......................................................................*...................................................
        // str Q<ssa_122>, [x2], #(4*16)                          // .......................................................................*..................................................
        // aesr v17.16b, v18.16b                                  // ................................................................................................*.........................
        // ldr q1, [x6, #16]                                      // .......................................................*..................................................................
        // pmull2 v3.1q, V<ssa_111>.2d, V<ssa_102>.2d             // ..................................................................................................*.......................
        // mov D<ssa_128>, V<ssa_116>.d[1]                        // ....................................................................................................................*.....
        // aesr v17.16b, v19.16b                                  // .........................................................................................................*................
        // ldr q15, [x6, #32]                                     // .........................................................*................................................................
        // eor v10.8B, V<ssa_128>.8B, V<ssa_116>.8B               // .........................................................................................................................*
        // aesr v17.16b, v20.16b                                  // ............................................................................................................*.............
        // eor v0.16B, V<ssa_124>.16B, v11.16B                    // .........................................................................*................................................
        // pmull v11.1q, V<ssa_111>.1d, V<ssa_102>.1d             // ......................................................................................................*...................
        // aesr v17.16b, v21.16b                                  // ...............................................................................................................*..........
        // ext V<ssa_130>.16B, v16.16B, v16.16B, #8               // ........................................................................................................*.................
        // pmull v8.1q, v0.1d, V<ssa_117>.1d                      // ..............................................................................................................*...........
        // ext V<ssa_131>.16B, v0.16B, v0.16B, #8                 // ..............................................................................*...........................................
        // pmull2 v31.1q, v0.2d, V<ssa_117>.2d                    // ................................................................................................................*.........
        // eor V<ssa_132>.16B, V<ssa_130>.16B, v16.16B            // ...........................................................................................................*..............
        // pmull v13.1q, v16.1d, v15.1d                           // ...................................................................................................................*......
        // eor V<ssa_133>.16B, V<ssa_131>.16B, v0.16B             // .....................................................................................*....................................
        // fmov d6, x11                                           // ...................................................................*......................................................
        // pmull2 v14.1q, V<ssa_132>.2d, v1.2d                    // ........................................................................................................................*.
        // fmov d0, x11                                           // .......................................................................................................................*..
        // pmull2 v5.1q, V<ssa_133>.2d, V<ssa_92>.2d              // .........................................................................................*................................

        sub count, count, #2
cbz count, Lloop_unrolled_start_postamble
Lloop_unrolled_start:
        // Instructions:    127
        // Expected cycles: 58
        // Expected IPC:    2.189655172413793
        pmull2 v16.1q, v16.2d, v15.2d            // l.........................................................
        fmov d15, x11                            // *.........................................................
        rev w9, w29                              // *.........................................................
        orr x21, x12, x28, lsl #32               // *.........................................................
        fmov v6.d[1], x21                        // .*........................................................
        aesr v17.16b, v22.16b                    // .*........................................................
        add w13, w22, #1                         // .*........................................................
        orr x23, x12, x9, lsl #32                // .*........................................................
        fmov v0.d[1], x23                        // ..*.......................................................
        pmull v10.1q, v10.1d, v1.1d              // ..l.......................................................
        fmov v15.d[1], x24                       // ...*......................................................
        aesr v17.16b, v23.16b                    // ...*......................................................
        add w29, w13, #1                         // ...e......................................................
        rev w28, w13                             // ...e......................................................
        eor v29.16B, v5.16B, v12.16B             // ....l.....................................................
        aesr v6.16b, v18.16b                     // ....*.....................................................
        add w23, w29, #1                         // ....e.....................................................
        aesr v0.16b, v18.16b                     // .....*....................................................
        eor v5.16B, v8.16B, v11.16B              // .....l....................................................
        rev w24, w23                             // .....e....................................................
        add w22, w23, #1                         // .....e....................................................
        aesr v15.16b, v18.16b                    // ......*...................................................
        eor v12.16B, v31.16B, v3.16B             // ......l...................................................
        rev w9, w22                              // ......e...................................................
        orr x25, x12, x24, lsl #32               // ......e...................................................
        aesr v0.16b, v19.16b                     // .......*..................................................
        ldr q2, [x6, #64]                        // .......*..................................................
        orr x24, x12, x9, lsl #32                // .......e..................................................
        eor v14.16B, v29.16B, v14.16B            // ........l.................................................
        aesr v15.16b, v19.16b                    // ........*.................................................
        aesr v0.16b, v20.16b                     // .........*................................................
        eor v31.16B, v5.16B, v13.16B             // ..........l...............................................
        aesr v6.16b, v19.16b                     // ..........*...............................................
        ldr q3, [x0, #48]                        // ...........*..............................................
        aesr v0.16b, v21.16b                     // ...........*..............................................
        eor v29.16B, v14.16B, v10.16B            // ............l.............................................
        aesr v15.16b, v20.16b                    // ............*.............................................
        eor v10.16B, v12.16B, v16.16B            // .............l............................................
        aesr v0.16b, v22.16b                     // .............*............................................
        ldr q5, [x0], #(4*16)                    // ..............*...........................................
        aesr v15.16b, v21.16b                    // ..............*...........................................
        ldr q12, [x0, #-48]                      // ...............*..........................................
        aesr v0.16b, v23.16b                     // ...............*..........................................
        eor v8.16B, v3.16B, v28.16B              // ................*.........................................
        aesr v15.16b, v22.16b                    // ................*.........................................
        aesr v0.16b, v24.16b                     // .................*........................................
        eor v4.16B, v10.16B, v4.16B              // .................l........................................
        aesr v15.16b, v23.16b                    // ..................*.......................................
        ldr q14, [x6, #48]                       // ..................*.......................................
        eor v11.16B, v5.16B, v28.16B             // ...................*......................................
        aesr v0.16b, v25.16b                     // ...................*......................................
        ldr q1, [x6]                             // ....................*.....................................
        aesr v15.16b, v24.16b                    // ....................*.....................................
        eor v16.16B, v30.16B, v28.16B            // .....................*....................................
        aesr v0.16b, v26.16b                     // .....................*....................................
        aesr v15.16b, v25.16b                    // ......................*...................................
        eor v5.16B, v31.16B, v9.16B              // ......................l...................................
        aese v0.16b, v27.16b                     // .......................*..................................
        eor v30.16B, v12.16B, v28.16B            // .......................*..................................
        aesr v15.16b, v26.16b                    // ........................*.................................
        eor v31.16B, v5.16B, v4.16B              // ........................l.................................
        aesr v6.16b, v20.16b                     // .........................*................................
        eor v3.16B, v30.16B, v0.16B              // .........................*................................
        eor v0.16B, v29.16B, v31.16B             // ..........................l...............................
        aese v15.16b, v27.16b                    // ..........................*...............................
        aesr v17.16b, v24.16b                    // ...........................*..............................
        rev64 v29.16B, v3.16B                    // ...........................*..............................
        eor v30.16B, v8.16B, v15.16B             // ............................*.............................
        aesr v6.16b, v21.16b                     // ............................*.............................
        aesr v17.16b, v25.16b                    // .............................*............................
        mov d12, v29.d[1]                        // .............................*............................
        ext v10.16B, v4.16B, v4.16B, #8          // ..............................l...........................
        aesr v6.16b, v22.16b                     // ..............................*...........................
        aesr v17.16b, v26.16b                    // ...............................*..........................
        eor v31.8B, v12.8B, v29.8B               // ...............................*..........................
        rev64 v13.16B, v30.16B                   // ................................*.........................
        aesr v6.16b, v23.16b                     // ................................*.........................
        pmull v12.1q, v31.1d, v2.1d              // .................................*........................
        str q3, [x2, #16]                        // .................................*........................
        aesr v6.16b, v24.16b                     // ..................................*.......................
        str q30, [x2, #48]                       // ..................................*.......................
        aese v17.16b, v27.16b                    // ...................................*......................
        ldr q31, [x6, #80]                       // ...................................*......................
        aesr v6.16b, v25.16b                     // ....................................*.....................
        ldr q30, [x0, #32]                       // ....................................e.....................
        eor v8.16B, v16.16B, v17.16B             // .....................................*....................
        pmull v16.1q, v4.1d, v7.1d               // .....................................l....................
        fmov d17, x11                            // ......................................e...................
        aesr v6.16b, v26.16b                     // ......................................*...................
        pmull2 v4.1q, v13.2d, v1.2d              // .......................................*..................
        eor v9.16B, v10.16B, v16.16B             // .......................................l..................
        str q8, [x2, #32]                        // ........................................*.................
        aese v6.16b, v27.16b                     // ........................................*.................
        fmov v17.d[1], x25                       // .........................................e................
        eor v15.16B, v0.16B, v9.16B              // .........................................l................
        eor v10.16B, v11.16B, v6.16B             // ..........................................*...............
        pmull v9.1q, v13.1d, v1.1d               // ..........................................*...............
        pmull v3.1q, v15.1d, v7.1d               // ...........................................l..............
        rev64 v16.16B, v8.16B                    // ...........................................*..............
        rev64 v0.16B, v10.16B                    // ............................................*.............
        str q10, [x2], #(4*16)                   // ............................................*.............
        eor v10.16B, v5.16B, v3.16B              // .............................................l............
        ext v11.16B, v15.16B, v15.16B, #8        // .............................................l............
        aesr v17.16b, v18.16b                    // ..............................................e...........
        ldr q1, [x6, #16]                        // ..............................................*...........
        eor v11.16B, v10.16B, v11.16B            // ...............................................l..........
        pmull2 v3.1q, v29.2d, v14.2d             // ...............................................*..........
        mov d10, v13.d[1]                        // ................................................*.........
        aesr v17.16b, v19.16b                    // ................................................e.........
        ldr q15, [x6, #32]                       // .................................................*........
        ext v11.16B, v11.16B, v11.16B, #8        // .................................................l........
        eor v10.8B, v10.8B, v13.8B               // ..................................................*.......
        aesr v17.16b, v20.16b                    // ..................................................e.......
        eor v0.16B, v0.16B, v11.16B              // ...................................................*......
        pmull v11.1q, v29.1d, v14.1d             // ...................................................*......
        aesr v17.16b, v21.16b                    // ....................................................e.....
        ext v13.16B, v16.16B, v16.16B, #8        // ....................................................*.....
        pmull v8.1q, v0.1d, v31.1d               // .....................................................*....
        ext v5.16B, v0.16B, v0.16B, #8           // .....................................................*....
        pmull2 v31.1q, v0.2d, v31.2d             // ......................................................*...
        eor v14.16B, v13.16B, v16.16B            // ......................................................*...
        pmull v13.1q, v16.1d, v15.1d             // .......................................................*..
        eor v29.16B, v5.16B, v0.16B              // .......................................................*..
        fmov d6, x11                             // ........................................................e.
        pmull2 v14.1q, v14.2d, v1.2d             // ........................................................*.
        fmov d0, x11                             // .........................................................e
        pmull2 v5.1q, v29.2d, v2.2d              // .........................................................*

        // original source code
        // ldr q29, [x0], #(4*16)                          // ...........................*.......................................................................................|......................................*.......................................................................................|......................................*.......................................................................
        // rev        w14, w13                             // .e.................................................................................................................|............e.................................................................................................................|............e.................................................................................................
        // orr        x14, x12, x14, lsl #32               // ...................................................................................................................|..*...........................................................................................................................|..*...........................................................................................................
        // fmov       d0, x11                              // ...............................................................................................................e...|..........................................................................................................................e...|..............................................................................................................
        // fmov       v0.d[1], x14                         // ...................................................................................................................|...*..........................................................................................................................|...*..........................................................................................................
        // add        w13, w13, #1                         // e..................................................................................................................|...........e..................................................................................................................|...........e..................................................................................................
        // aesr v0.16b, v18.16b                            // ...*...............................................................................................................|..............*...............................................................................................................|..............*...............................................................................................
        // aesr v0.16b, v19.16b                            // ....................*..............................................................................................|...............................*..............................................................................................|...............................*..............................................................................
        // aesr v0.16b, v20.16b                            // .................................................*.................................................................|............................................................*.................................................................|............................................................*.................................................
        // aesr v0.16b, v21.16b                            // ........................................................*..........................................................|...................................................................*..........................................................|...................................................................*..........................................
        // aesr v0.16b, v22.16b                            // ............................................................*......................................................|.......................................................................*......................................................|.......................................................................*......................................
        // aesr v0.16b, v23.16b                            // ................................................................*..................................................|...........................................................................*..................................................|...........................................................................*..................................
        // aesr v0.16b, v24.16b                            // ...................................................................*...............................................|..............................................................................*...............................................|..............................................................................*...............................
        // aesr v0.16b, v25.16b                            // .......................................................................*...........................................|..................................................................................*...........................................|..................................................................................*...........................
        // aesr v0.16b, v26.16b                            // ............................................................................*......................................|.......................................................................................*......................................|.......................................................................................*......................
        // aese v0.16b, v27.16b                            // ................................................................................*..................................|...........................................................................................*..................................|...........................................................................................*..................
        // eor v29.16b, v29.16b, v28.16b                   // .....................................*.............................................................................|................................................*.............................................................................|................................................*.............................................................
        // eor v0.16b, v29.16b, v0.16b                     // ...................................................................................*...............................|..............................................................................................*...............................|..............................................................................................*...............
        // str q0, [x2], #(4*16)                           // ........................................................................................*..........................|...................................................................................................*..........................|...................................................................................................*..........
        // ldr q12, [x6, #48]                              // ....................................*..............................................................................|...............................................*..............................................................................|...............................................*..............................................................
        // ldr q13, [x6, #80]                              // ......................................................................*............................................|.................................................................................*............................................|.................................................................................*............................
        // ldr q14, [x6, #64]                              // ..............*....................................................................................................|.........................*....................................................................................................|.........................*....................................................................................
        // rev64 v0.16b, v0.16b                            // .......................................................................................*...........................|..................................................................................................*...........................|..................................................................................................*...........
        // eor   v0.16b, v0.16b, v11.16b                   // .....................................................................................................*.............|................................................................................................................*.............|..............................................................................................................
        // pmull   v8.1q, v0.1d, v13.1d                    // .........................................................................................................*.........|....................................................................................................................*.........|..............................................................................................................
        // pmull2  v9.1q, v0.2d, v13.2d                    // ...........................................................................................................*.......|......................................................................................................................*.......|..............................................................................................................
        // ext     v11.16b, v0.16b, v0.16b, #8             // ..........................................................................................................*........|.....................................................................................................................*........|..............................................................................................................
        // eor     v11.16b, v11.16b, v0.16b                // ..............................................................................................................*....|.........................................................................................................................*....|..............................................................................................................
        // pmull2  v10.1q, v11.2d, v14.2d                  // ..................................................................................................................*|.............................................................................................................................*|..............................................................................................................
        // ldr q29, [x0, #(-3*16)]                         // .............................*.....................................................................................|........................................*.....................................................................................|........................................*.....................................................................
        // rev        w14, w13                             // ...................................................................................................................|.*............................................................................................................................|.*............................................................................................................
        // orr        x14, x12, x14, lsl #32               // ...................................................................................................................|......*.......................................................................................................................|......*.......................................................................................................
        // fmov       d0, x11                              // .................................................................................................................e.|............................................................................................................................e.|..............................................................................................................
        // fmov       v0.d[1], x14                         // ...................................................................................................................|.......*......................................................................................................................|.......*......................................................................................................
        // add        w13, w13, #1                         // ....e..............................................................................................................|...............e..............................................................................................................|...............e..............................................................................................
        // aesr v0.16b, v18.16b                            // .....*.............................................................................................................|................*.............................................................................................................|................*.............................................................................................
        // aesr v0.16b, v19.16b                            // .............*.....................................................................................................|........................*.....................................................................................................|........................*.....................................................................................
        // aesr v0.16b, v20.16b                            // ..................*................................................................................................|.............................*................................................................................................|.............................*................................................................................
        // aesr v0.16b, v21.16b                            // ......................*............................................................................................|.................................*............................................................................................|.................................*............................................................................
        // aesr v0.16b, v22.16b                            // ..........................*........................................................................................|.....................................*........................................................................................|.....................................*........................................................................
        // aesr v0.16b, v23.16b                            // ..............................*....................................................................................|.........................................*....................................................................................|.........................................*....................................................................
        // aesr v0.16b, v24.16b                            // .................................*.................................................................................|............................................*.................................................................................|............................................*.................................................................
        // aesr v0.16b, v25.16b                            // ......................................*............................................................................|.................................................*............................................................................|.................................................*............................................................
        // aesr v0.16b, v26.16b                            // ..........................................*........................................................................|.....................................................*........................................................................|.....................................................*........................................................
        // aese v0.16b, v27.16b                            // .............................................*.....................................................................|........................................................*.....................................................................|........................................................*.....................................................
        // eor v29.16b, v29.16b, v28.16b                   // ..............................................*....................................................................|.........................................................*....................................................................|.........................................................*....................................................
        // eor v0.16b, v29.16b, v0.16b                     // ..................................................*................................................................|.............................................................*................................................................|.............................................................*................................................
        // str q0, [x2, #(-3*16)]                          // ..................................................................*................................................|.............................................................................*................................................|.............................................................................*................................
        // rev64   v0.16b, v0.16b                          // ......................................................*............................................................|.................................................................*............................................................|.................................................................*............................................
        // pmull   v11.1q, v0.1d, v12.1d                   // ......................................................................................................*............|.................................................................................................................*............|..............................................................................................................
        // eor     v8.16b, v8.16b, v11.16b                 // ......l............................................................................................................|.................l............................................................................................................|.................l............................................................................................
        // pmull2  v11.1q, v0.2d, v12.2d                   // ..............................................................................................*....................|.........................................................................................................*....................|.........................................................................................................*....
        // eor     v9.16b, v9.16b, v11.16b                 // ..........l........................................................................................................|.....................l........................................................................................................|.....................l........................................................................................
        // mov     d11, v0.d[1]                            // ..........................................................*........................................................|.....................................................................*........................................................|.....................................................................*........................................
        // eor     v11.8b, v11.8b, v0.8b                   // ..............................................................*....................................................|.........................................................................*....................................................|.........................................................................*....................................
        // pmull   v11.1q, v11.1d, v14.1d                  // .................................................................*.................................................|............................................................................*.................................................|............................................................................*.................................
        // eor     v10.16b, v10.16b, v11.16b               // ..l................................................................................................................|.............l................................................................................................................|.............l................................................................................................
        // ldr q29, [x0, #(-2*16)]                         // ........................................................................e..........................................|...................................................................................e..........................................|...................................................................................e..........................
        // rev        w14, w13                             // .......e...........................................................................................................|..................e...........................................................................................................|..................e...........................................................................................
        // orr        x14, x12, x14, lsl #32               // ............e......................................................................................................|.......................e......................................................................................................|.......................e......................................................................................
        // fmov       d0, x11                              // ...........................................................................e.......................................|......................................................................................e.......................................|......................................................................................e.......................
        // fmov       v0.d[1], x14                         // .................................................................................e.................................|............................................................................................e.................................|............................................................................................e.................
        // add        w13, w13, #1                         // ........e..........................................................................................................|...................e..........................................................................................................|...................e..........................................................................................
        // aesr v0.16b, v18.16b                            // ...........................................................................................e.......................|......................................................................................................e.......................|......................................................................................................e.......
        // aesr v0.16b, v19.16b                            // ................................................................................................e..................|...........................................................................................................e..................|...........................................................................................................e..
        // aesr v0.16b, v20.16b                            // ....................................................................................................e..............|...............................................................................................................e..............|..............................................................................................................
        // aesr v0.16b, v21.16b                            // .......................................................................................................e...........|..................................................................................................................e...........|..............................................................................................................
        // aesr v0.16b, v22.16b                            // ...................................................................................................................|....*.........................................................................................................................|....*.........................................................................................................
        // aesr v0.16b, v23.16b                            // ...................................................................................................................|..........*...................................................................................................................|..........*...................................................................................................
        // aesr v0.16b, v24.16b                            // .....................................................*.............................................................|................................................................*.............................................................|................................................................*.............................................
        // aesr v0.16b, v25.16b                            // .........................................................*.........................................................|....................................................................*.........................................................|....................................................................*.........................................
        // aesr v0.16b, v26.16b                            // .............................................................*.....................................................|........................................................................*.....................................................|........................................................................*.....................................
        // aese v0.16b, v27.16b                            // .....................................................................*.............................................|................................................................................*.............................................|................................................................................*.............................
        // eor v29.16b, v29.16b, v28.16b                   // .........................................*.........................................................................|....................................................*.........................................................................|....................................................*.........................................................
        // eor v0.16b, v29.16b, v0.16b                     // .........................................................................*.........................................|....................................................................................*.........................................|....................................................................................*.........................
        // str q0, [x2, #(-2*16)]                          // ...............................................................................*...................................|..........................................................................................*...................................|..........................................................................................*...................
        // ldr q12, [x6]                                   // .......................................*...........................................................................|..................................................*...........................................................................|..................................................*...........................................................
        // ldr q13, [x6, #32]                              // .................................................................................................*.................|............................................................................................................*.................|............................................................................................................*.
        // ldr q14, [x6, #16]                              // ............................................................................................*......................|.......................................................................................................*......................|.......................................................................................................*......
        // rev64   v0.16b, v0.16b                          // ......................................................................................*............................|.................................................................................................*............................|.................................................................................................*............
        // pmull   v11.1q, v0.1d, v13.1d                   // .............................................................................................................*.....|........................................................................................................................*.....|..............................................................................................................
        // eor     v8.16b, v8.16b, v11.16b                 // ...................l...............................................................................................|..............................l...............................................................................................|..............................l...............................................................................
        // pmull2  v11.1q, v0.2d, v13.2d                   // ...................................................................................................................l..............................................................................................................................l..............................................................................................................
        // eor     v9.16b, v9.16b, v11.16b                 // .........................l.........................................................................................|....................................l.........................................................................................|....................................l.........................................................................
        // ext     v11.16b, v0.16b, v0.16b, #8             // ........................................................................................................*..........|...................................................................................................................*..........|..............................................................................................................
        // eor     v11.16b, v11.16b, v0.16b                // ............................................................................................................*......|.......................................................................................................................*......|..............................................................................................................
        // pmull2  v11.1q, v11.2d, v14.2d                  // ................................................................................................................*..|...........................................................................................................................*..|..............................................................................................................
        // eor     v10.16b, v10.16b, v11.16b               // ................l..................................................................................................|...........................l..................................................................................................|...........................l..................................................................................
        // ldr q29, [x0, #(-1*16)]                         // .....................*.............................................................................................|................................*.............................................................................................|................................*.............................................................................
        // rev        w14, w13                             // ...........e.......................................................................................................|......................e.......................................................................................................|......................e.......................................................................................
        // orr        x14, x12, x14, lsl #32               // ...............e...................................................................................................|..........................e...................................................................................................|..........................e...................................................................................
        // fmov       d0, x11                              // ...................................................................................................................|*.............................................................................................................................|*.............................................................................................................
        // fmov       v0.d[1], x14                         // ...................................................................................................................|.........*....................................................................................................................|.........*....................................................................................................
        // add        w13, w13, #1                         // ...................................................................................................................|.....*........................................................................................................................|.....*........................................................................................................
        // aesr v0.16b, v18.16b                            // .........*.........................................................................................................|....................*.........................................................................................................|....................*.........................................................................................
        // aesr v0.16b, v19.16b                            // .................*.................................................................................................|............................*.................................................................................................|............................*.................................................................................
        // aesr v0.16b, v20.16b                            // ........................*..........................................................................................|...................................*..........................................................................................|...................................*..........................................................................
        // aesr v0.16b, v21.16b                            // ............................*......................................................................................|.......................................*......................................................................................|.......................................*......................................................................
        // aesr v0.16b, v22.16b                            // ................................*..................................................................................|...........................................*..................................................................................|...........................................*..................................................................
        // aesr v0.16b, v23.16b                            // ...................................*...............................................................................|..............................................*...............................................................................|..............................................*...............................................................
        // aesr v0.16b, v24.16b                            // ........................................*..........................................................................|...................................................*..........................................................................|...................................................*..........................................................
        // aesr v0.16b, v25.16b                            // ...........................................*.......................................................................|......................................................*.......................................................................|......................................................*.......................................................
        // aesr v0.16b, v26.16b                            // ...............................................*...................................................................|..........................................................*...................................................................|..........................................................*...................................................
        // aese v0.16b, v27.16b                            // ....................................................*..............................................................|...............................................................*..............................................................|...............................................................*..............................................
        // eor v29.16b, v29.16b, v28.16b                   // ...............................*...................................................................................|..........................................*...................................................................................|..........................................*...................................................................
        // eor v0.16b, v29.16b, v0.16b                     // .......................................................*...........................................................|..................................................................*...........................................................|..................................................................*...........................................
        // str q0, [x2, #(-1*16)]                          // ....................................................................*..............................................|...............................................................................*..............................................|...............................................................................*..............................
        // rev64   v0.16b, v0.16b                          // ...............................................................*...................................................|..........................................................................*...................................................|..........................................................................*...................................
        // pmull   v11.1q, v0.1d, v12.1d                   // ....................................................................................*..............................|...............................................................................................*..............................|...............................................................................................*..............
        // eor     v8.16b, v8.16b, v11.16b                 // ............................................l......................................................................|.......................................................l......................................................................|.......................................................l......................................................
        // pmull2  v11.1q, v0.2d, v12.2d                   // .............................................................................*.....................................|........................................................................................*.....................................|........................................................................................*.....................
        // eor     v9.16b, v9.16b, v11.16b                 // ..................................l................................................................................|.............................................l................................................................................|.............................................l................................................................
        // mov     d11, v0.d[1]                            // ...............................................................................................*...................|..........................................................................................................*...................|..........................................................................................................*...
        // eor     v11.8b, v11.8b, v0.8b                   // ...................................................................................................*...............|..............................................................................................................*...............|..............................................................................................................
        // pmull   v11.1q, v11.1d, v14.1d                  // ...................................................................................................................|........l.....................................................................................................................|........l.....................................................................................................
        // eor     v10.16b, v10.16b, v11.16b               // .......................l...........................................................................................|..................................l...........................................................................................|..................................l...........................................................................
        // eor        v0.16b, v8.16b,  v9.16b              // ................................................l..................................................................|...........................................................l..................................................................|...........................................................l..................................................
        // pmull      v1.1q,  v9.1d,   v7.1d               // ..........................................................................l........................................|.....................................................................................l........................................|.....................................................................................l........................
        // ext        v9.16b,    v9.16b,  v9.16b, #8       // ...........................................................l.......................................................|......................................................................l.......................................................|......................................................................l.......................................
        // eor        v10.16b,   v10.16b, v0.16b           // ...................................................l...............................................................|..............................................................l...............................................................|..............................................................l...............................................
        // eor        v1.16b, v9.16b,  v1.16b              // ..............................................................................l....................................|.........................................................................................l....................................|.........................................................................................l....................
        // eor        v10.16b,   v10.16b, v1.16b           // ..................................................................................l................................|.............................................................................................l................................|.............................................................................................l................
        // pmull      v9.1q,     v10.1d,  v7.1d            // .....................................................................................l.............................|................................................................................................l.............................|................................................................................................l.............
        // eor        v8.16b,    v8.16b,  v9.16b           // .........................................................................................l.........................|....................................................................................................l.........................|....................................................................................................l.........
        // ext        v10.16b,   v10.16b, v10.16b, #8      // ..........................................................................................l........................|.....................................................................................................l........................|.....................................................................................................l........
        // eor        v11.16b,     v8.16b,  v10.16b        // .............................................................................................l.....................|........................................................................................................l.....................|........................................................................................................l.....
        // ext        v11.16b, v11.16b, v11.16b, #8        // ..................................................................................................l................|.............................................................................................................l................|.............................................................................................................l

        sub count, count, #1
        cbnz count, Lloop_unrolled_start
Lloop_unrolled_start_postamble:// end of loop kernel
        // Instructions:    132
        // Expected cycles: 70
        // Expected IPC:    1.8857142857142857
        ldr q29, [x0, #16]                       // *.....................................................................
        aesr v17.16b, v22.16b                    // *.....................................................................
        orr x14, x12, x28, lsl #32               // *.....................................................................
        rev w13, w29                             // *.....................................................................
        pmull2 v16.1q, v16.2d, v15.2d            // .*....................................................................
        fmov v6.d[1], x14                        // .*....................................................................
        orr x28, x12, x13, lsl #32               // .*....................................................................
        aesr v17.16b, v23.16b                    // ..*...................................................................
        eor v12.16B, v5.16B, v12.16B             // ..*...................................................................
        pmull v1.1q, v10.1d, v1.1d               // ...*..................................................................
        fmov v0.d[1], x28                        // ...*..................................................................
        aesr v6.16b, v18.16b                     // ....*.................................................................
        eor v2.16B, v12.16B, v14.16B             // ....*.................................................................
        eor v14.16B, v8.16B, v11.16B             // .....*................................................................
        aesr v17.16b, v24.16b                    // .....*................................................................
        eor v1.16B, v2.16B, v1.16B               // ......*...............................................................
        aesr v6.16b, v19.16b                     // ......*...............................................................
        eor v5.16B, v31.16B, v3.16B              // .......*..............................................................
        aesr v0.16b, v18.16b                     // .......*..............................................................
        eor v3.16B, v14.16B, v13.16B             // ........*.............................................................
        aesr v6.16b, v20.16b                     // ........*.............................................................
        eor v10.16B, v5.16B, v16.16B             // .........*............................................................
        aesr v0.16b, v19.16b                     // .........*............................................................
        eor v14.16B, v3.16B, v9.16B              // ..........*...........................................................
        aesr v6.16b, v21.16b                     // ..........*...........................................................
        eor v8.16B, v10.16B, v4.16B              // ...........*..........................................................
        aesr v0.16b, v20.16b                     // ...........*..........................................................
        ldr q9, [x0], #(4*16)                    // ............*.........................................................
        aesr v6.16b, v22.16b                     // ............*.........................................................
        aesr v0.16b, v21.16b                     // .............*........................................................
        eor v12.16B, v14.16B, v8.16B             // .............*........................................................
        ext v31.16B, v8.16B, v8.16B, #8          // ..............*.......................................................
        pmull v15.1q, v8.1d, v7.1d               // ..............*.......................................................
        aesr v0.16b, v22.16b                     // ...............*......................................................
        eor v1.16B, v1.16B, v12.16B              // ...............*......................................................
        eor v10.16B, v31.16B, v15.16B            // ................*.....................................................
        aesr v6.16b, v23.16b                     // ................*.....................................................
        fmov d15, x11                            // .................*....................................................
        aesr v0.16b, v23.16b                     // .................*....................................................
        eor v4.16B, v1.16B, v10.16B              // ..................*...................................................
        aesr v6.16b, v24.16b                     // ..................*...................................................
        eor v12.16B, v29.16B, v28.16B            // ...................*..................................................
        aesr v0.16b, v24.16b                     // ...................*..................................................
        ldr q29, [x0, #-16]                      // ....................*.................................................
        aesr v6.16b, v25.16b                     // ....................*.................................................
        fmov v15.d[1], x24                       // .....................*................................................
        aesr v0.16b, v25.16b                     // .....................*................................................
        eor v10.16B, v9.16B, v28.16B             // ......................*...............................................
        aesr v6.16b, v26.16b                     // ......................*...............................................
        ext v13.16B, v4.16B, v4.16B, #8          // .......................*..............................................
        aesr v0.16b, v26.16b                     // .......................*..............................................
        ldr q16, [x6, #48]                       // ........................*.............................................
        aesr v15.16b, v18.16b                    // ........................*.............................................
        eor v2.16B, v29.16B, v28.16B             // .........................*............................................
        aese v0.16b, v27.16b                     // .........................*............................................
        pmull v4.1q, v4.1d, v7.1d                // ..........................*...........................................
        ldr q5, [x6]                             // ..........................*...........................................
        eor v9.16B, v12.16B, v0.16B              // ...........................*..........................................
        aesr v15.16b, v19.16b                    // ...........................*..........................................
        eor v3.16B, v14.16B, v4.16B              // ............................*.........................................
        ldr q1, [x6, #80]                        // ............................*.........................................
        rev64 v8.16B, v9.16B                     // .............................*........................................
        aesr v15.16b, v20.16b                    // .............................*........................................
        eor v0.16B, v3.16B, v13.16B              // ..............................*.......................................
        aese v6.16b, v27.16b                     // ..............................*.......................................
        aesr v15.16b, v21.16b                    // ...............................*......................................
        eor v29.16B, v30.16B, v28.16B            // ...............................*......................................
        mov d31, v8.d[1]                         // ................................*.....................................
        aesr v17.16b, v25.16b                    // ................................*.....................................
        eor v10.16B, v10.16B, v6.16B             // .................................*....................................
        aesr v15.16b, v22.16b                    // .................................*....................................
        ext v3.16B, v0.16B, v0.16B, #8           // ..................................*...................................
        aesr v17.16b, v26.16b                    // ..................................*...................................
        rev64 v30.16B, v10.16B                   // ...................................*..................................
        aesr v15.16b, v23.16b                    // ...................................*..................................
        aese v17.16b, v27.16b                    // ....................................*.................................
        eor v0.8B, v31.8B, v8.8B                 // ....................................*.................................
        aesr v15.16b, v24.16b                    // .....................................*................................
        eor v13.16B, v30.16B, v3.16B             // .....................................*................................
        ldr q14, [x6, #64]                       // ......................................*...............................
        pmull2 v6.1q, v8.2d, v16.2d              // ......................................*...............................
        ext v12.16B, v13.16B, v13.16B, #8        // .......................................*..............................
        pmull v4.1q, v8.1d, v16.1d               // .......................................*..............................
        pmull2 v31.1q, v13.2d, v1.2d             // ........................................*.............................
        eor v3.16B, v29.16B, v17.16B             // ........................................*.............................
        aesr v15.16b, v25.16b                    // .........................................*............................
        eor v17.16B, v12.16B, v13.16B            // .........................................*............................
        pmull v11.1q, v13.1d, v1.1d              // ..........................................*...........................
        rev64 v16.16B, v3.16B                    // ..........................................*...........................
        aesr v15.16b, v26.16b                    // ...........................................*..........................
        ldr q1, [x6, #32]                        // ...........................................*..........................
        pmull v0.1q, v0.1d, v14.1d               // ............................................*.........................
        ext v29.16B, v16.16B, v16.16B, #8        // ............................................*.........................
        aese v15.16b, v27.16b                    // .............................................*........................
        ldr q8, [x6, #16]                        // .............................................*........................
        eor v30.16B, v29.16B, v16.16B            // ..............................................*.......................
        pmull2 v14.1q, v17.2d, v14.2d            // ..............................................*.......................
        eor v6.16B, v31.16B, v6.16B              // ...............................................*......................
        eor v2.16B, v2.16B, v15.16B              // ...............................................*......................
        pmull2 v17.1q, v16.2d, v1.2d             // ................................................*.....................
        eor v0.16B, v14.16B, v0.16B              // ................................................*.....................
        pmull v12.1q, v16.1d, v1.1d              // .................................................*....................
        rev64 v31.16B, v2.16B                    // .................................................*....................
        pmull2 v13.1q, v30.2d, v8.2d             // ..................................................*...................
        eor v15.16B, v11.16B, v4.16B             // ..................................................*...................
        pmull v14.1q, v31.1d, v5.1d              // ...................................................*..................
        mov d11, v31.d[1]                        // ...................................................*..................
        pmull2 v4.1q, v31.2d, v5.2d              // ....................................................*.................
        eor v29.16B, v6.16B, v17.16B             // ....................................................*.................
        eor v31.8B, v11.8B, v31.8B               // .....................................................*................
        eor v12.16B, v15.16B, v12.16B            // .....................................................*................
        eor v30.16B, v0.16B, v13.16B             // ......................................................*...............
        eor v16.16B, v29.16B, v4.16B             // ......................................................*...............
        pmull v8.1q, v31.1d, v8.1d               // .......................................................*..............
        eor v6.16B, v12.16B, v14.16B             // .......................................................*..............
        pmull v14.1q, v16.1d, v7.1d              // ........................................................*.............
        ext v29.16B, v16.16B, v16.16B, #8        // ........................................................*.............
        eor v15.16B, v6.16B, v16.16B             // .........................................................*............
        eor v8.16B, v30.16B, v8.16B              // .........................................................*............
        eor v5.16B, v29.16B, v14.16B             // ..........................................................*...........
        str q3, [x2, #32]                        // ..........................................................*...........
        eor v29.16B, v8.16B, v15.16B             // ...........................................................*..........
        add w13, w22, #1                         // ...........................................................*..........
        str q9, [x2, #16]                        // ............................................................*.........
        str q2, [x2, #48]                        // ............................................................*.........
        str q10, [x2], #(4*16)                   // .............................................................*........
        eor v13.16B, v29.16B, v5.16B             // .............................................................*........
        pmull v15.1q, v13.1d, v7.1d              // ...............................................................*......
        ext v30.16B, v13.16B, v13.16B, #8        // ................................................................*.....
        eor v13.16B, v6.16B, v15.16B             // .................................................................*....
        eor v0.16B, v13.16B, v30.16B             // ...................................................................*..
        ext v11.16B, v0.16B, v0.16B, #8          // .....................................................................*

        // original source code
        // pmull2 V<ssa_0>.1q, v16.2d, v15.2d                          // ....*...............................................................................................................................
        // fmov D<ssa_1>, x11                                          // .....................................*..............................................................................................
        // rev W<ssa_2>, w29                                           // ...*................................................................................................................................
        // orr X<ssa_3>, x12, x28, lsl #32                             // ..*.................................................................................................................................
        // fmov v6.d[1], X<ssa_3>                                      // .....*..............................................................................................................................
        // aesr v17.16b, v22.16b                                       // .*..................................................................................................................................
        // add w13, w22, #1                                            // ..........................................................................................................................*.........
        // orr X<ssa_5>, x12, X<ssa_2>, lsl #32                        // ......*.............................................................................................................................
        // fmov v0.d[1], X<ssa_5>                                      // ..........*.........................................................................................................................
        // pmull V<ssa_6>.1q, v10.1d, v1.1d                            // .........*..........................................................................................................................
        // fmov V<ssa_1>.d[1], x24                                     // .............................................*......................................................................................
        // aesr v17.16b, v23.16b                                       // .......*............................................................................................................................
        // eor V<ssa_9>.16B, v5.16B, v12.16B                           // ........*...........................................................................................................................
        // aesr v6.16b, v18.16b                                        // ...........*........................................................................................................................
        // aesr v0.16b, v18.16b                                        // ..................*.................................................................................................................
        // eor V<ssa_11>.16B, v8.16B, v11.16B                          // .............*......................................................................................................................
        // aesr V<ssa_1>.16b, v18.16b                                  // ....................................................*...............................................................................
        // eor V<ssa_14>.16B, v31.16B, v3.16B                          // .................*..................................................................................................................
        // aesr v0.16b, v19.16b                                        // ......................*.............................................................................................................
        // ldr Q<ssa_17>, [x6, #64]                                    // ...............................................................................*....................................................
        // eor V<ssa_19>.16B, V<ssa_9>.16B, v14.16B                    // ............*.......................................................................................................................
        // aesr V<ssa_1>.16b, v19.16b                                  // ..........................................................*.........................................................................
        // aesr v0.16b, v20.16b                                        // ..........................*.........................................................................................................
        // eor V<ssa_20>.16B, V<ssa_11>.16B, v13.16B                   // ...................*................................................................................................................
        // aesr v6.16b, v19.16b                                        // ................*...................................................................................................................
        // ldr Q<ssa_21>, [x0, #48]                                    // ...........................................*........................................................................................
        // aesr v0.16b, v21.16b                                        // .............................*......................................................................................................
        // eor V<ssa_22>.16B, V<ssa_19>.16B, V<ssa_6>.16B              // ...............*....................................................................................................................
        // aesr V<ssa_1>.16b, v20.16b                                  // ..............................................................*.....................................................................
        // eor V<ssa_23>.16B, V<ssa_14>.16B, V<ssa_0>.16B              // .....................*..............................................................................................................
        // aesr v0.16b, v22.16b                                        // .................................*..................................................................................................
        // ldr Q<ssa_24>, [x0], #(4*16)                                // ...........................*........................................................................................................
        // aesr V<ssa_1>.16b, v21.16b                                  // .................................................................*..................................................................
        // ldr Q<ssa_25>, [x0, #-48]                                   // *...................................................................................................................................
        // aesr v0.16b, v23.16b                                        // ......................................*.............................................................................................
        // eor V<ssa_26>.16B, V<ssa_21>.16B, v28.16B                   // .....................................................*..............................................................................
        // aesr V<ssa_1>.16b, v22.16b                                  // ......................................................................*.............................................................
        // aesr v0.16b, v24.16b                                        // ..........................................*.........................................................................................
        // eor V<ssa_27>.16B, V<ssa_23>.16B, v4.16B                    // .........................*..........................................................................................................
        // aesr V<ssa_1>.16b, v23.16b                                  // ..........................................................................*.........................................................
        // ldr Q<ssa_28>, [x6, #48]                                    // ...................................................*................................................................................
        // eor V<ssa_29>.16B, V<ssa_24>.16B, v28.16B                   // ...............................................*....................................................................................
        // aesr v0.16b, v25.16b                                        // ..............................................*.....................................................................................
        // ldr Q<ssa_30>, [x6]                                         // ........................................................*...........................................................................
        // aesr V<ssa_1>.16b, v24.16b                                  // .............................................................................*......................................................
        // eor V<ssa_31>.16B, v30.16B, v28.16B                         // ..................................................................*.................................................................
        // aesr v0.16b, v26.16b                                        // ..................................................*.................................................................................
        // aesr V<ssa_1>.16b, v25.16b                                  // .....................................................................................*..............................................
        // eor V<ssa_32>.16B, V<ssa_20>.16B, v9.16B                    // .......................*............................................................................................................
        // aese v0.16b, v27.16b                                        // ......................................................*.............................................................................
        // eor V<ssa_33>.16B, V<ssa_25>.16B, v28.16B                   // .........................................*..........................................................................................
        // aesr V<ssa_1>.16b, v26.16b                                  // .........................................................................................*..........................................
        // eor V<ssa_34>.16B, V<ssa_32>.16B, V<ssa_27>.16B             // ..............................*.....................................................................................................
        // aesr v6.16b, v20.16b                                        // ....................*...............................................................................................................
        // eor V<ssa_35>.16B, V<ssa_33>.16B, v0.16B                    // .........................................................*..........................................................................
        // eor V<ssa_36>.16B, V<ssa_22>.16B, V<ssa_34>.16B             // ..................................*.................................................................................................
        // aese V<ssa_1>.16b, v27.16b                                  // .............................................................................................*......................................
        // aesr v17.16b, v24.16b                                       // ..............*.....................................................................................................................
        // rev64 V<ssa_37>.16B, V<ssa_35>.16B                          // .............................................................*......................................................................
        // eor V<ssa_38>.16B, V<ssa_26>.16B, V<ssa_1>.16B              // ..................................................................................................*.................................
        // aesr v6.16b, v21.16b                                        // ........................*...........................................................................................................
        // aesr v17.16b, v25.16b                                       // ....................................................................*...............................................................
        // mov D<ssa_39>, V<ssa_37>.d[1]                               // ...................................................................*................................................................
        // ext V<ssa_40>.16B, V<ssa_27>.16B, V<ssa_27>.16B, #8         // ...............................*....................................................................................................
        // aesr v6.16b, v22.16b                                        // ............................*.......................................................................................................
        // aesr v17.16b, v26.16b                                       // ........................................................................*...........................................................
        // eor V<ssa_41>.8B, V<ssa_39>.8B, V<ssa_37>.8B                // ............................................................................*.......................................................
        // rev64 V<ssa_42>.16B, V<ssa_38>.16B                          // ......................................................................................................*.............................
        // aesr v6.16b, v23.16b                                        // ....................................*...............................................................................................
        // pmull V<ssa_43>.1q, V<ssa_41>.1d, V<ssa_17>.1d              // ...........................................................................................*........................................
        // str Q<ssa_35>, [x2, #16]                                    // ...........................................................................................................................*........
        // aesr v6.16b, v24.16b                                        // ........................................*...........................................................................................
        // str Q<ssa_38>, [x2, #48]                                    // ............................................................................................................................*.......
        // aese v17.16b, v27.16b                                       // ...........................................................................*........................................................
        // ldr Q<ssa_44>, [x6, #80]                                    // ............................................................*.......................................................................
        // aesr v6.16b, v25.16b                                        // ............................................*.......................................................................................
        // eor V<ssa_46>.16B, V<ssa_31>.16B, v17.16B                   // ....................................................................................*...............................................
        // pmull V<ssa_47>.1q, V<ssa_27>.1d, v7.1d                     // ................................*...................................................................................................
        // aesr v6.16b, v26.16b                                        // ................................................*...................................................................................
        // pmull2 V<ssa_49>.1q, V<ssa_42>.2d, V<ssa_30>.2d             // ...........................................................................................................*........................
        // eor V<ssa_50>.16B, V<ssa_40>.16B, V<ssa_47>.16B             // ...................................*................................................................................................
        // str Q<ssa_46>, [x2, #32]                                    // ........................................................................................................................*...........
        // aese v6.16b, v27.16b                                        // ................................................................*...................................................................
        // eor V<ssa_51>.16B, V<ssa_36>.16B, V<ssa_50>.16B             // .......................................*............................................................................................
        // eor V<ssa_52>.16B, V<ssa_29>.16B, v6.16B                    // .....................................................................*..............................................................
        // pmull V<ssa_53>.1q, V<ssa_42>.1d, V<ssa_30>.1d              // .........................................................................................................*..........................
        // pmull V<ssa_54>.1q, V<ssa_51>.1d, v7.1d                     // .......................................................*............................................................................
        // rev64 V<ssa_55>.16B, V<ssa_46>.16B                          // ........................................................................................*...........................................
        // rev64 V<ssa_56>.16B, V<ssa_52>.16B                          // .........................................................................*..........................................................
        // str Q<ssa_52>, [x2], #(4*16)                                // .............................................................................................................................*......
        // eor V<ssa_57>.16B, V<ssa_32>.16B, V<ssa_54>.16B             // ...........................................................*........................................................................
        // ext V<ssa_58>.16B, V<ssa_51>.16B, V<ssa_51>.16B, #8         // .................................................*..................................................................................
        // ldr Q<ssa_59>, [x6, #16]                                    // ..............................................................................................*.....................................
        // eor V<ssa_60>.16B, V<ssa_57>.16B, V<ssa_58>.16B             // ...............................................................*....................................................................
        // pmull2 V<ssa_61>.1q, V<ssa_37>.2d, V<ssa_28>.2d             // ................................................................................*...................................................
        // mov D<ssa_62>, V<ssa_42>.d[1]                               // ..........................................................................................................*.........................
        // ldr Q<ssa_63>, [x6, #32]                                    // ..........................................................................................*.........................................
        // ext V<ssa_64>.16B, V<ssa_60>.16B, V<ssa_60>.16B, #8         // .......................................................................*............................................................
        // eor V<ssa_65>.8B, V<ssa_62>.8B, V<ssa_42>.8B                // .............................................................................................................*......................
        // eor V<ssa_66>.16B, V<ssa_56>.16B, V<ssa_64>.16B             // ..............................................................................*.....................................................
        // pmull V<ssa_67>.1q, V<ssa_37>.1d, V<ssa_28>.1d              // ..................................................................................*.................................................
        // ext V<ssa_68>.16B, V<ssa_55>.16B, V<ssa_55>.16B, #8         // ............................................................................................*.......................................
        // pmull V<ssa_69>.1q, V<ssa_66>.1d, V<ssa_44>.1d              // .......................................................................................*............................................
        // ext V<ssa_70>.16B, V<ssa_66>.16B, V<ssa_66>.16B, #8         // .................................................................................*..................................................
        // pmull2 V<ssa_71>.1q, V<ssa_66>.2d, V<ssa_44>.2d             // ...................................................................................*................................................
        // eor V<ssa_72>.16B, V<ssa_68>.16B, V<ssa_55>.16B             // ...............................................................................................*....................................
        // pmull V<ssa_73>.1q, V<ssa_55>.1d, V<ssa_63>.1d              // .....................................................................................................*..............................
        // eor V<ssa_74>.16B, V<ssa_70>.16B, V<ssa_66>.16B             // ......................................................................................*.............................................
        // pmull2 V<ssa_75>.1q, V<ssa_72>.2d, V<ssa_59>.2d             // .......................................................................................................*............................
        // pmull2 V<ssa_77>.1q, V<ssa_74>.2d, V<ssa_17>.2d             // ................................................................................................*...................................
        // pmull2 V<ssa_78>.1q, V<ssa_55>.2d, V<ssa_63>.2d             // ...................................................................................................*................................
        // pmull V<ssa_84>.1q, V<ssa_65>.1d, V<ssa_59>.1d              // .................................................................................................................*..................
        // eor V<ssa_85>.16B, V<ssa_77>.16B, V<ssa_43>.16B             // ....................................................................................................*...............................
        // eor V<ssa_87>.16B, V<ssa_69>.16B, V<ssa_67>.16B             // ........................................................................................................*...........................
        // eor V<ssa_89>.16B, V<ssa_71>.16B, V<ssa_61>.16B             // .................................................................................................*..................................
        // eor V<ssa_93>.16B, V<ssa_85>.16B, V<ssa_75>.16B             // ...............................................................................................................*....................
        // eor V<ssa_94>.16B, V<ssa_87>.16B, V<ssa_73>.16B             // ..............................................................................................................*.....................
        // eor V<ssa_96>.16B, V<ssa_93>.16B, V<ssa_84>.16B             // ......................................................................................................................*.............
        // eor V<ssa_97>.16B, V<ssa_89>.16B, V<ssa_78>.16B             // ............................................................................................................*.......................
        // eor V<ssa_101>.16B, V<ssa_97>.16B, V<ssa_49>.16B            // ................................................................................................................*...................
        // eor V<ssa_106>.16B, V<ssa_94>.16B, V<ssa_53>.16B            // ..................................................................................................................*.................
        // eor V<ssa_108>.16B, V<ssa_106>.16B, V<ssa_101>.16B          // .....................................................................................................................*..............
        // eor V<ssa_110>.16B, V<ssa_96>.16B, V<ssa_108>.16B           // .........................................................................................................................*..........
        // ext V<ssa_114>.16B, V<ssa_101>.16B, V<ssa_101>.16B, #8      // ....................................................................................................................*...............
        // pmull V<ssa_119>.1q, V<ssa_101>.1d, v7.1d                   // ...................................................................................................................*................
        // eor V<ssa_120>.16B, V<ssa_114>.16B, V<ssa_119>.16B          // .......................................................................................................................*............
        // eor V<ssa_121>.16B, V<ssa_110>.16B, V<ssa_120>.16B          // ..............................................................................................................................*.....
        // pmull V<ssa_123>.1q, V<ssa_121>.1d, v7.1d                   // ...............................................................................................................................*....
        // eor V<ssa_125>.16B, V<ssa_106>.16B, V<ssa_123>.16B          // .................................................................................................................................*..
        // ext V<ssa_126>.16B, V<ssa_121>.16B, V<ssa_121>.16B, #8      // ................................................................................................................................*...
        // eor V<ssa_127>.16B, V<ssa_125>.16B, V<ssa_126>.16B          // ..................................................................................................................................*.
        // ext v11.16B, V<ssa_127>.16B, V<ssa_127>.16B, #8             // ...................................................................................................................................*

        b Lloop_unrolled_start_end
Lloop_unrolled_start_iter_1:


        ldr q29, [x0], #(4*16)
        rev        w14, w13
        orr        x14, x12, x14, lsl #32
        fmov       d0, x11
        fmov       v0.d[1], x14
        add        w13, w13, #1
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aese v0.16b, v27.16b
        eor v29.16b, v29.16b, v28.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2], #(4*16)

        ldr q12, [x6, #48]
        ldr q13, [x6, #80]
        ldr q14, [x6, #64]
        rev64 v0.16b, v0.16b
        eor   v0.16b, v0.16b, v11.16b
        // Low product
        pmull   v8.1q, v0.1d, v13.1d
        // High product
        pmull2  v9.1q, v0.2d, v13.2d
        // Middle product
        ext     v11.16b, v0.16b, v0.16b, #8
        eor     v11.16b, v11.16b, v0.16b
        pmull2  v10.1q, v11.2d, v14.2d

        ldr q29, [x0, #(-3*16)]
        rev        w14, w13
        orr        x14, x12, x14, lsl #32
        fmov       d0, x11
        fmov       v0.d[1], x14
        add        w13, w13, #1
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aese v0.16b, v27.16b
        eor v29.16b, v29.16b, v28.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(-3*16)]

        rev64   v0.16b, v0.16b
        // Low product
        pmull   v11.1q, v0.1d, v12.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v12.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        mov     d11, v0.d[1]
        eor     v11.8b, v11.8b, v0.8b
        pmull   v11.1q, v11.1d, v14.1d
        eor     v10.16b, v10.16b, v11.16b

        ldr q29, [x0, #(-2*16)]
        rev        w14, w13
        orr        x14, x12, x14, lsl #32
        fmov       d0, x11
        fmov       v0.d[1], x14
        add        w13, w13, #1
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aese v0.16b, v27.16b
        eor v29.16b, v29.16b, v28.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(-2*16)]

        ldr q12, [x6]
        ldr q13, [x6, #32]
        ldr q14, [x6, #16]
        rev64   v0.16b, v0.16b

        // Low product
        pmull   v11.1q, v0.1d, v13.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v13.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        ext     v11.16b, v0.16b, v0.16b, #8
        eor     v11.16b, v11.16b, v0.16b
        pmull2  v11.1q, v11.2d, v14.2d
        eor     v10.16b, v10.16b, v11.16b

        ldr q29, [x0, #(-1*16)]
        rev        w14, w13
        orr        x14, x12, x14, lsl #32
        fmov       d0, x11
        fmov       v0.d[1], x14
        add        w13, w13, #1
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aese v0.16b, v27.16b
        eor v29.16b, v29.16b, v28.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(-1*16)]

        rev64   v0.16b, v0.16b
        // Low product
        pmull   v11.1q, v0.1d, v12.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v12.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        mov     d11, v0.d[1]
        eor     v11.8b, v11.8b, v0.8b
        pmull   v11.1q, v11.1d, v14.1d
        eor     v10.16b, v10.16b, v11.16b

        eor        v0.16b, v8.16b,  v9.16b
        pmull      v1.1q,  v9.1d,   v7.1d
        ext        v9.16b,    v9.16b,  v9.16b, #8
        eor        v10.16b,   v10.16b, v0.16b
        eor        v1.16b, v9.16b,  v1.16b
        eor        v10.16b,   v10.16b, v1.16b
        pmull      v9.1q,     v10.1d,  v7.1d
        eor        v8.16b,    v8.16b,  v9.16b
        ext        v10.16b,   v10.16b, v10.16b, #8
        eor        v11.16b,     v8.16b,  v10.16b
        ext        v11.16b, v11.16b, v11.16b, #8

Lloop_unrolled_start_iter_1_end:
Lloop_unrolled_start_end:
Lloop_unrolled_end:

        load_htable_12

        cbz remainder, Lloop_1x_end
Lloop_1x_start:

        ldr plain_q, [input], #16
        aes_full_block aes_st, plain, res
        str res_q, [output], #16
        ghash_init_0 res, Ht1, Ht12, tag

        ghash_finalize tag

        sub remainder, remainder, #1
        cbnz remainder, Lloop_1x_start
Lloop_1x_end:

        // Return number of bytes processed
        mov x0, byte_len
        // Store new authentication tag
        rev64 tag.16b, tag.16b
        str tag_q, [tag_ptr]

        // Store updated counter
        // rev32 rtmp_ctr.16b, rtmp_ctr.16b
        // str rtmp_ctr_q, [ivec]
        rev ctr_tmp_w, ctr
        str ctr_tmp_w, [ivec, #12]

        restore_vregs
        restore_gprs

Lenc_postamble_end:
        add sp, sp, #STACK_SIZE

        ret

#endif
#endif  // !OPENSSL_NO_ASM && defined(__AARCH64EL__) && defined(__APPLE__)
#if defined(__ELF__)
// See https: // www.airs.com/blog/archives/518.
.section .note.GNU-stack,"",%progbits
#endif
