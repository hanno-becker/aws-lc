// Copyright (c) 2022, ARM Inc.

// Permission to use, copy, modify, and/or distribute this software for any
// purpose with or without fee is hereby granted, provided that the above
// copyright notice and this permission notice appear in all copies.

// THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
// WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
// MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
// SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
// WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
// OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
// CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. */

// Author: Hanno Becker <hannobecker@posteo.de>

// This file was derived from the assembly generated from aesv8-gcm-armv8.pl,
// written by Fangming Fang <fangming.fang@arm.com> for the OpenSSL project,
// and derived from https: // github.com/ARM-software/AArch64cryptolib, original
// author Samuel Lee <Samuel.Lee@arm.com>.

// The code below is a 'clean' AArch64 implementation of AES-GCM emphasizing
// the logic of the computation. It is meant as the input to manual audits /
// formal verification, as well as automated micro-optimization such as done
// by the SLOTHY superoptimizer (https: // github.com/slothy-optimizer/slothy).

#if !defined(__has_feature)
#define __has_feature(x) 0
#endif
#if __has_feature(memory_sanitizer) && !defined(OPENSSL_NO_ASM)
#define OPENSSL_NO_ASM
#endif

#include <openssl/asm_base.h>

#if !defined(OPENSSL_NO_ASM) && defined(__AARCH64EL__)
#if defined(__ELF__)
#include <openssl/boringssl_prefix_symbols_asm.h>
#include <openssl/arm_arch.h>
.arch   armv8-a+crypto
.text
.globl  aes_gcm_enc_kernel_slothy_base_256
.hidden aes_gcm_enc_kernel_slothy_base_256
.type   aes_gcm_enc_kernel_slothy_base_256,%function
#elif defined(__APPLE__)
#if defined(BORINGSSL_PREFIX)
#include <boringssl_prefix_symbols_asm.h>
#endif
#include <openssl/arm_arch.h>
.text
.globl	_aes_gcm_enc_kernel_slothy_base_256
.private_extern	_aes_gcm_enc_kernel_slothy_base_256
#else
#error Unknown configuration
#endif

#if __ARM_MAX_ARCH__ >= 8

// Arguments
input    .req x0
len_bits .req x1
output   .req x2
tag_ptr  .req x3
ivec     .req x4
key      .req x5
Htable   .req x6

byte_len .req x15

constant_temp .req x25

count           .req x1
full_blocks     .req x7
remainder       .req x9
unroll          .req x10

aes_st    .req v0
aes_st_q  .req q0

res       .req v0
res_q     .req q0

ghash_hi    .req v9
ghash_lo    .req v8
ghash_mid   .req v10
ghash_mid_d .req d10

ghash_tmp   .req v11
ghash_tmp_d .req d11

ghash_mod   .req v7
ghash_mod_d .req d7

modulo_tmp0 .req v0
modulo_tmp1 .req v1

Ht1q    .req q12
Ht2q    .req q13
Ht12q   .req q14

Ht1    .req v12
Ht2    .req v13
Ht12   .req v14

Ht3q    .req Ht1q
Ht4q    .req Ht2q
Ht34q   .req Ht12q

Ht3    .req Ht1
Ht4    .req Ht2
Ht34   .req Ht12

rk0q   .req q18
rk1q   .req q19
rk2q   .req q20
rk3q   .req q21
rk4q   .req q22
rk5q   .req q23
rk6q   .req q24
rk7q   .req q25
rk8q   .req q26
rk9q   .req q27
rk10q  .req q28

rk11q  .req q15
rk12q  .req q16
rk13q  .req q17
rk14q  .req q2

rk0    .req v18
rk1    .req v19
rk2    .req v20
rk3    .req v21
rk4    .req v22
rk5    .req v23
rk6    .req v24
rk7    .req v25
rk8    .req v26
rk9    .req v27
rk10   .req v28

rk11   .req v15
rk12   .req v16
rk13   .req v17
rk14   .req v2

plain   .req v29
plain_q .req q29

rctr_inc   .req v30
rtmp_ctr   .req v31
rtmp_ctr_q .req q31

tag    .req v11
tag_q  .req q11

#define UNROLL 4

#define STACK_SIZE_GPRS  (6*16)
#define STACK_SIZE_VREGS (4*16)
#define STACK_SIZE  (STACK_SIZE_GPRS + STACK_SIZE_VREGS)

#define STACK_BASE_GPRS  (0)
#define STACK_BASE_VREGS (STACK_SIZE_GPRS)

/********************************************************************/
/*                 Generic preamble/postamble macros                */
/********************************************************************/

.macro save_vregs
        stp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        stp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        stp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        stp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro restore_vregs
        ldp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        ldp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        ldp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        ldp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro save_gprs
        stp x19, x20, [sp, #(STACK_BASE_GPRS + 16*0)]
        stp x21, x22, [sp, #(STACK_BASE_GPRS + 16*1)]
        stp x23, x24, [sp, #(STACK_BASE_GPRS + 16*2)]
        stp x25, x26, [sp, #(STACK_BASE_GPRS + 16*3)]
        stp x27, x28, [sp, #(STACK_BASE_GPRS + 16*4)]
        stp x29, x30, [sp, #(STACK_BASE_GPRS + 16*5)]
.endm

.macro restore_gprs
        ldp x19, x20, [sp, #(STACK_BASE_GPRS + 16*0)]
        ldp x21, x22, [sp, #(STACK_BASE_GPRS + 16*1)]
        ldp x23, x24, [sp, #(STACK_BASE_GPRS + 16*2)]
        ldp x25, x26, [sp, #(STACK_BASE_GPRS + 16*3)]
        ldp x27, x28, [sp, #(STACK_BASE_GPRS + 16*4)]
        ldp x29, x30, [sp, #(STACK_BASE_GPRS + 16*5)]
.endm

// Derive number of iterations of unrolled loop and single-block loop
.macro prepare_loop_counts
        mov  unroll, #UNROLL
        // Number of AES Blocks (16b each)
        lsr  full_blocks, byte_len, #4
        // Number of iterations of the unrolled loop
        udiv count, full_blocks, unroll
        // Number of iterations for the tail loop handling 1 block each
        msub remainder, count, unroll, full_blocks
.endm

/********************************************************************/
/*                       AES related macros                         */
/********************************************************************/

.macro load_iv
        ldr     rtmp_ctr_q, [ivec]

        // set up counter increment
 mov	constant_temp, #0x100000000
 movi	rctr_inc.16b,  #0x0
 fmov	rctr_inc.d[1], constant_temp

        rev32   rtmp_ctr.16b, rtmp_ctr.16b
.endm

// Increase AES counter
.macro aes_ctr_inc
        add    rtmp_ctr.4s, rtmp_ctr.4s, rctr_inc.4s
.endm

// Increase AES counter and initialize new AES state
.macro next_ctr_init_aes aes_st
        rev32  \aes_st\().16b, rtmp_ctr.16b
        aes_ctr_inc
.endm

// A single AES round
// Prevent SLOTHY from unfolding because uArchs tend to fuse AESMC+AESE
.macro aesr data, key // @slothy:no-unfold
        aese  \data, \key
        aesmc \data, \data
.endm

.macro aesr_0_8 data, key
        aesr \data\().16b, \key\()0.16b
        aesr \data\().16b, \key\()1.16b
        aesr \data\().16b, \key\()2.16b
        aesr \data\().16b, \key\()3.16b
        aesr \data\().16b, \key\()4.16b
        aesr \data\().16b, \key\()5.16b
        aesr \data\().16b, \key\()6.16b
        aesr \data\().16b, \key\()7.16b
        aesr \data\().16b, \key\()8.16b
.endm

.macro aesr_9_10 data, key
        aesr \data\().16b, \key\()9.16b
        aesr \data\().16b, \key\()10.16b
.endm

.macro aesr_11_12 data, key
        aesr \data\().16b, \key\()11.16b
        aesr \data\().16b, \key\()12.16b
.endm

// Destructs inA
.macro eor3 out, inA, inB, inC
        eor \inA, \inA, \inB
        eor \out, \inA, \inC
.endm

.macro aesr_final aes_st, plain, out
        aese \aes_st\().16b, rk13.16b
        eor3 \out\().16b, \plain\().16b, rk14.16b, \aes_st\().16b
.endm

.macro aes_full_block aes_st, input, output
        next_ctr_init_aes \aes_st
        aesr_0_8   \aes_st\(), rk
        aesr_9_10  \aes_st\(), rk
        aesr_11_12 \aes_st\(), rk
        aesr_final \aes_st, \input, \output
.endm

.macro load_round_key i
        ldr rk\i\()q, [key, #((\i)*16)]
.endm

.macro load_round_keys0
        load_round_key 0
        load_round_key 1
        load_round_key 2
        load_round_key 3
        load_round_key 4
        load_round_key 5
        load_round_key 6
.endm

.macro load_round_keys1
        load_round_key 7
        load_round_key 8
        load_round_key 9
        load_round_key 10
        load_round_key 11
        load_round_key 12
        load_round_key 13
        load_round_key 14
.endm

/********************************************************************/
/*       Loading of H-table (precomputed H-powers for GHASH)        */
/********************************************************************/

// This has to be synchronized with the H-table generation

.macro load_h1 dst, dst_q
        ldr \dst_q, [Htable]
.endm

.macro load_h2 dst, dst_q
        ldr \dst_q, [Htable, #32]
.endm

.macro load_h3 dst, dst_q
        ldr \dst_q, [Htable, #48]
.endm

.macro load_h4 dst, dst_q
        ldr \dst_q, [Htable, #80]
.endm

.macro load_h12 dst, dst_q
        ldr \dst_q, [Htable, #16]
.endm

.macro load_h34 dst, dst_q
        ldr \dst_q, [Htable, #64]
.endm

.macro load_full_htable
        load_h1  Ht1,  Ht1q
        load_h2  Ht2,  Ht2q
        load_h3  Ht3,  Ht3q
        load_h4  Ht4,  Ht4q
        load_h12 Ht12, Ht12q
        load_h34 Ht34, Ht34q
.endm

.macro load_htable_12
        load_h1  Ht1,  Ht1q
        load_h2  Ht2,  Ht2q
        load_h12 Ht12, Ht12q
.endm

.macro load_htable_34
        load_h3  Ht3,  Ht3q
        load_h4  Ht4,  Ht4q
        load_h34 Ht34, Ht34q
.endm

/********************************************************************/
/*                    Macros for GHASH udpate                       */
/********************************************************************/

.macro ghash_init_0 input, Hk, Hk_mid, tag
        rev64 \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_mid.1q, ghash_tmp.1d, \Hk_mid\().1d
.endm

.macro ghash_init_1 input, Hk, Hk_mid, tag
        rev64 \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_mid.1q, ghash_tmp.2d, \Hk_mid\().2d
.endm

.macro ghash_acc_0 input, Hk, Hk_mid
        rev64   \input\().16b, \input\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_tmp.1q, ghash_tmp.1d, \Hk_mid\().1d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_acc_1 input, Hk, Hk_mid
        rev64   \input\().16b, \input\().16b

        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_tmp.1q, ghash_tmp.2d, \Hk_mid\().2d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_finalize tag
        eor        modulo_tmp0.16b, ghash_lo.16b,  ghash_hi.16b
        pmull      modulo_tmp1.1q,  ghash_hi.1d,   ghash_mod.1d
        ext        ghash_hi.16b,    ghash_hi.16b,  ghash_hi.16b, #8
        eor        ghash_mid.16b,   ghash_mid.16b, modulo_tmp0.16b
        eor        modulo_tmp1.16b, ghash_hi.16b,  modulo_tmp1.16b
        eor        ghash_mid.16b,   ghash_mid.16b, modulo_tmp1.16b
        pmull      ghash_hi.1q,     ghash_mid.1d,  ghash_mod.1d
        eor        ghash_lo.16b,    ghash_lo.16b,  ghash_hi.16b
        ext        ghash_mid.16b,   ghash_mid.16b, ghash_mid.16b, #8
        eor        \tag\().16b,     ghash_lo.16b,  ghash_mid.16b
        ext        \tag\().16b, \tag\().16b, \tag\().16b, #8
.endm

.macro load_tag
        ldr      tag_q, [tag_ptr]
        rev64    tag.16b, tag.16b
.endm

.macro prepare_ghash
        // Prepare constant for modular reduction
        movi ghash_mod.8b, #0xc2
        shl  ghash_mod_d, ghash_mod_d, #56
.endm

/********************************************************************/
/*                            Core routine                          */
/********************************************************************/

.align        4
_aes_gcm_enc_kernel_slothy_base_256:
aes_gcm_enc_kernel_slothy_base_256:
#ifdef BORINGSSL_DISPATCH_TEST
        adrp  x9,_BORINGSSL_function_hit@PAGE
        add   x9, x9, _BORINGSSL_function_hit@PAGEOFF
        mov   w10, #1
        strb  w10, [x9,#2] // kFlag_aes_gcm_enc_kernel
#endif

        AARCH64_VALID_CALL_TARGET
        sub sp, sp, #STACK_SIZE

Lenc_preamble_start:
        save_gprs
        save_vregs

        lsr byte_len, len_bits, #3

        load_round_keys0
        load_tag
        load_iv

        prepare_loop_counts
        prepare_ghash

Lenc_preamble_end:

        cbz count, Lloop_unrolled_end
        cmp count, #1
        b.eq Lloop_unrolled_start_iter_1
        // Instructions:    177
        // Expected cycles: 100
        // Expected IPC:    0.5649717514124294
        add v0.4S, v31.4S, v30.4S                // *................................................................................................................................................................................
        ldr q13, [x5, #176]                      // ...............*.................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        rev32 v8.16B, v31.16B                    // .*...............................................................................................................................................................................
        ldr q27, [x6, #64]                       // ........................*........................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        rev32 v6.16B, v0.16B                     // ...*.............................................................................................................................................................................
        ldr q28, [x5, #144]                      // ...........................*.....................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        ldr q26, [x5, #112]                      // ...............................*.................................................................................................................................................
        aesr v8.16b, v18.16b                     // ..*..............................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v6.16b, v18.16b                     // .....*...........................................................................................................................................................................
        ldr q1, [x5, #224]                       // .................................*...............................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v8.16b, v19.16b                     // ....*............................................................................................................................................................................
        ldr q15, [x0, #32]                       // ....................................*............................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        ldr q2, [x5, #128]                       // ........................................*........................................................................................................................................
        aesr v6.16b, v19.16b                     // .......*.........................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        ldr q5, [x0], #(4*16)                    // ..........................................*......................................................................................................................................
        aesr v8.16b, v20.16b                     // ......*..........................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        ldr q17, [x5, #160]                      // .............................................*...................................................................................................................................
        aesr v6.16b, v20.16b                     // .........*.......................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        ldr q14, [x5, #192]                      // ...............................................*.................................................................................................................................
        aesr v8.16b, v21.16b                     // ........*........................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v6.16b, v21.16b                     // ............*....................................................................................................................................................................
        ldr q9, [x0, #-48]                       // .................................................*...............................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v8.16b, v22.16b                     // ..........*......................................................................................................................................................................
        ldr q4, [x0, #-16]                       // ....................................................*............................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v6.16b, v22.16b                     // ..............*..................................................................................................................................................................
        add v12.4S, v0.4S, v30.4S                // ...........*.....................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        ldr q25, [x5, #208]                      // .....................................................*...........................................................................................................................
        aesr v8.16b, v23.16b                     // .........................................*.......................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        rev32 v3.16B, v12.16B                    // .............*...................................................................................................................................................................
        aesr v6.16b, v23.16b                     // ..................*..............................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        add v12.4S, v12.4S, v30.4S               // .................*...............................................................................................................................................................
        aesr v8.16b, v24.16b                     // ............................................*....................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v3.16b, v18.16b                     // ................*................................................................................................................................................................
        ldr q16, [x6, #80]                       // .......................................................*.........................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v6.16b, v24.16b                     // ....................*............................................................................................................................................................
        rev32 v10.16B, v12.16B                   // .....................*...........................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        eor v5.16B, v5.16B, v1.16B               // .........................................................*.......................................................................................................................
        aesr v3.16b, v19.16b                     // ...................*.............................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v10.16b, v18.16b                    // .......................*.........................................................................................................................................................
        eor v29.16B, v9.16B, v1.16B              // ...........................................................*.....................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v3.16b, v20.16b                     // ......................*..........................................................................................................................................................
        eor v0.16B, v4.16B, v1.16B               // ................................................................*................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v10.16b, v19.16b                    // ..........................*......................................................................................................................................................
        add v31.4S, v12.4S, v30.4S               // .......................................................................*.........................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v3.16b, v21.16b                     // .........................*.......................................................................................................................................................
        eor v15.16B, v15.16B, v1.16B             // .........................................................................*.......................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        ldr q9, [x6, #16]                        // ..............................................................*..................................................................................................................
        aesr v10.16b, v20.16b                    // .............................*...................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v3.16b, v22.16b                     // ............................*....................................................................................................................................................
        ldr q1, [x6, #48]                        // ..................................................................*..............................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        ldr q12, [x6]                            // .....................................................................*...........................................................................................................
        aesr v10.16b, v21.16b                    // ................................*................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v3.16b, v23.16b                     // ..............................*..................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v10.16b, v22.16b                    // ...................................*.............................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v3.16b, v24.16b                     // ..................................*..............................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v10.16b, v23.16b                    // .......................................*.........................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v3.16b, v26.16b                     // ......................................*..........................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v10.16b, v24.16b                    // ...........................................*.....................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v3.16b, v2.16b                      // ..........................................................*......................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v10.16b, v26.16b                    // ..............................................*..................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v3.16b, v28.16b                     // .............................................................*...................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v10.16b, v2.16b                     // ..................................................*..............................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v3.16b, v17.16b                     // .................................................................*...............................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v10.16b, v28.16b                    // ......................................................*..........................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v3.16b, v13.16b                     // ....................................................................*............................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v10.16b, v17.16b                    // ............................................................*....................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v3.16b, v14.16b                     // ........................................................................*........................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v10.16b, v13.16b                    // ...............................................................*.................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v6.16b, v26.16b                     // .....................................*...........................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v10.16b, v14.16b                    // ...................................................................*.............................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v8.16b, v26.16b                     // ................................................*................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aese v10.16b, v25.16b                    // ......................................................................*..........................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v8.16b, v2.16b                      // ...................................................*.............................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aese v3.16b, v25.16b                     // .............................................................................*...................................................................................................
        eor v26.16B, v0.16B, v10.16B             // ...........................................................................*.....................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        add v0.4S, v31.4S, v30.4S                // ............................................................................*....................................................................................................
        aesr v6.16b, v2.16b                      // ..........................................................................*......................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        eor v3.16B, v15.16B, v3.16B              // ................................................................................*................................................................................................
        aesr v8.16b, v28.16b                     // ........................................................*........................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        str q26, [x2, #48]                       // ...............................................................................*.................................................................................................
        aesr v6.16b, v28.16b                     // ..............................................................................*..................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        str q3, [x2, #32]                        // ....................................................................................*............................................................................................
        aesr v8.16b, v17.16b                     // .................................................................................*...............................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        ldr q4, [x6, #32]                        // ........................................................................................*........................................................................................
        aesr v6.16b, v17.16b                     // ..................................................................................*..............................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v8.16b, v13.16b                     // .....................................................................................*...........................................................................................
        rev64 v10.16B, v26.16B                   // ...................................................................................*.............................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v6.16b, v13.16b                     // ......................................................................................*..........................................................................................
        rev64 v15.16B, v3.16B                    // .......................................................................................*.........................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        ldr q13, [x5, #176]                      // ..............................................................................................................................................*..................................
        aesr v8.16b, v14.16b                     // .........................................................................................*.......................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v6.16b, v14.16b                     // ..........................................................................................*......................................................................................
        ext v14.16B, v15.16B, v15.16B, #8        // ...........................................................................................*.....................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aese v8.16b, v25.16b                     // ............................................................................................*....................................................................................
        mov d26, v10.d[1]                        // .............................................................................................*...................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        eor v28.16B, v14.16B, v15.16B            // ...............................................................................................*.................................................................................
        aese v6.16b, v25.16b                     // ..............................................................................................*..................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        eor v25.16B, v5.16B, v8.16B              // ................................................................................................*................................................................................
        pmull2 v3.1q, v15.2d, v4.2d              // ......................................................................................................*..........................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        pmull2 v17.1q, v10.2d, v12.2d            // ..................................................................................................*..............................................................................
        eor v14.16B, v29.16B, v6.16B             // ...................................................................................................*.............................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        pmull v29.1q, v15.1d, v4.1d              // ....................................................................................................*............................................................................
        rev64 v5.16B, v25.16B                    // .....................................................................................................*...........................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        pmull2 v28.1q, v28.2d, v9.2d             // .........................................................................................................*.......................................................................
        rev64 v6.16B, v14.16B                    // .......................................................................................................*.........................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        eor v4.16B, v5.16B, v11.16B              // ........................................................................................................*........................................................................
        pmull v2.1q, v10.1d, v12.1d              // .................................................................................................*...............................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        mov d15, v6.d[1]                         // ...........................................................................................................*.....................................................................
        pmull v8.1q, v6.1d, v1.1d                // ..........................................................................................................*......................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        ext v5.16B, v4.16B, v4.16B, #8           // .............................................................................................................*...................................................................
        pmull2 v11.1q, v6.2d, v1.2d              // .................................................................................................................*...............................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        eor v12.8B, v15.8B, v6.8B                // ...............................................................................................................*.................................................................
        pmull2 v15.1q, v4.2d, v16.2d             // ............................................................................................................*....................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        eor v6.16B, v5.16B, v4.16B               // ................................................................................................................*................................................................
        pmull v1.1q, v4.1d, v16.1d               // ..............................................................................................................*..................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        pmull v12.1q, v12.1d, v27.1d             // ...................................................................................................................*.............................................................
        rev32 v4.16B, v31.16B                    // ..................................................................................................................*..............................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        eor v31.8B, v26.8B, v10.8B               // .....................................................................................................................*...........................................................
        pmull2 v10.1q, v6.2d, v27.2d             // ....................................................................................................................*............................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        eor v6.16B, v1.16B, v8.16B               // ......................................................................................................................*..........................................................
        aesr v4.16b, v18.16b                     // .......................................................................................................................*.........................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        pmull v16.1q, v31.1d, v9.1d              // ........................................................................................................................*........................................................
        rev32 v8.16B, v0.16B                     // .........................................................................................................................*.......................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v4.16b, v19.16b                     // ...........................................................................................................................*.....................................................
        eor v31.16B, v10.16B, v12.16B            // ..........................................................................................................................*......................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v8.16b, v18.16b                     // .............................................................................................................................*...................................................
        eor v27.16B, v15.16B, v11.16B            // ............................................................................................................................*....................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v4.16b, v20.16b                     // ...............................................................................................................................*.................................................
        eor v1.16B, v31.16B, v28.16B             // ..............................................................................................................................*..................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v8.16b, v19.16b                     // .................................................................................................................................*...............................................
        eor v5.16B, v27.16B, v3.16B              // ................................................................................................................................*................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        eor v9.16B, v1.16B, v16.16B              // ...................................................................................................................................*.............................................
        aesr v4.16b, v21.16b                     // ..................................................................................................................................*..............................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v8.16b, v20.16b                     // .....................................................................................................................................*...........................................
        eor v3.16B, v5.16B, v17.16B              // ....................................................................................................................................*............................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v4.16b, v22.16b                     // ......................................................................................................................................*..........................................
        add v15.4S, v0.4S, v30.4S                // .......................................................................................................................................*.........................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v8.16b, v21.16b                     // .........................................................................................................................................*.......................................
        eor v29.16B, v6.16B, v29.16B             // ........................................................................................................................................*........................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        rev32 v12.16B, v15.16B                   // ..........................................................................................................................................*......................................
        pmull v27.1q, v3.1d, v7.1d               // ...........................................................................................................................................*.....................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        eor v10.16B, v29.16B, v2.16B             // ............................................................................................................................................*....................................
        aesr v8.16b, v22.16b                     // .............................................................................................................................................*...................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        add v31.4S, v15.4S, v30.4S               // ................................................................................................................................................*................................
        aesr v12.16b, v18.16b                    // ...............................................................................................................................................*.................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        str q14, [x2, #16]                       // ..................................................................................................................................................*..............................
        aesr v8.16b, v23.16b                     // .................................................................................................................................................*...............................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        rev32 v1.16B, v31.16B                    // .....................................................................................................................................................*...........................
        aesr v12.16b, v19.16b                    // ...................................................................................................................................................*.............................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v8.16b, v24.16b                     // ....................................................................................................................................................*............................
        eor v16.16B, v10.16B, v3.16B             // .......................................................................................................................................................*.........................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        ext v15.16B, v3.16B, v3.16B, #8          // ........................................................................................................................................................*........................
        aesr v12.16b, v20.16b                    // ......................................................................................................................................................*..........................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        eor v16.16B, v9.16B, v16.16B             // ............................................................................................................................................................*....................
        aesr v1.16b, v18.16b                     // .........................................................................................................................................................*.......................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v12.16b, v21.16b                    // ...........................................................................................................................................................*.....................
        eor v2.16B, v15.16B, v27.16B             // ................................................................................................................................................................*................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v1.16b, v19.16b                     // .............................................................................................................................................................*...................
        ldr q6, [x6, #64]                        // ..........................................................................................................................................................*......................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        eor v27.16B, v16.16B, v2.16B             // ....................................................................................................................................................................*............
        aesr v12.16b, v22.16b                    // ...............................................................................................................................................................*.................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v1.16b, v20.16b                     // .................................................................................................................................................................*...............
        ldr q26, [x5, #144]                      // ..............................................................................................................................................................*..................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        ldr q11, [x5, #112]                      // ...................................................................................................................................................................*.............
        pmull v15.1q, v27.1d, v7.1d              // ........................................................................................................................................................................*........
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v1.16b, v21.16b                     // .....................................................................................................................................................................*...........
        ext v17.16B, v27.16B, v27.16B, #8        // .........................................................................................................................................................................*.......
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v12.16b, v23.16b                    // ..................................................................................................................................................................*..............
        eor v10.16B, v10.16B, v15.16B            // ............................................................................................................................................................................*....
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        ldr q28, [x5, #224]                      // ......................................................................................................................................................................*..........
        aesr v1.16b, v22.16b                     // ..........................................................................................................................................................................*......
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        ldr q14, [x0, #32]                       // ...........................................................................................................................................................................*.....
        aesr v12.16b, v24.16b                    // .......................................................................................................................................................................*.........
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v8.16b, v11.16b                     // .............................................................................................................................................................................*...
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v12.16b, v11.16b                    // ..............................................................................................................................................................................*..
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................
        aesr v1.16b, v23.16b                     // ................................................................................................................................................................................*
        eor v17.16B, v10.16B, v17.16B            // ...............................................................................................................................................................................*.
        // gap                                   // .................................................................................................................................................................................
        // gap                                   // .................................................................................................................................................................................

        // original source code
        // add V<ssa_18>.4S, v31.4S, v30.4S                            // *................................................................................................................................................................................
        // rev32 V<ssa_44>.16B, v31.16B                                // ..*..............................................................................................................................................................................
        // aesr V<ssa_44>.16b, v18.16b                                 // .......*.........................................................................................................................................................................
        // rev32 V<ssa_50>.16B, V<ssa_18>.16B                          // ....*............................................................................................................................................................................
        // aesr V<ssa_44>.16b, v19.16b                                 // ..........*......................................................................................................................................................................
        // aesr V<ssa_50>.16b, v18.16b                                 // ........*........................................................................................................................................................................
        // aesr V<ssa_44>.16b, v20.16b                                 // ...............*.................................................................................................................................................................
        // aesr V<ssa_50>.16b, v19.16b                                 // .............*...................................................................................................................................................................
        // aesr V<ssa_44>.16b, v21.16b                                 // ...................*.............................................................................................................................................................
        // aesr V<ssa_50>.16b, v20.16b                                 // .................*...............................................................................................................................................................
        // aesr V<ssa_44>.16b, v22.16b                                 // ......................*..........................................................................................................................................................
        // add V<ssa_57>.4S, V<ssa_18>.4S, v30.4S                      // .........................*.......................................................................................................................................................
        // aesr V<ssa_50>.16b, v21.16b                                 // ....................*............................................................................................................................................................
        // rev32 V<ssa_59>.16B, V<ssa_57>.16B                          // ............................*....................................................................................................................................................
        // aesr V<ssa_50>.16b, v22.16b                                 // ........................*........................................................................................................................................................
        // ldr Q<ssa_62>, [x5, #176]                                   // .*...............................................................................................................................................................................
        // aesr V<ssa_59>.16b, v18.16b                                 // ................................*................................................................................................................................................
        // add V<ssa_63>.4S, V<ssa_57>.4S, v30.4S                      // ..............................*..................................................................................................................................................
        // aesr V<ssa_50>.16b, v23.16b                                 // .............................*...................................................................................................................................................
        // aesr V<ssa_59>.16b, v19.16b                                 // .....................................*...........................................................................................................................................
        // aesr V<ssa_50>.16b, v24.16b                                 // ..................................*..............................................................................................................................................
        // rev32 V<ssa_64>.16B, V<ssa_63>.16B                          // ...................................*.............................................................................................................................................
        // aesr V<ssa_59>.16b, v20.16b                                 // ........................................*........................................................................................................................................
        // aesr V<ssa_64>.16b, v18.16b                                 // ......................................*..........................................................................................................................................
        // ldr Q<ssa_67>, [x6, #64]                                    // ...*.............................................................................................................................................................................
        // aesr V<ssa_59>.16b, v21.16b                                 // ............................................*....................................................................................................................................
        // aesr V<ssa_64>.16b, v19.16b                                 // ..........................................*......................................................................................................................................
        // ldr Q<ssa_69>, [x5, #144]                                   // .....*...........................................................................................................................................................................
        // aesr V<ssa_59>.16b, v22.16b                                 // ................................................*................................................................................................................................
        // aesr V<ssa_64>.16b, v20.16b                                 // ...............................................*.................................................................................................................................
        // aesr V<ssa_59>.16b, v23.16b                                 // ....................................................*............................................................................................................................
        // ldr Q<ssa_71>, [x5, #112]                                   // ......*..........................................................................................................................................................................
        // aesr V<ssa_64>.16b, v21.16b                                 // ...................................................*.............................................................................................................................
        // ldr Q<ssa_73>, [x5, #224]                                   // .........*.......................................................................................................................................................................
        // aesr V<ssa_59>.16b, v24.16b                                 // ......................................................*..........................................................................................................................
        // aesr V<ssa_64>.16b, v22.16b                                 // .....................................................*...........................................................................................................................
        // ldr Q<ssa_76>, [x0, #32]                                    // ...........*.....................................................................................................................................................................
        // aesr V<ssa_50>.16b, V<ssa_71>.16b                           // ....................................................................*............................................................................................................
        // aesr V<ssa_59>.16b, V<ssa_71>.16b                           // ........................................................*........................................................................................................................
        // aesr V<ssa_64>.16b, v23.16b                                 // .......................................................*.........................................................................................................................
        // ldr Q<ssa_79>, [x5, #128]                                   // ............*....................................................................................................................................................................
        // aesr V<ssa_44>.16b, v23.16b                                 // ...........................*.....................................................................................................................................................
        // ldr Q<ssa_80>, [x0], #(4*16)                                // ..............*..................................................................................................................................................................
        // aesr V<ssa_64>.16b, v24.16b                                 // .........................................................*.......................................................................................................................
        // aesr V<ssa_44>.16b, v24.16b                                 // ...............................*.................................................................................................................................................
        // ldr Q<ssa_81>, [x5, #160]                                   // ................*................................................................................................................................................................
        // aesr V<ssa_64>.16b, V<ssa_71>.16b                           // ...........................................................*.....................................................................................................................
        // ldr Q<ssa_82>, [x5, #192]                                   // ..................*..............................................................................................................................................................
        // aesr V<ssa_44>.16b, V<ssa_71>.16b                           // ......................................................................*..........................................................................................................
        // ldr Q<ssa_84>, [x0, #-48]                                   // .....................*...........................................................................................................................................................
        // aesr V<ssa_64>.16b, V<ssa_79>.16b                           // .............................................................*...................................................................................................................
        // aesr V<ssa_44>.16b, V<ssa_79>.16b                           // ........................................................................*........................................................................................................
        // ldr Q<ssa_85>, [x0, #-16]                                   // .......................*.........................................................................................................................................................
        // ldr Q<ssa_86>, [x5, #208]                                   // ..........................*......................................................................................................................................................
        // aesr V<ssa_64>.16b, V<ssa_69>.16b                           // ...............................................................*.................................................................................................................
        // ldr Q<ssa_87>, [x6, #80]                                    // .................................*...............................................................................................................................................
        // aesr V<ssa_44>.16b, V<ssa_69>.16b                           // ..............................................................................*..................................................................................................
        // eor V<ssa_88>.16B, V<ssa_80>.16B, V<ssa_73>.16B             // ....................................*............................................................................................................................................
        // aesr V<ssa_59>.16b, V<ssa_79>.16b                           // ..........................................................*......................................................................................................................
        // eor V<ssa_89>.16B, V<ssa_84>.16B, V<ssa_73>.16B             // .......................................*.........................................................................................................................................
        // aesr V<ssa_64>.16b, V<ssa_81>.16b                           // .................................................................*...............................................................................................................
        // aesr V<ssa_59>.16b, V<ssa_69>.16b                           // ............................................................*....................................................................................................................
        // ldr Q<ssa_90>, [x6, #16]                                    // ..............................................*..................................................................................................................................
        // aesr V<ssa_64>.16b, V<ssa_62>.16b                           // ...................................................................*.............................................................................................................
        // eor V<ssa_91>.16B, V<ssa_85>.16B, V<ssa_73>.16B             // .........................................*.......................................................................................................................................
        // aesr V<ssa_59>.16b, V<ssa_81>.16b                           // ..............................................................*..................................................................................................................
        // ldr Q<ssa_92>, [x6, #48]                                    // .................................................*...............................................................................................................................
        // aesr V<ssa_64>.16b, V<ssa_82>.16b                           // .....................................................................*...........................................................................................................
        // aesr V<ssa_59>.16b, V<ssa_62>.16b                           // ................................................................*................................................................................................................
        // ldr Q<ssa_93>, [x6]                                         // ..................................................*..............................................................................................................................
        // aese V<ssa_64>.16b, V<ssa_86>.16b                           // .......................................................................*.........................................................................................................
        // add V<ssa_94>.4S, V<ssa_63>.4S, v30.4S                      // ...........................................*.....................................................................................................................................
        // aesr V<ssa_59>.16b, V<ssa_82>.16b                           // ..................................................................*..............................................................................................................
        // eor V<ssa_95>.16B, V<ssa_76>.16B, V<ssa_73>.16B             // .............................................*...................................................................................................................................
        // aesr V<ssa_50>.16b, V<ssa_79>.16b                           // ............................................................................*....................................................................................................
        // eor V<ssa_96>.16B, V<ssa_91>.16B, V<ssa_64>.16B             // ..........................................................................*......................................................................................................
        // add V<ssa_97>.4S, V<ssa_94>.4S, v30.4S                      // ...........................................................................*.....................................................................................................
        // aese V<ssa_59>.16b, V<ssa_86>.16b                           // .........................................................................*.......................................................................................................
        // aesr V<ssa_50>.16b, V<ssa_69>.16b                           // ................................................................................*................................................................................................
        // str Q<ssa_96>, [x2, #48]                                    // ...............................................................................*.................................................................................................
        // eor V<ssa_98>.16B, V<ssa_95>.16B, V<ssa_59>.16B             // .............................................................................*...................................................................................................
        // aesr V<ssa_44>.16b, V<ssa_81>.16b                           // ..................................................................................*..............................................................................................
        // aesr V<ssa_50>.16b, V<ssa_81>.16b                           // ....................................................................................*............................................................................................
        // rev64 V<ssa_99>.16B, V<ssa_96>.16B                          // ......................................................................................*..........................................................................................
        // str Q<ssa_98>, [x2, #32]                                    // .................................................................................*...............................................................................................
        // aesr V<ssa_44>.16b, V<ssa_62>.16b                           // .....................................................................................*...........................................................................................
        // aesr V<ssa_50>.16b, V<ssa_62>.16b                           // .......................................................................................*.........................................................................................
        // rev64 V<ssa_100>.16B, V<ssa_98>.16B                         // ........................................................................................*........................................................................................
        // ldr Q<ssa_101>, [x6, #32]                                   // ...................................................................................*.............................................................................................
        // aesr V<ssa_44>.16b, V<ssa_82>.16b                           // ..........................................................................................*......................................................................................
        // aesr V<ssa_50>.16b, V<ssa_82>.16b                           // ...........................................................................................*.....................................................................................
        // ext V<ssa_102>.16B, V<ssa_100>.16B, V<ssa_100>.16B, #8      // ............................................................................................*....................................................................................
        // aese V<ssa_44>.16b, V<ssa_86>.16b                           // .............................................................................................*...................................................................................
        // mov D<ssa_103>, V<ssa_99>.d[1]                              // ..............................................................................................*..................................................................................
        // aese V<ssa_50>.16b, V<ssa_86>.16b                           // ................................................................................................*................................................................................
        // eor V<ssa_104>.16B, V<ssa_102>.16B, V<ssa_100>.16B          // ...............................................................................................*.................................................................................
        // eor v25.16B, V<ssa_88>.16B, V<ssa_44>.16B                   // .................................................................................................*...............................................................................
        // pmull V<ssa_105>.1q, V<ssa_99>.1d, V<ssa_93>.1d             // ..........................................................................................................*......................................................................
        // pmull2 V<ssa_106>.1q, V<ssa_99>.2d, V<ssa_93>.2d            // ...................................................................................................*.............................................................................
        // eor V<ssa_107>.16B, V<ssa_89>.16B, V<ssa_50>.16B            // ....................................................................................................*............................................................................
        // pmull V<ssa_108>.1q, V<ssa_100>.1d, V<ssa_101>.1d           // .....................................................................................................*...........................................................................
        // rev64 V<ssa_109>.16B, v25.16B                               // ......................................................................................................*..........................................................................
        // pmull2 V<ssa_110>.1q, V<ssa_100>.2d, V<ssa_101>.2d          // ..................................................................................................*..............................................................................
        // rev64 V<ssa_111>.16B, V<ssa_107>.16B                        // ........................................................................................................*........................................................................
        // eor V<ssa_112>.16B, V<ssa_109>.16B, v11.16B                 // .........................................................................................................*.......................................................................
        // pmull2 V<ssa_113>.1q, V<ssa_104>.2d, V<ssa_90>.2d           // .......................................................................................................*.........................................................................
        // pmull V<ssa_114>.1q, V<ssa_111>.1d, V<ssa_92>.1d            // ............................................................................................................*....................................................................
        // mov D<ssa_115>, V<ssa_111>.d[1]                             // ...........................................................................................................*.....................................................................
        // pmull2 V<ssa_116>.1q, V<ssa_112>.2d, V<ssa_87>.2d           // ................................................................................................................*................................................................
        // ext V<ssa_117>.16B, V<ssa_112>.16B, V<ssa_112>.16B, #8      // .............................................................................................................*...................................................................
        // pmull V<ssa_118>.1q, V<ssa_112>.1d, V<ssa_87>.1d            // ..................................................................................................................*..............................................................
        // eor V<ssa_119>.8B, V<ssa_115>.8B, V<ssa_111>.8B             // ...............................................................................................................*.................................................................
        // eor V<ssa_120>.16B, V<ssa_117>.16B, V<ssa_112>.16B          // .................................................................................................................*...............................................................
        // pmull2 V<ssa_121>.1q, V<ssa_111>.2d, V<ssa_92>.2d           // ..............................................................................................................*..................................................................
        // rev32 v4.16B, V<ssa_94>.16B                                 // ....................................................................................................................*............................................................
        // pmull V<ssa_122>.1q, V<ssa_119>.1d, V<ssa_67>.1d            // ...................................................................................................................*.............................................................
        // pmull2 V<ssa_123>.1q, V<ssa_120>.2d, V<ssa_67>.2d           // ......................................................................................................................*..........................................................
        // eor V<ssa_124>.8B, V<ssa_103>.8B, V<ssa_99>.8B              // .....................................................................................................................*...........................................................
        // eor V<ssa_125>.16B, V<ssa_118>.16B, V<ssa_114>.16B          // .......................................................................................................................*.........................................................
        // aesr v4.16b, v18.16b                                        // ........................................................................................................................*........................................................
        // pmull V<ssa_126>.1q, V<ssa_124>.1d, V<ssa_90>.1d            // .........................................................................................................................*.......................................................
        // rev32 v8.16B, V<ssa_97>.16B                                 // ..........................................................................................................................*......................................................
        // eor V<ssa_127>.16B, V<ssa_123>.16B, V<ssa_122>.16B          // ............................................................................................................................*....................................................
        // aesr v4.16b, v19.16b                                        // ...........................................................................................................................*.....................................................
        // eor V<ssa_128>.16B, V<ssa_116>.16B, V<ssa_121>.16B          // ..............................................................................................................................*..................................................
        // aesr v8.16b, v18.16b                                        // .............................................................................................................................*...................................................
        // eor V<ssa_129>.16B, V<ssa_127>.16B, V<ssa_113>.16B          // ................................................................................................................................*................................................
        // aesr v4.16b, v20.16b                                        // ...............................................................................................................................*.................................................
        // eor V<ssa_130>.16B, V<ssa_128>.16B, V<ssa_110>.16B          // ..................................................................................................................................*..............................................
        // aesr v8.16b, v19.16b                                        // .................................................................................................................................*...............................................
        // aesr v4.16b, v21.16b                                        // ....................................................................................................................................*............................................
        // eor V<ssa_131>.16B, V<ssa_129>.16B, V<ssa_126>.16B          // ...................................................................................................................................*.............................................
        // eor V<ssa_132>.16B, V<ssa_130>.16B, V<ssa_106>.16B          // ......................................................................................................................................*..........................................
        // aesr v8.16b, v20.16b                                        // .....................................................................................................................................*...........................................
        // aesr v4.16b, v22.16b                                        // .......................................................................................................................................*.........................................
        // add V<ssa_133>.4S, V<ssa_97>.4S, v30.4S                     // ........................................................................................................................................*........................................
        // eor V<ssa_134>.16B, V<ssa_125>.16B, V<ssa_108>.16B          // ..........................................................................................................................................*......................................
        // aesr v8.16b, v21.16b                                        // .........................................................................................................................................*.......................................
        // rev32 v12.16B, V<ssa_133>.16B                               // ...........................................................................................................................................*.....................................
        // pmull V<ssa_135>.1q, V<ssa_132>.1d, v7.1d                   // ............................................................................................................................................*....................................
        // eor V<ssa_136>.16B, V<ssa_134>.16B, V<ssa_105>.16B          // .............................................................................................................................................*...................................
        // aesr v8.16b, v22.16b                                        // ..............................................................................................................................................*..................................
        // ldr q13, [x5, #176]                                         // .........................................................................................*.......................................................................................
        // aesr v12.16b, v18.16b                                       // ................................................................................................................................................*................................
        // add v31.4S, V<ssa_133>.4S, v30.4S                           // ...............................................................................................................................................*.................................
        // aesr v8.16b, v23.16b                                        // ..................................................................................................................................................*..............................
        // str Q<ssa_107>, [x2, #16]                                   // .................................................................................................................................................*...............................
        // aesr v12.16b, v19.16b                                       // ....................................................................................................................................................*............................
        // aesr v8.16b, v24.16b                                        // .....................................................................................................................................................*...........................
        // rev32 v1.16B, v31.16B                                       // ...................................................................................................................................................*.............................
        // aesr v12.16b, v20.16b                                       // ........................................................................................................................................................*........................
        // eor V<ssa_137>.16B, V<ssa_136>.16B, V<ssa_132>.16B          // ......................................................................................................................................................*..........................
        // ext V<ssa_138>.16B, V<ssa_132>.16B, V<ssa_132>.16B, #8      // .......................................................................................................................................................*.........................
        // aesr v1.16b, v18.16b                                        // ..........................................................................................................................................................*......................
        // ldr q6, [x6, #64]                                           // ..............................................................................................................................................................*..................
        // aesr v12.16b, v21.16b                                       // ...........................................................................................................................................................*.....................
        // eor V<ssa_139>.16B, V<ssa_131>.16B, V<ssa_137>.16B          // .........................................................................................................................................................*.......................
        // aesr v1.16b, v19.16b                                        // .............................................................................................................................................................*...................
        // ldr q26, [x5, #144]                                         // ..................................................................................................................................................................*..............
        // aesr v12.16b, v22.16b                                       // ................................................................................................................................................................*................
        // eor V<ssa_140>.16B, V<ssa_138>.16B, V<ssa_135>.16B          // ............................................................................................................................................................*....................
        // aesr v1.16b, v20.16b                                        // .................................................................................................................................................................*...............
        // aesr v12.16b, v23.16b                                       // .......................................................................................................................................................................*.........
        // ldr q11, [x5, #112]                                         // ...................................................................................................................................................................*.............
        // eor V<ssa_141>.16B, V<ssa_139>.16B, V<ssa_140>.16B          // ...............................................................................................................................................................*.................
        // aesr v1.16b, v21.16b                                        // .....................................................................................................................................................................*...........
        // ldr q28, [x5, #224]                                         // .........................................................................................................................................................................*.......
        // aesr v12.16b, v24.16b                                       // ............................................................................................................................................................................*....
        // pmull V<ssa_142>.1q, V<ssa_141>.1d, v7.1d                   // ....................................................................................................................................................................*............
        // ext V<ssa_143>.16B, V<ssa_141>.16B, V<ssa_141>.16B, #8      // ......................................................................................................................................................................*..........
        // aesr v1.16b, v22.16b                                        // ..........................................................................................................................................................................*......
        // ldr q14, [x0, #32]                                          // ...........................................................................................................................................................................*.....
        // eor V<ssa_144>.16B, V<ssa_136>.16B, V<ssa_142>.16B          // ........................................................................................................................................................................*........
        // aesr v8.16b, v11.16b                                        // .............................................................................................................................................................................*...
        // aesr v12.16b, v11.16b                                       // ..............................................................................................................................................................................*..
        // eor v17.16B, V<ssa_144>.16B, V<ssa_143>.16B                 // ................................................................................................................................................................................*
        // aesr v1.16b, v23.16b                                        // ...............................................................................................................................................................................*.

        sub count, count, #2
cbz count, Lloop_unrolled_start_postamble
Lloop_unrolled_start:
        // Instructions:    139
        // Expected cycles: 70
        // Expected IPC:    0.5035971223021583
        ldr q5, [x5, #128]                       // .*.........................................................................................................................................
        aesr v4.16b, v23.16b                     // ................*..........................................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        ldr q16, [x0], #(4*16)                   // ........*..................................................................................................................................
        aesr v1.16b, v24.16b                     // ............................................................................................................*..............................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v4.16b, v24.16b                     // .................*.........................................................................................................................
        ldr q2, [x5, #160]                       // ...*.......................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v1.16b, v11.16b                     // .............................................................................................................*.............................
        ldr q27, [x5, #192]                      // .....*.....................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v4.16b, v11.16b                     // ..................*........................................................................................................................
        ext v11.16B, v17.16B, v17.16B, #8        // ..........................................................................................................................................l
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        ldr q17, [x0, #-48]                      // ......................................*....................................................................................................
        aesr v1.16b, v5.16b                      // ..............................................................................................................*............................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v4.16b, v5.16b                      // ...................*.......................................................................................................................
        ldr q0, [x0, #-16]                       // ...................................................................................................*.......................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        ldr q15, [x5, #208]                      // ......*....................................................................................................................................
        aesr v1.16b, v26.16b                     // ...............................................................................................................*...........................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        ldr q29, [x6, #80]                       // .............................*.............................................................................................................
        aesr v4.16b, v26.16b                     // ....................*......................................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v16.16B, v16.16B, v28.16B            // .........................*.................................................................................................................
        aesr v12.16b, v5.16b                     // ..............................................................................*............................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v10.16B, v17.16B, v28.16B            // .......................................................*...................................................................................
        aesr v1.16b, v2.16b                      // ................................................................................................................*..........................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v12.16b, v26.16b                    // ...............................................................................*...........................................................
        ldr q9, [x6, #16]                        // .........................................................................................*.................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v1.16b, v13.16b                     // .................................................................................................................*.........................
        str q25, [x2], #(4*16)                   // ...........................l...............................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v25.16B, v0.16B, v28.16B             // ....................................................................................................................*......................
        aesr v12.16b, v2.16b                     // ................................................................................*..........................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        ldr q0, [x6, #48]                        // ............................*..............................................................................................................
        aesr v1.16b, v27.16b                     // ..................................................................................................................*........................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v12.16b, v13.16b                    // .................................................................................*.........................................................
        ldr q3, [x6]                             // .......................................................................................*...................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aese v1.16b, v15.16b                     // ...................................................................................................................*.......................
        add v31.4S, v31.4S, v30.4S               // .....................................................................................................*.....................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v12.16b, v27.16b                    // ..................................................................................*........................................................
        eor v14.16B, v14.16B, v28.16B            // ....................................................................................*......................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v8.16b, v5.16b                      // .................................................*.........................................................................................
        eor v25.16B, v25.16B, v1.16B             // .....................................................................................................................*.....................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        add v5.4S, v31.4S, v30.4S                // ..........e................................................................................................................................
        aese v12.16b, v15.16b                    // ...................................................................................*.......................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v8.16b, v26.16b                     // ..................................................*........................................................................................
        str q25, [x2, #48]                       // ......................................................................................................................*....................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v28.16B, v14.16B, v12.16B            // .....................................................................................*.....................................................
        aesr v4.16b, v2.16b                      // .....................*.....................................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v8.16b, v2.16b                      // ...................................................*.......................................................................................
        rev64 v2.16B, v25.16B                    // .......................................................................................................................*...................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        str q28, [x2, #32]                       // ......................................................................................*....................................................
        aesr v4.16b, v13.16b                     // ......................*....................................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v8.16b, v13.16b                     // ....................................................*......................................................................................
        rev64 v17.16B, v28.16B                   // ..........................................................................................*................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        ldr q13, [x6, #32]                       // ........................................................................................*..................................................
        aesr v4.16b, v27.16b                     // .......................*...................................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v8.16b, v27.16b                     // .....................................................*.....................................................................................
        ext v26.16B, v17.16B, v17.16B, #8        // ...............................................................................................*...........................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aese v4.16b, v15.16b                     // ........................*..................................................................................................................
        mov d28, v2.d[1]                         // ............................................................................................................................*..............
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aese v8.16b, v15.16b                     // ......................................................*....................................................................................
        eor v15.16B, v26.16B, v17.16B            // ................................................................................................*..........................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v25.16B, v16.16B, v4.16B             // ..........................*................................................................................................................
        pmull v16.1q, v2.1d, v3.1d               // ........................................................................................................................*..................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        pmull2 v27.1q, v2.2d, v3.2d              // ..........................................................................................................................*................
        eor v10.16B, v10.16B, v8.16B             // ........................................................*..................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        pmull v12.1q, v17.1d, v13.1d             // ...........................................................................................*...............................................
        rev64 v26.16B, v25.16B                   // ...............................*...........................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        pmull2 v13.1q, v17.2d, v13.2d            // .............................................................................................*.............................................
        rev64 v4.16B, v10.16B                    // ..........................................................*................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v3.16B, v26.16B, v11.16B             // ................................*..........................................................................................................
        pmull2 v14.1q, v15.2d, v9.2d             // .................................................................................................*.........................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        pmull v17.1q, v4.1d, v0.1d               // ...........................................................*...............................................................................
        mov d26, v4.d[1]                         // ...............................................................*...........................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        pmull2 v15.1q, v3.2d, v29.2d             // ..................................*........................................................................................................
        ext v8.16B, v3.16B, v3.16B, #8           // ...................................*.......................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        pmull v11.1q, v3.1d, v29.1d              // .................................*.........................................................................................................
        eor v29.8B, v26.8B, v4.8B                // ................................................................*..........................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v8.16B, v8.16B, v3.16B               // ....................................*......................................................................................................
        pmull2 v3.1q, v4.2d, v0.2d               // .............................................................*.............................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        rev32 v4.16B, v31.16B                    // .........e.................................................................................................................................
        pmull v29.1q, v29.1d, v6.1d              // .................................................................*.........................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        pmull2 v31.1q, v8.2d, v6.2d              // .....................................*.....................................................................................................
        eor v6.8B, v28.8B, v2.8B                 // .............................................................................................................................*.............
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v26.16B, v11.16B, v17.16B            // ............................................................*..............................................................................
        aesr v4.16b, v18.16b                     // ...........e...............................................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        pmull v1.1q, v6.1d, v9.1d                // ..............................................................................................................................*............
        rev32 v8.16B, v5.16B                     // .......................................e...................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v29.16B, v31.16B, v29.16B            // ..................................................................*........................................................................
        aesr v4.16b, v19.16b                     // ............e..............................................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v2.16B, v15.16B, v3.16B              // ..............................................................*............................................................................
        aesr v8.16b, v18.16b                     // .........................................e.................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v3.16B, v29.16B, v14.16B             // ..................................................................................................*........................................
        aesr v4.16b, v20.16b                     // .............e.............................................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v2.16B, v2.16B, v13.16B              // ..............................................................................................*............................................
        aesr v8.16b, v19.16b                     // ..........................................e................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v4.16b, v21.16b                     // ..............e............................................................................................................................
        eor v17.16B, v3.16B, v1.16B              // ...............................................................................................................................*...........
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v6.16B, v2.16B, v27.16B              // ...........................................................................................................................*...............
        aesr v8.16b, v20.16b                     // ...........................................e...............................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v4.16b, v22.16b                     // ...............e...........................................................................................................................
        add v3.4S, v5.4S, v30.4S                 // ........................................e..................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v13.16B, v26.16B, v12.16B            // ............................................................................................*..............................................
        aesr v8.16b, v21.16b                     // ............................................e..............................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        rev32 v12.16B, v3.16B                    // ....................................................................e......................................................................
        pmull v14.1q, v6.1d, v7.1d               // .................................................................................................................................*.........
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v15.16B, v13.16B, v16.16B            // .........................................................................................................................*.................
        aesr v8.16b, v22.16b                     // .............................................e.............................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        ldr q13, [x5, #176]                      // ....e......................................................................................................................................
        aesr v12.16b, v18.16b                    // ......................................................................e....................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        add v31.4S, v3.4S, v30.4S                // .....................................................................e.....................................................................
        aesr v8.16b, v23.16b                     // ..............................................e............................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        str q10, [x2, #16]                       // .........................................................*.................................................................................
        aesr v12.16b, v19.16b                    // .......................................................................e...................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v8.16b, v24.16b                     // ...............................................e...........................................................................................
        rev32 v1.16B, v31.16B                    // ....................................................................................................e......................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v12.16b, v20.16b                    // ........................................................................e..................................................................
        eor v10.16B, v15.16B, v6.16B             // ................................................................................................................................*..........
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        ext v16.16B, v6.16B, v6.16B, #8          // ..................................................................................................................................*........
        aesr v1.16b, v18.16b                     // ......................................................................................................e....................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        ldr q6, [x6, #64]                        // ..............................e............................................................................................................
        aesr v12.16b, v21.16b                    // .........................................................................e.................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v10.16B, v17.16B, v10.16B            // ...................................................................................................................................*.......
        aesr v1.16b, v19.16b                     // .......................................................................................................e...................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        ldr q26, [x5, #144]                      // ..e........................................................................................................................................
        aesr v12.16b, v22.16b                    // ..........................................................................e................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v5.16B, v16.16B, v14.16B             // ....................................................................................................................................*......
        aesr v1.16b, v20.16b                     // ........................................................................................................e..................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v12.16b, v23.16b                    // ...........................................................................e...............................................................
        ldr q11, [x5, #112]                      // e..........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v29.16B, v10.16B, v5.16B             // .....................................................................................................................................*.....
        aesr v1.16b, v21.16b                     // .........................................................................................................e.................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        ldr q28, [x5, #224]                      // .......e...................................................................................................................................
        aesr v12.16b, v24.16b                    // ............................................................................e..............................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        pmull v9.1q, v29.1d, v7.1d               // ......................................................................................................................................*....
        ext v16.16B, v29.16B, v29.16B, #8        // ........................................................................................................................................*..
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v1.16b, v22.16b                     // ..........................................................................................................e................................
        ldr q14, [x0, #32]                       // ...................................................................e.......................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v9.16B, v15.16B, v9.16B              // .......................................................................................................................................*...
        aesr v8.16b, v11.16b                     // ................................................e..........................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        aesr v12.16b, v11.16b                    // .............................................................................e.............................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................
        eor v17.16B, v9.16B, v16.16B             // .........................................................................................................................................*.
        aesr v1.16b, v23.16b                     // ...........................................................................................................e...............................
        // gap                                   // ...........................................................................................................................................
        // gap                                   // ...........................................................................................................................................

        // original source code
        // ldr q25, [x5, #((7)*16)]                        // .......................................................................................e.............|............................................................................................................................e.............|.........................
        // ldr q26, [x5, #((8)*16)]                        // .....................................................................................................*..........................................................................................................................................*.........................
        // ldr q27, [x5, #((9)*16)]                        // ..................................................................................e..................|.......................................................................................................................e..................|.........................
        // ldr q28, [x5, #((10)*16)]                       // .....................................................................................................|....*.....................................................................................................................................|....*....................
        // ldr q15, [x5, #((11)*16)]                       // ..................................................................e..................................|.......................................................................................................e..................................|.........................
        // ldr q16, [x5, #((12)*16)]                       // .....................................................................................................|......*...................................................................................................................................|......*..................
        // ldr q17, [x5, #((13)*16)]                       // .....................................................................................................|.............*............................................................................................................................|.............*...........
        // ldr q2, [x5, #((14)*16)]                        // ..........................................................................................e..........|...............................................................................................................................e..........|.........................
        // ldr q29, [x0], #(4*16)                          // .....................................................................................................|.*........................................................................................................................................|.*.......................
        // rev32  v0.16b, v31.16b                          // ......................................e..............................................................|...........................................................................e..............................................................|.........................
        // add    v31.4s, v31.4s, v30.4s                   // e....................................................................................................|.....................................e....................................................................................................|.........................
        // aesr v0.16b, v18.16b                            // ...........................................e.........................................................|................................................................................e.........................................................|.........................
        // aesr v0.16b, v19.16b                            // ...............................................e.....................................................|....................................................................................e.....................................................|.........................
        // aesr v0.16b, v20.16b                            // ...................................................e.................................................|........................................................................................e.................................................|.........................
        // aesr v0.16b, v21.16b                            // ......................................................e..............................................|...........................................................................................e..............................................|.........................
        // aesr v0.16b, v22.16b                            // ..........................................................e..........................................|...............................................................................................e..........................................|.........................
        // aesr v0.16b, v23.16b                            // .....................................................................................................|*.........................................................................................................................................|*........................
        // aesr v0.16b, v24.16b                            // .....................................................................................................|...*......................................................................................................................................|...*.....................
        // aesr v0.16b, v25.16b                            // .....................................................................................................|.......*..................................................................................................................................|.......*.................
        // aesr v0.16b, v26.16b                            // .....................................................................................................|...........*..............................................................................................................................|...........*.............
        // aesr v0.16b, v27.16b                            // .....................................................................................................|................*.........................................................................................................................|................*........
        // aesr v0.16b, v28.16b                            // .....*...............................................................................................|..........................................*...............................................................................................|.........................
        // aesr v0.16b, v15.16b                            // .........*...........................................................................................|..............................................*...........................................................................................|.........................
        // aesr v0.16b, v16.16b                            // .............*.......................................................................................|..................................................*.......................................................................................|.........................
        // aese v0.16b, v17.16b                            // ................*....................................................................................|.....................................................*....................................................................................|.........................
        // eor v29.16b, v29.16b, v2.16b                    // .....................................................................................................|.................*........................................................................................................................|.................*.......
        // eor v0.16b, v29.16b, v0.16b                     // ....................*................................................................................|.........................................................*................................................................................|.........................
        // str q0, [x2], #(4*16)                           // .....................................................................................................|........................l.................................................................................................................|........................l
        // ldr q12, [x6, #48]                              // .....................................................................................................|...........................*..............................................................................................................|.........................
        // ldr q13, [x6, #80]                              // .....................................................................................................|...............*..........................................................................................................................|...............*.........
        // ldr q14, [x6, #64]                              // ..............................................................................e......................|...................................................................................................................e......................|.........................
        // rev64 v0.16b, v0.16b                            // .........................*...........................................................................|..............................................................*...........................................................................|.........................
        // eor   v0.16b, v0.16b, v11.16b                   // ............................*........................................................................|.................................................................*........................................................................|.........................
        // pmull   v8.1q, v0.1d, v13.1d                    // ..................................*..................................................................|.......................................................................*..................................................................|.........................
        // pmull2  v9.1q, v0.2d, v13.2d                    // ................................*....................................................................|.....................................................................*....................................................................|.........................
        // ext     v11.16b, v0.16b, v0.16b, #8             // .................................*...................................................................|......................................................................*...................................................................|.........................
        // eor     v11.16b, v11.16b, v0.16b                // ....................................*................................................................|.........................................................................*................................................................|.........................
        // pmull2  v10.1q, v11.2d, v14.2d                  // ........................................*............................................................|.............................................................................*............................................................|.........................
        // ldr q29, [x0, #(-3*16)]                         // .....................................................................................................|.........*................................................................................................................................|.........*...............
        // rev32  v0.16b, v31.16b                          // .............................................e.......................................................|..................................................................................e.......................................................|.........................
        // add    v31.4s, v31.4s, v30.4s                   // ...........................................................e.........................................|................................................................................................e.........................................|.........................
        // aesr v0.16b, v18.16b                            // .................................................e...................................................|......................................................................................e...................................................|.........................
        // aesr v0.16b, v19.16b                            // .....................................................e...............................................|..........................................................................................e...............................................|.........................
        // aesr v0.16b, v20.16b                            // .........................................................e...........................................|..............................................................................................e...........................................|.........................
        // aesr v0.16b, v21.16b                            // .............................................................e.......................................|..................................................................................................e.......................................|.........................
        // aesr v0.16b, v22.16b                            // .................................................................e...................................|......................................................................................................e...................................|.........................
        // aesr v0.16b, v23.16b                            // .....................................................................e...............................|..........................................................................................................e...............................|.........................
        // aesr v0.16b, v24.16b                            // ........................................................................e............................|.............................................................................................................e............................|.........................
        // aesr v0.16b, v25.16b                            // .................................................................................................e...|......................................................................................................................................e...|.........................
        // aesr v0.16b, v26.16b                            // .....................................................................................................|...................................*......................................................................................................|.........................
        // aesr v0.16b, v27.16b                            // ..*..................................................................................................|.......................................*..................................................................................................|.........................
        // aesr v0.16b, v28.16b                            // ......*..............................................................................................|...........................................*..............................................................................................|.........................
        // aesr v0.16b, v15.16b                            // ..........*..........................................................................................|...............................................*..........................................................................................|.........................
        // aesr v0.16b, v16.16b                            // ..............*......................................................................................|...................................................*......................................................................................|.........................
        // aese v0.16b, v17.16b                            // ..................*..................................................................................|.......................................................*..................................................................................|.........................
        // eor v29.16b, v29.16b, v2.16b                    // .....................................................................................................|...................*......................................................................................................................|...................*.....
        // eor v0.16b, v29.16b, v0.16b                     // .......................*.............................................................................|............................................................*.............................................................................|.........................
        // str q0, [x2, #(-3*16)]                          // ......................................................................*..............................|...........................................................................................................*..............................|.........................
        // rev64   v0.16b, v0.16b                          // ...........................*.........................................................................|................................................................*.........................................................................|.........................
        // pmull   v11.1q, v0.1d, v12.1d                   // ..............................*......................................................................|...................................................................*......................................................................|.........................
        // eor     v8.16b, v8.16b, v11.16b                 // ..........................................*..........................................................|...............................................................................*..........................................................|.........................
        // pmull2  v11.1q, v0.2d, v12.2d                   // .....................................*...............................................................|..........................................................................*...............................................................|.........................
        // eor     v9.16b, v9.16b, v11.16b                 // ................................................*....................................................|.....................................................................................*....................................................|.........................
        // mov     d11, v0.d[1]                            // ...............................*.....................................................................|....................................................................*.....................................................................|.........................
        // eor     v11.8b, v11.8b, v0.8b                   // ...................................*.................................................................|........................................................................*.................................................................|.........................
        // pmull   v11.1q, v11.1d, v14.1d                  // .......................................*.............................................................|............................................................................*.............................................................|.........................
        // eor     v10.16b, v10.16b, v11.16b               // ..............................................*......................................................|...................................................................................*......................................................|.........................
        // ldr q29, [x0, #(-2*16)]                         // ...............................................................................................e.....|....................................................................................................................................e.....|.........................
        // rev32  v0.16b, v31.16b                          // ..............................................................e......................................|...................................................................................................e......................................|.........................
        // add    v31.4s, v31.4s, v30.4s                   // ....................................................................e................................|.........................................................................................................e................................|.........................
        // aesr v0.16b, v18.16b                            // ...................................................................e.................................|........................................................................................................e.................................|.........................
        // aesr v0.16b, v19.16b                            // .......................................................................e.............................|............................................................................................................e.............................|.........................
        // aesr v0.16b, v20.16b                            // ..........................................................................e..........................|...............................................................................................................e..........................|.........................
        // aesr v0.16b, v21.16b                            // ...............................................................................e.....................|....................................................................................................................e.....................|.........................
        // aesr v0.16b, v22.16b                            // ...................................................................................e.................|........................................................................................................................e.................|.........................
        // aesr v0.16b, v23.16b                            // ......................................................................................e..............|...........................................................................................................................e..............|.........................
        // aesr v0.16b, v24.16b                            // ...........................................................................................e.........|................................................................................................................................e.........|.........................
        // aesr v0.16b, v25.16b                            // ..................................................................................................e..|.......................................................................................................................................e..|.........................
        // aesr v0.16b, v26.16b                            // .....................................................................................................|..................*.......................................................................................................................|..................*......
        // aesr v0.16b, v27.16b                            // .....................................................................................................|.....................*....................................................................................................................|.....................*...
        // aesr v0.16b, v28.16b                            // .....................................................................................................|..........................*...............................................................................................................|.........................
        // aesr v0.16b, v15.16b                            // .....................................................................................................|.............................*............................................................................................................|.........................
        // aesr v0.16b, v16.16b                            // .....................................................................................................|.................................*........................................................................................................|.........................
        // aese v0.16b, v17.16b                            // .*...................................................................................................|......................................*...................................................................................................|.........................
        // eor v29.16b, v29.16b, v2.16b                    // .....................................................................................................|..................................*.......................................................................................................|.........................
        // eor v0.16b, v29.16b, v0.16b                     // ....*................................................................................................|.........................................*................................................................................................|.........................
        // str q0, [x2, #(-2*16)]                          // ........*............................................................................................|.............................................*............................................................................................|.........................
        // ldr q12, [x6]                                   // .....................................................................................................|..............................*...........................................................................................................|.........................
        // ldr q13, [x6, #32]                              // ............*........................................................................................|.................................................*........................................................................................|.........................
        // ldr q14, [x6, #16]                              // .....................................................................................................|......................*...................................................................................................................|......................*..
        // rev64   v0.16b, v0.16b                          // ...........*.........................................................................................|................................................*.........................................................................................|.........................
        // pmull   v11.1q, v0.1d, v13.1d                   // ........................*............................................................................|.............................................................*............................................................................|.........................
        // eor     v8.16b, v8.16b, v11.16b                 // ............................................................*........................................|.................................................................................................*........................................|.........................
        // pmull2  v11.1q, v0.2d, v13.2d                   // ..........................*..........................................................................|...............................................................*..........................................................................|.........................
        // eor     v9.16b, v9.16b, v11.16b                 // ....................................................*................................................|.........................................................................................*................................................|.........................
        // ext     v11.16b, v0.16b, v0.16b, #8             // ...............*.....................................................................................|....................................................*.....................................................................................|.........................
        // eor     v11.16b, v11.16b, v0.16b                // ...................*.................................................................................|........................................................*.................................................................................|.........................
        // pmull2  v11.1q, v11.2d, v14.2d                  // .............................*.......................................................................|..................................................................*.......................................................................|.........................
        // eor     v10.16b, v10.16b, v11.16b               // ..................................................*..................................................|.......................................................................................*..................................................|.........................
        // ldr q29, [x0, #(-1*16)]                         // .....................................................................................................|............*.............................................................................................................................|............*............
        // rev32  v0.16b, v31.16b                          // .........................................................................e...........................|..............................................................................................................e...........................|.........................
        // add    v31.4s, v31.4s, v30.4s                   // .....................................................................................................|................................*.........................................................................................................|.........................
        // aesr v0.16b, v18.16b                            // .............................................................................e.......................|..................................................................................................................e.......................|.........................
        // aesr v0.16b, v19.16b                            // .................................................................................e...................|......................................................................................................................e...................|.........................
        // aesr v0.16b, v20.16b                            // .....................................................................................e...............|..........................................................................................................................e...............|.........................
        // aesr v0.16b, v21.16b                            // .........................................................................................e...........|..............................................................................................................................e...........|.........................
        // aesr v0.16b, v22.16b                            // ..............................................................................................e......|...................................................................................................................................e......|.........................
        // aesr v0.16b, v23.16b                            // ....................................................................................................e|.........................................................................................................................................e|.........................
        // aesr v0.16b, v24.16b                            // .....................................................................................................|..*.......................................................................................................................................|..*......................
        // aesr v0.16b, v25.16b                            // .....................................................................................................|.....*....................................................................................................................................|.....*...................
        // aesr v0.16b, v26.16b                            // .....................................................................................................|..........*...............................................................................................................................|..........*..............
        // aesr v0.16b, v27.16b                            // .....................................................................................................|..............*...........................................................................................................................|..............*..........
        // aesr v0.16b, v28.16b                            // .....................................................................................................|....................*.....................................................................................................................|....................*....
        // aesr v0.16b, v15.16b                            // .....................................................................................................|.......................*..................................................................................................................|.......................*.
        // aesr v0.16b, v16.16b                            // .....................................................................................................|............................*.............................................................................................................|.........................
        // aese v0.16b, v17.16b                            // .....................................................................................................|...............................*..........................................................................................................|.........................
        // eor v29.16b, v29.16b, v2.16b                    // .....................................................................................................|.........................*................................................................................................................|.........................
        // eor v0.16b, v29.16b, v0.16b                     // .....................................................................................................|....................................*.....................................................................................................|.........................
        // str q0, [x2, #(-1*16)]                          // ...*.................................................................................................|........................................*.................................................................................................|.........................
        // rev64   v0.16b, v0.16b                          // .......*.............................................................................................|............................................*.............................................................................................|.........................
        // pmull   v11.1q, v0.1d, v12.1d                   // .....................*...............................................................................|..........................................................*...............................................................................|.........................
        // eor     v8.16b, v8.16b, v11.16b                 // ................................................................*....................................|.....................................................................................................*....................................|.........................
        // pmull2  v11.1q, v0.2d, v12.2d                   // ......................*..............................................................................|...........................................................*..............................................................................|.........................
        // eor     v9.16b, v9.16b, v11.16b                 // ........................................................*............................................|.............................................................................................*............................................|.........................
        // mov     d11, v0.d[1]                            // .................*...................................................................................|......................................................*...................................................................................|.........................
        // eor     v11.8b, v11.8b, v0.8b                   // .........................................*...........................................................|..............................................................................*...........................................................|.........................
        // pmull   v11.1q, v11.1d, v14.1d                  // ............................................*........................................................|.................................................................................*........................................................|.........................
        // eor     v10.16b, v10.16b, v11.16b               // .......................................................*.............................................|............................................................................................*.............................................|.........................
        // eor        v0.16b, v8.16b,  v9.16b              // ...........................................................................*.........................|................................................................................................................*.........................|.........................
        // pmull      v1.1q,  v9.1d,   v7.1d               // ...............................................................*.....................................|....................................................................................................*.....................................|.........................
        // ext        v9.16b,    v9.16b,  v9.16b, #8       // ............................................................................*........................|.................................................................................................................*........................|.........................
        // eor        v10.16b,   v10.16b, v0.16b           // ................................................................................*....................|.....................................................................................................................*....................|.........................
        // eor        v1.16b, v9.16b,  v1.16b              // ....................................................................................*................|.........................................................................................................................*................|.........................
        // eor        v10.16b,   v10.16b, v1.16b           // ........................................................................................*............|.............................................................................................................................*............|.........................
        // pmull      v9.1q,     v10.1d,  v7.1d            // ............................................................................................*........|.................................................................................................................................*........|.........................
        // eor        v8.16b,    v8.16b,  v9.16b           // ................................................................................................*....|.....................................................................................................................................*....|.........................
        // ext        v10.16b,   v10.16b, v10.16b, #8      // .............................................................................................*.......|..................................................................................................................................*.......|.........................
        // eor        v11.16b,     v8.16b,  v10.16b        // ...................................................................................................*.|........................................................................................................................................*.|.........................
        // ext        v11.16b, v11.16b, v11.16b, #8        // .....................................................................................................|........l.................................................................................................................................|........l................

        sub count, count, #1
        cbnz count, Lloop_unrolled_start
Lloop_unrolled_start_postamble:// end of loop kernel
        // Instructions:    101
        // Expected cycles: 57
        // Expected IPC:    0.5643564356435643
        aesr v4.16b, v23.16b                     // .*...................................................................................................
        ldr q3, [x5, #128]                       // *....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        ldr q27, [x0], #(4*16)                   // ..*..................................................................................................
        aesr v1.16b, v24.16b                     // ...*.................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        ldr q2, [x5, #192]                       // .......*.............................................................................................
        aesr v4.16b, v24.16b                     // ....*................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        ldr q0, [x0, #-48]                       // ..........*..........................................................................................
        aesr v1.16b, v11.16b                     // ......*..............................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        aesr v4.16b, v11.16b                     // ........*............................................................................................
        ldr q15, [x5, #160]                      // .....*...............................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        ldr q9, [x6, #48]                        // ............................*........................................................................
        aesr v8.16b, v3.16b                      // ....................................*................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        aesr v4.16b, v3.16b                      // ............*........................................................................................
        str q25, [x2], #(4*16)                   // .........................*...........................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v25.16B, v14.16B, v28.16B            // ...................................*.................................................................
        aesr v8.16b, v26.16b                     // .......................................*.............................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        aesr v4.16b, v26.16b                     // .................*...................................................................................
        eor v11.16B, v0.16B, v28.16B             // ....................*................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        aesr v8.16b, v15.16b                     // ...........................................*.........................................................
        ldr q5, [x0, #-16]                       // .............*.......................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        aesr v1.16b, v3.16b                      // ...........*.........................................................................................
        ldr q16, [x5, #208]                      // ..............*......................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v27.16B, v27.16B, v28.16B            // ..................*..................................................................................
        aesr v8.16b, v13.16b                     // ...............................................*.....................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        ldr q14, [x6]                            // ...............................*.....................................................................
        aesr v4.16b, v15.16b                     // ..........................................*..........................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        aesr v8.16b, v2.16b                      // ...................................................*.................................................
        ldr q29, [x6, #16]                       // .......................*.............................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v10.16B, v5.16B, v28.16B             // ..........................*..........................................................................
        aesr v4.16b, v13.16b                     // ..............................................*......................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        ldr q5, [x6, #32]                        // .................................................*...................................................
        aese v8.16b, v16.16b                     // .......................................................*.............................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        aesr v4.16b, v2.16b                      // ..................................................*..................................................
        ext v17.16B, v17.16B, v17.16B, #8        // .........*...........................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v8.16B, v11.16B, v8.16B              // ............................................................*........................................
        aesr v1.16b, v26.16b                     // ...............*.....................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        aese v4.16b, v16.16b                     // .....................................................*...............................................
        ldr q28, [x6, #80]                       // ................*....................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        rev64 v11.16B, v8.16B                    // ................................................................*....................................
        aesr v1.16b, v15.16b                     // .....................*...............................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        aesr v12.16b, v3.16b                     // ...................*.................................................................................
        eor v3.16B, v27.16B, v4.16B              // .........................................................*...........................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        mov d4, v11.d[1]                         // ....................................................................*................................
        aesr v1.16b, v13.16b                     // ........................*............................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        rev64 v27.16B, v3.16B                    // ..............................................................*......................................
        aesr v12.16b, v26.16b                    // ......................*..............................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        aesr v1.16b, v2.16b                      // .............................*.......................................................................
        str q8, [x2, #16]                        // .........................................................................................*...........
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v17.16B, v27.16B, v17.16B            // .................................................................*...................................
        aesr v12.16b, v15.16b                    // ...........................*.........................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v15.8B, v4.8B, v11.8B                // ........................................................................*............................
        aese v1.16b, v16.16b                     // ................................*....................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        ext v27.16B, v17.16B, v17.16B, #8        // ......................................................................*..............................
        aesr v12.16b, v13.16b                    // ..............................*......................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v8.16B, v10.16B, v1.16B              // .....................................*...............................................................
        pmull2 v26.1q, v11.2d, v9.2d             // ..........................................................................*..........................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        aesr v12.16b, v2.16b                     // ..................................*..................................................................
        eor v2.16B, v27.16B, v17.16B             // .........................................................................*...........................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        rev64 v13.16B, v8.16B                    // ............................................*........................................................
        pmull2 v4.1q, v17.2d, v28.2d             // .....................................................................*...............................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        str q8, [x2, #48]                        // ........................................*............................................................
        aese v12.16b, v16.16b                    // ......................................*..............................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        pmull2 v27.1q, v2.2d, v6.2d              // ............................................................................*........................
        eor v26.16B, v4.16B, v26.16B             // .................................................................................*...................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v0.16B, v25.16B, v12.16B             // .........................................*...........................................................
        pmull v8.1q, v15.1d, v6.1d               // ...........................................................................*.........................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        pmull v16.1q, v17.1d, v28.1d             // .......................................................................*.............................
        mov d2, v13.d[1]                         // ......................................................*..............................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v1.16B, v27.16B, v8.16B              // ................................................................................*....................
        rev64 v12.16B, v0.16B                    // ................................................*....................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v8.8B, v2.8B, v13.8B                 // .............................................................................*.......................
        pmull v15.1q, v11.1d, v9.1d              // ...................................................................*.................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        pmull v27.1q, v13.1d, v14.1d             // ..........................................................*..........................................
        ext v10.16B, v12.16B, v12.16B, #8        // ....................................................*................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v15.16B, v16.16B, v15.16B            // ..............................................................................*......................
        pmull2 v16.1q, v12.2d, v5.2d             // ...............................................................*.....................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v10.16B, v10.16B, v12.16B            // ........................................................*............................................
        pmull v11.1q, v12.1d, v5.1d              // .............................................................*.......................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v28.16B, v26.16B, v16.16B            // ...................................................................................*.................
        pmull2 v17.1q, v13.2d, v14.2d            // ...........................................................*.........................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v14.16B, v15.16B, v11.16B            // ......................................................................................*..............
        pmull2 v25.1q, v10.2d, v29.2d            // ..................................................................*..................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        pmull v29.1q, v8.1d, v29.1d              // ...............................................................................*.....................
        eor v2.16B, v28.16B, v17.16B             // .....................................................................................*...............
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v1.16B, v1.16B, v25.16B              // ..................................................................................*..................
        eor v25.16B, v14.16B, v27.16B            // ........................................................................................*............
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        pmull v6.1q, v2.1d, v7.1d                // .......................................................................................*.............
        ext v13.16B, v2.16B, v2.16B, #8          // ...........................................................................................*.........
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v5.16B, v1.16B, v29.16B              // ....................................................................................*................
        eor v15.16B, v25.16B, v2.16B             // ..........................................................................................*..........
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        add v31.4S, v31.4S, v30.4S               // .................................*...................................................................
        str q0, [x2, #32]                        // .............................................*.......................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v13.16B, v13.16B, v6.16B             // .............................................................................................*.......
        eor v15.16B, v5.16B, v15.16B             // ............................................................................................*........
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        str q3, [x2], #(4*16)                    // ....................................................................................................*
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v3.16B, v15.16B, v13.16B             // ..............................................................................................*......
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        ext v13.16B, v3.16B, v3.16B, #8          // ................................................................................................*....
        pmull v3.1q, v3.1d, v7.1d                // ...............................................................................................*.....
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v3.16B, v25.16B, v3.16B              // .................................................................................................*...
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        eor v3.16B, v3.16B, v13.16B              // ..................................................................................................*..
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        ext v11.16B, v3.16B, v3.16B, #8          // ...................................................................................................*.
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................
        // gap                                   // .....................................................................................................

        // original source code
        // ldr Q<ssa_0>, [x5, #128]                                 // .*...................................................................................................
        // aesr v4.16b, v23.16b                                     // *....................................................................................................
        // ldr Q<ssa_1>, [x0], #(4*16)                              // ..*..................................................................................................
        // aesr v1.16b, v24.16b                                     // ...*.................................................................................................
        // aesr v4.16b, v24.16b                                     // .....*...............................................................................................
        // ldr Q<ssa_2>, [x5, #160]                                 // .........*...........................................................................................
        // aesr v1.16b, v11.16b                                     // .......*.............................................................................................
        // ldr Q<ssa_3>, [x5, #192]                                 // ....*................................................................................................
        // aesr v4.16b, v11.16b                                     // ........*............................................................................................
        // ext V<ssa_4>.16B, v17.16B, v17.16B, #8                   // .................................*...................................................................
        // ldr Q<ssa_5>, [x0, #-48]                                 // ......*..............................................................................................
        // aesr v1.16b, V<ssa_0>.16b                                // ....................*................................................................................
        // aesr v4.16b, V<ssa_0>.16b                                // ............*........................................................................................
        // ldr Q<ssa_6>, [x0, #-16]                                 // ...................*.................................................................................
        // ldr Q<ssa_7>, [x5, #208]                                 // .....................*...............................................................................
        // aesr v1.16b, v26.16b                                     // ...................................*.................................................................
        // ldr Q<ssa_8>, [x6, #80]                                  // .....................................*...............................................................
        // aesr v4.16b, v26.16b                                     // ................*....................................................................................
        // eor V<ssa_9>.16B, V<ssa_1>.16B, v28.16B                  // ......................*..............................................................................
        // aesr v12.16b, V<ssa_0>.16b                               // ........................................*............................................................
        // eor V<ssa_10>.16B, V<ssa_5>.16B, v28.16B                 // .................*...................................................................................
        // aesr v1.16b, V<ssa_2>.16b                                // .......................................*.............................................................
        // aesr v12.16b, v26.16b                                    // .............................................*.......................................................
        // ldr Q<ssa_11>, [x6, #16]                                 // ...........................*.........................................................................
        // aesr v1.16b, v13.16b                                     // ...........................................*.........................................................
        // str q25, [x2], #(4*16)                                   // .............*.......................................................................................
        // eor V<ssa_12>.16B, V<ssa_6>.16B, v28.16B                 // ............................*........................................................................
        // aesr v12.16b, V<ssa_2>.16b                               // .................................................*...................................................
        // ldr Q<ssa_13>, [x6, #48]                                 // ..........*..........................................................................................
        // aesr v1.16b, V<ssa_3>.16b                                // ..............................................*......................................................
        // aesr v12.16b, v13.16b                                    // .....................................................*...............................................
        // ldr Q<ssa_14>, [x6]                                      // ........................*............................................................................
        // aese v1.16b, V<ssa_7>.16b                                // ...................................................*.................................................
        // add v31.4S, v31.4S, v30.4S                               // ..........................................................................................*..........
        // aesr v12.16b, V<ssa_3>.16b                               // ........................................................*............................................
        // eor V<ssa_16>.16B, v14.16B, v28.16B                      // ..............*......................................................................................
        // aesr v8.16b, V<ssa_0>.16b                                // ...........*.........................................................................................
        // eor V<ssa_17>.16B, V<ssa_12>.16B, v1.16B                 // ......................................................*..............................................
        // aese v12.16b, V<ssa_7>.16b                               // .............................................................*.......................................
        // aesr v8.16b, v26.16b                                     // ...............*.....................................................................................
        // str Q<ssa_17>, [x2, #48]                                 // ............................................................*........................................
        // eor V<ssa_19>.16B, V<ssa_16>.16B, v12.16B                // ................................................................*....................................
        // aesr v4.16b, V<ssa_2>.16b                                // .........................*...........................................................................
        // aesr v8.16b, V<ssa_2>.16b                                // ..................*..................................................................................
        // rev64 V<ssa_20>.16B, V<ssa_17>.16B                       // ..........................................................*..........................................
        // str Q<ssa_19>, [x2, #32]                                 // ...........................................................................................*.........
        // aesr v4.16b, v13.16b                                     // .............................*.......................................................................
        // aesr v8.16b, v13.16b                                     // .......................*.............................................................................
        // rev64 V<ssa_21>.16B, V<ssa_19>.16B                       // .....................................................................*...............................
        // ldr Q<ssa_22>, [x6, #32]                                 // ..............................*......................................................................
        // aesr v4.16b, V<ssa_3>.16b                                // ................................*....................................................................
        // aesr v8.16b, V<ssa_3>.16b                                // ..........................*..........................................................................
        // ext V<ssa_23>.16B, V<ssa_21>.16B, V<ssa_21>.16B, #8      // .........................................................................*...........................
        // aese v4.16b, V<ssa_7>.16b                                // ....................................*................................................................
        // mov D<ssa_24>, V<ssa_20>.d[1]                            // ...................................................................*.................................
        // aese v8.16b, V<ssa_7>.16b                                // ...............................*.....................................................................
        // eor V<ssa_25>.16B, V<ssa_23>.16B, V<ssa_21>.16B          // ............................................................................*........................
        // eor V<ssa_26>.16B, V<ssa_9>.16B, v4.16B                  // .........................................*...........................................................
        // pmull V<ssa_27>.1q, V<ssa_20>.1d, V<ssa_14>.1d           // ........................................................................*............................
        // pmull2 V<ssa_28>.1q, V<ssa_20>.2d, V<ssa_14>.2d          // ...............................................................................*.....................
        // eor V<ssa_29>.16B, V<ssa_10>.16B, v8.16B                 // ..................................*..................................................................
        // pmull V<ssa_30>.1q, V<ssa_21>.1d, V<ssa_22>.1d           // .............................................................................*.......................
        // rev64 V<ssa_31>.16B, V<ssa_26>.16B                       // ............................................*........................................................
        // pmull2 V<ssa_32>.1q, V<ssa_21>.2d, V<ssa_22>.2d          // ...........................................................................*.........................
        // rev64 V<ssa_33>.16B, V<ssa_29>.16B                       // ......................................*..............................................................
        // eor V<ssa_34>.16B, V<ssa_31>.16B, V<ssa_4>.16B           // ................................................*....................................................
        // pmull2 V<ssa_35>.1q, V<ssa_25>.2d, V<ssa_11>.2d          // .................................................................................*...................
        // pmull V<ssa_36>.1q, V<ssa_33>.1d, V<ssa_13>.1d           // .......................................................................*.............................
        // mov D<ssa_37>, V<ssa_33>.d[1]                            // ..........................................*..........................................................
        // pmull2 V<ssa_38>.1q, V<ssa_34>.2d, V<ssa_8>.2d           // ...........................................................*.........................................
        // ext V<ssa_39>.16B, V<ssa_34>.16B, V<ssa_34>.16B, #8      // ....................................................*................................................
        // pmull V<ssa_40>.1q, V<ssa_34>.1d, V<ssa_8>.1d            // ..................................................................*..................................
        // eor V<ssa_41>.8B, V<ssa_37>.8B, V<ssa_33>.8B             // ..................................................*..................................................
        // eor V<ssa_42>.16B, V<ssa_39>.16B, V<ssa_34>.16B          // .........................................................*...........................................
        // pmull2 V<ssa_43>.1q, V<ssa_33>.2d, V<ssa_13>.2d          // .......................................................*.............................................
        // pmull V<ssa_45>.1q, V<ssa_41>.1d, v6.1d                  // .................................................................*...................................
        // pmull2 V<ssa_46>.1q, V<ssa_42>.2d, v6.2d                 // ..............................................................*......................................
        // eor V<ssa_47>.8B, V<ssa_24>.8B, V<ssa_20>.8B             // ......................................................................*..............................
        // eor V<ssa_48>.16B, V<ssa_40>.16B, V<ssa_36>.16B          // ..........................................................................*..........................
        // pmull V<ssa_49>.1q, V<ssa_47>.1d, V<ssa_11>.1d           // ..................................................................................*..................
        // eor V<ssa_51>.16B, V<ssa_46>.16B, V<ssa_45>.16B          // ....................................................................*................................
        // eor V<ssa_52>.16B, V<ssa_38>.16B, V<ssa_43>.16B          // ...............................................................*.....................................
        // eor V<ssa_53>.16B, V<ssa_51>.16B, V<ssa_35>.16B          // ....................................................................................*................
        // eor V<ssa_54>.16B, V<ssa_52>.16B, V<ssa_32>.16B          // ..............................................................................*......................
        // eor V<ssa_55>.16B, V<ssa_53>.16B, V<ssa_49>.16B          // ........................................................................................*............
        // eor V<ssa_56>.16B, V<ssa_54>.16B, V<ssa_28>.16B          // ...................................................................................*.................
        // eor V<ssa_58>.16B, V<ssa_48>.16B, V<ssa_30>.16B          // ................................................................................*....................
        // pmull V<ssa_60>.1q, V<ssa_56>.1d, v7.1d                  // ......................................................................................*..............
        // eor V<ssa_61>.16B, V<ssa_58>.16B, V<ssa_27>.16B          // .....................................................................................*...............
        // str Q<ssa_29>, [x2, #16]                                 // ...............................................*.....................................................
        // eor V<ssa_65>.16B, V<ssa_61>.16B, V<ssa_56>.16B          // .........................................................................................*...........
        // ext V<ssa_66>.16B, V<ssa_56>.16B, V<ssa_56>.16B, #8      // .......................................................................................*.............
        // eor V<ssa_68>.16B, V<ssa_55>.16B, V<ssa_65>.16B          // .............................................................................................*.......
        // eor V<ssa_70>.16B, V<ssa_66>.16B, V<ssa_60>.16B          // ............................................................................................*........
        // eor V<ssa_72>.16B, V<ssa_68>.16B, V<ssa_70>.16B          // ...............................................................................................*.....
        // pmull V<ssa_74>.1q, V<ssa_72>.1d, v7.1d                  // .................................................................................................*...
        // ext V<ssa_75>.16B, V<ssa_72>.16B, V<ssa_72>.16B, #8      // ................................................................................................*....
        // eor V<ssa_77>.16B, V<ssa_61>.16B, V<ssa_74>.16B          // ..................................................................................................*..
        // eor V<ssa_78>.16B, V<ssa_77>.16B, V<ssa_75>.16B          // ...................................................................................................*.
        // ext v11.16B, V<ssa_78>.16B, V<ssa_78>.16B, #8            // ....................................................................................................*
        // str Q<ssa_26>, [x2], #(4*16)                             // ..............................................................................................*......

        b Lloop_unrolled_start_end
Lloop_unrolled_start_iter_1:


        ldr q25, [x5, #((7)*16)]
        ldr q26, [x5, #((8)*16)]
        ldr q27, [x5, #((9)*16)]
        ldr q28, [x5, #((10)*16)]
        ldr q15, [x5, #((11)*16)]
        ldr q16, [x5, #((12)*16)]
        ldr q17, [x5, #((13)*16)]
        ldr q2, [x5, #((14)*16)]

        ldr q29, [x0], #(4*16)
        rev32  v0.16b, v31.16b
        add    v31.4s, v31.4s, v30.4s
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aesr v0.16b, v27.16b
        aesr v0.16b, v28.16b
        aesr v0.16b, v15.16b
        aesr v0.16b, v16.16b
        aese v0.16b, v17.16b
        eor v29.16b, v29.16b, v2.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2], #(4*16)

        ldr q12, [x6, #48]
        ldr q13, [x6, #80]
        ldr q14, [x6, #64]
        rev64 v0.16b, v0.16b
        eor   v0.16b, v0.16b, v11.16b
        // Low product
        pmull   v8.1q, v0.1d, v13.1d
        // High product
        pmull2  v9.1q, v0.2d, v13.2d
        // Middle product
        ext     v11.16b, v0.16b, v0.16b, #8
        eor     v11.16b, v11.16b, v0.16b
        pmull2  v10.1q, v11.2d, v14.2d

        ldr q29, [x0, #(-3*16)]
        rev32  v0.16b, v31.16b
        add    v31.4s, v31.4s, v30.4s
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aesr v0.16b, v27.16b
        aesr v0.16b, v28.16b
        aesr v0.16b, v15.16b
        aesr v0.16b, v16.16b
        aese v0.16b, v17.16b
        eor v29.16b, v29.16b, v2.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(-3*16)]

        rev64   v0.16b, v0.16b
        // Low product
        pmull   v11.1q, v0.1d, v12.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v12.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        mov     d11, v0.d[1]
        eor     v11.8b, v11.8b, v0.8b
        pmull   v11.1q, v11.1d, v14.1d
        eor     v10.16b, v10.16b, v11.16b

        ldr q29, [x0, #(-2*16)]
        rev32  v0.16b, v31.16b
        add    v31.4s, v31.4s, v30.4s
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aesr v0.16b, v27.16b
        aesr v0.16b, v28.16b
        aesr v0.16b, v15.16b
        aesr v0.16b, v16.16b
        aese v0.16b, v17.16b
        eor v29.16b, v29.16b, v2.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(-2*16)]

        ldr q12, [x6]
        ldr q13, [x6, #32]
        ldr q14, [x6, #16]
        rev64   v0.16b, v0.16b

        // Low product
        pmull   v11.1q, v0.1d, v13.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v13.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        ext     v11.16b, v0.16b, v0.16b, #8
        eor     v11.16b, v11.16b, v0.16b
        pmull2  v11.1q, v11.2d, v14.2d
        eor     v10.16b, v10.16b, v11.16b

        ldr q29, [x0, #(-1*16)]
        rev32  v0.16b, v31.16b
        add    v31.4s, v31.4s, v30.4s
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aesr v0.16b, v27.16b
        aesr v0.16b, v28.16b
        aesr v0.16b, v15.16b
        aesr v0.16b, v16.16b
        aese v0.16b, v17.16b
        eor v29.16b, v29.16b, v2.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(-1*16)]

        rev64   v0.16b, v0.16b
        // Low product
        pmull   v11.1q, v0.1d, v12.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v12.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        mov     d11, v0.d[1]
        eor     v11.8b, v11.8b, v0.8b
        pmull   v11.1q, v11.1d, v14.1d
        eor     v10.16b, v10.16b, v11.16b

        eor        v0.16b, v8.16b,  v9.16b
        pmull      v1.1q,  v9.1d,   v7.1d
        ext        v9.16b,    v9.16b,  v9.16b, #8
        eor        v10.16b,   v10.16b, v0.16b
        eor        v1.16b, v9.16b,  v1.16b
        eor        v10.16b,   v10.16b, v1.16b
        pmull      v9.1q,     v10.1d,  v7.1d
        eor        v8.16b,    v8.16b,  v9.16b
        ext        v10.16b,   v10.16b, v10.16b, #8
        eor        v11.16b,     v8.16b,  v10.16b
        ext        v11.16b, v11.16b, v11.16b, #8

Lloop_unrolled_start_iter_1_end:
Lloop_unrolled_start_end:
Lloop_unrolled_end:

        load_round_keys1
        load_htable_12

        cbz remainder, Lloop_1x_end
Lloop_1x_start:

        ldr plain_q, [input], #16
        aes_full_block aes_st, plain, res
        str res_q, [output], #16
        ghash_init_0 res, Ht1, Ht12, tag

        ghash_finalize tag

        sub remainder, remainder, #1
        cbnz remainder, Lloop_1x_start
Lloop_1x_end:

        // Return number of bytes processed
        mov x0, byte_len
        // Store new authentication tag
        rev64 tag.16b, tag.16b
        str tag_q, [tag_ptr]
        // Store updated counter
        rev32 rtmp_ctr.16b, rtmp_ctr.16b
        str rtmp_ctr_q, [ivec]

        restore_vregs
        restore_gprs

Lenc_postamble_end:
        add sp, sp, #STACK_SIZE

        ret

#endif
#endif  // !OPENSSL_NO_ASM && defined(__AARCH64EL__) && defined(__APPLE__)
#if defined(__ELF__)
// See https: // www.airs.com/blog/archives/518.
.section .note.GNU-stack,"",%progbits
#endif