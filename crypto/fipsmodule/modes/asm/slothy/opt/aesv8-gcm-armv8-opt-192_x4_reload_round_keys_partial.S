// Copyright (c) 2022, ARM Inc.

// Permission to use, copy, modify, and/or distribute this software for any
// purpose with or without fee is hereby granted, provided that the above
// copyright notice and this permission notice appear in all copies.

// THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
// WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
// MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
// SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
// WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
// OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
// CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. */

// Author: Hanno Becker <hannobecker@posteo.de>

// This file was derived from the assembly generated from aesv8-gcm-armv8.pl,
// written by Fangming Fang <fangming.fang@arm.com> for the OpenSSL project,
// and derived from https: // github.com/ARM-software/AArch64cryptolib, original
// author Samuel Lee <Samuel.Lee@arm.com>.

// The code below is a 'clean' AArch64 implementation of AES-GCM emphasizing
// the logic of the computation. It is meant as the input to manual audits /
// formal verification, as well as automated micro-optimization such as done
// by the SLOTHY superoptimizer (https: // github.com/slothy-optimizer/slothy).

#if !defined(__has_feature)
#define __has_feature(x) 0
#endif
#if __has_feature(memory_sanitizer) && !defined(OPENSSL_NO_ASM)
#define OPENSSL_NO_ASM
#endif

#include <openssl/asm_base.h>

#if !defined(OPENSSL_NO_ASM) && defined(__AARCH64EL__)
#if defined(__ELF__)
#include <openssl/boringssl_prefix_symbols_asm.h>
#include <openssl/arm_arch.h>
.arch   armv8-a+crypto
.text
.globl  aes_gcm_enc_kernel_slothy_base_192
.hidden aes_gcm_enc_kernel_slothy_base_192
.type   aes_gcm_enc_kernel_slothy_base_192,%function
#elif defined(__APPLE__)
#if defined(BORINGSSL_PREFIX)
#include <boringssl_prefix_symbols_asm.h>
#endif
#include <openssl/arm_arch.h>
.text
.globl	_aes_gcm_enc_kernel_slothy_base_192
.private_extern	_aes_gcm_enc_kernel_slothy_base_192
#else
#error Unknown configuration
#endif

#if __ARM_MAX_ARCH__ >= 8

// Arguments
input    .req x0
len_bits .req x1
output   .req x2
tag_ptr  .req x3
ivec     .req x4
key      .req x5
Htable   .req x6

byte_len .req x15

constant_temp .req x25

count           .req x1
full_blocks     .req x7
remainder       .req x9
unroll          .req x10

aes_st    .req v0
aes_st_q  .req q0

res       .req v0
res_q     .req q0

ghash_hi    .req v9
ghash_lo    .req v8
ghash_mid   .req v10
ghash_mid_d .req d10

ghash_tmp   .req v11
ghash_tmp_d .req d11

ghash_mod   .req v7
ghash_mod_d .req d7

modulo_tmp0 .req v0
modulo_tmp1 .req v1

Ht1q    .req q12
Ht2q    .req q13
Ht12q   .req q14

Ht1    .req v12
Ht2    .req v13
Ht12   .req v14

Ht3q    .req Ht1q
Ht4q    .req Ht2q
Ht34q   .req Ht12q

Ht3    .req Ht1
Ht4    .req Ht2
Ht34   .req Ht12

rk0q   .req q18
rk1q   .req q19
rk2q   .req q20
rk3q   .req q21
rk4q   .req q22
rk5q   .req q23
rk6q   .req q24
rk7q   .req q25
rk8q   .req q26
rk9q   .req q27
rk10q  .req q28

rk11q  .req q15
rk12q  .req q16
rk13q  .req q17
rk14q  .req q2

rk0    .req v18
rk1    .req v19
rk2    .req v20
rk3    .req v21
rk4    .req v22
rk5    .req v23
rk6    .req v24
rk7    .req v25
rk8    .req v26
rk9    .req v27
rk10   .req v28

rk11   .req v15
rk12   .req v16
rk13   .req v17
rk14   .req v2

plain   .req v29
plain_q .req q29

rctr_inc   .req v30
rtmp_ctr   .req v31
rtmp_ctr_q .req q31

tag    .req v11
tag_q  .req q11

#define UNROLL 4

#define STACK_SIZE_GPRS  (6*16)
#define STACK_SIZE_VREGS (4*16)
#define STACK_SIZE  (STACK_SIZE_GPRS + STACK_SIZE_VREGS)

#define STACK_BASE_GPRS  (0)
#define STACK_BASE_VREGS (STACK_SIZE_GPRS)

/********************************************************************/
/*                 Generic preamble/postamble macros                */
/********************************************************************/

.macro save_vregs
        stp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        stp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        stp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        stp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro restore_vregs
        ldp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        ldp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        ldp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        ldp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro save_gprs
        stp x19, x20, [sp, #(STACK_BASE_GPRS + 16*0)]
        stp x21, x22, [sp, #(STACK_BASE_GPRS + 16*1)]
        stp x23, x24, [sp, #(STACK_BASE_GPRS + 16*2)]
        stp x25, x26, [sp, #(STACK_BASE_GPRS + 16*3)]
        stp x27, x28, [sp, #(STACK_BASE_GPRS + 16*4)]
        stp x29, x30, [sp, #(STACK_BASE_GPRS + 16*5)]
.endm

.macro restore_gprs
        ldp x19, x20, [sp, #(STACK_BASE_GPRS + 16*0)]
        ldp x21, x22, [sp, #(STACK_BASE_GPRS + 16*1)]
        ldp x23, x24, [sp, #(STACK_BASE_GPRS + 16*2)]
        ldp x25, x26, [sp, #(STACK_BASE_GPRS + 16*3)]
        ldp x27, x28, [sp, #(STACK_BASE_GPRS + 16*4)]
        ldp x29, x30, [sp, #(STACK_BASE_GPRS + 16*5)]
.endm

// Derive number of iterations of unrolled loop and single-block loop
.macro prepare_loop_counts
        mov  unroll, #UNROLL
        // Number of AES Blocks (16b each)
        lsr  full_blocks, byte_len, #4
        // Number of iterations of the unrolled loop
        udiv count, full_blocks, unroll
        // Number of iterations for the tail loop handling 1 block each
        msub remainder, count, unroll, full_blocks
.endm

/********************************************************************/
/*                       AES related macros                         */
/********************************************************************/

.macro load_iv
        ldr     rtmp_ctr_q, [ivec]

        // set up counter increment
 mov	constant_temp, #0x100000000
 movi	rctr_inc.16b,  #0x0
 fmov	rctr_inc.d[1], constant_temp

        rev32   rtmp_ctr.16b, rtmp_ctr.16b
.endm

// Increase AES counter
.macro aes_ctr_inc
        add    rtmp_ctr.4s, rtmp_ctr.4s, rctr_inc.4s
.endm

// Increase AES counter and initialize new AES state
.macro next_ctr_init_aes aes_st
        rev32  \aes_st\().16b, rtmp_ctr.16b
        aes_ctr_inc
.endm

// A single AES round
// Prevent SLOTHY from unfolding because uArchs tend to fuse AESMC+AESE
.macro aesr data, key // @slothy:no-unfold
        aese  \data, \key
        aesmc \data, \data
.endm

.macro aesr_0_8 data, key
        aesr \data\().16b, \key\()0.16b
        aesr \data\().16b, \key\()1.16b
        aesr \data\().16b, \key\()2.16b
        aesr \data\().16b, \key\()3.16b
        aesr \data\().16b, \key\()4.16b
        aesr \data\().16b, \key\()5.16b
        aesr \data\().16b, \key\()6.16b
        aesr \data\().16b, \key\()7.16b
        aesr \data\().16b, \key\()8.16b
.endm

.macro aesr_9_10 data, key
        aesr \data\().16b, \key\()9.16b
        aesr \data\().16b, \key\()10.16b
.endm

.macro aesr_11_12 data, key
        aesr \data\().16b, \key\()11.16b
        aesr \data\().16b, \key\()12.16b
.endm

// Destructs inA
.macro eor3 out, inA, inB, inC
        eor \inA, \inA, \inB
        eor \out, \inA, \inC
.endm

.macro aesr_final aes_st, plain, out
        aese \aes_st\().16b, rk11.16b
        eor3 \out\().16b, \plain\().16b, rk12.16b, \aes_st\().16b
.endm

.macro aes_full_block aes_st, input, output
        next_ctr_init_aes \aes_st
        aesr_0_8   \aes_st\(), rk
        aesr_9_10  \aes_st\(), rk
        aesr_final \aes_st, \input, \output
.endm

.macro load_round_key i
        ldr rk\i\()q, [key, #((\i)*16)]
.endm

.macro load_round_keys0
        load_round_key 0
        load_round_key 1
        load_round_key 2
        load_round_key 3
        load_round_key 4
        load_round_key 5
        load_round_key 6
.endm

.macro load_round_keys1
        load_round_key 7
        load_round_key 8
        load_round_key 9
        load_round_key 10
        load_round_key 11
        load_round_key 12
.endm

/********************************************************************/
/*       Loading of H-table (precomputed H-powers for GHASH)        */
/********************************************************************/

// This has to be synchronized with the H-table generation

.macro load_h1 dst, dst_q
        ldr \dst_q, [Htable]
.endm

.macro load_h2 dst, dst_q
        ldr \dst_q, [Htable, #32]
.endm

.macro load_h3 dst, dst_q
        ldr \dst_q, [Htable, #48]
.endm

.macro load_h4 dst, dst_q
        ldr \dst_q, [Htable, #80]
.endm

.macro load_h12 dst, dst_q
        ldr \dst_q, [Htable, #16]
.endm

.macro load_h34 dst, dst_q
        ldr \dst_q, [Htable, #64]
.endm

.macro load_full_htable
        load_h1  Ht1,  Ht1q
        load_h2  Ht2,  Ht2q
        load_h3  Ht3,  Ht3q
        load_h4  Ht4,  Ht4q
        load_h12 Ht12, Ht12q
        load_h34 Ht34, Ht34q
.endm

.macro load_htable_12
        load_h1  Ht1,  Ht1q
        load_h2  Ht2,  Ht2q
        load_h12 Ht12, Ht12q
.endm

.macro load_htable_34
        load_h3  Ht3,  Ht3q
        load_h4  Ht4,  Ht4q
        load_h34 Ht34, Ht34q
.endm

/********************************************************************/
/*                    Macros for GHASH udpate                       */
/********************************************************************/

.macro ghash_init_0 input, Hk, Hk_mid, tag
        rev64 \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_mid.1q, ghash_tmp.1d, \Hk_mid\().1d
.endm

.macro ghash_init_1 input, Hk, Hk_mid, tag
        rev64 \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_mid.1q, ghash_tmp.2d, \Hk_mid\().2d
.endm

.macro ghash_acc_0 input, Hk, Hk_mid
        rev64   \input\().16b, \input\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_tmp.1q, ghash_tmp.1d, \Hk_mid\().1d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_acc_1 input, Hk, Hk_mid
        rev64   \input\().16b, \input\().16b

        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_tmp.1q, ghash_tmp.2d, \Hk_mid\().2d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_finalize tag
        eor        modulo_tmp0.16b, ghash_lo.16b,  ghash_hi.16b
        pmull      modulo_tmp1.1q,  ghash_hi.1d,   ghash_mod.1d
        ext        ghash_hi.16b,    ghash_hi.16b,  ghash_hi.16b, #8
        eor        ghash_mid.16b,   ghash_mid.16b, modulo_tmp0.16b
        eor        modulo_tmp1.16b, ghash_hi.16b,  modulo_tmp1.16b
        eor        ghash_mid.16b,   ghash_mid.16b, modulo_tmp1.16b
        pmull      ghash_hi.1q,     ghash_mid.1d,  ghash_mod.1d
        eor        ghash_lo.16b,    ghash_lo.16b,  ghash_hi.16b
        ext        ghash_mid.16b,   ghash_mid.16b, ghash_mid.16b, #8
        eor        \tag\().16b,     ghash_lo.16b,  ghash_mid.16b
        ext        \tag\().16b, \tag\().16b, \tag\().16b, #8
.endm

.macro load_tag
        ldr      tag_q, [tag_ptr]
        rev64    tag.16b, tag.16b
.endm

.macro prepare_ghash
        // Prepare constant for modular reduction
        movi ghash_mod.8b, #0xc2
        shl  ghash_mod_d, ghash_mod_d, #56
.endm

/********************************************************************/
/*                            Core routine                          */
/********************************************************************/

.align        4
_aes_gcm_enc_kernel_slothy_base_192:
aes_gcm_enc_kernel_slothy_base_192:
#ifdef BORINGSSL_DISPATCH_TEST
        adrp  x9,_BORINGSSL_function_hit@PAGE
        add   x9, x9, _BORINGSSL_function_hit@PAGEOFF
        mov   w10, #1
        strb  w10, [x9,#2] // kFlag_aes_gcm_enc_kernel
#endif

        AARCH64_VALID_CALL_TARGET
        sub sp, sp, #STACK_SIZE

Lenc_preamble_start:
        save_gprs
        save_vregs

        lsr byte_len, len_bits, #3

        load_round_keys0
        load_tag
        load_iv

        prepare_loop_counts
        prepare_ghash

Lenc_preamble_end:

        cbz count, Lloop_unrolled_end
        cmp count, #1
        b.eq Lloop_unrolled_start_iter_1
        rev32 v0.16B, v31.16B                  // .........................*...............................................................................................
        ldr q10, [x5, #128]                    // .....*...................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        add v14.4S, v31.4S, v30.4S             // *........................................................................................................................
        ldr q9, [x0, #16]                      // ........*................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v0.16b, v18.16b                   // ...............................*.........................................................................................
        ldr q12, [x5, #176]                    // ..................*......................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        rev32 v3.16B, v14.16B                  // .*.......................................................................................................................
        ldr q17, [x0], #(4*16)                 // ....................................*....................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        add v29.4S, v14.4S, v30.4S             // .......................*.................................................................................................
        aesr v0.16b, v19.16b                   // ...............................................................*.........................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v3.16b, v18.16b                   // ..*......................................................................................................................
        ldr q15, [x6, #48]                     // .......................................*.................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        rev32 v26.16B, v29.16B                 // ........................*................................................................................................
        aesr v0.16b, v20.16b                   // .................................................................*.......................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v3.16b, v19.16b                   // ...*.....................................................................................................................
        ldr q25, [x0, #16]                     // ....................................................................................*....................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        ldr q4, [x5, #144]                     // .......................................................................................*.................................
        aesr v0.16b, v21.16b                   // ....................................................................*....................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        ldr q2, [x5, #160]                     // ..........................................................................................*..............................
        aesr v3.16b, v20.16b                   // ......*..................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v0.16b, v22.16b                   // .....................................................................*...................................................
        ldr q6, [x5, #160]                     // ...........*.............................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v3.16b, v21.16b                   // .......*.................................................................................................................
        ldr q8, [x5, #144]                     // ..........*..............................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        ldr q14, [x5, #112]                    // ....*....................................................................................................................
        aesr v0.16b, v23.16b                   // .......................................................................*.................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        ldr q28, [x5, #192]                    // .............*...........................................................................................................
        aesr v3.16b, v22.16b                   // .........*...............................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v0.16b, v24.16b                   // .........................................................................*...............................................
        ldr q16, [x5, #192]                    // ..............................................................................................*..........................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v3.16b, v23.16b                   // ............*............................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v0.16b, v14.16b                   // ............................................................................*............................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        eor v13.16B, v9.16B, v28.16B           // ................*........................................................................................................
        aesr v3.16b, v24.16b                   // ..............*..........................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        add v29.4S, v29.4S, v30.4S             // .............................*...........................................................................................
        aesr v0.16b, v10.16b                   // ...............................................................................*.........................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        eor v25.16B, v25.16B, v16.16B          // .....................................................................................................*...................
        aesr v3.16b, v14.16b                   // ...............*.........................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v0.16b, v8.16b                    // ..................................................................................*......................................
        rev32 v27.16B, v29.16B                 // ................................*........................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v3.16b, v10.16b                   // .................*.......................................................................................................
        eor v5.16B, v17.16B, v28.16B           // .................................................*.......................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        ldr q17, [x0, #-16]                    // ..........................................*..............................................................................
        aesr v0.16b, v6.16b                    // .....................................................................................*...................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v3.16b, v8.16b                    // ...................*.....................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aese v0.16b, v12.16b                   // ........................................................................................*................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v3.16b, v6.16b                    // ....................*....................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        eor v5.16B, v5.16B, v0.16B             // ............................................................................................*............................
        aesr v26.16b, v18.16b                  // ..........................*..............................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aese v3.16b, v12.16b                   // .....................*...................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v26.16b, v19.16b                  // ............................*............................................................................................
        rev64 v9.16B, v5.16B                   // ...............................................................................................*.........................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        eor v13.16B, v13.16B, v3.16B           // ......................*..................................................................................................
        aesr v27.16b, v18.16b                  // ...................................*.....................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        eor v9.16B, v9.16B, v11.16B            // ........................................................................................................*................
        aesr v26.16b, v20.16b                  // ..............................*..........................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        str q13, [x2, #16]                     // ...........................*.............................................................................................
        aesr v27.16b, v19.16b                  // ......................................*..................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v26.16b, v21.16b                  // .................................*.......................................................................................
        ldr q31, [x0, #-32]                    // ..................................*......................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        rev64 v3.16B, v13.16B                  // .............................................*...........................................................................
        aesr v27.16b, v20.16b                  // .........................................*...............................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        str q5, [x2], #(4*16)                  // ..................................................................................................*......................
        aesr v26.16b, v22.16b                  // .....................................*...................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        pmull v0.1q, v3.1d, v15.1d             // .................................................................................................*.......................
        mov d1, v3.d[1]                        // ...................................................*.....................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        eor v5.16B, v31.16B, v28.16B           // ....................................................*....................................................................
        aesr v26.16b, v23.16b                  // ........................................*................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        eor v11.16B, v17.16B, v28.16B          // .......................................................*.................................................................
        aesr v27.16b, v21.16b                  // ............................................*............................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        eor v17.8B, v1.8B, v3.8B               // ........................................................*................................................................
        aesr v26.16b, v24.16b                  // ...........................................*.............................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        pmull2 v3.1q, v3.2d, v15.2d            // ......................................................................................................*..................
        add v31.4S, v29.4S, v30.4S             // ...........................................................*.............................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v26.16b, v14.16b                  // ..............................................*..........................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v27.16b, v22.16b                  // ...............................................*.........................................................................
        add v29.4S, v31.4S, v30.4S             // ................................................................*........................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v26.16b, v10.16b                  // ................................................*........................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v27.16b, v23.16b                  // ..................................................*......................................................................
        rev32 v28.16B, v29.16B                 // ...................................................................*.....................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v26.16b, v8.16b                   // .....................................................*...................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v28.16b, v18.16b                  // ........................................................................*................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v26.16b, v6.16b                   // .........................................................*...............................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v28.16b, v19.16b                  // ...........................................................................*.............................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aese v26.16b, v12.16b                  // ............................................................*............................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v28.16b, v20.16b                  // .................................................................................*.......................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        eor v1.16B, v5.16B, v26.16B            // ..............................................................*..........................................................
        aesr v27.16b, v24.16b                  // ......................................................*..................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v28.16b, v21.16b                  // ...................................................................................*.....................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v27.16b, v14.16b                  // ..........................................................*..............................................................
        str q1, [x2, #-32]                     // ..................................................................*......................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        ldr q26, [x6, #64]                     // ..........................................................................*..............................................
        aesr v28.16b, v22.16b                  // ......................................................................................*..................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v27.16b, v10.16b                  // .............................................................*...........................................................
        ldr q15, [x6, #80]                     // ...................................................................................................*.....................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v28.16b, v23.16b                  // ...........................................................................................*.............................
        ldr q14, [x5, #112]                    // .............................................................................*...........................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v27.16b, v8.16b                   // ......................................................................*..................................................
        ldr q5, [x6, #32]                      // ..............................................................................*..........................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v28.16b, v24.16b                  // ................................................................................................*........................
        ldr q13, [x5, #128]                    // ................................................................................*........................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v27.16b, v6.16b                   // .........................................................................................*...............................
        ldr q10, [x5, #176]                    // ..........................................................................................................*..............
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v28.16b, v14.16b                  // ....................................................................................................*....................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aese v27.16b, v12.16b                  // .........................................................................................................*...............
        ext v12.16B, v9.16B, v9.16B, #8        // ............................................................................................................*............
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v28.16b, v13.16b                  // .......................................................................................................*.................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        eor v6.16B, v11.16B, v27.16B           // ..............................................................................................................*..........
        pmull2 v27.1q, v9.2d, v15.2d           // .............................................................................................................*...........
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        rev64 v8.16B, v1.16B                   // ...............................................................................................................*.........
        aesr v28.16b, v4.16b                   // ...........................................................................................................*.............
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        eor v1.16B, v12.16B, v9.16B            // ..................................................................................................................*......
        pmull v9.1q, v9.1d, v15.1d             // .................................................................................................................*.......
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aesr v28.16b, v2.16b                   // ................................................................................................................*........
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        eor v12.16B, v9.16B, v0.16B            // ......................................................................................................................*..
        pmull2 v0.1q, v1.2d, v26.2d            // .....................................................................................................................*...
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        aese v28.16b, v10.16b                  // ....................................................................................................................*....
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        pmull v1.1q, v17.1d, v26.1d            // .............................................................................................*...........................
        ldr q17, [x6, #16]                     // ...................................................................................................................*.....
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................
        eor v25.16B, v25.16B, v28.16B          // .......................................................................................................................*.
        pmull v11.1q, v8.1d, v5.1d             // ........................................................................................................................*
        // gap                                 // .........................................................................................................................
        // gap                                 // .........................................................................................................................

        // original source code
        // add V<ssa_32>.4S, v31.4S, v30.4S                            // ..*......................................................................................................................
        // rev32 V<ssa_36>.16B, V<ssa_32>.16B                          // ......*..................................................................................................................
        // aesr V<ssa_36>.16b, v18.16b                                 // ..........*..............................................................................................................
        // aesr V<ssa_36>.16b, v19.16b                                 // ..............*..........................................................................................................
        // ldr Q<ssa_45>, [x5, #112]                                   // ........................*................................................................................................
        // ldr Q<ssa_48>, [x5, #128]                                   // .*.......................................................................................................................
        // aesr V<ssa_36>.16b, v20.16b                                 // ...................*.....................................................................................................
        // aesr V<ssa_36>.16b, v21.16b                                 // ......................*..................................................................................................
        // ldr Q<ssa_51>, [x0, #16]                                    // ...*.....................................................................................................................
        // aesr V<ssa_36>.16b, v22.16b                                 // ...........................*.............................................................................................
        // ldr Q<ssa_53>, [x5, #144]                                   // .......................*.................................................................................................
        // ldr Q<ssa_55>, [x5, #160]                                   // .....................*...................................................................................................
        // aesr V<ssa_36>.16b, v23.16b                                 // ..............................*..........................................................................................
        // ldr Q<ssa_58>, [x5, #192]                                   // ..........................*..............................................................................................
        // aesr V<ssa_36>.16b, v24.16b                                 // .................................*.......................................................................................
        // aesr V<ssa_36>.16b, V<ssa_45>.16b                           // .....................................*...................................................................................
        // eor V<ssa_62>.16B, V<ssa_51>.16B, V<ssa_58>.16B             // ................................*........................................................................................
        // aesr V<ssa_36>.16b, V<ssa_48>.16b                           // ........................................*................................................................................
        // ldr Q<ssa_65>, [x5, #176]                                   // .....*...................................................................................................................
        // aesr V<ssa_36>.16b, V<ssa_53>.16b                           // ............................................*............................................................................
        // aesr V<ssa_36>.16b, V<ssa_55>.16b                           // ..............................................*..........................................................................
        // aese V<ssa_36>.16b, V<ssa_65>.16b                           // .................................................*.......................................................................
        // eor V<ssa_75>.16B, V<ssa_62>.16B, V<ssa_36>.16B             // ....................................................*....................................................................
        // add V<ssa_78>.4S, V<ssa_32>.4S, v30.4S                      // ........*................................................................................................................
        // rev32 V<ssa_82>.16B, V<ssa_78>.16B                          // ............*............................................................................................................
        // rev32 V<ssa_85>.16B, v31.16B                                // *........................................................................................................................
        // aesr V<ssa_82>.16b, v18.16b                                 // ................................................*........................................................................
        // str Q<ssa_75>, [x2, #16]                                    // ........................................................*................................................................
        // aesr V<ssa_82>.16b, v19.16b                                 // ..................................................*......................................................................
        // add V<ssa_89>.4S, V<ssa_78>.4S, v30.4S                      // ..................................*......................................................................................
        // aesr V<ssa_82>.16b, v20.16b                                 // .......................................................*.................................................................
        // aesr V<ssa_85>.16b, v18.16b                                 // ....*....................................................................................................................
        // rev32 V<ssa_91>.16B, V<ssa_89>.16B                          // .......................................*.................................................................................
        // aesr V<ssa_82>.16b, v21.16b                                 // ..........................................................*..............................................................
        // ldr Q<ssa_92>, [x0, #32]                                    // ...........................................................*.............................................................
        // aesr V<ssa_91>.16b, v18.16b                                 // .....................................................*...................................................................
        // ldr Q<ssa_93>, [x0], #(4*16)                                // .......*.................................................................................................................
        // aesr V<ssa_82>.16b, v22.16b                                 // ...............................................................*.........................................................
        // aesr V<ssa_91>.16b, v19.16b                                 // .........................................................*...............................................................
        // ldr Q<ssa_95>, [x6, #48]                                    // ...........*.............................................................................................................
        // aesr V<ssa_82>.16b, v23.16b                                 // ...................................................................*.....................................................
        // aesr V<ssa_91>.16b, v20.16b                                 // .............................................................*...........................................................
        // ldr Q<ssa_96>, [x0, #-16]                                   // ..........................................*..............................................................................
        // aesr V<ssa_82>.16b, v24.16b                                 // .......................................................................*.................................................
        // aesr V<ssa_91>.16b, v21.16b                                 // .....................................................................*...................................................
        // rev64 V<ssa_99>.16B, V<ssa_75>.16B                          // ............................................................*............................................................
        // aesr V<ssa_82>.16b, V<ssa_45>.16b                           // ..........................................................................*..............................................
        // aesr V<ssa_91>.16b, v22.16b                                 // ...........................................................................*.............................................
        // aesr V<ssa_82>.16b, V<ssa_48>.16b                           // .............................................................................*...........................................
        // eor V<ssa_101>.16B, V<ssa_93>.16B, V<ssa_58>.16B            // .........................................*...............................................................................
        // aesr V<ssa_91>.16b, v23.16b                                 // ..............................................................................*..........................................
        // mov D<ssa_102>, V<ssa_99>.d[1]                              // .................................................................*.......................................................
        // eor V<ssa_103>.16B, V<ssa_92>.16B, V<ssa_58>.16B            // ..................................................................*......................................................
        // aesr V<ssa_82>.16b, V<ssa_53>.16b                           // ................................................................................*........................................
        // aesr V<ssa_91>.16b, v24.16b                                 // .......................................................................................*.................................
        // eor V<ssa_104>.16B, V<ssa_96>.16B, V<ssa_58>.16B            // ....................................................................*....................................................
        // eor V<ssa_105>.8B, V<ssa_102>.8B, V<ssa_99>.8B              // ......................................................................*..................................................
        // aesr V<ssa_82>.16b, V<ssa_55>.16b                           // ..................................................................................*......................................
        // aesr V<ssa_91>.16b, V<ssa_45>.16b                           // .........................................................................................*...............................
        // add v31.4S, V<ssa_89>.4S, v30.4S                            // .........................................................................*...............................................
        // aese V<ssa_82>.16b, V<ssa_65>.16b                           // ....................................................................................*....................................
        // aesr V<ssa_91>.16b, V<ssa_48>.16b                           // .............................................................................................*...........................
        // eor V<ssa_107>.16B, V<ssa_103>.16B, V<ssa_82>.16B           // ......................................................................................*..................................
        // aesr V<ssa_85>.16b, v19.16b                                 // .........*...............................................................................................................
        // add v29.4S, v31.4S, v30.4S                                  // ............................................................................*............................................
        // aesr V<ssa_85>.16b, v20.16b                                 // .............*...........................................................................................................
        // str Q<ssa_107>, [x2, #32]                                   // ..........................................................................................*..............................
        // rev32 V<ssa_111>.16B, v29.16B                               // ...............................................................................*.........................................
        // aesr V<ssa_85>.16b, v21.16b                                 // .................*.......................................................................................................
        // aesr V<ssa_85>.16b, v22.16b                                 // ....................*....................................................................................................
        // aesr V<ssa_91>.16b, V<ssa_53>.16b                           // .................................................................................................*.......................
        // aesr V<ssa_85>.16b, v23.16b                                 // .........................*...............................................................................................
        // aesr V<ssa_111>.16b, v18.16b                                // .................................................................................*.......................................
        // aesr V<ssa_85>.16b, v24.16b                                 // ............................*............................................................................................
        // ldr Q<ssa_118>, [x6, #64]                                   // ...........................................................................................*.............................
        // aesr V<ssa_111>.16b, v19.16b                                // ...................................................................................*.....................................
        // aesr V<ssa_85>.16b, V<ssa_45>.16b                           // ...............................*.........................................................................................
        // ldr q14, [x5, #112]                                         // ................................................................................................*........................
        // ldr q5, [x6, #32]                                           // ..................................................................................................*......................
        // aesr V<ssa_85>.16b, V<ssa_48>.16b                           // ...................................*.....................................................................................
        // ldr q13, [x5, #128]                                         // ....................................................................................................*....................
        // aesr V<ssa_111>.16b, v20.16b                                // .....................................................................................*...................................
        // aesr V<ssa_85>.16b, V<ssa_53>.16b                           // ......................................*..................................................................................
        // aesr V<ssa_111>.16b, v21.16b                                // ........................................................................................*................................
        // ldr Q<ssa_123>, [x0, #16]                                   // ...............*.........................................................................................................
        // aesr V<ssa_85>.16b, V<ssa_55>.16b                           // ...........................................*.............................................................................
        // aesr V<ssa_111>.16b, v22.16b                                // ............................................................................................*............................
        // ldr q4, [x5, #144]                                          // ................*........................................................................................................
        // aese V<ssa_85>.16b, V<ssa_65>.16b                           // .............................................*...........................................................................
        // aesr V<ssa_91>.16b, V<ssa_55>.16b                           // .....................................................................................................*...................
        // ldr q2, [x5, #160]                                          // ..................*......................................................................................................
        // aesr V<ssa_111>.16b, v23.16b                                // ...............................................................................................*.........................
        // eor V<ssa_126>.16B, V<ssa_101>.16B, V<ssa_85>.16B           // ...............................................*.........................................................................
        // pmull v1.1q, V<ssa_105>.1d, V<ssa_118>.1d                   // .....................................................................................................................*...
        // ldr q16, [x5, #192]                                         // .............................*...........................................................................................
        // rev64 V<ssa_127>.16B, V<ssa_126>.16B                        // ...................................................*.....................................................................
        // aesr V<ssa_111>.16b, v24.16b                                // ...................................................................................................*.....................
        // pmull V<ssa_128>.1q, V<ssa_99>.1d, V<ssa_95>.1d             // ................................................................*........................................................
        // str Q<ssa_126>, [x2], #(4*16)                               // ..............................................................*..........................................................
        // ldr Q<ssa_129>, [x6, #80]                                   // ..............................................................................................*..........................
        // aesr V<ssa_111>.16b, v14.16b                                // .......................................................................................................*.................
        // eor V<ssa_130>.16B, V<ssa_123>.16B, v16.16B                 // ....................................*....................................................................................
        // pmull2 v3.1q, V<ssa_99>.2d, V<ssa_95>.2d                    // ........................................................................*................................................
        // aesr V<ssa_111>.16b, v13.16b                                // ..........................................................................................................*..............
        // eor V<ssa_131>.16B, V<ssa_127>.16B, v11.16B                 // ......................................................*..................................................................
        // aese V<ssa_91>.16b, V<ssa_65>.16b                           // ........................................................................................................*................
        // ldr q10, [x5, #176]                                         // ......................................................................................................*..................
        // aesr V<ssa_111>.16b, v4.16b                                 // ..............................................................................................................*..........
        // ext V<ssa_132>.16B, V<ssa_131>.16B, V<ssa_131>.16B, #8      // .........................................................................................................*...............
        // pmull2 v27.1q, V<ssa_131>.2d, V<ssa_129>.2d                 // ............................................................................................................*............
        // eor v6.16B, V<ssa_104>.16B, V<ssa_91>.16B                   // ...........................................................................................................*.............
        // rev64 v8.16B, V<ssa_107>.16B                                // .............................................................................................................*...........
        // aesr V<ssa_111>.16b, v2.16b                                 // .................................................................................................................*.......
        // pmull V<ssa_133>.1q, V<ssa_131>.1d, V<ssa_129>.1d           // ................................................................................................................*........
        // eor V<ssa_134>.16B, V<ssa_132>.16B, V<ssa_131>.16B          // ...............................................................................................................*.........
        // ldr q17, [x6, #16]                                          // ......................................................................................................................*..
        // aese V<ssa_111>.16b, v10.16b                                // ....................................................................................................................*....
        // pmull2 v0.1q, V<ssa_134>.2d, V<ssa_118>.2d                  // ...................................................................................................................*.....
        // eor v12.16B, V<ssa_133>.16B, V<ssa_128>.16B                 // ..................................................................................................................*......
        // eor v25.16B, V<ssa_130>.16B, V<ssa_111>.16B                 // .......................................................................................................................*.
        // pmull v11.1q, v8.1d, v5.1d                                  // ........................................................................................................................*

        sub count, count, #2
cbz count, Lloop_unrolled_start_postamble
Lloop_unrolled_start:
        ext v26.16B, v8.16B, v8.16B, #8          // .......................................................................................l.........................................
        add v29.4S, v29.4S, v30.4S               // ....................................*............................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        eor v1.16B, v0.16B, v1.16B               // ............................................................l....................................................................
        rev64 v15.16B, v6.16B                    // .............................................................................................................l...................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        eor v26.16B, v26.16B, v8.16B             // ........................................................................................l........................................
        rev32 v0.16B, v29.16B                    // ..............................................................*..................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        pmull2 v5.1q, v8.2d, v5.2d               // .....................................................................................l...........................................
        mov d9, v15.d[1]                         // ..................................................................................................................l..............
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        rev32 v28.16B, v31.16B                   // .......*.........................................................................................................................
        aesr v0.16b, v18.16b                     // ................................................................*................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        pmull2 v31.1q, v26.2d, v17.2d            // .........................................................................................l.......................................
        eor v8.8B, v9.8B, v15.8B                 // ...................................................................................................................l.............
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        str q25, [x2, #16]                       // ...................................................*.............................................................................
        aesr v0.16b, v19.16b                     // .................................................................*...............................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        pmull v9.1q, v8.1d, v17.1d               // ....................................................................................................................l............
        add v26.4S, v29.4S, v30.4S               // ...............................................................*.................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        eor v17.16B, v1.16B, v31.16B             // ..........................................................................................l......................................
        aesr v0.16b, v20.16b                     // ..................................................................*..............................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v28.16b, v18.16b                    // .........*.......................................................................................................................
        rev32 v8.16B, v26.16B                    // ............................................................................................*....................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v0.16b, v21.16b                     // ...................................................................*.............................................................
        ldr q31, [x0, #32]                       // .............................................................*...................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v8.16b, v18.16b                     // ..............................................................................................*..................................
        ldr q29, [x0], #(4*16)                   // ......*..........................................................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v0.16b, v22.16b                     // ....................................................................*............................................................
        eor v1.16B, v17.16B, v9.16B              // .....................................................................................................................l...........
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v8.16b, v19.16b                     // ...............................................................................................*.................................
        ldr q9, [x6, #48]                        // ........................*........................................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        str q6, [x2, #-16]                       // ............................................................................................................l....................
        aesr v0.16b, v23.16b                     // .....................................................................*...........................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v8.16b, v20.16b                     // ................................................................................................*................................
        ldr q6, [x0, #-16]                       // ...........................................................................................*.....................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        eor v27.16B, v27.16B, v3.16B             // ........................................................l........................................................................
        aesr v0.16b, v24.16b                     // ......................................................................*..........................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        eor v11.16B, v12.16B, v11.16B            // ....................................................................................l............................................
        aesr v8.16b, v21.16b                     // .................................................................................................*...............................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        rev64 v3.16B, v25.16B                    // ....................................................*............................................................................
        aesr v0.16b, v14.16b                     // .......................................................................*.........................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        eor v5.16B, v27.16B, v5.16B              // ......................................................................................l..........................................
        aesr v8.16b, v22.16b                     // ..................................................................................................*..............................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v0.16b, v13.16b                     // ........................................................................*........................................................
        eor v27.16B, v29.16B, v16.16B            // .....................*...........................................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v8.16b, v23.16b                     // ...................................................................................................*.............................
        mov d12, v3.d[1]                         // .........................................................*.......................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        eor v17.16B, v31.16B, v16.16B            // ............................................................................*....................................................
        aesr v0.16b, v4.16b                      // .........................................................................*.......................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v8.16b, v24.16b                     // ....................................................................................................*............................
        eor v6.16B, v6.16B, v16.16B              // ..........................................................................................................*......................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        eor v16.8B, v12.8B, v3.8B                // ..........................................................*......................................................................
        aesr v0.16b, v2.16b                      // ..........................................................................*......................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v8.16b, v14.16b                     // .....................................................................................................*...........................
        ldr q12, [x6]                            // ...............................................................................l.................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        add v31.4S, v26.4S, v30.4S               // .............................................................................................*...................................
        aese v0.16b, v10.16b                     // ...........................................................................*.....................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v8.16b, v13.16b                     // ......................................................................................................*..........................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        eor v17.16B, v17.16B, v0.16B             // .............................................................................*...................................................
        aesr v28.16b, v19.16b                    // ..........*......................................................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        add v29.4S, v31.4S, v30.4S               // ........e........................................................................................................................
        pmull2 v25.1q, v15.2d, v12.2d            // ................................................................................................................l................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v28.16b, v20.16b                    // ...........*.....................................................................................................................
        str q17, [x2, #32]                       // ..............................................................................*..................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        pmull v12.1q, v15.1d, v12.1d             // ..............................................................................................................l..................
        eor v0.16B, v5.16B, v25.16B              // .................................................................................................................l...............
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        rev32 v26.16B, v29.16B                   // ...................................e.............................................................................................
        aesr v28.16b, v21.16b                    // ............*....................................................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        eor v12.16B, v11.16B, v12.16B            // ...............................................................................................................l.................
        pmull v25.1q, v0.1d, v7.1d               // .......................................................................................................................l.........
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v28.16b, v22.16b                    // .............*...................................................................................................................
        ext v11.16B, v0.16B, v0.16B, #8          // ........................................................................................................................l........
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v8.16b, v4.16b                      // .......................................................................................................*.........................
        eor v0.16B, v12.16B, v0.16B              // ......................................................................................................................l..........
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v28.16b, v23.16b                    // ..............*..................................................................................................................
        eor v11.16B, v11.16B, v25.16B            // ..........................................................................................................................l......
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        eor v25.16B, v1.16B, v0.16B              // .........................................................................................................................l.......
        aesr v26.16b, v18.16b                    // .....................................e...........................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v28.16b, v24.16b                    // ...............*.................................................................................................................
        ldr q0, [x6, #64]                        // ..........................*......................................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v26.16b, v19.16b                    // ......................................e..........................................................................................
        eor v11.16B, v25.16B, v11.16B            // ...........................................................................................................................l.....
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v28.16b, v14.16b                    // ................*................................................................................................................
        ldr q14, [x5, #112]                      // e................................................................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        pmull v25.1q, v11.1d, v7.1d              // ............................................................................................................................l....
        ldr q5, [x6, #32]                        // ................................................................................*................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v28.16b, v13.16b                    // .................*...............................................................................................................
        ldr q13, [x5, #128]                      // .e...............................................................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v26.16b, v20.16b                    // .......................................e.........................................................................................
        eor v12.16B, v12.16B, v25.16B            // .............................................................................................................................l...
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v28.16b, v4.16b                     // ..................*..............................................................................................................
        ext v4.16B, v11.16B, v11.16B, #8         // ..............................................................................................................................l..
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v26.16b, v21.16b                    // ........................................e........................................................................................
        ldr q25, [x0, #16]                       // ..................................e..............................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v28.16b, v2.16b                     // ...................*.............................................................................................................
        eor v12.16B, v12.16B, v4.16B             // ...............................................................................................................................l.
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v26.16b, v22.16b                    // .........................................e.......................................................................................
        ldr q4, [x5, #144]                       // ..e..............................................................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aese v28.16b, v10.16b                    // ....................*............................................................................................................
        ext v11.16B, v12.16B, v12.16B, #8        // ................................................................................................................................l
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v8.16b, v2.16b                      // ........................................................................................................*........................
        ldr q2, [x5, #160]                       // ...e.............................................................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v26.16b, v23.16b                    // ..........................................e......................................................................................
        eor v15.16B, v27.16B, v28.16B            // ......................*..........................................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        pmull v1.1q, v16.1d, v0.1d               // ...........................................................*.....................................................................
        ldr q16, [x5, #192]                      // .....e...........................................................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        rev64 v27.16B, v15.16B                   // ...........................*.....................................................................................................
        aesr v26.16b, v24.16b                    // ...........................................e.....................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        pmull v12.1q, v3.1d, v9.1d               // .....................................................*...........................................................................
        str q15, [x2], #(4*16)                   // .......................*.........................................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        ldr q15, [x6, #80]                       // .........................*.......................................................................................................
        aesr v26.16b, v14.16b                    // ............................................e....................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        eor v25.16B, v25.16B, v16.16B            // .................................................e...............................................................................
        pmull2 v3.1q, v3.2d, v9.2d               // .......................................................*.........................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v26.16b, v13.16b                    // .............................................e...................................................................................
        eor v11.16B, v27.16B, v11.16B            // ............................*....................................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aese v8.16b, v10.16b                     // .........................................................................................................*.......................
        ldr q10, [x5, #176]                      // ....e............................................................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        aesr v26.16b, v4.16b                     // ..............................................e..................................................................................
        ext v9.16B, v11.16B, v11.16B, #8         // ...............................*.................................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        pmull2 v27.1q, v11.2d, v15.2d            // ..............................*..................................................................................................
        eor v6.16B, v6.16B, v8.16B               // ...........................................................................................................*.....................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        rev64 v8.16B, v17.16B                    // ..................................................................................*..............................................
        aesr v26.16b, v2.16b                     // ...............................................e.................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        pmull v15.1q, v11.1d, v15.1d             // .............................*...................................................................................................
        eor v28.16B, v9.16B, v11.16B             // ................................*................................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        ldr q17, [x6, #16]                       // .................................................................................*...............................................
        aese v26.16b, v10.16b                    // ................................................e................................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        pmull2 v0.1q, v28.2d, v0.2d              // .................................*...............................................................................................
        eor v12.16B, v15.16B, v12.16B            // ......................................................*..........................................................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................
        eor v25.16B, v25.16B, v26.16B            // ..................................................e..............................................................................
        pmull v11.1q, v8.1d, v5.1d               // ...................................................................................*.............................................
        // gap                                   // .................................................................................................................................
        // gap                                   // .................................................................................................................................

        // original source code
        // ldr q25, [x5, #((7)*16)]                        // .......................e................................................|...............................................................................e................................................|...............................................................................e................
        // ldr q26, [x5, #((8)*16)]                        // ...........................e............................................|...................................................................................e............................................|...................................................................................e............
        // ldr q27, [x5, #((9)*16)]                        // .....................................e..................................|.............................................................................................e..................................|.............................................................................................e..
        // ldr q28, [x5, #((10)*16)]                       // .........................................e..............................|.................................................................................................e..............................|................................................................................................
        // ldr q15, [x5, #((11)*16)]                       // .........................................................e..............|.................................................................................................................e..............|................................................................................................
        // ldr q16, [x5, #((12)*16)]                       // .............................................e..........................|.....................................................................................................e..........................|................................................................................................
        // ldr q29, [x0], #(4*16)                          // ........................................................................|......................*.........................................................................................................|......................*.........................................................................
        // rev32  v0.16b, v31.16b                          // ........................................................................|.......*........................................................................................................................|.......*........................................................................................
        // add    v31.4s, v31.4s, v30.4s                   // e.......................................................................|........................................................e.......................................................................|........................................................e.......................................
        // aesr v0.16b, v18.16b                            // ........................................................................|.................*..............................................................................................................|.................*..............................................................................
        // aesr v0.16b, v19.16b                            // ........................................................................|.......................................................*........................................................................|.......................................................*........................................
        // aesr v0.16b, v20.16b                            // ..*.....................................................................|..........................................................*.....................................................................|..........................................................*.....................................
        // aesr v0.16b, v21.16b                            // .......*................................................................|...............................................................*................................................................|...............................................................*................................
        // aesr v0.16b, v22.16b                            // ..........*.............................................................|..................................................................*.............................................................|..................................................................*.............................
        // aesr v0.16b, v23.16b                            // ..............*.........................................................|......................................................................*.........................................................|......................................................................*.........................
        // aesr v0.16b, v24.16b                            // ..................*.....................................................|..........................................................................*.....................................................|..........................................................................*.....................
        // aesr v0.16b, v25.16b                            // ......................*.................................................|..............................................................................*.................................................|..............................................................................*.................
        // aesr v0.16b, v26.16b                            // ..........................*.............................................|..................................................................................*.............................................|..................................................................................*.............
        // aesr v0.16b, v27.16b                            // ..............................*.........................................|......................................................................................*.........................................|......................................................................................*.........
        // aesr v0.16b, v28.16b                            // ..................................*.....................................|..........................................................................................*.....................................|..........................................................................................*.....
        // aese v0.16b, v15.16b                            // ......................................*.................................|..............................................................................................*.................................|..............................................................................................*.
        // eor v29.16b, v29.16b, v16.16b                   // ........................................................................|........................................*.......................................................................................|........................................*.......................................................
        // eor v0.16b, v29.16b, v0.16b                     // ...........................................*............................|...................................................................................................*............................|................................................................................................
        // str q0, [x2], #(4*16)                           // .................................................*......................|.........................................................................................................*......................|................................................................................................
        // ldr q12, [x6, #48]                              // ........................................................................|..........................*.....................................................................................................|..........................*.....................................................................
        // ldr q13, [x6, #80]                              // ..................................................*.....................|..........................................................................................................*.....................|................................................................................................
        // ldr q14, [x6, #64]                              // ...................*....................................................|...........................................................................*....................................................|...........................................................................*....................
        // rev64 v0.16b, v0.16b                            // ..............................................*.........................|......................................................................................................*.........................|................................................................................................
        // eor   v0.16b, v0.16b, v11.16b                   // .......................................................*................|...............................................................................................................*................|................................................................................................
        // pmull   v8.1q, v0.1d, v13.1d                    // ................................................................*.......|........................................................................................................................*.......|................................................................................................
        // pmull2  v9.1q, v0.2d, v13.2d                    // ............................................................*...........|....................................................................................................................*...........|................................................................................................
        // ext     v11.16b, v0.16b, v0.16b, #8             // ...........................................................*............|...................................................................................................................*............|................................................................................................
        // eor     v11.16b, v11.16b, v0.16b                // .................................................................*......|.........................................................................................................................*......|................................................................................................
        // pmull2  v10.1q, v11.2d, v14.2d                  // ....................................................................*...|............................................................................................................................*...|................................................................................................
        // ldr q29, [x0, #(-3*16)]                         // .................................e......................................|.........................................................................................e......................................|.........................................................................................e......
        // rev32  v0.16b, v31.16b                          // ......e.................................................................|..............................................................e.................................................................|..............................................................e.................................
        // add    v31.4s, v31.4s, v30.4s                   // ........................................................................|*...............................................................................................................................|*...............................................................................................
        // aesr v0.16b, v18.16b                            // .................e......................................................|.........................................................................e......................................................|.........................................................................e......................
        // aesr v0.16b, v19.16b                            // ....................e...................................................|............................................................................e...................................................|............................................................................e...................
        // aesr v0.16b, v20.16b                            // ............................e...........................................|....................................................................................e...........................................|....................................................................................e...........
        // aesr v0.16b, v21.16b                            // ................................e.......................................|........................................................................................e.......................................|........................................................................................e.......
        // aesr v0.16b, v22.16b                            // ....................................e...................................|............................................................................................e...................................|............................................................................................e...
        // aesr v0.16b, v23.16b                            // ..........................................e.............................|..................................................................................................e.............................|................................................................................................
        // aesr v0.16b, v24.16b                            // ...............................................e........................|.......................................................................................................e........................|................................................................................................
        // aesr v0.16b, v25.16b                            // ...................................................e....................|...........................................................................................................e....................|................................................................................................
        // aesr v0.16b, v26.16b                            // ......................................................e.................|..............................................................................................................e.................|................................................................................................
        // aesr v0.16b, v27.16b                            // ..........................................................e.............|..................................................................................................................e.............|................................................................................................
        // aesr v0.16b, v28.16b                            // ...............................................................e........|.......................................................................................................................e........|................................................................................................
        // aese v0.16b, v15.16b                            // ...................................................................e....|...........................................................................................................................e....|................................................................................................
        // eor v29.16b, v29.16b, v16.16b                   // ....................................................e...................|............................................................................................................e...................|................................................................................................
        // eor v0.16b, v29.16b, v0.16b                     // ......................................................................e.|..............................................................................................................................e.|................................................................................................
        // str q0, [x2, #(-3*16)]                          // ........................................................................|...........*....................................................................................................................|...........*....................................................................................
        // rev64   v0.16b, v0.16b                          // ........................................................................|...................................*............................................................................................|...................................*............................................................
        // pmull   v11.1q, v0.1d, v12.1d                   // ................................................*.......................|........................................................................................................*.......................|................................................................................................
        // eor     v8.16b, v8.16b, v11.16b                 // .....................................................................*..|.............................................................................................................................*..|................................................................................................
        // pmull2  v11.1q, v0.2d, v12.2d                   // .....................................................*..................|.............................................................................................................*..................|................................................................................................
        // eor     v9.16b, v9.16b, v11.16b                 // ........................................................................|...............................l................................................................................................|...............................l................................................................
        // mov     d11, v0.d[1]                            // ........................................................................|..........................................*.....................................................................................|..........................................*.....................................................
        // eor     v11.8b, v11.8b, v0.8b                   // ........................................................................|...............................................*................................................................................|...............................................*................................................
        // pmull   v11.1q, v11.1d, v14.1d                  // ............................................*...........................|....................................................................................................*...........................|................................................................................................
        // eor     v10.16b, v10.16b, v11.16b               // ........................................................................|.l..............................................................................................................................|.l..............................................................................................
        // ldr q29, [x0, #(-2*16)]                         // ........................................................................|....................*...........................................................................................................|....................*...........................................................................
        // rev32  v0.16b, v31.16b                          // ........................................................................|....*...........................................................................................................................|....*...........................................................................................
        // add    v31.4s, v31.4s, v30.4s                   // ........................................................................|..............*.................................................................................................................|..............*.................................................................................
        // aesr v0.16b, v18.16b                            // ........................................................................|........*.......................................................................................................................|........*.......................................................................................
        // aesr v0.16b, v19.16b                            // ........................................................................|............*...................................................................................................................|............*...................................................................................
        // aesr v0.16b, v20.16b                            // ........................................................................|................*...............................................................................................................|................*...............................................................................
        // aesr v0.16b, v21.16b                            // ........................................................................|...................*............................................................................................................|...................*............................................................................
        // aesr v0.16b, v22.16b                            // ........................................................................|.......................*........................................................................................................|.......................*........................................................................
        // aesr v0.16b, v23.16b                            // ........................................................................|............................*...................................................................................................|............................*...................................................................
        // aesr v0.16b, v24.16b                            // ........................................................................|................................*...............................................................................................|................................*...............................................................
        // aesr v0.16b, v25.16b                            // ........................................................................|....................................*...........................................................................................|....................................*...........................................................
        // aesr v0.16b, v26.16b                            // ........................................................................|.......................................*........................................................................................|.......................................*........................................................
        // aesr v0.16b, v27.16b                            // ........................................................................|............................................*...................................................................................|............................................*...................................................
        // aesr v0.16b, v28.16b                            // ........................................................................|................................................*...............................................................................|................................................*...............................................
        // aese v0.16b, v15.16b                            // ........................................................................|....................................................*...........................................................................|....................................................*...........................................
        // eor v29.16b, v29.16b, v16.16b                   // ........................................................................|...........................................*....................................................................................|...........................................*....................................................
        // eor v0.16b, v29.16b, v0.16b                     // ........................................................................|......................................................*.........................................................................|......................................................*.........................................
        // str q0, [x2, #(-2*16)]                          // ...*....................................................................|...........................................................*....................................................................|...........................................................*....................................
        // ldr q12, [x6]                                   // ........................................................................|..................................................l.............................................................................|..................................................l.............................................
        // ldr q13, [x6, #32]                              // .........................*..............................................|.................................................................................*..............................................|.................................................................................*..............
        // ldr q14, [x6, #16]                              // ..................................................................*.....|..........................................................................................................................*.....|................................................................................................
        // rev64   v0.16b, v0.16b                          // ..............................................................*.........|......................................................................................................................*.........|................................................................................................
        // pmull   v11.1q, v0.1d, v13.1d                   // .......................................................................*|...............................................................................................................................*|................................................................................................
        // eor     v8.16b, v8.16b, v11.16b                 // ........................................................................|.................................l..............................................................................................|.................................l..............................................................
        // pmull2  v11.1q, v0.2d, v13.2d                   // ........................................................................|.....l..........................................................................................................................|.....l..........................................................................................
        // eor     v9.16b, v9.16b, v11.16b                 // ........................................................................|.....................................l..........................................................................................|.....................................l..........................................................
        // ext     v11.16b, v0.16b, v0.16b, #8             // ........................................................................l................................................................................................................................l................................................................................................
        // eor     v11.16b, v11.16b, v0.16b                // ........................................................................|...l............................................................................................................................|...l............................................................................................
        // pmull2  v11.1q, v11.2d, v14.2d                  // ........................................................................|.........l......................................................................................................................|.........l......................................................................................
        // eor     v10.16b, v10.16b, v11.16b               // ........................................................................|...............l................................................................................................................|...............l................................................................................
        // ldr q29, [x0, #(-1*16)]                         // ........................................................................|..............................*.................................................................................................|..............................*.................................................................
        // rev32  v0.16b, v31.16b                          // ........................................................................|..................*.............................................................................................................|..................*.............................................................................
        // add    v31.4s, v31.4s, v30.4s                   // ........................................................................|...................................................*............................................................................|...................................................*............................................
        // aesr v0.16b, v18.16b                            // ........................................................................|.....................*..........................................................................................................|.....................*..........................................................................
        // aesr v0.16b, v19.16b                            // ........................................................................|.........................*......................................................................................................|.........................*......................................................................
        // aesr v0.16b, v20.16b                            // ........................................................................|.............................*..................................................................................................|.............................*..................................................................
        // aesr v0.16b, v21.16b                            // ........................................................................|..................................*.............................................................................................|..................................*.............................................................
        // aesr v0.16b, v22.16b                            // ........................................................................|......................................*.........................................................................................|......................................*.........................................................
        // aesr v0.16b, v23.16b                            // ........................................................................|.........................................*......................................................................................|.........................................*......................................................
        // aesr v0.16b, v24.16b                            // ........................................................................|.............................................*..................................................................................|.............................................*..................................................
        // aesr v0.16b, v25.16b                            // ........................................................................|.................................................*..............................................................................|.................................................*..............................................
        // aesr v0.16b, v26.16b                            // ........................................................................|.....................................................*..........................................................................|.....................................................*..........................................
        // aesr v0.16b, v27.16b                            // ............*...........................................................|....................................................................*...........................................................|....................................................................*...........................
        // aesr v0.16b, v28.16b                            // ........................................*...............................|................................................................................................*...............................|................................................................................................
        // aese v0.16b, v15.16b                            // ........................................................*...............|................................................................................................................*...............|................................................................................................
        // eor v29.16b, v29.16b, v16.16b                   // ........................................................................|..............................................*.................................................................................|..............................................*.................................................
        // eor v0.16b, v29.16b, v0.16b                     // .............................................................*..........|.....................................................................................................................*..........|................................................................................................
        // str q0, [x2, #(-1*16)]                          // ........................................................................|...........................l....................................................................................................|...........................l....................................................................
        // rev64   v0.16b, v0.16b                          // ........................................................................|..l.............................................................................................................................|..l.............................................................................................
        // pmull   v11.1q, v0.1d, v12.1d                   // ....l...................................................................|............................................................l...................................................................|............................................................l...................................
        // eor     v8.16b, v8.16b, v11.16b                 // ........l...............................................................|................................................................l...............................................................|................................................................l...............................
        // pmull2  v11.1q, v0.2d, v12.2d                   // .l......................................................................|.........................................................l......................................................................|.........................................................l......................................
        // eor     v9.16b, v9.16b, v11.16b                 // .....l..................................................................|.............................................................l..................................................................|.............................................................l..................................
        // mov     d11, v0.d[1]                            // ........................................................................|......l.........................................................................................................................|......l.........................................................................................
        // eor     v11.8b, v11.8b, v0.8b                   // ........................................................................|..........l.....................................................................................................................|..........l.....................................................................................
        // pmull   v11.1q, v11.1d, v14.1d                  // ........................................................................|.............l..................................................................................................................|.............l..................................................................................
        // eor     v10.16b, v10.16b, v11.16b               // ........................................................................|........................l.......................................................................................................|........................l.......................................................................
        // eor        v0.16b, v8.16b,  v9.16b              // .............l..........................................................|.....................................................................l..........................................................|.....................................................................l..........................
        // pmull      v1.1q,  v9.1d,   v7.1d               // .........l..............................................................|.................................................................l..............................................................|.................................................................l..............................
        // ext        v9.16b,    v9.16b,  v9.16b, #8       // ...........l............................................................|...................................................................l............................................................|...................................................................l............................
        // eor        v10.16b,   v10.16b, v0.16b           // ................l.......................................................|........................................................................l.......................................................|........................................................................l.......................
        // eor        v1.16b, v9.16b,  v1.16b              // ...............l........................................................|.......................................................................l........................................................|.......................................................................l........................
        // eor        v10.16b,   v10.16b, v1.16b           // .....................l..................................................|.............................................................................l..................................................|.............................................................................l..................
        // pmull      v9.1q,     v10.1d,  v7.1d            // ........................l...............................................|................................................................................l...............................................|................................................................................l...............
        // eor        v8.16b,    v8.16b,  v9.16b           // .............................l..........................................|.....................................................................................l..........................................|.....................................................................................l..........
        // ext        v10.16b,   v10.16b, v10.16b, #8      // ...............................l........................................|.......................................................................................l........................................|.......................................................................................l........
        // eor        v11.16b,     v8.16b,  v10.16b        // ...................................l....................................|...........................................................................................l....................................|...........................................................................................l....
        // ext        v11.16b, v11.16b, v11.16b, #8        // .......................................l................................|...............................................................................................l................................|...............................................................................................l

        sub count, count, #1
        cbnz count, Lloop_unrolled_start
Lloop_unrolled_start_postamble:// end of loop kernel
        add v15.4S, v29.4S, v30.4S               // .*.......................................................................................................................................
        rev32 v9.16B, v31.16B                    // ........*................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        ldr q31, [x6]                            // .........................................................................................................................*...............
        eor v28.16B, v0.16B, v1.16B              // ..*......................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        rev32 v29.16B, v15.16B                   // .....*...................................................................................................................................
        pmull2 v1.1q, v8.2d, v5.2d               // ......*..................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v9.16b, v18.16b                     // ..................*......................................................................................................................
        ext v26.16B, v8.16B, v8.16B, #8          // *........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v29.16b, v18.16b                    // .........*...............................................................................................................................
        add v0.4S, v15.4S, v30.4S                // ...............*.........................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v9.16b, v19.16b                     // ........................................................*................................................................................
        eor v15.16B, v26.16B, v8.16B             // ....*....................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        rev64 v8.16B, v6.16B                     // ...*.....................................................................................................................................
        aesr v29.16b, v19.16b                    // .............*...........................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        pmull2 v15.1q, v15.2d, v17.2d            // ..........*..............................................................................................................................
        rev32 v26.16B, v0.16B                    // ...................*.....................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        mov d5, v8.d[1]                          // .......*.................................................................................................................................
        aesr v29.16b, v20.16b                    // .................*.......................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        eor v15.16B, v28.16B, v15.16B            // ................*........................................................................................................................
        aesr v26.16b, v18.16b                    // ......................*..................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v29.16b, v21.16b                    // ....................*....................................................................................................................
        eor v27.16B, v27.16B, v3.16B             // ................................*........................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        eor v5.8B, v5.8B, v8.8B                  // ...........*.............................................................................................................................
        aesr v26.16b, v19.16b                    // ..........................*..............................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v29.16b, v22.16b                    // ........................*................................................................................................................
        ldr q28, [x6, #16]                       // ......................................................................................................*..................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        pmull v17.1q, v5.1d, v17.1d              // ..............*..........................................................................................................................
        ldr q5, [x6]                             // ...................................................*.....................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v29.16b, v23.16b                    // .............................*...........................................................................................................
        ldr q3, [x0], #(4*16)                    // .......................*.................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        eor v27.16B, v27.16B, v1.16B             // ......................................*..................................................................................................
        aesr v26.16b, v20.16b                    // ..............................*..........................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v29.16b, v24.16b                    // .................................*.......................................................................................................
        eor v17.16B, v15.16B, v17.16B            // .........................*...............................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        ldr q1, [x0, #-32]                       // .....................*...................................................................................................................
        pmull2 v15.1q, v8.2d, v5.2d              // .........................................................*...............................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v29.16b, v14.16b                    // .....................................*...................................................................................................
        eor v12.16B, v12.16B, v11.16B            // ..................................*......................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        eor v27.16B, v27.16B, v15.16B            // .............................................................*...........................................................................
        pmull v11.1q, v8.1d, v5.1d               // ............................................................*............................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v29.16b, v13.16b                    // ........................................*................................................................................................
        rev64 v15.16B, v25.16B                   // ....................................*....................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v9.16b, v20.16b                     // ..........................................................*..............................................................................
        eor v12.16B, v12.16B, v11.16B            // ...............................................................*.........................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v29.16b, v4.16b                     // .............................................*...........................................................................................
        ldr q5, [x0, #-16]                       // ...............................*.........................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        ext v11.16B, v27.16B, v27.16B, #8        // ..................................................................*......................................................................
        pmull v8.1q, v27.1d, v7.1d               // ................................................................*........................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v29.16b, v2.16b                     // .................................................*.......................................................................................
        eor v1.16B, v1.16B, v16.16B              // ............................................*............................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v9.16b, v21.16b                     // ..............................................................*..........................................................................
        eor v11.16B, v11.16B, v8.16B             // ......................................................................*..................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aese v29.16b, v10.16b                    // .....................................................*...................................................................................
        eor v5.16B, v5.16B, v16.16B              // ...............................................*.........................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v9.16b, v22.16b                     // .................................................................*.......................................................................
        eor v27.16B, v12.16B, v27.16B            // ....................................................................*....................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        eor v8.16B, v1.16B, v29.16B              // .......................................................*.................................................................................
        aesr v26.16b, v21.16b                    // ...................................*.....................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v9.16b, v23.16b                     // .....................................................................*...................................................................
        eor v1.16B, v17.16B, v27.16B             // .......................................................................*.................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        rev64 v29.16B, v8.16B                    // ...................................................................................................*.....................................
        aesr v26.16b, v22.16b                    // .......................................*.................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v9.16b, v24.16b                     // ........................................................................*................................................................
        eor v17.16B, v1.16B, v11.16B             // ..........................................................................*..............................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        ldr q27, [x6, #48]                       // ...........................*.............................................................................................................
        aesr v26.16b, v23.16b                    // ..........................................*..............................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        mov d1, v15.d[1]                         // ...........................................*.............................................................................................
        pmull v11.1q, v17.1d, v7.1d              // ............................................................................*............................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v26.16b, v24.16b                    // ..............................................*..........................................................................................
        eor v16.16B, v3.16B, v16.16B             // .........................................*...............................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v9.16b, v14.16b                     // ...........................................................................*.............................................................
        eor v1.8B, v1.8B, v15.8B                 // ................................................*........................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v26.16b, v14.16b                    // ..................................................*......................................................................................
        ldr q3, [x6, #64]                        // .........................................................................*...............................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v9.16b, v13.16b                     // ..............................................................................*..........................................................
        ext v17.16B, v17.16B, v17.16B, #8        // .................................................................................*.......................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v26.16b, v13.16b                    // ......................................................*..................................................................................
        eor v13.16B, v12.16B, v11.16B            // ...............................................................................*.........................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v9.16b, v4.16b                      // ................................................................................*........................................................
        ldr q11, [x6, #32]                       // .............................................................................*...........................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        eor v12.16B, v13.16B, v17.16B            // ...................................................................................*.....................................................
        aesr v26.16b, v4.16b                     // ...................................................................*.....................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v9.16b, v2.16b                      // ..................................................................................*......................................................
        ext v13.16B, v29.16B, v29.16B, #8        // ..........................................................................................................*..............................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aesr v26.16b, v2.16b                     // ......................................................................................*..................................................
        ldr q4, [x6, #80]                        // ............................................................................................*............................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aese v9.16b, v10.16b                     // ....................................................................................*....................................................
        eor v2.16B, v13.16B, v29.16B             // .............................................................................................................*...........................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        aese v26.16b, v10.16b                    // ...............................................................................................*.........................................
        ext v12.16B, v12.16B, v12.16B, #8        // .....................................................................................*...................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        pmull2 v10.1q, v29.2d, v11.2d            // ..............................................................................................................*..........................
        eor v14.16B, v16.16B, v9.16B             // .......................................................................................*.................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        pmull v9.1q, v15.1d, v27.1d              // ..........................................................................................*..............................................
        eor v17.16B, v5.16B, v26.16B             // ..................................................................................................*......................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        pmull2 v13.1q, v15.2d, v27.2d            // .............................................................................................*...........................................
        rev64 v5.16B, v14.16B                    // .........................................................................................*...............................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        str q17, [x2, #48]                       // .....................................................................................................................*...................
        rev64 v17.16B, v17.16B                   // ............................................................................................................*............................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        eor v26.16B, v5.16B, v12.16B             // ..............................................................................................*..........................................
        pmull v27.1q, v1.1d, v3.1d               // ........................................................................................*................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        pmull v5.1q, v29.1d, v11.1d              // .........................................................................................................*...............................
        mov d12, v17.d[1]                        // ...............................................................................................................*.........................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        pmull v29.1q, v26.1d, v4.1d              // ....................................................................................................*....................................
        ext v11.16B, v26.16B, v26.16B, #8        // ................................................................................................*........................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        eor v12.8B, v12.8B, v17.8B               // .................................................................................................................*.......................
        pmull2 v4.1q, v26.2d, v4.2d              // .................................................................................................*.......................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        eor v9.16B, v29.16B, v9.16B              // ........................................................................................................*................................
        eor v26.16B, v11.16B, v26.16B            // .....................................................................................................*...................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        pmull2 v29.1q, v17.2d, v31.2d            // ..........................................................................................................................*..............
        eor v11.16B, v4.16B, v13.16B             // ......................................................................................................................*..................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        eor v9.16B, v9.16B, v5.16B               // .......................................................................................................................*.................
        pmull2 v13.1q, v26.2d, v3.2d             // .......................................................................................................*.................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        pmull2 v26.1q, v2.2d, v28.2d             // ................................................................................................................*........................
        eor v5.16B, v11.16B, v10.16B             // ........................................................................................................................*................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        pmull v2.1q, v17.1d, v31.1d              // ...........................................................................................................................*.............
        eor v17.16B, v13.16B, v27.16B            // ...........................................................................................................*.............................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        pmull v31.1q, v12.1d, v28.1d             // ..................................................................................................................*......................
        eor v27.16B, v5.16B, v29.16B             // ............................................................................................................................*............
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        eor v12.16B, v9.16B, v2.16B              // .............................................................................................................................*...........
        eor v13.16B, v17.16B, v26.16B            // ...................................................................................................................*.....................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        ext v9.16B, v27.16B, v27.16B, #8         // ...............................................................................................................................*.........
        pmull v5.1q, v27.1d, v7.1d               // ..............................................................................................................................*..........
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        eor v29.16B, v12.16B, v27.16B            // ................................................................................................................................*........
        eor v27.16B, v13.16B, v31.16B            // ....................................................................................................................*....................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        eor v9.16B, v9.16B, v5.16B               // .................................................................................................................................*.......
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        eor v29.16B, v27.16B, v29.16B            // ..................................................................................................................................*......
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        eor v9.16B, v29.16B, v9.16B              // ...................................................................................................................................*.....
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        ext v29.16B, v9.16B, v9.16B, #8          // ......................................................................................................................................*..
        pmull v5.1q, v9.1d, v7.1d                // ....................................................................................................................................*....
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        eor v9.16B, v12.16B, v5.16B              // .....................................................................................................................................*...
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        str q25, [x2, #16]                       // ............*............................................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        eor v29.16B, v9.16B, v29.16B             // .......................................................................................................................................*.
        str q6, [x2, #-16]                       // ............................*............................................................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        add v31.4S, v0.4S, v30.4S                // ....................................................*....................................................................................
        str q8, [x2, #32]                        // ...........................................................*.............................................................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................
        ext v11.16B, v29.16B, v29.16B, #8        // ........................................................................................................................................*
        str q14, [x2], #(4*16)                   // ...........................................................................................*.............................................
        // gap                                   // .........................................................................................................................................
        // gap                                   // .........................................................................................................................................

        // original source code
        // ext V<ssa_0>.16B, v8.16B, v8.16B, #8                        // .......*.................................................................................................................................
        // add V<ssa_1>.4S, v29.4S, v30.4S                             // *........................................................................................................................................
        // eor V<ssa_2>.16B, v0.16B, v1.16B                            // ...*.....................................................................................................................................
        // rev64 V<ssa_3>.16B, v6.16B                                  // ............*............................................................................................................................
        // eor V<ssa_4>.16B, V<ssa_0>.16B, v8.16B                      // ...........*.............................................................................................................................
        // rev32 V<ssa_5>.16B, V<ssa_1>.16B                            // ....*....................................................................................................................................
        // pmull2 V<ssa_6>.1q, v8.2d, v5.2d                            // .....*...................................................................................................................................
        // mov D<ssa_7>, V<ssa_3>.d[1]                                 // ................*........................................................................................................................
        // rev32 V<ssa_8>.16B, v31.16B                                 // .*.......................................................................................................................................
        // aesr V<ssa_5>.16b, v18.16b                                  // ........*................................................................................................................................
        // pmull2 V<ssa_9>.1q, V<ssa_4>.2d, v17.2d                     // ..............*..........................................................................................................................
        // eor V<ssa_10>.8B, V<ssa_7>.8B, V<ssa_3>.8B                  // ......................*..................................................................................................................
        // str q25, [x2, #16]                                          // ..................................................................................................................................*......
        // aesr V<ssa_5>.16b, v19.16b                                  // .............*...........................................................................................................................
        // pmull V<ssa_11>.1q, V<ssa_10>.1d, v17.1d                    // ..........................*..............................................................................................................
        // add V<ssa_12>.4S, V<ssa_1>.4S, v30.4S                       // .........*...............................................................................................................................
        // eor V<ssa_13>.16B, V<ssa_2>.16B, V<ssa_9>.16B               // ..................*......................................................................................................................
        // aesr V<ssa_5>.16b, v20.16b                                  // .................*.......................................................................................................................
        // aesr V<ssa_8>.16b, v18.16b                                  // ......*..................................................................................................................................
        // rev32 V<ssa_14>.16B, V<ssa_12>.16B                          // ...............*.........................................................................................................................
        // aesr V<ssa_5>.16b, v21.16b                                  // ....................*....................................................................................................................
        // ldr Q<ssa_15>, [x0, #32]                                    // ..................................*......................................................................................................
        // aesr V<ssa_14>.16b, v18.16b                                 // ...................*.....................................................................................................................
        // ldr Q<ssa_16>, [x0], #(4*16)                                // .............................*...........................................................................................................
        // aesr V<ssa_5>.16b, v22.16b                                  // ........................*................................................................................................................
        // eor V<ssa_17>.16B, V<ssa_13>.16B, V<ssa_11>.16B             // .................................*.......................................................................................................
        // aesr V<ssa_14>.16b, v19.16b                                 // .......................*.................................................................................................................
        // ldr Q<ssa_18>, [x6, #48]                                    // ................................................................*........................................................................
        // str q6, [x2, #-16]                                          // ....................................................................................................................................*....
        // aesr V<ssa_5>.16b, v23.16b                                  // ............................*............................................................................................................
        // aesr V<ssa_14>.16b, v20.16b                                 // ...............................*.........................................................................................................
        // ldr Q<ssa_19>, [x0, #-16]                                   // .............................................*...........................................................................................
        // eor V<ssa_20>.16B, v27.16B, v3.16B                          // .....................*...................................................................................................................
        // aesr V<ssa_5>.16b, v24.16b                                  // ................................*........................................................................................................
        // eor V<ssa_21>.16B, v12.16B, v11.16B                         // .....................................*...................................................................................................
        // aesr V<ssa_14>.16b, v21.16b                                 // .........................................................*...............................................................................
        // rev64 V<ssa_22>.16B, v25.16B                                // .........................................*...............................................................................................
        // aesr V<ssa_5>.16b, v14.16b                                  // ....................................*....................................................................................................
        // eor V<ssa_23>.16B, V<ssa_20>.16B, V<ssa_6>.16B              // ..............................*..........................................................................................................
        // aesr V<ssa_14>.16b, v22.16b                                 // .............................................................*...........................................................................
        // aesr V<ssa_5>.16b, v13.16b                                  // ........................................*................................................................................................
        // eor V<ssa_24>.16B, V<ssa_16>.16B, v16.16B                   // .....................................................................*...................................................................
        // aesr V<ssa_14>.16b, v23.16b                                 // .................................................................*.......................................................................
        // mov D<ssa_25>, V<ssa_22>.d[1]                               // ..................................................................*......................................................................
        // eor V<ssa_26>.16B, V<ssa_15>.16B, v16.16B                   // .................................................*.......................................................................................
        // aesr V<ssa_5>.16b, v4.16b                                   // ............................................*............................................................................................
        // aesr V<ssa_14>.16b, v24.16b                                 // ....................................................................*....................................................................
        // eor V<ssa_27>.16B, V<ssa_19>.16B, v16.16B                   // .....................................................*...................................................................................
        // eor V<ssa_28>.8B, V<ssa_25>.8B, V<ssa_22>.8B                // .......................................................................*.................................................................
        // aesr V<ssa_5>.16b, v2.16b                                   // ................................................*........................................................................................
        // aesr V<ssa_14>.16b, v14.16b                                 // ........................................................................*................................................................
        // ldr Q<ssa_29>, [x6]                                         // ...........................*.............................................................................................................
        // add v31.4S, V<ssa_12>.4S, v30.4S                            // .....................................................................................................................................*...
        // aese V<ssa_5>.16b, v10.16b                                  // ....................................................*....................................................................................
        // aesr V<ssa_14>.16b, v13.16b                                 // ............................................................................*............................................................
        // eor V<ssa_31>.16B, V<ssa_26>.16B, V<ssa_5>.16B              // ........................................................*................................................................................
        // aesr V<ssa_8>.16b, v19.16b                                  // ..........*..............................................................................................................................
        // pmull2 V<ssa_33>.1q, V<ssa_3>.2d, V<ssa_29>.2d              // ...................................*.....................................................................................................
        // aesr V<ssa_8>.16b, v20.16b                                  // ..........................................*..............................................................................................
        // str Q<ssa_31>, [x2, #32]                                    // ......................................................................................................................................*..
        // pmull V<ssa_34>.1q, V<ssa_3>.1d, V<ssa_29>.1d               // .......................................*.................................................................................................
        // eor V<ssa_35>.16B, V<ssa_23>.16B, V<ssa_33>.16B             // ......................................*..................................................................................................
        // aesr V<ssa_8>.16b, v21.16b                                  // ..................................................*......................................................................................
        // eor V<ssa_37>.16B, V<ssa_21>.16B, V<ssa_34>.16B             // ...........................................*.............................................................................................
        // pmull V<ssa_38>.1q, V<ssa_35>.1d, v7.1d                     // ...............................................*.........................................................................................
        // aesr V<ssa_8>.16b, v22.16b                                  // ......................................................*..................................................................................
        // ext V<ssa_39>.16B, V<ssa_35>.16B, V<ssa_35>.16B, #8         // ..............................................*..........................................................................................
        // aesr V<ssa_14>.16b, v4.16b                                  // .................................................................................*.......................................................
        // eor V<ssa_40>.16B, V<ssa_37>.16B, V<ssa_35>.16B             // .......................................................*.................................................................................
        // aesr V<ssa_8>.16b, v23.16b                                  // ..........................................................*..............................................................................
        // eor V<ssa_41>.16B, V<ssa_39>.16B, V<ssa_38>.16B             // ...................................................*.....................................................................................
        // eor V<ssa_42>.16B, V<ssa_17>.16B, V<ssa_40>.16B             // ...........................................................*.............................................................................
        // aesr V<ssa_8>.16b, v24.16b                                  // ..............................................................*..........................................................................
        // ldr Q<ssa_43>, [x6, #64]                                    // .........................................................................*...............................................................
        // eor V<ssa_44>.16B, V<ssa_42>.16B, V<ssa_41>.16B             // ...............................................................*.........................................................................
        // aesr V<ssa_8>.16b, v14.16b                                  // ......................................................................*..................................................................
        // pmull V<ssa_46>.1q, V<ssa_44>.1d, v7.1d                     // ...................................................................*.....................................................................
        // ldr Q<ssa_47>, [x6, #32]                                    // ...............................................................................*.........................................................
        // aesr V<ssa_8>.16b, v13.16b                                  // ..........................................................................*..............................................................
        // eor V<ssa_49>.16B, V<ssa_37>.16B, V<ssa_46>.16B             // .............................................................................*...........................................................
        // aesr V<ssa_8>.16b, v4.16b                                   // ..............................................................................*..........................................................
        // ext V<ssa_50>.16B, V<ssa_44>.16B, V<ssa_44>.16B, #8         // ...........................................................................*.............................................................
        // aesr V<ssa_8>.16b, v2.16b                                   // ..................................................................................*......................................................
        // eor V<ssa_52>.16B, V<ssa_49>.16B, V<ssa_50>.16B             // ................................................................................*........................................................
        // aese V<ssa_8>.16b, v10.16b                                  // ......................................................................................*..................................................
        // ext V<ssa_54>.16B, V<ssa_52>.16B, V<ssa_52>.16B, #8         // .........................................................................................*...............................................
        // aesr V<ssa_14>.16b, v2.16b                                  // ....................................................................................*....................................................
        // eor V<ssa_56>.16B, V<ssa_24>.16B, V<ssa_8>.16B              // ...........................................................................................*.............................................
        // pmull V<ssa_57>.1q, V<ssa_28>.1d, V<ssa_43>.1d              // ...................................................................................................*.....................................
        // rev64 V<ssa_59>.16B, V<ssa_56>.16B                          // ...............................................................................................*.........................................
        // pmull V<ssa_60>.1q, V<ssa_22>.1d, V<ssa_18>.1d              // ............................................................................................*............................................
        // str Q<ssa_56>, [x2], #(4*16)                                // ........................................................................................................................................*
        // ldr Q<ssa_61>, [x6, #80]                                    // .....................................................................................*...................................................
        // pmull2 V<ssa_63>.1q, V<ssa_22>.2d, V<ssa_18>.2d             // ..............................................................................................*..........................................
        // eor V<ssa_64>.16B, V<ssa_59>.16B, V<ssa_54>.16B             // ..................................................................................................*......................................
        // aese V<ssa_14>.16b, v10.16b                                 // ........................................................................................*................................................
        // ext V<ssa_66>.16B, V<ssa_64>.16B, V<ssa_64>.16B, #8         // .......................................................................................................*.................................
        // pmull2 V<ssa_67>.1q, V<ssa_64>.2d, V<ssa_61>.2d             // .........................................................................................................*...............................
        // eor V<ssa_68>.16B, V<ssa_27>.16B, V<ssa_14>.16B             // .............................................................................................*...........................................
        // rev64 V<ssa_69>.16B, V<ssa_31>.16B                          // ............................................................*............................................................................
        // pmull V<ssa_70>.1q, V<ssa_64>.1d, V<ssa_61>.1d              // ......................................................................................................*..................................
        // eor V<ssa_71>.16B, V<ssa_66>.16B, V<ssa_64>.16B             // ...........................................................................................................*.............................
        // ldr Q<ssa_72>, [x6, #16]                                    // .........................*...............................................................................................................
        // pmull2 V<ssa_73>.1q, V<ssa_71>.2d, V<ssa_43>.2d             // ...............................................................................................................*.........................
        // eor V<ssa_74>.16B, V<ssa_70>.16B, V<ssa_60>.16B             // ..........................................................................................................*..............................
        // pmull V<ssa_76>.1q, V<ssa_69>.1d, V<ssa_47>.1d              // ....................................................................................................*....................................
        // ext V<ssa_77>.16B, V<ssa_69>.16B, V<ssa_69>.16B, #8         // ...................................................................................*.....................................................
        // eor V<ssa_79>.16B, V<ssa_73>.16B, V<ssa_57>.16B             // ...................................................................................................................*.....................
        // rev64 V<ssa_80>.16B, V<ssa_68>.16B                          // .................................................................................................*.......................................
        // eor V<ssa_81>.16B, V<ssa_77>.16B, V<ssa_69>.16B             // .......................................................................................*.................................................
        // pmull2 V<ssa_83>.1q, V<ssa_69>.2d, V<ssa_47>.2d             // ..........................................................................................*..............................................
        // mov D<ssa_84>, V<ssa_80>.d[1]                               // .....................................................................................................*...................................
        // pmull2 V<ssa_86>.1q, V<ssa_81>.2d, V<ssa_72>.2d             // ................................................................................................................*........................
        // eor V<ssa_87>.8B, V<ssa_84>.8B, V<ssa_80>.8B                // ........................................................................................................*................................
        // pmull V<ssa_88>.1q, V<ssa_87>.1d, V<ssa_72>.1d              // ....................................................................................................................*....................
        // eor V<ssa_90>.16B, V<ssa_79>.16B, V<ssa_86>.16B             // .......................................................................................................................*.................
        // eor V<ssa_94>.16B, V<ssa_90>.16B, V<ssa_88>.16B             // ...........................................................................................................................*.............
        // str Q<ssa_68>, [x2, #-16]                                   // ................................................................................................*........................................
        // eor V<ssa_97>.16B, V<ssa_67>.16B, V<ssa_63>.16B             // .............................................................................................................*...........................
        // eor V<ssa_98>.16B, V<ssa_74>.16B, V<ssa_76>.16B             // ..............................................................................................................*..........................
        // eor V<ssa_100>.16B, V<ssa_97>.16B, V<ssa_83>.16B            // .................................................................................................................*.......................
        // ldr Q<ssa_106>, [x6]                                        // ..*......................................................................................................................................
        // pmull2 V<ssa_108>.1q, V<ssa_80>.2d, V<ssa_106>.2d           // ............................................................................................................*............................
        // pmull V<ssa_109>.1q, V<ssa_80>.1d, V<ssa_106>.1d            // ..................................................................................................................*......................
        // eor V<ssa_110>.16B, V<ssa_100>.16B, V<ssa_108>.16B          // .....................................................................................................................*...................
        // eor V<ssa_112>.16B, V<ssa_98>.16B, V<ssa_109>.16B           // ......................................................................................................................*..................
        // pmull V<ssa_113>.1q, V<ssa_110>.1d, v7.1d                   // .........................................................................................................................*...............
        // ext V<ssa_114>.16B, V<ssa_110>.16B, V<ssa_110>.16B, #8      // ........................................................................................................................*................
        // eor V<ssa_115>.16B, V<ssa_112>.16B, V<ssa_110>.16B          // ..........................................................................................................................*..............
        // eor V<ssa_116>.16B, V<ssa_114>.16B, V<ssa_113>.16B          // ............................................................................................................................*............
        // eor V<ssa_117>.16B, V<ssa_94>.16B, V<ssa_115>.16B           // .............................................................................................................................*...........
        // eor V<ssa_119>.16B, V<ssa_117>.16B, V<ssa_116>.16B          // ..............................................................................................................................*..........
        // pmull V<ssa_120>.1q, V<ssa_119>.1d, v7.1d                   // ................................................................................................................................*........
        // eor V<ssa_121>.16B, V<ssa_112>.16B, V<ssa_120>.16B          // .................................................................................................................................*.......
        // ext V<ssa_122>.16B, V<ssa_119>.16B, V<ssa_119>.16B, #8      // ...............................................................................................................................*.........
        // eor V<ssa_124>.16B, V<ssa_121>.16B, V<ssa_122>.16B          // ...................................................................................................................................*.....
        // ext v11.16B, V<ssa_124>.16B, V<ssa_124>.16B, #8             // .......................................................................................................................................*.

        b Lloop_unrolled_start_end
Lloop_unrolled_start_iter_1:


        ldr q25, [x5, #((7)*16)]
        ldr q26, [x5, #((8)*16)]
        ldr q27, [x5, #((9)*16)]
        ldr q28, [x5, #((10)*16)]
        ldr q15, [x5, #((11)*16)]
        ldr q16, [x5, #((12)*16)]

        ldr q29, [x0], #(4*16)
        rev32  v0.16b, v31.16b
        add    v31.4s, v31.4s, v30.4s
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aesr v0.16b, v27.16b
        aesr v0.16b, v28.16b
        aese v0.16b, v15.16b
        eor v29.16b, v29.16b, v16.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2], #(4*16)

        ldr q12, [x6, #48]
        ldr q13, [x6, #80]
        ldr q14, [x6, #64]
        rev64 v0.16b, v0.16b
        eor   v0.16b, v0.16b, v11.16b
        // Low product
        pmull   v8.1q, v0.1d, v13.1d
        // High product
        pmull2  v9.1q, v0.2d, v13.2d
        // Middle product
        ext     v11.16b, v0.16b, v0.16b, #8
        eor     v11.16b, v11.16b, v0.16b
        pmull2  v10.1q, v11.2d, v14.2d

        ldr q29, [x0, #(-3*16)]
        rev32  v0.16b, v31.16b
        add    v31.4s, v31.4s, v30.4s
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aesr v0.16b, v27.16b
        aesr v0.16b, v28.16b
        aese v0.16b, v15.16b
        eor v29.16b, v29.16b, v16.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(-3*16)]

        rev64   v0.16b, v0.16b
        // Low product
        pmull   v11.1q, v0.1d, v12.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v12.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        mov     d11, v0.d[1]
        eor     v11.8b, v11.8b, v0.8b
        pmull   v11.1q, v11.1d, v14.1d
        eor     v10.16b, v10.16b, v11.16b

        ldr q29, [x0, #(-2*16)]
        rev32  v0.16b, v31.16b
        add    v31.4s, v31.4s, v30.4s
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aesr v0.16b, v27.16b
        aesr v0.16b, v28.16b
        aese v0.16b, v15.16b
        eor v29.16b, v29.16b, v16.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(-2*16)]

        ldr q12, [x6]
        ldr q13, [x6, #32]
        ldr q14, [x6, #16]
        rev64   v0.16b, v0.16b

        // Low product
        pmull   v11.1q, v0.1d, v13.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v13.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        ext     v11.16b, v0.16b, v0.16b, #8
        eor     v11.16b, v11.16b, v0.16b
        pmull2  v11.1q, v11.2d, v14.2d
        eor     v10.16b, v10.16b, v11.16b

        ldr q29, [x0, #(-1*16)]
        rev32  v0.16b, v31.16b
        add    v31.4s, v31.4s, v30.4s
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aesr v0.16b, v27.16b
        aesr v0.16b, v28.16b
        aese v0.16b, v15.16b
        eor v29.16b, v29.16b, v16.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(-1*16)]

        rev64   v0.16b, v0.16b
        // Low product
        pmull   v11.1q, v0.1d, v12.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v12.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        mov     d11, v0.d[1]
        eor     v11.8b, v11.8b, v0.8b
        pmull   v11.1q, v11.1d, v14.1d
        eor     v10.16b, v10.16b, v11.16b

        eor        v0.16b, v8.16b,  v9.16b
        pmull      v1.1q,  v9.1d,   v7.1d
        ext        v9.16b,    v9.16b,  v9.16b, #8
        eor        v10.16b,   v10.16b, v0.16b
        eor        v1.16b, v9.16b,  v1.16b
        eor        v10.16b,   v10.16b, v1.16b
        pmull      v9.1q,     v10.1d,  v7.1d
        eor        v8.16b,    v8.16b,  v9.16b
        ext        v10.16b,   v10.16b, v10.16b, #8
        eor        v11.16b,     v8.16b,  v10.16b
        ext        v11.16b, v11.16b, v11.16b, #8

Lloop_unrolled_start_iter_1_end:
Lloop_unrolled_start_end:
Lloop_unrolled_end:

        load_round_keys1
        load_htable_12

        cbz remainder, Lloop_1x_end
Lloop_1x_start:

        ldr plain_q, [input], #16
        aes_full_block aes_st, plain, res
        str res_q, [output], #16
        ghash_init_0 res, Ht1, Ht12, tag

        ghash_finalize tag

        sub remainder, remainder, #1
        cbnz remainder, Lloop_1x_start
Lloop_1x_end:

        // Return number of bytes processed
        mov x0, byte_len
        // Store new authentication tag
        rev64 tag.16b, tag.16b
        str tag_q, [tag_ptr]
        // Store updated counter
        rev32 rtmp_ctr.16b, rtmp_ctr.16b
        str rtmp_ctr_q, [ivec]

        restore_vregs
        restore_gprs

Lenc_postamble_end:
        add sp, sp, #STACK_SIZE

        ret

#endif
#endif  // !OPENSSL_NO_ASM && defined(__AARCH64EL__) && defined(__APPLE__)
#if defined(__ELF__)
// See https: // www.airs.com/blog/archives/518.
.section .note.GNU-stack,"",%progbits
#endif