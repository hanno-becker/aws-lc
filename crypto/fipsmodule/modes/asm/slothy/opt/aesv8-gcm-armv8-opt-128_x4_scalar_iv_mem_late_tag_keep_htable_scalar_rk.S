// Copyright (c) 2022, ARM Inc.

// Permission to use, copy, modify, and/or distribute this software for any
// purpose with or without fee is hereby granted, provided that the above
// copyright notice and this permission notice appear in all copies.

// THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
// WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
// MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
// SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
// WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
// OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
// CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. */

// Author: Hanno Becker <hannobecker@posteo.de>

// This file was derived from the assembly generated from aesv8-gcm-armv8.pl,
// written by Fangming Fang <fangming.fang@arm.com> for the OpenSSL project,
// and derived from https: // github.com/ARM-software/AArch64cryptolib, original
// author Samuel Lee <Samuel.Lee@arm.com>.

// The code below is a 'clean' AArch64 implementation of AES-GCM emphasizing
// the logic of the computation. It is meant as the input to manual audits /
// formal verification, as well as automated micro-optimization such as done
// by the SLOTHY superoptimizer (https: // github.com/slothy-optimizer/slothy).

#if !defined(__has_feature)
#define __has_feature(x) 0
#endif
#if __has_feature(memory_sanitizer) && !defined(OPENSSL_NO_ASM)
#define OPENSSL_NO_ASM
#endif

#include <openssl/asm_base.h>

#if !defined(OPENSSL_NO_ASM) && defined(__AARCH64EL__)
#if defined(__ELF__)
#include <openssl/boringssl_prefix_symbols_asm.h>
#include <openssl/arm_arch.h>
.arch   armv8-a+crypto
.text
.globl  aes_gcm_enc_kernel_slothy_base_128
.hidden aes_gcm_enc_kernel_slothy_base_128
.type   aes_gcm_enc_kernel_slothy_base_128,%function
#elif defined(__APPLE__)
#if defined(BORINGSSL_PREFIX)
#include <boringssl_prefix_symbols_asm.h>
#endif
#include <openssl/arm_arch.h>
.text
.globl	_aes_gcm_enc_kernel_slothy_base_128
.private_extern	_aes_gcm_enc_kernel_slothy_base_128
#else
#error Unknown configuration
#endif

#if __ARM_MAX_ARCH__ >= 8

// Arguments
input    .req x0
len_bits .req x1
output   .req x2
tag_ptr  .req x3
ivec     .req x4
key      .req x5
Htable   .req x6

byte_len .req x15

constant_temp .req x25

count           .req x1
full_blocks     .req x7
remainder       .req x16
unroll          .req x10

ctr_tmp   .req x14
ctr_tmp_w .req w14

ivec_0_63    .req x11
ivec_64_96   .req x12
ivec_64_96_w .req w12

ctr      .req w13
ctr_x    .req x13

aes_st    .req v0
aes_st_q  .req q0
aes_st_d  .req d0

res       .req v0
res_q     .req q0

ghash_hi    .req v9
ghash_lo    .req v8
ghash_mid   .req v10
ghash_mid_d .req d10

ghash_tmp   .req v11
ghash_tmp_d .req d11

ghash_mod   .req v7
ghash_mod_d .req d7

modulo_tmp0 .req v0
modulo_tmp1 .req v1

Ht1q   .req q12
Ht2q   .req q13
Ht12q  .req q14

Ht1    .req v12
Ht2    .req v13
Ht12   .req v14

Ht3q   .req q15
Ht4q   .req q16
Ht34q  .req q17

Ht3    .req v15
Ht4    .req v16
Ht34   .req v17

rk0q   .req q18
rk1q   .req q19
rk2q   .req q20
rk3q   .req q21
rk4q   .req q22
rk5q   .req q23
rk6q   .req q24
rk7q   .req q25
rk8q   .req q26
rk9q   .req q27
rk10q  .req q28

rk10_lo .req x20
rk10_hi .req x21

rk0    .req v18
rk1    .req v19
rk2    .req v20
rk3    .req v21
rk4    .req v22
rk5    .req v23
rk6    .req v24
rk7    .req v25
rk8    .req v26
rk9    .req v27
rk10   .req v28

plain   .req v29
plain_q .req q29

plain_lo .req x22
plain_hi .req x23

tag    .req v30
tag_q  .req q30

#define UNROLL 4

#define STACK_SIZE_GPRS  (6*16)
#define STACK_SIZE_VREGS (4*16)
#define STACK_SIZE  (STACK_SIZE_GPRS + STACK_SIZE_VREGS + UNROLL*16)

#define STACK_BASE_GPRS  (0)
#define STACK_BASE_VREGS (STACK_SIZE_GPRS)
#define STACK_BASE_AES_ST (STACK_SIZE_GPRS + STACK_SIZE_VREGS)

/********************************************************************/
/*                 Generic preamble/postamble macros                */
/********************************************************************/

.macro save_vregs
        stp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        stp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        stp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        stp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro restore_vregs
        ldp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        ldp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        ldp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        ldp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro save_gprs
        stp x19, x20, [sp, #(STACK_BASE_GPRS + 16*0)]
        stp x21, x22, [sp, #(STACK_BASE_GPRS + 16*1)]
        stp x23, x24, [sp, #(STACK_BASE_GPRS + 16*2)]
        stp x25, x26, [sp, #(STACK_BASE_GPRS + 16*3)]
        stp x27, x28, [sp, #(STACK_BASE_GPRS + 16*4)]
        stp x29, x30, [sp, #(STACK_BASE_GPRS + 16*5)]
.endm

.macro restore_gprs
        ldp x19, x20, [sp, #(STACK_BASE_GPRS + 16*0)]
        ldp x21, x22, [sp, #(STACK_BASE_GPRS + 16*1)]
        ldp x23, x24, [sp, #(STACK_BASE_GPRS + 16*2)]
        ldp x25, x26, [sp, #(STACK_BASE_GPRS + 16*3)]
        ldp x27, x28, [sp, #(STACK_BASE_GPRS + 16*4)]
        ldp x29, x30, [sp, #(STACK_BASE_GPRS + 16*5)]
.endm

// Derive number of iterations of unrolled loop and single-block loop
.macro prepare_loop_counts
        mov  unroll, #UNROLL
        // Number of AES Blocks (16b each)
        lsr  full_blocks, byte_len, #4
        // Number of iterations of the unrolled loop
        udiv count, full_blocks, unroll
        // Number of iterations for the tail loop handling 1 block each
        msub remainder, count, unroll, full_blocks
.endm

/********************************************************************/
/*                       AES related macros                         */
/********************************************************************/

.macro load_iv
        ldp        ivec_0_63, ivec_64_96, [ivec]
        lsr        ctr_x, ivec_64_96, #32
        rev        ctr, ctr
        orr        ivec_64_96_w, ivec_64_96_w, ivec_64_96_w // clear top 32 bit
.endm

.macro next_ctr_init_aes aes_st, loc
        add        ctr_tmp_w, ctr, #\loc
        rev        ctr_tmp_w, ctr_tmp_w
        orr        ctr_tmp, ivec_64_96, ctr_tmp, lsl #32
        stp        ivec_0_63, ctr_tmp, [sp, #(STACK_BASE_AES_ST + \loc*16)] // @slothy:writes=stack_\loc
        ldr        \aes_st\()_q, [sp, #(STACK_BASE_AES_ST + \loc*16)]       // @slothy:reads=stack_\loc
.endm

// A single AES round
// Prevent SLOTHY from unfolding because uArchs tend to fuse AESMC+AESE
.macro aesr data, key // @slothy:no-unfold
        aese  \data, \key
        aesmc \data, \data
.endm

.macro aesr_0_8 data, key
        aesr \data\().16b, \key\()0.16b
        aesr \data\().16b, \key\()1.16b
        aesr \data\().16b, \key\()2.16b
        aesr \data\().16b, \key\()3.16b
        aesr \data\().16b, \key\()4.16b
        aesr \data\().16b, \key\()5.16b
        aesr \data\().16b, \key\()6.16b
        aesr \data\().16b, \key\()7.16b
        aesr \data\().16b, \key\()8.16b
.endm

.macro aesr_9_10 data, key
        aesr \data\().16b, \key\()9.16b
        aesr \data\().16b, \key\()10.16b
.endm

.macro aesr_11_12 data, key
        aesr \data\().16b, \key\()11.16b
        aesr \data\().16b, \key\()12.16b
.endm

// Destructs inA
.macro eor3 out, inA, inB, inC
        eor \inA, \inA, \inB
        eor \out, \inA, \inC
.endm

.macro aesr_final aes_st, plain, out, loc
        aese \aes_st\().16b, rk9.16b
        eor \plain\()_lo, \plain\()_lo, rk10_lo
        eor \plain\()_hi, \plain\()_hi, rk10_hi
        stp \plain\()_lo, \plain\()_hi, [sp, #(STACK_BASE_AES_ST + \loc*16)] // @slothy:writes=stack_\loc
        ldr \plain\()_q, [sp, #(STACK_BASE_AES_ST + \loc*16)]       // @slothy:reads=stack_\loc
        eor \out\().16b, \plain\().16b, \aes_st\().16b
.endm

.macro aes_full_block aes_st, input, output, loc
        next_ctr_init_aes \aes_st, \loc
        aesr_0_8 \aes_st\(), rk
        aesr_final \aes_st, \input, \output, \loc
.endm

.macro load_round_key i
        ldr rk\i\()q, [key, #((\i)*16)]
.endm

.macro load_round_key_scalar i
        ldp rk\i\()_lo, rk\i\()_hi, [key, #((\i)*16)]
.endm

.macro load_round_keys
        load_round_key 0
        load_round_key 1
        load_round_key 2
        load_round_key 3
        load_round_key 4
        load_round_key 5
        load_round_key 6
        load_round_key 7
        load_round_key 8
        load_round_key 9
        load_round_key_scalar 10
.endm

/********************************************************************/
/*       Loading of H-table (precomputed H-powers for GHASH)        */
/********************************************************************/

// This has to be synchronized with the H-table generation

.macro load_h1 dst, dst_q
        ldr \dst_q, [Htable]
.endm

.macro load_h2 dst, dst_q
        ldr \dst_q, [Htable, #32]
.endm

.macro load_h3 dst, dst_q
        ldr \dst_q, [Htable, #48]
.endm

.macro load_h4 dst, dst_q
        ldr \dst_q, [Htable, #80]
.endm

.macro load_h5 dst, dst_q
        ldr \dst_q, [Htable, #96]
.endm

.macro load_h6 dst, dst_q
        ldr \dst_q, [Htable, #128]
.endm

.macro load_h7 dst, dst_q
        ldr \dst_q, [Htable, #144]
.endm

.macro load_h8 dst, dst_q
        ldr \dst_q, [Htable, #176]
.endm

.macro load_h12 dst, dst_q
        ldr \dst_q, [Htable, #16]
.endm

.macro load_h34 dst, dst_q
        ldr \dst_q, [Htable, #64]
.endm

.macro load_h56 dst, dst_q
        ldr \dst_q, [Htable, #112]
.endm

.macro load_h78 dst, dst_q
        ldr \dst_q, [Htable, #160]
.endm

.macro load_full_htable
        load_h1  Ht1,  Ht1q
        load_h2  Ht2,  Ht2q
        load_h3  Ht3,  Ht3q
        load_h4  Ht4,  Ht4q
        load_h5  Ht5,  Ht5q
        load_h6  Ht6,  Ht6q
        load_h12 Ht12, Ht12q
        load_h34 Ht34, Ht34q
        load_h56 Ht56, Ht56q
.endm

.macro load_htable_12
        load_h1  Ht1,  Ht1q
        load_h2  Ht2,  Ht2q
        load_h12 Ht12, Ht12q
.endm

.macro load_htable_34
        load_h3  Ht3,  Ht3q
        load_h4  Ht4,  Ht4q
        load_h34 Ht34, Ht34q
.endm

.macro load_htable_56
        load_h5  Ht5,  Ht5q
        load_h6  Ht6,  Ht6q
        load_h56 Ht56, Ht56q
.endm

.macro load_htable_78
        load_h7  Ht7,  Ht7q
        load_h8  Ht8,  Ht8q
        load_h78 Ht78, Ht78q
.endm

/********************************************************************/
/*                    Macros for GHASH udpate                       */
/********************************************************************/

.macro ghash_init_0 input, Hk, Hk_mid
        rev64 \input\().16b, \input\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_mid.1q, ghash_tmp.1d, \Hk_mid\().1d
.endm

.macro ghash_init_1 input, Hk, Hk_mid
        rev64 \input\().16b, \input\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_mid.1q, ghash_tmp.2d, \Hk_mid\().2d
.endm

.macro ghash_acc_0 input, Hk, Hk_mid
        rev64   \input\().16b, \input\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_tmp.1q, ghash_tmp.1d, \Hk_mid\().1d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_acc_1 input, Hk, Hk_mid
        rev64   \input\().16b, \input\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_tmp.1q, ghash_tmp.2d, \Hk_mid\().2d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_init_with_tag_0 input, Hk, Hk_mid, tag
        rev64 \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_mid.1q, ghash_tmp.1d, \Hk_mid\().1d
.endm

.macro ghash_init_with_tag_1 input, Hk, Hk_mid, tag
        rev64 \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_mid.1q, ghash_tmp.2d, \Hk_mid\().2d
.endm

.macro ghash_acc_with_tag_0 input, Hk, Hk_mid, tag
        rev64   \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_tmp.1q, ghash_tmp.1d, \Hk_mid\().1d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_acc_with_tag_1 input, Hk, Hk_mid, tag
        rev64   \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_tmp.1q, ghash_tmp.2d, \Hk_mid\().2d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_finalize tag
        eor        modulo_tmp0.16b, ghash_lo.16b,  ghash_hi.16b
        pmull      modulo_tmp1.1q,  ghash_hi.1d,   ghash_mod.1d
        ext        ghash_hi.16b,    ghash_hi.16b,  ghash_hi.16b, #8
        eor        ghash_mid.16b,   ghash_mid.16b, modulo_tmp0.16b
        eor        modulo_tmp1.16b, ghash_hi.16b,  modulo_tmp1.16b
        eor        ghash_mid.16b,   ghash_mid.16b, modulo_tmp1.16b
        pmull      ghash_hi.1q,     ghash_mid.1d,  ghash_mod.1d
        eor        ghash_lo.16b,    ghash_lo.16b,  ghash_hi.16b
        ext        ghash_mid.16b,   ghash_mid.16b, ghash_mid.16b, #8
        eor        \tag\().16b,     ghash_lo.16b,  ghash_mid.16b
        ext        \tag\().16b, \tag\().16b, \tag\().16b, #8
.endm

.macro load_tag
        ldr      tag_q, [tag_ptr]
        rev64    tag.16b, tag.16b
.endm

.macro prepare_ghash
        // Prepare constant for modular reduction
        movi ghash_mod.8b, #0xc2
        shl  ghash_mod_d, ghash_mod_d, #56
.endm

/********************************************************************/
/*                            Core routine                          */
/********************************************************************/

.align        4
_aes_gcm_enc_kernel_slothy_base_128:
aes_gcm_enc_kernel_slothy_base_128:
#ifdef BORINGSSL_DISPATCH_TEST
        adrp  x9,_BORINGSSL_function_hit@PAGE
        add   x9, x9, _BORINGSSL_function_hit@PAGEOFF
        mov   w10, #1
        strb  w10, [x9,#2] // kFlag_aes_gcm_enc_kernel
#endif

        AARCH64_VALID_CALL_TARGET
        sub sp, sp, #STACK_SIZE

Lenc_preamble_start:
        save_gprs
        save_vregs

        lsr byte_len, len_bits, #3

        load_round_keys
        load_tag
        load_iv

        prepare_loop_counts
        prepare_ghash

        load_htable_12
        load_htable_34

Lenc_preamble_end:

        cbz count, Lloop_unrolled_end
        cmp count, #1
        b.eq Lloop_unrolled_start_iter_1
        // Instructions:    138
        // Expected cycles: 65
        // Expected IPC:    2.123076923076923
        add w29, w13, #0                                   // *................................................................
        add w27, w13, #3                                   // *................................................................
        rev w22, w27                                       // .*...............................................................
        rev w19, w29                                       // .*...............................................................
        add w25, w13, #2                                   // .*...............................................................
        orr x27, x12, x22, lsl #32                         // ..*..............................................................
        orr x22, x12, x19, lsl #32                         // ..*..............................................................
        add w24, w13, #1                                   // ..*..............................................................
        stp x11, x22, [sp, #STACK_BASE_AES_ST]             // ...*............................................................. // @slothy:writes=stack_0
        stp x11, x27, [sp, #STACK_BASE_AES_ST + 48]        // ...*............................................................. // @slothy:writes=stack_3
        rev w19, w24                                       // ...*.............................................................
        orr x27, x12, x19, lsl #32                         // ....*............................................................
        ldr q8, [sp, #STACK_BASE_AES_ST + 48]              // .....*........................................................... // @slothy:reads=stack_3
        stp x11, x27, [sp, #STACK_BASE_AES_ST + 16]        // .....*........................................................... // @slothy:writes=stack_1
        ldr q0, [sp, #STACK_BASE_AES_ST]                   // ......*.......................................................... // @slothy:reads=stack_0
        rev w25, w25                                       // ........*........................................................
        aesr v8.16b, v18.16b                               // .........*.......................................................
        orr x27, x12, x25, lsl #32                         // .........*.......................................................
        aesr v0.16b, v18.16b                               // ..........*......................................................
        stp x11, x27, [sp, #STACK_BASE_AES_ST + 32]        // ..........*...................................................... // @slothy:writes=stack_2
        aesr v8.16b, v19.16b                               // ...........*.....................................................
        aesr v0.16b, v19.16b                               // ............*....................................................
        ldr q10, [sp, #STACK_BASE_AES_ST + 32]             // ............*.................................................... // @slothy:reads=stack_2
        aesr v8.16b, v20.16b                               // .............*...................................................
        aesr v0.16b, v20.16b                               // ..............*..................................................
        ldp x22, x10, [x0, #48]                            // ..............*..................................................
        aesr v8.16b, v21.16b                               // ...............*.................................................
        ldp x8, x9, [x0, #16]                              // ...............*.................................................
        aesr v10.16b, v18.16b                              // ................*................................................
        ldp x19, x25, [x0, #32]                            // ................*................................................
        aesr v8.16b, v22.16b                               // .................*...............................................
        ldr q1, [sp, #STACK_BASE_AES_ST + 16]              // ..................*.............................................. // @slothy:reads=stack_1
        aesr v10.16b, v19.16b                              // ..................*..............................................
        eor x29, x10, x21                                  // ..................*..............................................
        ldp x7, x24, [x0], #(4*16)                         // ..................*..............................................
        aesr v8.16b, v23.16b                               // ...................*.............................................
        eor x27, x22, x20                                  // ...................*.............................................
        ldp x10, x28, [x0, #48]                            // ...................*.............................................
        eor x26, x9, x21                                   // ...................*.............................................
        aesr v10.16b, v20.16b                              // ....................*............................................
        eor x22, x19, x20                                  // ....................*............................................
        stp x27, x29, [sp, #STACK_BASE_AES_ST + 48]        // ....................*............................................ // @slothy:writes=stack_3
        aesr v8.16b, v24.16b                               // .....................*...........................................
        eor x19, x25, x21                                  // .....................*...........................................
        add w13, w13, #UNROLL                              // .....................*...........................................
        aesr v10.16b, v21.16b                              // ......................*..........................................
        add w27, w13, #3                                   // ......................*..........................................
        stp x22, x19, [sp, #STACK_BASE_AES_ST + 32]        // ......................*.......................................... // @slothy:writes=stack_2
        aesr v8.16b, v25.16b                               // .......................*.........................................
        ldr q5, [sp, #STACK_BASE_AES_ST + 48]              // .......................*......................................... // @slothy:reads=stack_3
        add w19, w13, #0                                   // .......................*.........................................
        eor x24, x24, x21                                  // .......................*.........................................
        aesr v10.16b, v22.16b                              // ........................*........................................
        ldr q31, [sp, #STACK_BASE_AES_ST + 32]             // ........................*........................................ // @slothy:reads=stack_2
        eor x22, x7, x20                                   // ........................*........................................
        rev w25, w27                                       // ........................*........................................
        aesr v8.16b, v26.16b                               // .........................*.......................................
        rev w19, w19                                       // .........................*.......................................
        stp x22, x24, [sp, #STACK_BASE_AES_ST]             // .........................*....................................... // @slothy:writes=stack_0
        eor x27, x8, x20                                   // .........................*.......................................
        aesr v0.16b, v21.16b                               // ..........................*......................................
        eor x22, x28, x21                                  // ..........................*......................................
        orr x28, x12, x19, lsl #32                         // ..........................*......................................
        stp x27, x26, [sp, #STACK_BASE_AES_ST + 16]        // ..........................*...................................... // @slothy:writes=stack_1
        aesr v10.16b, v23.16b                              // ...........................*.....................................
        ldr q4, [sp, #STACK_BASE_AES_ST]                   // ...........................*..................................... // @slothy:reads=stack_0
        orr x25, x12, x25, lsl #32                         // ...........................*.....................................
        add w27, w13, #1                                   // ...........................*.....................................
        ldr q28, [sp, #STACK_BASE_AES_ST + 16]             // ............................*.................................... // @slothy:reads=stack_1
        aese v8.16b, v27.16b                               // ............................*....................................
        stp x11, x25, [sp, #STACK_BASE_AES_ST + 48]        // ............................*.................................... // @slothy:writes=stack_3
        rev w25, w27                                       // ............................*....................................
        aesr v0.16b, v22.16b                               // .............................*...................................
        add w27, w13, #2                                   // .............................*...................................
        orr x19, x12, x25, lsl #32                         // .............................*...................................
        aesr v1.16b, v18.16b                               // ..............................*..................................
        rev w25, w27                                       // ..............................*..................................
        stp x11, x19, [sp, #STACK_BASE_AES_ST + 16]        // ..............................*.................................. // @slothy:writes=stack_1
        aesr v0.16b, v23.16b                               // ...............................*.................................
        orr x27, x12, x25, lsl #32                         // ...............................*.................................
        aesr v1.16b, v19.16b                               // ................................*................................
        stp x11, x27, [sp, #STACK_BASE_AES_ST + 32]        // ................................*................................ // @slothy:writes=stack_2
        stp x11, x28, [sp, #STACK_BASE_AES_ST]             // ................................*................................ // @slothy:writes=stack_0
        aesr v0.16b, v24.16b                               // .................................*...............................
        ldr q11, [sp, #STACK_BASE_AES_ST + 48]             // ..................................*.............................. // @slothy:reads=stack_3
        aesr v1.16b, v20.16b                               // ..................................*..............................
        ldr q29, [sp, #STACK_BASE_AES_ST]                  // ...................................*............................. // @slothy:reads=stack_0
        aesr v0.16b, v25.16b                               // ...................................*.............................
        aesr v10.16b, v24.16b                              // ....................................*............................
        aesr v1.16b, v21.16b                               // .....................................*...........................
        aesr v10.16b, v25.16b                              // ......................................*..........................
        aesr v29.16b, v18.16b                              // .......................................*.........................
        aesr v1.16b, v22.16b                               // ........................................*........................
        aesr v29.16b, v19.16b                              // .........................................*.......................
        eor v5.16B, v5.16B, v8.16B                         // ..........................................*......................
        aesr v10.16b, v26.16b                              // ..........................................*......................
        aesr v1.16b, v23.16b                               // ...........................................*.....................
        aesr v29.16b, v20.16b                              // ............................................*....................
        rev64 v2.16B, v5.16B                               // ............................................*....................
        aesr v1.16b, v24.16b                               // .............................................*...................
        mov d9, v2.d[1]                                    // ..............................................*..................
        aese v10.16b, v27.16b                              // ..............................................*..................
        str q5, [x2, #48]                                  // ...............................................*.................
        aesr v1.16b, v25.16b                               // ...............................................*.................
        eor v3.16B, v31.16B, v10.16B                       // ................................................*................
        aesr v29.16b, v21.16b                              // ................................................*................
        aesr v1.16b, v26.16b                               // .................................................*...............
        eor v10.8B, v9.8B, v2.8B                           // .................................................*...............
        rev64 v5.16B, v3.16B                               // ..................................................*..............
        aesr v29.16b, v22.16b                              // ..................................................*..............
        str q3, [x2, #32]                                  // ...................................................*.............
        aese v1.16b, v27.16b                               // ...................................................*.............
        aesr v0.16b, v26.16b                               // ....................................................*............
        ext v31.16B, v5.16B, v5.16B, #8                    // ....................................................*............
        aesr v29.16b, v23.16b                              // .....................................................*...........
        eor v8.16B, v28.16B, v1.16B                        // .....................................................*...........
        eor v28.16B, v31.16B, v5.16B                       // ......................................................*..........
        aese v0.16b, v27.16b                               // ......................................................*..........
        rev64 v9.16B, v8.16B                               // .......................................................*.........
        aesr v29.16b, v24.16b                              // .......................................................*.........
        eor v6.16B, v4.16B, v0.16B                         // ........................................................*........
        pmull2 v4.1q, v2.2d, v12.2d                        // ........................................................*........
        pmull v31.1q, v5.1d, v13.1d                        // .........................................................*.......
        mov d0, v9.d[1]                                    // .........................................................*.......
        pmull2 v1.1q, v28.2d, v14.2d                       // ..........................................................*......
        rev64 v3.16B, v6.16B                               // ..........................................................*......
        pmull2 v28.1q, v5.2d, v13.2d                       // ...........................................................*.....
        str q6, [x2], #(4*16)                              // ...........................................................*.....
        eor v5.16B, v3.16B, v30.16B                        // ............................................................*....
        pmull v30.1q, v10.1d, v14.1d                       // ............................................................*....
        pmull2 v3.1q, v9.2d, v15.2d                        // .............................................................*...
        eor v4.16B, v4.16B, v28.16B                        // .............................................................*...
        pmull v28.1q, v5.1d, v16.1d                        // ..............................................................*..
        eor v1.16B, v30.16B, v1.16B                        // ..............................................................*..
        pmull v6.1q, v9.1d, v15.1d                         // ...............................................................*.
        ext v10.16B, v5.16B, v5.16B, #8                    // ...............................................................*.
        eor v30.8B, v0.8B, v9.8B                           // ................................................................*
        pmull2 v0.1q, v5.2d, v16.2d                        // ................................................................*

        // original source code
        // ldp X<ssa_22>, X<ssa_23>, [x0, #48]                            // .........................*................................................................................................................
        // add W<ssa_36>, w13, #0                                         // *.........................................................................................................................................
        // rev W<ssa_42>, W<ssa_36>                                       // ...*......................................................................................................................................
        // eor X<ssa_44>, X<ssa_23>, x21                                  // .................................*........................................................................................................
        // orr X<ssa_45>, x12, X<ssa_42>, lsl #32                         // ......*...................................................................................................................................
        // add W<ssa_47>, w13, #3                                         // .*........................................................................................................................................
        // rev W<ssa_49>, W<ssa_47>                                       // ..*.......................................................................................................................................
        // orr X<ssa_51>, x12, X<ssa_49>, lsl #32                         // .....*....................................................................................................................................
        // stp x11, X<ssa_51>, [sp, #STACK_BASE_AES_ST + 48]              // .........*................................................................................................................................
        // stp x11, X<ssa_45>, [sp, #STACK_BASE_AES_ST]                   // ........*.................................................................................................................................
        // ldr Q<ssa_57>, [sp, #STACK_BASE_AES_ST]                        // ..............*...........................................................................................................................
        // ldr Q<ssa_58>, [sp, #STACK_BASE_AES_ST + 48]                   // ............*.............................................................................................................................
        // add W<ssa_59>, w13, #1                                         // .......*..................................................................................................................................
        // rev W<ssa_61>, W<ssa_59>                                       // ..........*...............................................................................................................................
        // orr X<ssa_64>, x12, X<ssa_61>, lsl #32                         // ...........*..............................................................................................................................
        // aesr V<ssa_57>.16b, v18.16b                                    // ..................*.......................................................................................................................
        // stp x11, X<ssa_64>, [sp, #STACK_BASE_AES_ST + 16]              // .............*............................................................................................................................
        // aesr V<ssa_57>.16b, v19.16b                                    // .....................*....................................................................................................................
        // aesr V<ssa_57>.16b, v20.16b                                    // ........................*.................................................................................................................
        // aesr V<ssa_57>.16b, v21.16b                                    // ............................................................*.............................................................................
        // aesr V<ssa_57>.16b, v22.16b                                    // ........................................................................*.................................................................
        // aesr V<ssa_57>.16b, v23.16b                                    // ..............................................................................*...........................................................
        // add W<ssa_83>, w13, #2                                         // ....*.....................................................................................................................................
        // rev W<ssa_86>, W<ssa_83>                                       // ...............*..........................................................................................................................
        // aesr V<ssa_57>.16b, v24.16b                                    // ...................................................................................*......................................................
        // orr X<ssa_88>, x12, X<ssa_86>, lsl #32                         // .................*........................................................................................................................
        // stp x11, X<ssa_88>, [sp, #STACK_BASE_AES_ST + 32]              // ...................*......................................................................................................................
        // ldr Q<ssa_95>, [sp, #STACK_BASE_AES_ST + 16]                   // ...............................*..........................................................................................................
        // aesr V<ssa_57>.16b, v25.16b                                    // .......................................................................................*..................................................
        // aesr V<ssa_58>.16b, v18.16b                                    // ................*.........................................................................................................................
        // aesr V<ssa_95>.16b, v18.16b                                    // ...........................................................................*..............................................................
        // aesr V<ssa_58>.16b, v19.16b                                    // ....................*.....................................................................................................................
        // ldp X<ssa_103>, X<ssa_104>, [x0], #(4*16)                      // ..................................*.......................................................................................................
        // aesr V<ssa_58>.16b, v20.16b                                    // .......................*..................................................................................................................
        // ldr Q<ssa_106>, [sp, #STACK_BASE_AES_ST + 32]                  // ......................*...................................................................................................................
        // aesr V<ssa_95>.16b, v19.16b                                    // ................................................................................*.........................................................
        // ldp X<ssa_107>, X<ssa_108>, [x0, #-48]                         // ...........................*..............................................................................................................
        // aesr V<ssa_95>.16b, v20.16b                                    // .....................................................................................*....................................................
        // ldp X<ssa_112>, X<ssa_113>, [x0, #-32]                         // .............................*............................................................................................................
        // eor X<ssa_114>, X<ssa_22>, x20                                 // ....................................*.....................................................................................................
        // aesr V<ssa_58>.16b, v21.16b                                    // ..........................*...............................................................................................................
        // ldp x10, X<ssa_116>, [x0, #48]                                 // .....................................*....................................................................................................
        // aesr V<ssa_106>.16b, v18.16b                                   // ............................*.............................................................................................................
        // eor X<ssa_118>, X<ssa_108>, x21                                // ......................................*...................................................................................................
        // aesr V<ssa_58>.16b, v22.16b                                    // ..............................*...........................................................................................................
        // aesr V<ssa_95>.16b, v21.16b                                    // .........................................................................................*................................................
        // aesr V<ssa_106>.16b, v19.16b                                   // ................................*.........................................................................................................
        // aesr V<ssa_58>.16b, v23.16b                                    // ...................................*......................................................................................................
        // aesr V<ssa_106>.16b, v20.16b                                   // .......................................*..................................................................................................
        // aesr V<ssa_58>.16b, v24.16b                                    // ..........................................*...............................................................................................
        // eor X<ssa_122>, X<ssa_112>, x20                                // ........................................*.................................................................................................
        // stp X<ssa_114>, X<ssa_44>, [sp, #STACK_BASE_AES_ST + 48]       // .........................................*................................................................................................
        // eor X<ssa_126>, X<ssa_113>, x21                                // ...........................................*..............................................................................................
        // aesr V<ssa_106>.16b, v21.16b                                   // .............................................*............................................................................................
        // add w13, w13, #UNROLL                                          // ............................................*.............................................................................................
        // aesr V<ssa_58>.16b, v25.16b                                    // ................................................*.........................................................................................
        // ldr Q<ssa_127>, [sp, #STACK_BASE_AES_ST + 48]                  // .................................................*........................................................................................
        // add W<ssa_128>, w13, #0                                        // ..................................................*.......................................................................................
        // stp X<ssa_122>, X<ssa_126>, [sp, #STACK_BASE_AES_ST + 32]      // ...............................................*..........................................................................................
        // aesr V<ssa_106>.16b, v22.16b                                   // ....................................................*.....................................................................................
        // eor X<ssa_131>, X<ssa_104>, x21                                // ...................................................*......................................................................................
        // eor X<ssa_132>, X<ssa_103>, x20                                // ......................................................*...................................................................................
        // ldr Q<ssa_133>, [sp, #STACK_BASE_AES_ST + 32]                  // .....................................................*....................................................................................
        // aesr V<ssa_58>.16b, v26.16b                                    // ........................................................*.................................................................................
        // rev W<ssa_134>, W<ssa_128>                                     // .........................................................*................................................................................
        // stp X<ssa_132>, X<ssa_131>, [sp, #STACK_BASE_AES_ST]           // ..........................................................*...............................................................................
        // aesr V<ssa_106>.16b, v23.16b                                   // ................................................................*.........................................................................
        // eor x22, X<ssa_116>, x21                                       // .............................................................*............................................................................
        // orr X<ssa_136>, x12, X<ssa_134>, lsl #32                       // ..............................................................*...........................................................................
        // aese V<ssa_58>.16b, v27.16b                                    // .....................................................................*....................................................................
        // ldr Q<ssa_137>, [sp, #STACK_BASE_AES_ST]                       // .................................................................*........................................................................
        // add W<ssa_138>, w13, #3                                        // ..............................................*...........................................................................................
        // aesr V<ssa_57>.16b, v26.16b                                    // ................................................................................................................*.........................
        // rev W<ssa_140>, W<ssa_138>                                     // .......................................................*..................................................................................
        // aesr V<ssa_106>.16b, v24.16b                                   // ........................................................................................*.................................................
        // eor V<ssa_141>.16B, V<ssa_127>.16B, V<ssa_58>.16B              // ..............................................................................................*...........................................
        // orr X<ssa_142>, x12, X<ssa_140>, lsl #32                       // ..................................................................*.......................................................................
        // aese V<ssa_57>.16b, v27.16b                                    // .....................................................................................................................*....................
        // stp x11, X<ssa_142>, [sp, #STACK_BASE_AES_ST + 48]             // ......................................................................*...................................................................
        // aesr V<ssa_106>.16b, v25.16b                                   // ..........................................................................................*...............................................
        // rev64 v2.16B, V<ssa_141>.16B                                   // ..................................................................................................*.......................................
        // stp x11, X<ssa_136>, [sp, #STACK_BASE_AES_ST]                  // ..................................................................................*.......................................................
        // eor X<ssa_145>, X<ssa_107>, x20                                // ...........................................................*..............................................................................
        // eor V<ssa_146>.16B, V<ssa_137>.16B, V<ssa_57>.16B              // ........................................................................................................................*.................
        // aesr V<ssa_95>.16b, v22.16b                                    // ............................................................................................*.............................................
        // aesr V<ssa_106>.16b, v26.16b                                   // ...............................................................................................*..........................................
        // ldr q29, [sp, #STACK_BASE_AES_ST]                              // ......................................................................................*...................................................
        // ldr q11, [sp, #STACK_BASE_AES_ST + 48]                         // ....................................................................................*.....................................................
        // aesr V<ssa_95>.16b, v23.16b                                    // ................................................................................................*.........................................
        // add W<ssa_147>, w13, #1                                        // ...................................................................*......................................................................
        // mov D<ssa_148>, v2.d[1]                                        // ....................................................................................................*.....................................
        // aese V<ssa_106>.16b, v27.16b                                   // .....................................................................................................*....................................
        // rev W<ssa_149>, W<ssa_147>                                     // .......................................................................*..................................................................
        // str Q<ssa_141>, [x2, #48]                                      // ......................................................................................................*...................................
        // pmull2 V<ssa_150>.1q, v2.2d, v12.2d                            // .........................................................................................................................*................
        // stp X<ssa_145>, X<ssa_118>, [sp, #STACK_BASE_AES_ST + 16]      // ...............................................................*..........................................................................
        // orr X<ssa_152>, x12, X<ssa_149>, lsl #32                       // ..........................................................................*...............................................................
        // eor V<ssa_153>.16B, V<ssa_133>.16B, V<ssa_106>.16B             // ........................................................................................................*.................................
        // aesr V<ssa_95>.16b, v24.16b                                    // ...................................................................................................*......................................
        // ldr Q<ssa_154>, [sp, #STACK_BASE_AES_ST + 16]                  // ....................................................................*.....................................................................
        // aesr v29.16b, v18.16b                                          // ...........................................................................................*..............................................
        // stp x11, X<ssa_152>, [sp, #STACK_BASE_AES_ST + 16]             // .............................................................................*............................................................
        // aesr V<ssa_95>.16b, v25.16b                                    // .......................................................................................................*..................................
        // rev64 V<ssa_155>.16B, V<ssa_153>.16B                           // ............................................................................................................*.............................
        // aesr v29.16b, v19.16b                                          // .............................................................................................*............................................
        // aesr V<ssa_95>.16b, v26.16b                                    // ..........................................................................................................*...............................
        // ext V<ssa_157>.16B, V<ssa_155>.16B, V<ssa_155>.16B, #8         // .................................................................................................................*........................
        // eor V<ssa_158>.8B, V<ssa_148>.8B, v2.8B                        // ...........................................................................................................*..............................
        // aesr v29.16b, v20.16b                                          // .................................................................................................*........................................
        // eor V<ssa_159>.16B, V<ssa_157>.16B, V<ssa_155>.16B             // ....................................................................................................................*.....................
        // aese V<ssa_95>.16b, v27.16b                                    // ...............................................................................................................*..........................
        // aesr v29.16b, v21.16b                                          // .........................................................................................................*................................
        // str Q<ssa_153>, [x2, #32]                                      // ..............................................................................................................*...........................
        // pmull v31.1q, V<ssa_155>.1d, v13.1d                            // ..........................................................................................................................*...............
        // eor v8.16B, V<ssa_154>.16B, V<ssa_95>.16B                      // ...................................................................................................................*......................
        // aesr v29.16b, v22.16b                                          // .............................................................................................................*............................
        // pmull2 V<ssa_160>.1q, V<ssa_159>.2d, v14.2d                    // ............................................................................................................................*.............
        // rev64 V<ssa_161>.16B, v8.16B                                   // ......................................................................................................................*...................
        // rev64 V<ssa_162>.16B, V<ssa_146>.16B                           // .............................................................................................................................*............
        // pmull2 V<ssa_163>.1q, V<ssa_155>.2d, v13.2d                    // ..............................................................................................................................*...........
        // pmull2 v3.1q, V<ssa_161>.2d, v15.2d                            // ..................................................................................................................................*.......
        // str Q<ssa_146>, [x2], #(4*16)                                  // ...............................................................................................................................*..........
        // pmull V<ssa_164>.1q, V<ssa_158>.1d, v14.1d                     // .................................................................................................................................*........
        // eor v5.16B, V<ssa_162>.16B, v30.16B                            // ................................................................................................................................*.........
        // aesr v29.16b, v23.16b                                          // ..................................................................................................................*.......................
        // mov D<ssa_165>, V<ssa_161>.d[1]                                // ...........................................................................................................................*..............
        // add W<ssa_166>, w13, #2                                        // .........................................................................*................................................................
        // pmull2 v0.1q, v5.2d, v16.2d                                    // .........................................................................................................................................*
        // eor v4.16B, V<ssa_150>.16B, V<ssa_163>.16B                     // ...................................................................................................................................*......
        // rev W<ssa_167>, W<ssa_166>                                     // ............................................................................*.............................................................
        // ext v10.16B, v5.16B, v5.16B, #8                                // .......................................................................................................................................*..
        // aesr v29.16b, v24.16b                                          // .......................................................................................................................*..................
        // orr X<ssa_168>, x12, X<ssa_167>, lsl #32                       // ...............................................................................*..........................................................
        // eor v30.8B, V<ssa_165>.8B, V<ssa_161>.8B                       // ........................................................................................................................................*.
        // pmull v28.1q, v5.1d, v16.1d                                    // ....................................................................................................................................*.....
        // stp x11, X<ssa_168>, [sp, #STACK_BASE_AES_ST + 32]             // .................................................................................*........................................................
        // eor v1.16B, V<ssa_164>.16B, V<ssa_160>.16B                     // .....................................................................................................................................*....
        // pmull v6.1q, V<ssa_161>.1d, v15.1d                             // ......................................................................................................................................*...

        sub count, count, #2
cbz count, Lloop_unrolled_start_postamble
Lloop_unrolled_start:
        // Instructions:    134
        // Expected cycles: 54
        // Expected IPC:    2.4814814814814814
        pmull v30.1q, v30.1d, v17.1d                       // l.....................................................
        ldr q9, [sp, #STACK_BASE_AES_ST + 16]              // *..................................................... // @slothy:reads=stack_1
        pmull v2.1q, v2.1d, v12.1d                         // .l....................................................
        aesr v29.16b, v25.16b                              // ..*...................................................
        eor v1.16B, v1.16B, v30.16B                        // ..l...................................................
        eor v31.16B, v2.16B, v31.16B                       // ...l..................................................
        aesr v11.16b, v18.16b                              // ...*..................................................
        eor v10.16B, v10.16B, v5.16B                       // ....l.................................................
        aesr v9.16b, v18.16b                               // ....*.................................................
        eor v4.16B, v4.16B, v3.16B                         // .....l................................................
        aesr v11.16b, v19.16b                              // .....*................................................
        pmull2 v5.1q, v10.2d, v17.2d                       // ......l...............................................
        eor v3.16B, v31.16B, v6.16B                        // ......l...............................................
        ldp x30, x29, [x0], #(4*16)                        // ......*...............................................
        aesr v11.16b, v20.16b                              // .......*..............................................
        eor v31.16B, v4.16B, v0.16B                        // .......l..............................................
        ldr q30, [sp, #STACK_BASE_AES_ST + 32]             // ........*............................................. // @slothy:reads=stack_2
        aesr v9.16b, v19.16b                               // ........*.............................................
        ldp x8, x26, [x0, #-48]                            // ........*.............................................
        pmull v2.1q, v31.1d, v7.1d                         // .........l............................................
        ext v0.16B, v31.16B, v31.16B, #8                   // .........l............................................
        eor v28.16B, v3.16B, v28.16B                       // ..........l...........................................
        aesr v9.16b, v20.16b                               // ..........*...........................................
        ldp x24, x25, [x0, #-32]                           // ..........*...........................................
        eor x28, x10, x20                                  // ..........*...........................................
        aesr v11.16b, v21.16b                              // ...........*..........................................
        eor v6.16B, v1.16B, v5.16B                         // ...........l..........................................
        ldp x10, x27, [x0, #48]                            // ...........e..........................................
        aesr v30.16b, v18.16b                              // ............*.........................................
        eor v31.16B, v28.16B, v31.16B                      // ............l.........................................
        eor x7, x26, x21                                   // ............*.........................................
        aesr v11.16b, v22.16b                              // .............*........................................
        eor v0.16B, v0.16B, v2.16B                         // .............l........................................
        eor v3.16B, v6.16B, v31.16B                        // ..............l.......................................
        aesr v9.16b, v21.16b                               // ..............*.......................................
        str q8, [x2, #-48]                                 // ...............l......................................
        aesr v30.16b, v19.16b                              // ...............*......................................
        aesr v11.16b, v23.16b                              // ................*.....................................
        aesr v30.16b, v20.16b                              // .................*....................................
        eor v2.16B, v3.16B, v0.16B                         // .................l....................................
        aesr v11.16b, v24.16b                              // ..................*...................................
        eor x24, x24, x20                                  // ..................*...................................
        pmull v10.1q, v2.1d, v7.1d                         // ...................l..................................
        ext v8.16B, v2.16B, v2.16B, #8                     // ...................l..................................
        stp x28, x22, [sp, #STACK_BASE_AES_ST + 48]        // ...................*.................................. // @slothy:writes=stack_3
        eor x17, x25, x21                                  // ...................*..................................
        aesr v30.16b, v21.16b                              // ....................*.................................
        add w13, w13, #UNROLL                              // ....................*.................................
        aesr v11.16b, v25.16b                              // .....................*................................
        ldr q5, [sp, #STACK_BASE_AES_ST + 48]              // .....................*................................ // @slothy:reads=stack_3
        add w28, w13, #0                                   // .....................e................................
        stp x24, x17, [sp, #STACK_BASE_AES_ST + 32]        // .....................*................................ // @slothy:writes=stack_2
        eor v1.16B, v28.16B, v10.16B                       // ......................l...............................
        aesr v30.16b, v22.16b                              // ......................*...............................
        eor x9, x29, x21                                   // ......................*...............................
        eor x24, x30, x20                                  // ......................*...............................
        ldr q3, [sp, #STACK_BASE_AES_ST + 32]              // .......................*.............................. // @slothy:reads=stack_2
        aesr v11.16b, v26.16b                              // .......................*..............................
        rev w14, w28                                       // .......................e..............................
        stp x24, x9, [sp, #STACK_BASE_AES_ST]              // .......................*.............................. // @slothy:writes=stack_0
        aesr v30.16b, v23.16b                              // ........................*.............................
        eor x22, x27, x21                                  // ........................e.............................
        orr x17, x12, x14, lsl #32                         // ........................e.............................
        aese v11.16b, v27.16b                              // .........................*............................
        ldr q10, [sp, #STACK_BASE_AES_ST]                  // .........................*............................ // @slothy:reads=stack_0
        add w25, w13, #3                                   // .........................e............................
        eor v0.16B, v1.16B, v8.16B                         // ..........................l...........................
        aesr v29.16b, v26.16b                              // ..........................*...........................
        rev w27, w25                                       // ..........................e...........................
        aesr v30.16b, v24.16b                              // ...........................*..........................
        eor v31.16B, v5.16B, v11.16B                       // ...........................*..........................
        orr x25, x12, x27, lsl #32                         // ...........................e..........................
        aese v29.16b, v27.16b                              // ............................*.........................
        stp x11, x25, [sp, #STACK_BASE_AES_ST + 48]        // ............................e......................... // @slothy:writes=stack_3
        aesr v30.16b, v25.16b                              // .............................*........................
        rev64 v2.16B, v31.16B                              // .............................*........................
        stp x11, x17, [sp, #STACK_BASE_AES_ST]             // .............................e........................ // @slothy:writes=stack_0
        eor x29, x8, x20                                   // .............................*........................
        eor v28.16B, v10.16B, v29.16B                      // ..............................*.......................
        aesr v9.16b, v22.16b                               // ..............................*.......................
        aesr v30.16b, v26.16b                              // ...............................*......................
        ldr q29, [sp, #STACK_BASE_AES_ST]                  // ...............................e...................... // @slothy:reads=stack_0
        ldr q11, [sp, #STACK_BASE_AES_ST + 48]             // ................................e..................... // @slothy:reads=stack_3
        aesr v9.16b, v23.16b                               // ................................*.....................
        add w23, w13, #1                                   // ................................e.....................
        mov d5, v2.d[1]                                    // .................................*....................
        aese v30.16b, v27.16b                              // .................................*....................
        rev w27, w23                                       // .................................e....................
        str q31, [x2, #48]                                 // ..................................*...................
        pmull2 v10.1q, v2.2d, v12.2d                       // ..................................*...................
        stp x29, x7, [sp, #STACK_BASE_AES_ST + 16]         // ..................................*................... // @slothy:writes=stack_1
        orr x25, x12, x27, lsl #32                         // ..................................e...................
        eor v1.16B, v3.16B, v30.16B                        // ...................................*..................
        aesr v9.16b, v24.16b                               // ...................................*..................
        ldr q8, [sp, #STACK_BASE_AES_ST + 16]              // ....................................*................. // @slothy:reads=stack_1
        aesr v29.16b, v18.16b                              // ....................................e.................
        stp x11, x25, [sp, #STACK_BASE_AES_ST + 16]        // ....................................e................. // @slothy:writes=stack_1
        aesr v9.16b, v25.16b                               // .....................................*................
        rev64 v3.16B, v1.16B                               // .....................................*................
        ext v30.16B, v0.16B, v0.16B, #8                    // ......................................l...............
        aesr v29.16b, v19.16b                              // ......................................e...............
        aesr v9.16b, v26.16b                               // .......................................*..............
        ext v6.16B, v3.16B, v3.16B, #8                     // .......................................*..............
        eor v5.8B, v5.8B, v2.8B                            // ........................................*.............
        aesr v29.16b, v20.16b                              // ........................................e.............
        eor v4.16B, v6.16B, v3.16B                         // .........................................*............
        aese v9.16b, v27.16b                               // .........................................*............
        aesr v29.16b, v21.16b                              // ..........................................e...........
        str q1, [x2, #32]                                  // ..........................................*...........
        pmull v31.1q, v3.1d, v13.1d                        // ...........................................*..........
        eor v8.16B, v8.16B, v9.16B                         // ...........................................*..........
        aesr v29.16b, v22.16b                              // ............................................e.........
        pmull2 v1.1q, v4.2d, v14.2d                        // .............................................*........
        rev64 v9.16B, v8.16B                               // .............................................*........
        rev64 v0.16B, v28.16B                              // ..............................................*.......
        pmull2 v4.1q, v3.2d, v13.2d                        // ..............................................*.......
        pmull2 v3.1q, v9.2d, v15.2d                        // ...............................................*......
        str q28, [x2], #(4*16)                             // ...............................................*......
        pmull v6.1q, v5.1d, v14.1d                         // ................................................*.....
        eor v5.16B, v0.16B, v30.16B                        // ................................................*.....
        aesr v29.16b, v23.16b                              // .................................................e....
        mov d28, v9.d[1]                                   // .................................................*....
        add w28, w13, #2                                   // .................................................e....
        pmull2 v0.1q, v5.2d, v16.2d                        // ..................................................*...
        eor v4.16B, v10.16B, v4.16B                        // ..................................................*...
        rev w9, w28                                        // ..................................................e...
        ext v10.16B, v5.16B, v5.16B, #8                    // ...................................................*..
        aesr v29.16b, v24.16b                              // ...................................................e..
        orr x19, x12, x9, lsl #32                          // ...................................................e..
        eor v30.8B, v28.8B, v9.8B                          // ....................................................*.
        pmull v28.1q, v5.1d, v16.1d                        // ....................................................*.
        stp x11, x19, [sp, #STACK_BASE_AES_ST + 32]        // ....................................................e. // @slothy:writes=stack_2
        eor v1.16B, v6.16B, v1.16B                         // .....................................................*
        pmull v6.1q, v9.1d, v15.1d                         // .....................................................*

        // original source code
        // ldp x22, x23, [x0, #(3*16)]                                  // e..........................................................................................................|..........................e..........................................................................................................|..........................e........................................................................
        // add        w14, w13, #3                                      // ......................................e....................................................................|................................................................e....................................................................|................................................................e..................................
        // rev        w14, w14                                          // .........................................e.................................................................|...................................................................e.................................................................|...................................................................e...............................
        // orr        x14, x12, x14, lsl #32                            // ............................................e..............................................................|......................................................................e..............................................................|......................................................................e............................
        // stp        x11, x14, [sp, #(STACK_BASE_AES_ST + 3*16)]       // ..............................................e............................................................|........................................................................e............................................................|........................................................................e..........................
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 3*16)]             // .......................................................e...................................................|.................................................................................e...................................................|.................................................................................e.................
        // aesr v0.16b, v18.16b                                         // ...........................................................................................................|.....*...............................................................................................................................|.....*.............................................................................................
        // aesr v0.16b, v19.16b                                         // ...........................................................................................................|.........*...........................................................................................................................|.........*.........................................................................................
        // aesr v0.16b, v20.16b                                         // ...........................................................................................................|.............*.......................................................................................................................|.............*.....................................................................................
        // aesr v0.16b, v21.16b                                         // ...........................................................................................................|........................*............................................................................................................|........................*..........................................................................
        // aesr v0.16b, v22.16b                                         // ....*......................................................................................................|..............................*......................................................................................................|..............................*....................................................................
        // aesr v0.16b, v23.16b                                         // ..........*................................................................................................|....................................*................................................................................................|....................................*..............................................................
        // aesr v0.16b, v24.16b                                         // .............*.............................................................................................|.......................................*.............................................................................................|.......................................*...........................................................
        // aesr v0.16b, v25.16b                                         // .....................*.....................................................................................|...............................................*.....................................................................................|...............................................*...................................................
        // aesr v0.16b, v26.16b                                         // ..............................*............................................................................|........................................................*............................................................................|........................................................*..........................................
        // aese v0.16b, v27.16b                                         // ....................................*......................................................................|..............................................................*......................................................................|..............................................................*....................................
        // eor x22, x22, x20                                            // ...........................................................................................................|.......................*.............................................................................................................|.......................*...........................................................................
        // eor x23, x23, x21                                            // ..................................e........................................................................|............................................................e........................................................................|............................................................e......................................
        // stp x22, x23, [sp, #(STACK_BASE_AES_ST + 3*16)]              // .................*.........................................................................................|...........................................*.........................................................................................|...........................................*.......................................................
        // ldr q29, [sp, #(STACK_BASE_AES_ST + 3*16)]                   // ......................*....................................................................................|................................................*....................................................................................|................................................*..................................................
        // eor v0.16b, v29.16b, v0.16b                                  // ...........................................*...............................................................|.....................................................................*...............................................................|.....................................................................*.............................
        // str q0, [x2, #(3*16)]                                        // .............................................................*.............................................|.......................................................................................*.............................................|.......................................................................................*...........
        // rev64 v0.16b, v0.16b                                         // ................................................*..........................................................|..........................................................................*..........................................................|..........................................................................*........................
        // pmull   v8.1q, v0.1d, v12.1d                                 // ...........................................................................................................|.l...................................................................................................................................|.l.................................................................................................
        // pmull2  v9.1q, v0.2d, v12.2d                                 // ..............................................................*............................................|........................................................................................*............................................|........................................................................................*..........
        // mov     d11, v0.d[1]                                         // ..........................................................*................................................|....................................................................................*................................................|....................................................................................*..............
        // eor     v11.8b, v11.8b, v0.8b                                // ............................................................................*..............................|......................................................................................................*..............................|...................................................................................................
        // pmull   v10.1q, v11.1d, v14.1d                               // ...........................................................................................*...............|.....................................................................................................................*...............|...................................................................................................
        // ldp x22, x23, [x0, #(2*16)]                                  // ...........................................................................................................|......................*..............................................................................................................|......................*............................................................................
        // add        w14, w13, #2                                      // ...............................................................................................e...........|.........................................................................................................................e...........|...................................................................................................
        // rev        w14, w14                                          // ..................................................................................................e........|............................................................................................................................e........|...................................................................................................
        // orr        x14, x12, x14, lsl #32                            // .....................................................................................................e.....|...............................................................................................................................e.....|...................................................................................................
        // stp        x11, x14, [sp, #(STACK_BASE_AES_ST + 2*16)]       // ........................................................................................................e..|..................................................................................................................................e..|...................................................................................................
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 2*16)]             // ...........................................................................................................|...............*.....................................................................................................................|...............*...................................................................................
        // aesr v0.16b, v18.16b                                         // .*.........................................................................................................|...........................*.........................................................................................................|...........................*.......................................................................
        // aesr v0.16b, v19.16b                                         // .........*.................................................................................................|...................................*.................................................................................................|...................................*...............................................................
        // aesr v0.16b, v20.16b                                         // ...........*...............................................................................................|.....................................*...............................................................................................|.....................................*.............................................................
        // aesr v0.16b, v21.16b                                         // ...................*.......................................................................................|.............................................*.......................................................................................|.............................................*.....................................................
        // aesr v0.16b, v22.16b                                         // ..........................*................................................................................|....................................................*................................................................................|....................................................*..............................................
        // aesr v0.16b, v23.16b                                         // .................................*.........................................................................|...........................................................*.........................................................................|...........................................................*.......................................
        // aesr v0.16b, v24.16b                                         // ..........................................*................................................................|....................................................................*................................................................|....................................................................*..............................
        // aesr v0.16b, v25.16b                                         // ...............................................*...........................................................|.........................................................................*...........................................................|.........................................................................*.........................
        // aesr v0.16b, v26.16b                                         // .....................................................*.....................................................|...............................................................................*.....................................................|...............................................................................*...................
        // aese v0.16b, v27.16b                                         // ...........................................................*...............................................|.....................................................................................*...............................................|.....................................................................................*.............
        // eor x22, x22, x20                                            // ..............*............................................................................................|........................................*............................................................................................|........................................*..........................................................
        // eor x23, x23, x21                                            // ..................*........................................................................................|............................................*........................................................................................|............................................*......................................................
        // stp x22, x23, [sp, #(STACK_BASE_AES_ST + 2*16)]              // ........................*..................................................................................|..................................................*..................................................................................|..................................................*................................................
        // ldr q29, [sp, #(STACK_BASE_AES_ST + 2*16)]                   // .............................*.............................................................................|.......................................................*.............................................................................|.......................................................*...........................................
        // eor v0.16b, v29.16b, v0.16b                                  // .................................................................*.........................................|...........................................................................................*.........................................|...........................................................................................*.......
        // str q0, [x2, #(2*16)]                                        // .................................................................................*.........................|...........................................................................................................*.........................|...................................................................................................
        // rev64   v0.16b, v0.16b                                       // .......................................................................*...................................|.................................................................................................*...................................|.................................................................................................*.
        // pmull   v11.1q, v0.1d, v13.1d                                // ..................................................................................*........................|............................................................................................................*........................|...................................................................................................
        // eor     v8.16b, v8.16b, v11.16b                              // ...........................................................................................................|....l................................................................................................................................|....l..............................................................................................
        // pmull2  v11.1q, v0.2d, v13.2d                                // ........................................................................................*..................|..................................................................................................................*..................|...................................................................................................
        // eor     v9.16b, v9.16b, v11.16b                              // .................................................................................................*.........|...........................................................................................................................*.........|...................................................................................................
        // ext     v11.16b, v0.16b, v0.16b, #8                          // ...........................................................................*...............................|.....................................................................................................*...............................|...................................................................................................
        // eor     v11.16b, v11.16b, v0.16b                             // ..............................................................................*............................|........................................................................................................*............................|...................................................................................................
        // pmull2  v11.1q, v11.2d, v14.2d                               // .....................................................................................*.....................|...............................................................................................................*.....................|...................................................................................................
        // eor     v10.16b, v10.16b, v11.16b                            // .........................................................................................................*.|...................................................................................................................................*.|...................................................................................................
        // ldp x22, x23, [x0, #(1*16)]                                  // ...........................................................................................................|.................*...................................................................................................................|.................*.................................................................................
        // add        w14, w13, #1                                      // .........................................................e.................................................|...................................................................................e.................................................|...................................................................................e...............
        // rev        w14, w14                                          // ............................................................e..............................................|......................................................................................e..............................................|......................................................................................e............
        // orr        x14, x12, x14, lsl #32                            // ................................................................e..........................................|..........................................................................................e..........................................|..........................................................................................e........
        // stp        x11, x14, [sp, #(STACK_BASE_AES_ST + 1*16)]       // .....................................................................e.....................................|...............................................................................................e.....................................|...............................................................................................e...
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 1*16)]             // ...........................................................................................................|*....................................................................................................................................|*..................................................................................................
        // aesr v0.16b, v18.16b                                         // ...........................................................................................................|.......*.............................................................................................................................|.......*...........................................................................................
        // aesr v0.16b, v19.16b                                         // ...........................................................................................................|................*....................................................................................................................|................*..................................................................................
        // aesr v0.16b, v20.16b                                         // ...........................................................................................................|.....................*...............................................................................................................|.....................*.............................................................................
        // aesr v0.16b, v21.16b                                         // .......*...................................................................................................|.................................*...................................................................................................|.................................*.................................................................
        // aesr v0.16b, v22.16b                                         // ....................................................*......................................................|..............................................................................*......................................................|..............................................................................*....................
        // aesr v0.16b, v23.16b                                         // ........................................................*..................................................|..................................................................................*..................................................|..................................................................................*................
        // aesr v0.16b, v24.16b                                         // ..................................................................*........................................|............................................................................................*........................................|............................................................................................*......
        // aesr v0.16b, v25.16b                                         // ......................................................................*....................................|................................................................................................*....................................|................................................................................................*..
        // aesr v0.16b, v26.16b                                         // ..........................................................................*................................|....................................................................................................*................................|...................................................................................................
        // aese v0.16b, v27.16b                                         // ...............................................................................*...........................|.........................................................................................................*...........................|...................................................................................................
        // eor x22, x22, x20                                            // ..................................................*........................................................|............................................................................*........................................................|............................................................................*......................
        // eor x23, x23, x21                                            // ...*.......................................................................................................|.............................*.......................................................................................................|.............................*.....................................................................
        // stp x22, x23, [sp, #(STACK_BASE_AES_ST + 1*16)]              // ...............................................................*...........................................|.........................................................................................*...........................................|.........................................................................................*.........
        // ldr q29, [sp, #(STACK_BASE_AES_ST + 1*16)]                   // ...................................................................*.......................................|.............................................................................................*.......................................|.............................................................................................*.....
        // eor v0.16b, v29.16b, v0.16b                                  // ...................................................................................*.......................|.............................................................................................................*.......................|...................................................................................................
        // str q0, [x2, #(1*16)]                                        // ........l..................................................................................................|..................................l..................................................................................................|..................................l................................................................
        // rev64   v0.16b, v0.16b                                       // ......................................................................................*....................|................................................................................................................*....................|...................................................................................................
        // pmull   v11.1q, v0.1d, v15.1d                                // ..........................................................................................................*|....................................................................................................................................*|...................................................................................................
        // eor     v8.16b, v8.16b, v11.16b                              // ...........................................................................................................|...........l.........................................................................................................................|...........l.......................................................................................
        // pmull2  v11.1q, v0.2d, v15.2d                                // .........................................................................................*.................|...................................................................................................................*.................|...................................................................................................
        // eor     v9.16b, v9.16b, v11.16b                              // ...........................................................................................................|........l............................................................................................................................|........l..........................................................................................
        // mov     d11, v0.d[1]                                         // ..............................................................................................*............|........................................................................................................................*............|...................................................................................................
        // eor     v11.8b, v11.8b, v0.8b                                // ......................................................................................................*....|................................................................................................................................*....|...................................................................................................
        // pmull   v11.1q, v11.1d, v17.1d                               // ...........................................................................................................l.....................................................................................................................................l...................................................................................................
        // eor     v10.16b, v10.16b, v11.16b                            // ...........................................................................................................|...l.................................................................................................................................|...l...............................................................................................
        // ldp x22, x23, [x0], #(4*16)                                  // ...........................................................................................................|............*........................................................................................................................|............*......................................................................................
        // add        w14, w13, #0                                      // .......................e...................................................................................|.................................................e...................................................................................|.................................................e.................................................
        // rev        w14, w14                                          // ...............................e...........................................................................|.........................................................e...........................................................................|.........................................................e.........................................
        // orr        x14, x12, x14, lsl #32                            // ...................................e.......................................................................|.............................................................e.......................................................................|.............................................................e.....................................
        // stp        x11, x14, [sp, #(STACK_BASE_AES_ST + 0*16)]       // .................................................e.........................................................|...........................................................................e.........................................................|...........................................................................e.......................
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 0*16)]             // ......................................................e....................................................|................................................................................e....................................................|................................................................................e..................
        // aesr v0.16b, v18.16b                                         // ....................................................................e......................................|..............................................................................................e......................................|..............................................................................................e....
        // aesr v0.16b, v19.16b                                         // .........................................................................e.................................|...................................................................................................e.................................|...................................................................................................
        // aesr v0.16b, v20.16b                                         // .............................................................................e.............................|.......................................................................................................e.............................|...................................................................................................
        // aesr v0.16b, v21.16b                                         // ................................................................................e..........................|..........................................................................................................e..........................|...................................................................................................
        // aesr v0.16b, v22.16b                                         // ....................................................................................e......................|..............................................................................................................e......................|...................................................................................................
        // aesr v0.16b, v23.16b                                         // .............................................................................................e.............|.......................................................................................................................e.............|...................................................................................................
        // aesr v0.16b, v24.16b                                         // ....................................................................................................e......|..............................................................................................................................e......|...................................................................................................
        // aesr v0.16b, v25.16b                                         // ...........................................................................................................|..*..................................................................................................................................|..*................................................................................................
        // aesr v0.16b, v26.16b                                         // ........................................*..................................................................|..................................................................*..................................................................|..................................................................*................................
        // aese v0.16b, v27.16b                                         // .............................................*.............................................................|.......................................................................*.............................................................|.......................................................................*...........................
        // eor x22, x22, x20                                            // ............................*..............................................................................|......................................................*..............................................................................|......................................................*............................................
        // eor x23, x23, x21                                            // ...........................*...............................................................................|.....................................................*...............................................................................|.....................................................*.............................................
        // stp x22, x23, [sp, #(STACK_BASE_AES_ST + 0*16)]              // ................................*..........................................................................|..........................................................*..........................................................................|..........................................................*........................................
        // ldr q29, [sp, #(STACK_BASE_AES_ST + 0*16)]                   // .....................................*.....................................................................|...............................................................*.....................................................................|...............................................................*...................................
        // eor v0.16b, v29.16b, v0.16b                                  // ...................................................*.......................................................|.............................................................................*.......................................................|.............................................................................*.....................
        // str q0, [x2], #(4*16)                                        // ..........................................................................................*................|....................................................................................................................*................|...................................................................................................
        // rev64   v0.16b, v0.16b                                       // .......................................................................................*...................|.................................................................................................................*...................|...................................................................................................
        // eor   v0.16b, v0.16b, v30.16b                                // ............................................................................................*..............|......................................................................................................................*..............|...................................................................................................
        // pmull   v11.1q, v0.1d, v16.1d                                // .......................................................................................................*...|.................................................................................................................................*...|...................................................................................................
        // eor     v8.16b, v8.16b, v11.16b                              // ...........................................................................................................|....................l................................................................................................................|....................l..............................................................................
        // pmull2  v11.1q, v0.2d, v16.2d                                // ................................................................................................*..........|..........................................................................................................................*..........|...................................................................................................
        // eor     v9.16b, v9.16b, v11.16b                              // ...........................................................................................................|..............l......................................................................................................................|..............l....................................................................................
        // ext     v11.16b, v0.16b, v0.16b, #8                          // ...................................................................................................*.......|.............................................................................................................................*.......|...................................................................................................
        // eor     v11.16b, v11.16b, v0.16b                             // ...........................................................................................................|......l..............................................................................................................................|......l............................................................................................
        // pmull2  v11.1q, v11.2d, v17.2d                               // ...........................................................................................................|..........l..........................................................................................................................|..........l........................................................................................
        // eor     v10.16b, v10.16b, v11.16b                            // ...........................................................................................................|.........................l...........................................................................................................|.........................l.........................................................................
        // eor        v0.16b, v8.16b,  v9.16b                           // ..l........................................................................................................|............................l........................................................................................................|............................l......................................................................
        // pmull      v1.1q,  v9.1d,   v7.1d                            // ...........................................................................................................|..................l..................................................................................................................|..................l................................................................................
        // ext        v9.16b,    v9.16b,  v9.16b, #8                    // ...........................................................................................................|...................l.................................................................................................................|...................l...............................................................................
        // eor        v10.16b,   v10.16b, v0.16b                        // ......l....................................................................................................|................................l....................................................................................................|................................l..................................................................
        // eor        v1.16b, v9.16b,  v1.16b                           // .....l.....................................................................................................|...............................l.....................................................................................................|...............................l...................................................................
        // eor        v10.16b,   v10.16b, v1.16b                        // ............l..............................................................................................|......................................l..............................................................................................|......................................l............................................................
        // pmull      v9.1q,     v10.1d,  v7.1d                         // ...............l...........................................................................................|.........................................l...........................................................................................|.........................................l.........................................................
        // eor        v8.16b,    v8.16b,  v9.16b                        // .........................l.................................................................................|...................................................l.................................................................................|...................................................l...............................................
        // ext        v10.16b,   v10.16b, v10.16b, #8                   // ................l..........................................................................................|..........................................l..........................................................................................|..........................................l........................................................
        // eor        v30.16b,     v8.16b,  v10.16b                     // .......................................l...................................................................|.................................................................l...................................................................|.................................................................l.................................
        // ext        v30.16b, v30.16b, v30.16b, #8                     // ........................................................................l..................................|..................................................................................................l..................................|..................................................................................................l
        // add w13, w13, #UNROLL                                        // ....................*......................................................................................|..............................................*......................................................................................|..............................................*....................................................

        sub count, count, #1
        cbnz count, Lloop_unrolled_start
Lloop_unrolled_start_postamble:// end of loop kernel
        // Instructions:    130
        // Expected cycles: 66
        // Expected IPC:    1.9696969696969697
        str q8, [x2, #-48]                                 // *.................................................................
        aesr v11.16b, v18.16b                              // *.................................................................
        ldp x27, x19, [x0], #(4*16)                        // *.................................................................
        eor x28, x10, x20                                  // *.................................................................
        ldr q8, [sp, #STACK_BASE_AES_ST + 32]              // .*................................................................ // @slothy:reads=stack_2
        pmull v9.1q, v2.1d, v12.1d                         // .*................................................................
        add w13, w13, #UNROLL                              // .*................................................................
        aesr v11.16b, v19.16b                              // ..*...............................................................
        ldp x10, x26, [x0, #-48]                           // ..*...............................................................
        eor v10.16B, v10.16B, v5.16B                       // ...*..............................................................
        aesr v29.16b, v25.16b                              // ...*..............................................................
        aesr v11.16b, v20.16b                              // ....*.............................................................
        eor x7, x27, x20                                   // ....*.............................................................
        eor x19, x19, x21                                  // ....*.............................................................
        pmull2 v5.1q, v10.2d, v17.2d                       // .....*............................................................
        stp x28, x22, [sp, #STACK_BASE_AES_ST + 48]        // .....*............................................................ // @slothy:writes=stack_3
        stp x7, x19, [sp, #STACK_BASE_AES_ST]              // .....*............................................................ // @slothy:writes=stack_0
        aesr v11.16b, v21.16b                              // ......*...........................................................
        eor v31.16B, v9.16B, v31.16B                       // ......*...........................................................
        eor x30, x10, x20                                  // ......*...........................................................
        eor x17, x26, x21                                  // ......*...........................................................
        ldr q2, [sp, #STACK_BASE_AES_ST + 48]              // .......*.......................................................... // @slothy:reads=stack_3
        pmull v30.1q, v30.1d, v17.1d                       // .......*..........................................................
        ldp x27, x10, [x0, #-32]                           // .......*..........................................................
        eor v10.16B, v4.16B, v3.16B                        // ........*.........................................................
        aesr v11.16b, v22.16b                              // ........*.........................................................
        aesr v29.16b, v26.16b                              // .........*........................................................
        eor v9.16B, v1.16B, v30.16B                        // .........*........................................................
        aesr v11.16b, v23.16b                              // ..........*.......................................................
        eor v4.16B, v31.16B, v6.16B                        // ..........*.......................................................
        eor v30.16B, v9.16B, v5.16B                        // ...........*......................................................
        aesr v8.16b, v18.16b                               // ...........*......................................................
        eor x9, x27, x20                                   // ...........*......................................................
        eor x28, x10, x21                                  // ...........*......................................................
        eor v28.16B, v4.16B, v28.16B                       // ............*.....................................................
        aesr v11.16b, v24.16b                              // ............*.....................................................
        stp x9, x28, [sp, #STACK_BASE_AES_ST + 32]         // ............*..................................................... // @slothy:writes=stack_2
        eor v31.16B, v10.16B, v0.16B                       // .............*....................................................
        aesr v8.16b, v19.16b                               // .............*....................................................
        aesr v11.16b, v25.16b                              // ..............*...................................................
        ldr q10, [sp, #STACK_BASE_AES_ST + 16]             // ..............*................................................... // @slothy:reads=stack_1
        stp x30, x17, [sp, #STACK_BASE_AES_ST + 16]        // ..............*................................................... // @slothy:writes=stack_1
        eor v3.16B, v28.16B, v31.16B                       // ...............*..................................................
        pmull v0.1q, v31.1d, v7.1d                         // ...............*..................................................
        ext v4.16B, v31.16B, v31.16B, #8                   // ................*.................................................
        aesr v11.16b, v26.16b                              // ................*.................................................
        eor v6.16B, v30.16B, v3.16B                        // .................*................................................
        aese v29.16b, v27.16b                              // .................*................................................
        eor v0.16B, v4.16B, v0.16B                         // ..................*...............................................
        aese v11.16b, v27.16b                              // ..................*...............................................
        aesr v10.16b, v18.16b                              // ...................*..............................................
        ldr q5, [sp, #STACK_BASE_AES_ST + 16]              // ...................*.............................................. // @slothy:reads=stack_1
        aesr v8.16b, v20.16b                               // ....................*.............................................
        eor v31.16B, v2.16B, v11.16B                       // ....................*.............................................
        eor v3.16B, v6.16B, v0.16B                         // .....................*............................................
        aesr v10.16b, v19.16b                              // .....................*............................................
        rev64 v6.16B, v31.16B                              // ......................*...........................................
        aesr v8.16b, v21.16b                               // ......................*...........................................
        ldr q9, [sp, #STACK_BASE_AES_ST]                   // .......................*.......................................... // @slothy:reads=stack_0
        aesr v10.16b, v20.16b                              // .......................*..........................................
        ldr q0, [sp, #STACK_BASE_AES_ST + 32]              // ........................*......................................... // @slothy:reads=stack_2
        pmull v11.1q, v3.1d, v7.1d                         // ........................*.........................................
        ext v2.16B, v3.16B, v3.16B, #8                     // .........................*........................................
        aesr v10.16b, v21.16b                              // .........................*........................................
        aesr v8.16b, v22.16b                               // ..........................*.......................................
        eor v1.16B, v28.16B, v11.16B                       // ..........................*.......................................
        aesr v10.16b, v22.16b                              // ...........................*......................................
        eor v30.16B, v9.16B, v29.16B                       // ...........................*......................................
        aesr v8.16b, v23.16b                               // ............................*.....................................
        eor v1.16B, v1.16B, v2.16B                         // ............................*.....................................
        aesr v10.16b, v23.16b                              // .............................*....................................
        rev64 v28.16B, v30.16B                             // .............................*....................................
        ext v3.16B, v1.16B, v1.16B, #8                     // ..............................*...................................
        aesr v8.16b, v24.16b                               // ..............................*...................................
        mov d11, v6.d[1]                                   // ...............................*..................................
        aesr v10.16b, v24.16b                              // ...............................*..................................
        aesr v8.16b, v25.16b                               // ................................*.................................
        eor v2.16B, v28.16B, v3.16B                        // ................................*.................................
        str q31, [x2, #48]                                 // .................................*................................
        aesr v10.16b, v25.16b                              // .................................*................................
        ext v9.16B, v2.16B, v2.16B, #8                     // ..................................*...............................
        aesr v8.16b, v26.16b                               // ..................................*...............................
        str q30, [x2], #(4*16)                             // ...................................*..............................
        aesr v10.16b, v26.16b                              // ...................................*..............................
        eor v3.16B, v9.16B, v2.16B                         // ....................................*.............................
        aese v8.16b, v27.16b                               // ....................................*.............................
        eor v9.8B, v11.8B, v6.8B                           // .....................................*............................
        aese v10.16b, v27.16b                              // .....................................*............................
        pmull v29.1q, v6.1d, v12.1d                        // ......................................*...........................
        eor v8.16B, v0.16B, v8.16B                         // ......................................*...........................
        eor v1.16B, v5.16B, v10.16B                        // .......................................*..........................
        pmull2 v0.1q, v2.2d, v16.2d                        // .......................................*..........................
        pmull2 v31.1q, v6.2d, v12.2d                       // ........................................*.........................
        rev64 v4.16B, v8.16B                               // ........................................*.........................
        rev64 v6.16B, v1.16B                               // .........................................*........................
        pmull v11.1q, v9.1d, v14.1d                        // .........................................*........................
        pmull v9.1q, v4.1d, v13.1d                         // ..........................................*.......................
        ext v30.16B, v4.16B, v4.16B, #8                    // ..........................................*.......................
        pmull v5.1q, v6.1d, v15.1d                         // ...........................................*......................
        mov d10, v6.d[1]                                   // ...........................................*......................
        pmull2 v28.1q, v4.2d, v13.2d                       // ............................................*.....................
        eor v30.16B, v30.16B, v4.16B                       // ............................................*.....................
        pmull2 v4.1q, v6.2d, v15.2d                        // .............................................*....................
        eor v10.8B, v10.8B, v6.8B                          // .............................................*....................
        eor v28.16B, v31.16B, v28.16B                      // ..............................................*...................
        pmull2 v30.1q, v30.2d, v14.2d                      // ..............................................*...................
        pmull v31.1q, v10.1d, v17.1d                       // ...............................................*..................
        eor v29.16B, v29.16B, v9.16B                       // ...............................................*..................
        eor v11.16B, v11.16B, v30.16B                      // ................................................*.................
        eor v4.16B, v28.16B, v4.16B                        // ................................................*.................
        eor v9.16B, v29.16B, v5.16B                        // .................................................*................
        pmull v10.1q, v2.1d, v16.1d                        // .................................................*................
        pmull2 v28.1q, v3.2d, v17.2d                       // ..................................................*...............
        eor v30.16B, v4.16B, v0.16B                        // ..................................................*...............
        eor v5.16B, v9.16B, v10.16B                        // ...................................................*..............
        eor v2.16B, v11.16B, v31.16B                       // ...................................................*..............
        ext v10.16B, v30.16B, v30.16B, #8                  // ....................................................*.............
        pmull v29.1q, v30.1d, v7.1d                        // ....................................................*.............
        eor v9.16B, v5.16B, v30.16B                        // .....................................................*............
        eor v31.16B, v2.16B, v28.16B                       // .....................................................*............
        str q1, [x2, #-48]                                 // ......................................................*...........
        str q8, [x2, #-32]                                 // ......................................................*...........
        eor v2.16B, v10.16B, v29.16B                       // .......................................................*..........
        eor v29.16B, v31.16B, v9.16B                       // .......................................................*..........
        eor v29.16B, v29.16B, v2.16B                       // .........................................................*........
        pmull v9.1q, v29.1d, v7.1d                         // ...........................................................*......
        eor v0.16B, v5.16B, v9.16B                         // .............................................................*....
        ext v9.16B, v29.16B, v29.16B, #8                   // .............................................................*....
        eor v30.16B, v0.16B, v9.16B                        // ...............................................................*..
        ext v30.16B, v30.16B, v30.16B, #8                  // .................................................................*

        // original source code
        // pmull V<ssa_0>.1q, v30.1d, v17.1d                            // ......................*...........................................................................................................
        // ldr Q<ssa_1>, [sp, #STACK_BASE_AES_ST + 16]                  // ........................................*.........................................................................................
        // pmull V<ssa_2>.1q, v2.1d, v12.1d                             // .....*............................................................................................................................
        // aesr v29.16b, v25.16b                                        // ..........*.......................................................................................................................
        // eor V<ssa_3>.16B, v1.16B, V<ssa_0>.16B                       // ...........................*......................................................................................................
        // eor V<ssa_4>.16B, V<ssa_2>.16B, v31.16B                      // ..................*...............................................................................................................
        // aesr v11.16b, v18.16b                                        // .*................................................................................................................................
        // eor V<ssa_5>.16B, v10.16B, v5.16B                            // .........*........................................................................................................................
        // aesr V<ssa_1>.16b, v18.16b                                   // ..................................................*...............................................................................
        // eor V<ssa_6>.16B, v4.16B, v3.16B                             // ........................*.........................................................................................................
        // aesr v11.16b, v19.16b                                        // .......*..........................................................................................................................
        // pmull2 V<ssa_7>.1q, V<ssa_5>.2d, v17.2d                      // ..............*...................................................................................................................
        // eor V<ssa_8>.16B, V<ssa_4>.16B, v6.16B                       // .............................*....................................................................................................
        // ldp X<ssa_9>, X<ssa_10>, [x0], #(4*16)                       // ..*...............................................................................................................................
        // aesr v11.16b, v20.16b                                        // ...........*......................................................................................................................
        // eor V<ssa_11>.16B, V<ssa_6>.16B, v0.16B                      // .....................................*............................................................................................
        // ldr Q<ssa_12>, [sp, #STACK_BASE_AES_ST + 32]                 // ....*.............................................................................................................................
        // aesr V<ssa_1>.16b, v19.16b                                   // .......................................................*..........................................................................
        // ldp X<ssa_13>, X<ssa_14>, [x0, #-48]                         // ........*.........................................................................................................................
        // pmull V<ssa_15>.1q, V<ssa_11>.1d, v7.1d                      // ...........................................*......................................................................................
        // ext V<ssa_16>.16B, V<ssa_11>.16B, V<ssa_11>.16B, #8          // ............................................*.....................................................................................
        // eor V<ssa_17>.16B, V<ssa_8>.16B, v28.16B                     // ..................................*...............................................................................................
        // aesr V<ssa_1>.16b, v20.16b                                   // ...........................................................*......................................................................
        // ldp X<ssa_18>, X<ssa_19>, [x0, #-32]                         // .......................*..........................................................................................................
        // eor X<ssa_20>, x10, x20                                      // ...*..............................................................................................................................
        // aesr v11.16b, v21.16b                                        // .................*................................................................................................................
        // eor V<ssa_21>.16B, V<ssa_3>.16B, V<ssa_7>.16B                // ..............................*...................................................................................................
        // aesr V<ssa_12>.16b, v18.16b                                  // ...............................*..................................................................................................
        // eor V<ssa_24>.16B, V<ssa_17>.16B, V<ssa_11>.16B              // ..........................................*.......................................................................................
        // eor X<ssa_25>, X<ssa_14>, x21                                // ....................*.............................................................................................................
        // aesr v11.16b, v22.16b                                        // .........................*........................................................................................................
        // eor V<ssa_26>.16B, V<ssa_16>.16B, V<ssa_15>.16B              // ................................................*.................................................................................
        // eor V<ssa_27>.16B, V<ssa_21>.16B, V<ssa_24>.16B              // ..............................................*...................................................................................
        // aesr V<ssa_1>.16b, v21.16b                                   // ...............................................................*..................................................................
        // str q8, [x2, #-48]                                           // *.................................................................................................................................
        // aesr V<ssa_12>.16b, v19.16b                                  // ......................................*...........................................................................................
        // aesr v11.16b, v23.16b                                        // ............................*.....................................................................................................
        // aesr V<ssa_12>.16b, v20.16b                                  // ....................................................*.............................................................................
        // eor V<ssa_28>.16B, V<ssa_27>.16B, V<ssa_26>.16B              // ......................................................*...........................................................................
        // aesr v11.16b, v24.16b                                        // ...................................*..............................................................................................
        // eor X<ssa_29>, X<ssa_18>, x20                                // ................................*.................................................................................................
        // pmull V<ssa_30>.1q, V<ssa_28>.1d, v7.1d                      // .............................................................*....................................................................
        // ext V<ssa_31>.16B, V<ssa_28>.16B, V<ssa_28>.16B, #8          // ..............................................................*...................................................................
        // stp X<ssa_20>, x22, [sp, #STACK_BASE_AES_ST + 48]            // ...............*..................................................................................................................
        // eor X<ssa_33>, X<ssa_19>, x21                                // .................................*................................................................................................
        // aesr V<ssa_12>.16b, v21.16b                                  // .........................................................*........................................................................
        // add w13, w13, #UNROLL                                        // ......*...........................................................................................................................
        // aesr v11.16b, v25.16b                                        // .......................................*..........................................................................................
        // ldr Q<ssa_35>, [sp, #STACK_BASE_AES_ST + 48]                 // .....................*............................................................................................................
        // stp X<ssa_29>, X<ssa_33>, [sp, #STACK_BASE_AES_ST + 32]      // ....................................*.............................................................................................
        // eor V<ssa_38>.16B, V<ssa_17>.16B, V<ssa_30>.16B              // .................................................................*................................................................
        // aesr V<ssa_12>.16b, v22.16b                                  // ................................................................*.................................................................
        // eor X<ssa_39>, X<ssa_10>, x21                                // .............*....................................................................................................................
        // eor X<ssa_40>, X<ssa_9>, x20                                 // ............*.....................................................................................................................
        // ldr Q<ssa_41>, [sp, #STACK_BASE_AES_ST + 32]                 // ............................................................*.....................................................................
        // aesr v11.16b, v26.16b                                        // .............................................*....................................................................................
        // stp X<ssa_40>, X<ssa_39>, [sp, #STACK_BASE_AES_ST]           // ................*.................................................................................................................
        // aesr V<ssa_12>.16b, v23.16b                                  // ....................................................................*.............................................................
        // aese v11.16b, v27.16b                                        // .................................................*................................................................................
        // ldr Q<ssa_46>, [sp, #STACK_BASE_AES_ST]                      // ..........................................................*.......................................................................
        // eor V<ssa_48>.16B, V<ssa_38>.16B, V<ssa_31>.16B              // .....................................................................*............................................................
        // aesr v29.16b, v26.16b                                        // ..........................*.......................................................................................................
        // aesr V<ssa_12>.16b, v24.16b                                  // .........................................................................*........................................................
        // eor V<ssa_50>.16B, V<ssa_35>.16B, v11.16B                    // .....................................................*............................................................................
        // aese v29.16b, v27.16b                                        // ...............................................*..................................................................................
        // aesr V<ssa_12>.16b, v25.16b                                  // ............................................................................*.....................................................
        // rev64 V<ssa_53>.16B, V<ssa_50>.16B                           // ........................................................*.........................................................................
        // eor X<ssa_55>, X<ssa_13>, x20                                // ...................*..............................................................................................................
        // eor V<ssa_56>.16B, V<ssa_46>.16B, v29.16B                    // ...................................................................*..............................................................
        // aesr V<ssa_1>.16b, v22.16b                                   // ..................................................................*...............................................................
        // aesr V<ssa_12>.16b, v26.16b                                  // .................................................................................*................................................
        // aesr V<ssa_1>.16b, v23.16b                                   // ......................................................................*...........................................................
        // mov D<ssa_60>, V<ssa_53>.d[1]                                // ..........................................................................*.......................................................
        // aese V<ssa_12>.16b, v27.16b                                  // .....................................................................................*............................................
        // str Q<ssa_50>, [x2, #48]                                     // ..............................................................................*...................................................
        // pmull2 V<ssa_62>.1q, V<ssa_53>.2d, v12.2d                    // ............................................................................................*.....................................
        // stp X<ssa_55>, X<ssa_25>, [sp, #STACK_BASE_AES_ST + 16]      // .........................................*........................................................................................
        // eor V<ssa_65>.16B, V<ssa_41>.16B, V<ssa_12>.16B              // .........................................................................................*........................................
        // aesr V<ssa_1>.16b, v24.16b                                   // ...........................................................................*......................................................
        // ldr Q<ssa_66>, [sp, #STACK_BASE_AES_ST + 16]                 // ...................................................*..............................................................................
        // aesr V<ssa_1>.16b, v25.16b                                   // ...............................................................................*..................................................
        // rev64 V<ssa_68>.16B, V<ssa_65>.16B                           // .............................................................................................*....................................
        // ext V<ssa_69>.16B, V<ssa_48>.16B, V<ssa_48>.16B, #8          // ........................................................................*.........................................................
        // aesr V<ssa_1>.16b, v26.16b                                   // ...................................................................................*..............................................
        // ext V<ssa_70>.16B, V<ssa_68>.16B, V<ssa_68>.16B, #8          // .................................................................................................*................................
        // eor V<ssa_71>.8B, V<ssa_60>.8B, V<ssa_53>.8B                 // ......................................................................................*...........................................
        // eor V<ssa_72>.16B, V<ssa_70>.16B, V<ssa_68>.16B              // .....................................................................................................*............................
        // aese V<ssa_1>.16b, v27.16b                                   // .......................................................................................*..........................................
        // str Q<ssa_65>, [x2, #32]                                     // .........................................................................................................................*........
        // pmull V<ssa_73>.1q, V<ssa_68>.1d, v13.1d                     // ................................................................................................*.................................
        // eor V<ssa_74>.16B, V<ssa_66>.16B, V<ssa_1>.16B               // ..........................................................................................*.......................................
        // pmull2 V<ssa_75>.1q, V<ssa_72>.2d, v14.2d                    // .........................................................................................................*........................
        // rev64 V<ssa_76>.16B, V<ssa_74>.16B                           // ..............................................................................................*...................................
        // rev64 V<ssa_77>.16B, V<ssa_56>.16B                           // .......................................................................*..........................................................
        // pmull2 V<ssa_78>.1q, V<ssa_68>.2d, v13.2d                    // ....................................................................................................*.............................
        // pmull2 V<ssa_79>.1q, V<ssa_76>.2d, v15.2d                    // ......................................................................................................*...........................
        // str Q<ssa_56>, [x2], #(4*16)                                 // ..................................................................................*...............................................
        // pmull V<ssa_80>.1q, V<ssa_71>.1d, v14.1d                     // ...............................................................................................*..................................
        // eor V<ssa_81>.16B, V<ssa_77>.16B, V<ssa_69>.16B              // .............................................................................*....................................................
        // mov D<ssa_82>, V<ssa_76>.d[1]                                // ...................................................................................................*..............................
        // pmull2 V<ssa_84>.1q, V<ssa_81>.2d, v16.2d                    // ...........................................................................................*......................................
        // eor V<ssa_85>.16B, V<ssa_62>.16B, V<ssa_78>.16B              // ........................................................................................................*.........................
        // ext V<ssa_87>.16B, V<ssa_81>.16B, V<ssa_81>.16B, #8          // ................................................................................*.................................................
        // eor V<ssa_89>.8B, V<ssa_82>.8B, V<ssa_76>.8B                 // .......................................................................................................*..........................
        // pmull V<ssa_90>.1q, V<ssa_81>.1d, v16.1d                     // ...............................................................................................................*..................
        // eor V<ssa_92>.16B, V<ssa_80>.16B, V<ssa_75>.16B              // ............................................................................................................*.....................
        // pmull V<ssa_93>.1q, V<ssa_76>.1d, v15.1d                     // ..................................................................................................*...............................
        // pmull V<ssa_94>.1q, V<ssa_89>.1d, v17.1d                     // ..........................................................................................................*.......................
        // pmull V<ssa_96>.1q, V<ssa_53>.1d, v12.1d                     // ........................................................................................*.........................................
        // eor V<ssa_97>.16B, V<ssa_92>.16B, V<ssa_94>.16B              // ...................................................................................................................*..............
        // eor V<ssa_98>.16B, V<ssa_96>.16B, V<ssa_73>.16B              // ...........................................................................................................*......................
        // eor V<ssa_99>.16B, V<ssa_87>.16B, V<ssa_81>.16B              // ....................................................................................*.............................................
        // eor V<ssa_100>.16B, V<ssa_85>.16B, V<ssa_79>.16B             // .............................................................................................................*....................
        // pmull2 V<ssa_101>.1q, V<ssa_99>.2d, v17.2d                   // ................................................................................................................*.................
        // eor V<ssa_102>.16B, V<ssa_98>.16B, V<ssa_93>.16B             // ..............................................................................................................*...................
        // eor V<ssa_105>.16B, V<ssa_100>.16B, V<ssa_84>.16B            // .................................................................................................................*................
        // pmull V<ssa_109>.1q, V<ssa_105>.1d, v7.1d                    // .....................................................................................................................*............
        // ext V<ssa_110>.16B, V<ssa_105>.16B, V<ssa_105>.16B, #8       // ....................................................................................................................*.............
        // eor V<ssa_111>.16B, V<ssa_102>.16B, V<ssa_90>.16B            // ..................................................................................................................*...............
        // eor V<ssa_115>.16B, V<ssa_97>.16B, V<ssa_101>.16B            // .......................................................................................................................*..........
        // eor V<ssa_117>.16B, V<ssa_111>.16B, V<ssa_105>.16B           // ......................................................................................................................*...........
        // eor V<ssa_119>.16B, V<ssa_110>.16B, V<ssa_109>.16B           // ..........................................................................................................................*.......
        // eor V<ssa_120>.16B, V<ssa_115>.16B, V<ssa_117>.16B           // ...........................................................................................................................*......
        // str Q<ssa_74>, [x2, #-48]                                    // ........................................................................................................................*.........
        // eor V<ssa_121>.16B, V<ssa_120>.16B, V<ssa_119>.16B           // ............................................................................................................................*.....
        // pmull V<ssa_123>.1q, V<ssa_121>.1d, v7.1d                    // .............................................................................................................................*....
        // ext V<ssa_124>.16B, V<ssa_121>.16B, V<ssa_121>.16B, #8       // ...............................................................................................................................*..
        // eor V<ssa_130>.16B, V<ssa_111>.16B, V<ssa_123>.16B           // ..............................................................................................................................*...
        // eor V<ssa_139>.16B, V<ssa_130>.16B, V<ssa_124>.16B           // ................................................................................................................................*.
        // ext v30.16B, V<ssa_139>.16B, V<ssa_139>.16B, #8              // .................................................................................................................................*

        b Lloop_unrolled_start_end
Lloop_unrolled_start_iter_1:


        ldp x22, x23, [x0, #(3*16)]
        add        w14, w13, #3
        rev        w14, w14
        orr        x14, x12, x14, lsl #32
        stp        x11, x14, [sp, #(STACK_BASE_AES_ST + 3*16)] // @slothy:writes=stack_3
        ldr        q0, [sp, #(STACK_BASE_AES_ST + 3*16)]       // @slothy:reads=stack_3
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aese v0.16b, v27.16b
        eor x22, x22, x20
        eor x23, x23, x21
        stp x22, x23, [sp, #(STACK_BASE_AES_ST + 3*16)] // @slothy:writes=stack_3
        ldr q29, [sp, #(STACK_BASE_AES_ST + 3*16)]       // @slothy:reads=stack_3
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(3*16)]

        rev64 v0.16b, v0.16b
        // Low product
        pmull   v8.1q, v0.1d, v12.1d
        // High product
        pmull2  v9.1q, v0.2d, v12.2d
        // Middle product
        mov     d11, v0.d[1]
        eor     v11.8b, v11.8b, v0.8b
        pmull   v10.1q, v11.1d, v14.1d

        ldp x22, x23, [x0, #(2*16)]
        add        w14, w13, #2
        rev        w14, w14
        orr        x14, x12, x14, lsl #32
        stp        x11, x14, [sp, #(STACK_BASE_AES_ST + 2*16)] // @slothy:writes=stack_2
        ldr        q0, [sp, #(STACK_BASE_AES_ST + 2*16)]       // @slothy:reads=stack_2
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aese v0.16b, v27.16b
        eor x22, x22, x20
        eor x23, x23, x21
        stp x22, x23, [sp, #(STACK_BASE_AES_ST + 2*16)] // @slothy:writes=stack_2
        ldr q29, [sp, #(STACK_BASE_AES_ST + 2*16)]       // @slothy:reads=stack_2
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(2*16)]

        rev64   v0.16b, v0.16b
        // Low product
        pmull   v11.1q, v0.1d, v13.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v13.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        ext     v11.16b, v0.16b, v0.16b, #8
        eor     v11.16b, v11.16b, v0.16b
        pmull2  v11.1q, v11.2d, v14.2d
        eor     v10.16b, v10.16b, v11.16b

        ldp x22, x23, [x0, #(1*16)]
        add        w14, w13, #1
        rev        w14, w14
        orr        x14, x12, x14, lsl #32
        stp        x11, x14, [sp, #(STACK_BASE_AES_ST + 1*16)] // @slothy:writes=stack_1
        ldr        q0, [sp, #(STACK_BASE_AES_ST + 1*16)]       // @slothy:reads=stack_1
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aese v0.16b, v27.16b
        eor x22, x22, x20
        eor x23, x23, x21
        stp x22, x23, [sp, #(STACK_BASE_AES_ST + 1*16)] // @slothy:writes=stack_1
        ldr q29, [sp, #(STACK_BASE_AES_ST + 1*16)]       // @slothy:reads=stack_1
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(1*16)]

        rev64   v0.16b, v0.16b
        // Low product
        pmull   v11.1q, v0.1d, v15.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v15.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        mov     d11, v0.d[1]
        eor     v11.8b, v11.8b, v0.8b
        pmull   v11.1q, v11.1d, v17.1d
        eor     v10.16b, v10.16b, v11.16b

        ldp x22, x23, [x0], #(4*16)
        add        w14, w13, #0
        rev        w14, w14
        orr        x14, x12, x14, lsl #32
        stp        x11, x14, [sp, #(STACK_BASE_AES_ST + 0*16)] // @slothy:writes=stack_0
        ldr        q0, [sp, #(STACK_BASE_AES_ST + 0*16)]       // @slothy:reads=stack_0
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aese v0.16b, v27.16b
        eor x22, x22, x20
        eor x23, x23, x21
        stp x22, x23, [sp, #(STACK_BASE_AES_ST + 0*16)] // @slothy:writes=stack_0
        ldr q29, [sp, #(STACK_BASE_AES_ST + 0*16)]       // @slothy:reads=stack_0
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2], #(4*16)

        rev64   v0.16b, v0.16b
        eor   v0.16b, v0.16b, v30.16b
        // Low product
        pmull   v11.1q, v0.1d, v16.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v16.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        ext     v11.16b, v0.16b, v0.16b, #8
        eor     v11.16b, v11.16b, v0.16b
        pmull2  v11.1q, v11.2d, v17.2d
        eor     v10.16b, v10.16b, v11.16b
        eor        v0.16b, v8.16b,  v9.16b
        pmull      v1.1q,  v9.1d,   v7.1d
        ext        v9.16b,    v9.16b,  v9.16b, #8
        eor        v10.16b,   v10.16b, v0.16b
        eor        v1.16b, v9.16b,  v1.16b
        eor        v10.16b,   v10.16b, v1.16b
        pmull      v9.1q,     v10.1d,  v7.1d
        eor        v8.16b,    v8.16b,  v9.16b
        ext        v10.16b,   v10.16b, v10.16b, #8
        eor        v30.16b,     v8.16b,  v10.16b
        ext        v30.16b, v30.16b, v30.16b, #8

        add w13, w13, #UNROLL
Lloop_unrolled_start_iter_1_end:
Lloop_unrolled_start_end:
Lloop_unrolled_end:

        cbz remainder, Lloop_1x_end
Lloop_1x_start:

        ldp plain_lo, plain_hi, [input], #16
        aes_full_block aes_st, plain, res, 0
        str res_q, [output], #16
        ghash_init_with_tag_0 res, Ht1, Ht12, tag

        ghash_finalize tag

        add ctr, ctr, #1
        sub remainder, remainder, #1
        cbnz remainder, Lloop_1x_start
Lloop_1x_end:

        // Return number of bytes processed
        mov x0, byte_len
        // Store new authentication tag
        rev64 tag.16b, tag.16b
        str tag_q, [tag_ptr]

        // Store updated counter
        // rev32 rtmp_ctr.16b, rtmp_ctr.16b
        // str rtmp_ctr_q, [ivec]
        rev ctr_tmp_w, ctr
        str ctr_tmp_w, [ivec, #12]

        restore_vregs
        restore_gprs

Lenc_postamble_end:
        add sp, sp, #STACK_SIZE

        ret

#endif
#endif  // !OPENSSL_NO_ASM && defined(__AARCH64EL__) && defined(__APPLE__)
#if defined(__ELF__)
// See https: // www.airs.com/blog/archives/518.
.section .note.GNU-stack,"",%progbits
#endif