// Copyright (c) 2022, ARM Inc.

// Permission to use, copy, modify, and/or distribute this software for any
// purpose with or without fee is hereby granted, provided that the above
// copyright notice and this permission notice appear in all copies.

// THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
// WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
// MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
// SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
// WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
// OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
// CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. */

// Author: Hanno Becker <hannobecker@posteo.de>

// This file was derived from the assembly generated from aesv8-gcm-armv8.pl,
// written by Fangming Fang <fangming.fang@arm.com> for the OpenSSL project,
// and derived from https: // github.com/ARM-software/AArch64cryptolib, original
// author Samuel Lee <Samuel.Lee@arm.com>.

// The code below is a 'clean' AArch64 implementation of AES-GCM emphasizing
// the logic of the computation. It is meant as the input to manual audits /
// formal verification, as well as automated micro-optimization such as done
// by the SLOTHY superoptimizer (https: // github.com/slothy-optimizer/slothy).

#if !defined(__has_feature)
#define __has_feature(x) 0
#endif
#if __has_feature(memory_sanitizer) && !defined(OPENSSL_NO_ASM)
#define OPENSSL_NO_ASM
#endif

#include <openssl/asm_base.h>

#if !defined(OPENSSL_NO_ASM) && defined(__AARCH64EL__)
#if defined(__ELF__)
#include <openssl/boringssl_prefix_symbols_asm.h>
#include <openssl/arm_arch.h>
.arch   armv8-a+crypto
.text
.globl  aes_gcm_enc_kernel_slothy_base_128
.hidden aes_gcm_enc_kernel_slothy_base_128
.type   aes_gcm_enc_kernel_slothy_base_128,%function
#elif defined(__APPLE__)
#if defined(BORINGSSL_PREFIX)
#include <boringssl_prefix_symbols_asm.h>
#endif
#include <openssl/arm_arch.h>
.text
.globl	_aes_gcm_enc_kernel_slothy_base_128
.private_extern	_aes_gcm_enc_kernel_slothy_base_128
#else
#error Unknown configuration
#endif

#if __ARM_MAX_ARCH__ >= 8

// Arguments
input    .req x0
len_bits .req x1
output   .req x2
tag_ptr  .req x3
ivec     .req x4
key      .req x5
Htable   .req x6

byte_len .req x15

constant_temp .req x25

count           .req x1
full_blocks     .req x7
remainder       .req x16
unroll          .req x10

ctr_tmp   .req x14
ctr_tmp_w .req w14

ivec_0_63    .req x11
ivec_64_96   .req x12
ivec_64_96_w .req w12

ctr      .req w13
ctr_x    .req x13

aes_st    .req v0
aes_st_q  .req q0
aes_st_d  .req d0

res       .req v0
res_q     .req q0

ghash_hi    .req v9
ghash_lo    .req v8
ghash_mid   .req v10
ghash_mid_d .req d10

ghash_tmp   .req v11
ghash_tmp_d .req d11

ghash_mod   .req v7
ghash_mod_d .req d7

modulo_tmp0 .req v0
modulo_tmp1 .req v1

Ht1q   .req q12
Ht2q   .req q13
Ht12q  .req q14

Ht1    .req v12
Ht2    .req v13
Ht12   .req v14

Ht3q   .req q15
Ht4q   .req q16
Ht34q  .req q17

Ht3    .req v15
Ht4    .req v16
Ht34   .req v17

rk0q   .req q18
rk1q   .req q19
rk2q   .req q20
rk3q   .req q21
rk4q   .req q22
rk5q   .req q23
rk6q   .req q24
rk7q   .req q25
rk8q   .req q26
rk9q   .req q27
rk10q  .req q28

rk10_lo .req x20
rk10_hi .req x21

rk0    .req v18
rk1    .req v19
rk2    .req v20
rk3    .req v21
rk4    .req v22
rk5    .req v23
rk6    .req v24
rk7    .req v25
rk8    .req v26
rk9    .req v27
rk10   .req v28

plain   .req v29
plain_q .req q29

plain_lo .req x22
plain_hi .req x23

tag    .req v30
tag_q  .req q30

#define UNROLL 4

#define STACK_SIZE_GPRS  (6*16)
#define STACK_SIZE_VREGS (4*16)
#define STACK_SIZE  (STACK_SIZE_GPRS + STACK_SIZE_VREGS + UNROLL*16)

#define STACK_BASE_GPRS  (0)
#define STACK_BASE_VREGS (STACK_SIZE_GPRS)
#define STACK_BASE_AES_ST (STACK_SIZE_GPRS + STACK_SIZE_VREGS)

/********************************************************************/
/*                 Generic preamble/postamble macros                */
/********************************************************************/

.macro save_vregs
        stp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        stp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        stp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        stp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro restore_vregs
        ldp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        ldp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        ldp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        ldp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro save_gprs
        stp x19, x20, [sp, #(STACK_BASE_GPRS + 16*0)]
        stp x21, x22, [sp, #(STACK_BASE_GPRS + 16*1)]
        stp x23, x24, [sp, #(STACK_BASE_GPRS + 16*2)]
        stp x25, x26, [sp, #(STACK_BASE_GPRS + 16*3)]
        stp x27, x28, [sp, #(STACK_BASE_GPRS + 16*4)]
        stp x29, x30, [sp, #(STACK_BASE_GPRS + 16*5)]
.endm

.macro restore_gprs
        ldp x19, x20, [sp, #(STACK_BASE_GPRS + 16*0)]
        ldp x21, x22, [sp, #(STACK_BASE_GPRS + 16*1)]
        ldp x23, x24, [sp, #(STACK_BASE_GPRS + 16*2)]
        ldp x25, x26, [sp, #(STACK_BASE_GPRS + 16*3)]
        ldp x27, x28, [sp, #(STACK_BASE_GPRS + 16*4)]
        ldp x29, x30, [sp, #(STACK_BASE_GPRS + 16*5)]
.endm

// Derive number of iterations of unrolled loop and single-block loop
.macro prepare_loop_counts
        mov  unroll, #UNROLL
        // Number of AES Blocks (16b each)
        lsr  full_blocks, byte_len, #4
        // Number of iterations of the unrolled loop
        udiv count, full_blocks, unroll
        // Number of iterations for the tail loop handling 1 block each
        msub remainder, count, unroll, full_blocks
.endm

/********************************************************************/
/*                       AES related macros                         */
/********************************************************************/

.macro load_iv
        ldp        ivec_0_63, ivec_64_96, [ivec]
        lsr        ctr_x, ivec_64_96, #32
        rev        ctr, ctr
        orr        ivec_64_96_w, ivec_64_96_w, ivec_64_96_w // clear top 32 bit
.endm

.macro next_ctr_init_aes aes_st, loc
        add        ctr_tmp_w, ctr, #\loc
        rev        ctr_tmp_w, ctr_tmp_w
        orr        ctr_tmp, ivec_64_96, ctr_tmp, lsl #32
        stp        ivec_0_63, ctr_tmp, [sp, #(STACK_BASE_AES_ST + \loc*16)] // @slothy:writes=stack_\loc
        ldr        \aes_st\()_q, [sp, #(STACK_BASE_AES_ST + \loc*16)]       // @slothy:reads=stack_\loc
.endm

// A single AES round
// Prevent SLOTHY from unfolding because uArchs tend to fuse AESMC+AESE
.macro aesr data, key // @slothy:no-unfold
        aese  \data, \key
        aesmc \data, \data
.endm

.macro aesr_0_8 data, key
        aesr \data\().16b, \key\()0.16b
        aesr \data\().16b, \key\()1.16b
        aesr \data\().16b, \key\()2.16b
        aesr \data\().16b, \key\()3.16b
        aesr \data\().16b, \key\()4.16b
        aesr \data\().16b, \key\()5.16b
        aesr \data\().16b, \key\()6.16b
        aesr \data\().16b, \key\()7.16b
        aesr \data\().16b, \key\()8.16b
.endm

.macro aesr_9_10 data, key
        aesr \data\().16b, \key\()9.16b
        aesr \data\().16b, \key\()10.16b
.endm

.macro aesr_11_12 data, key
        aesr \data\().16b, \key\()11.16b
        aesr \data\().16b, \key\()12.16b
.endm

// Destructs inA
.macro eor3 out, inA, inB, inC
        eor \inA, \inA, \inB
        eor \out, \inA, \inC
.endm

.macro aesr_final aes_st, plain, out, loc
        aese \aes_st\().16b, rk9.16b
        eor \plain\()_lo, \plain\()_lo, rk10_lo
        eor \plain\()_hi, \plain\()_hi, rk10_hi
        stp \plain\()_lo, \plain\()_hi, [sp, #(STACK_BASE_AES_ST + \loc*16)] // @slothy:writes=stack_\loc
        ldr \plain\()_q, [sp, #(STACK_BASE_AES_ST + \loc*16)]       // @slothy:reads=stack_\loc
        eor \out\().16b, \plain\().16b, \aes_st\().16b
.endm

.macro aes_full_block aes_st, input, output, loc
        next_ctr_init_aes \aes_st, \loc
        aesr_0_8 \aes_st\(), rk
        aesr_final \aes_st, \input, \output, \loc
.endm

.macro load_round_key i
        ldr rk\i\()q, [key, #((\i)*16)]
.endm

.macro load_round_key_scalar i
        ldp rk\i\()_lo, rk\i\()_hi, [key, #((\i)*16)]
.endm

.macro load_round_keys
        load_round_key 0
        load_round_key 1
        load_round_key 2
        load_round_key 3
        load_round_key 4
        load_round_key 5
        load_round_key 6
        load_round_key 7
        load_round_key 8
        load_round_key 9
        load_round_key_scalar 10
.endm

/********************************************************************/
/*       Loading of H-table (precomputed H-powers for GHASH)        */
/********************************************************************/

// This has to be synchronized with the H-table generation

.macro load_h1 dst, dst_q
        ldr \dst_q, [Htable]
.endm

.macro load_h2 dst, dst_q
        ldr \dst_q, [Htable, #32]
.endm

.macro load_h3 dst, dst_q
        ldr \dst_q, [Htable, #48]
.endm

.macro load_h4 dst, dst_q
        ldr \dst_q, [Htable, #80]
.endm

.macro load_h5 dst, dst_q
        ldr \dst_q, [Htable, #96]
.endm

.macro load_h6 dst, dst_q
        ldr \dst_q, [Htable, #128]
.endm

.macro load_h7 dst, dst_q
        ldr \dst_q, [Htable, #144]
.endm

.macro load_h8 dst, dst_q
        ldr \dst_q, [Htable, #176]
.endm

.macro load_h12 dst, dst_q
        ldr \dst_q, [Htable, #16]
.endm

.macro load_h34 dst, dst_q
        ldr \dst_q, [Htable, #64]
.endm

.macro load_h56 dst, dst_q
        ldr \dst_q, [Htable, #112]
.endm

.macro load_h78 dst, dst_q
        ldr \dst_q, [Htable, #160]
.endm

.macro load_full_htable
        load_h1  Ht1,  Ht1q
        load_h2  Ht2,  Ht2q
        load_h3  Ht3,  Ht3q
        load_h4  Ht4,  Ht4q
        load_h5  Ht5,  Ht5q
        load_h6  Ht6,  Ht6q
        load_h12 Ht12, Ht12q
        load_h34 Ht34, Ht34q
        load_h56 Ht56, Ht56q
.endm

.macro load_htable_12
        load_h1  Ht1,  Ht1q
        load_h2  Ht2,  Ht2q
        load_h12 Ht12, Ht12q
.endm

.macro load_htable_34
        load_h3  Ht3,  Ht3q
        load_h4  Ht4,  Ht4q
        load_h34 Ht34, Ht34q
.endm

.macro load_htable_56
        load_h5  Ht5,  Ht5q
        load_h6  Ht6,  Ht6q
        load_h56 Ht56, Ht56q
.endm

.macro load_htable_78
        load_h7  Ht7,  Ht7q
        load_h8  Ht8,  Ht8q
        load_h78 Ht78, Ht78q
.endm

/********************************************************************/
/*                    Macros for GHASH udpate                       */
/********************************************************************/

.macro ghash_init_0 input, Hk, Hk_mid
        rev64 \input\().16b, \input\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_mid.1q, ghash_tmp.1d, \Hk_mid\().1d
.endm

.macro ghash_init_1 input, Hk, Hk_mid
        rev64 \input\().16b, \input\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_mid.1q, ghash_tmp.2d, \Hk_mid\().2d
.endm

.macro ghash_acc_0 input, Hk, Hk_mid
        rev64   \input\().16b, \input\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_tmp.1q, ghash_tmp.1d, \Hk_mid\().1d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_acc_1 input, Hk, Hk_mid
        rev64   \input\().16b, \input\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_tmp.1q, ghash_tmp.2d, \Hk_mid\().2d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_init_with_tag_0 input, Hk, Hk_mid, tag
        rev64 \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_mid.1q, ghash_tmp.1d, \Hk_mid\().1d
.endm

.macro ghash_init_with_tag_1 input, Hk, Hk_mid, tag
        rev64 \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_mid.1q, ghash_tmp.2d, \Hk_mid\().2d
.endm

.macro ghash_acc_with_tag_0 input, Hk, Hk_mid, tag
        rev64   \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_tmp.1q, ghash_tmp.1d, \Hk_mid\().1d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_acc_with_tag_1 input, Hk, Hk_mid, tag
        rev64   \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_tmp.1q, ghash_tmp.2d, \Hk_mid\().2d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_finalize tag
        eor        modulo_tmp0.16b, ghash_lo.16b,  ghash_hi.16b
        pmull      modulo_tmp1.1q,  ghash_hi.1d,   ghash_mod.1d
        ext        ghash_hi.16b,    ghash_hi.16b,  ghash_hi.16b, #8
        eor        ghash_mid.16b,   ghash_mid.16b, modulo_tmp0.16b
        eor        modulo_tmp1.16b, ghash_hi.16b,  modulo_tmp1.16b
        eor        ghash_mid.16b,   ghash_mid.16b, modulo_tmp1.16b
        pmull      ghash_hi.1q,     ghash_mid.1d,  ghash_mod.1d
        eor        ghash_lo.16b,    ghash_lo.16b,  ghash_hi.16b
        ext        ghash_mid.16b,   ghash_mid.16b, ghash_mid.16b, #8
        eor        \tag\().16b,     ghash_lo.16b,  ghash_mid.16b
        ext        \tag\().16b, \tag\().16b, \tag\().16b, #8
.endm

.macro load_tag
        ldr      tag_q, [tag_ptr]
        rev64    tag.16b, tag.16b
.endm

.macro prepare_ghash
        // Prepare constant for modular reduction
        movi ghash_mod.8b, #0xc2
        shl  ghash_mod_d, ghash_mod_d, #56
.endm

/********************************************************************/
/*                            Core routine                          */
/********************************************************************/

.align        4
_aes_gcm_enc_kernel_slothy_base_128:
aes_gcm_enc_kernel_slothy_base_128:
#ifdef BORINGSSL_DISPATCH_TEST
        adrp  x9,_BORINGSSL_function_hit@PAGE
        add   x9, x9, _BORINGSSL_function_hit@PAGEOFF
        mov   w10, #1
        strb  w10, [x9,#2] // kFlag_aes_gcm_enc_kernel
#endif

        AARCH64_VALID_CALL_TARGET
        sub sp, sp, #STACK_SIZE

Lenc_preamble_start:
        save_gprs
        save_vregs

        lsr byte_len, len_bits, #3

        load_round_keys
        load_tag
        load_iv

        prepare_loop_counts
        prepare_ghash

        load_htable_12
        load_htable_34

Lenc_preamble_end:

        cbz count, Lloop_unrolled_end
        cmp count, #1
        b.eq Lloop_unrolled_start_iter_1
                                                           // Instructions:    176
                                                           // Expected cycles: 87
                                                           // Expected IPC:    2.02
                                                           // -------------------------------- expected cycle count -------------------------------->
                                                           // 0                        25                       50                       75
                                                           // |------------------------|------------------------|------------------------|-----------
        add w7, w13, #0                                    // *......................................................................................
        add w17, w13, #3                                   // *......................................................................................
        add w14, w13, #2                                   // *......................................................................................
        add w29, w13, #1                                   // .*.....................................................................................
        add w13, w13, #UNROLL                              // .*.....................................................................................
        rev w7, w7                                         // .*.....................................................................................
        rev w17, w17                                       // ..*....................................................................................
        rev w14, w14                                       // ..*....................................................................................
        orr x7, x12, x7, lsl #32                           // ..*....................................................................................
        orr x17, x12, x17, lsl #32                         // ...*...................................................................................
        orr x14, x12, x14, lsl #32                         // ...*...................................................................................
        stp x11, x7, [sp, #STACK_BASE_AES_ST]              // ...*................................................................................... // @slothy:writes=stack_0
        rev w7, w29                                        // ....*..................................................................................
        stp x11, x17, [sp, #STACK_BASE_AES_ST + 48]        // ....*.................................................................................. // @slothy:writes=stack_3
        add w17, w13, #3                                   // ....*..................................................................................
        ldr q28, [sp, #STACK_BASE_AES_ST]                  // .....*................................................................................. // @slothy:reads=stack_0
        orr x29, x12, x7, lsl #32                          // .....*.................................................................................
        rev w7, w17                                        // .....*.................................................................................
        add w17, w13, #2                                   // .....*.................................................................................
        ldr q3, [sp, #STACK_BASE_AES_ST + 48]              // ......*................................................................................ // @slothy:reads=stack_3
        orr x22, x12, x7, lsl #32                          // ......*................................................................................
        rev w7, w17                                        // ......*................................................................................
        add w17, w13, #1                                   // ......*................................................................................
        orr x10, x12, x7, lsl #32                          // .......*...............................................................................
        rev w7, w17                                        // .......*...............................................................................
        add w17, w13, #0                                   // .......*...............................................................................
        orr x26, x12, x7, lsl #32                          // ........*..............................................................................
        rev w7, w17                                        // ........*..............................................................................
        ldp x17, x30, [x0, #32]                            // ........*..............................................................................
        aesr v28.16b, v18.16b                              // .........*.............................................................................
        ldp x24, x25, [x0, #16]                            // .........*.............................................................................
        aesr v3.16b, v18.16b                               // ..........*............................................................................
        stp x11, x26, [sp, #STACK_BASE_AES_ST + 16]        // ..........*............................................................................ // @slothy:writes=stack_1
        aesr v28.16b, v19.16b                              // ...........*...........................................................................
        aesr v3.16b, v19.16b                               // ............*..........................................................................
        ldr q11, [sp, #STACK_BASE_AES_ST + 16]             // ............*.......................................................................... // @slothy:reads=stack_1
        eor x17, x17, x20                                  // ............*..........................................................................
        eor x30, x30, x21                                  // ............*..........................................................................
        aesr v28.16b, v20.16b                              // .............*.........................................................................
        stp x11, x14, [sp, #STACK_BASE_AES_ST + 32]        // .............*......................................................................... // @slothy:writes=stack_2
        eor x14, x24, x20                                  // .............*.........................................................................
        eor x24, x25, x21                                  // .............*.........................................................................
        aesr v3.16b, v20.16b                               // ..............*........................................................................
        ldp x26, x25, [x0, #48]                            // ..............*........................................................................
        aesr v28.16b, v21.16b                              // ...............*.......................................................................
        stp x11, x29, [sp, #STACK_BASE_AES_ST + 16]        // ...............*....................................................................... // @slothy:writes=stack_1
        aesr v3.16b, v21.16b                               // ................*......................................................................
        ldp x29, x28, [x0], #(4*16)                        // ................*......................................................................
        aesr v28.16b, v22.16b                              // .................*.....................................................................
        ldr q5, [sp, #STACK_BASE_AES_ST + 16]              // .................*..................................................................... // @slothy:reads=stack_1
        ldr q10, [sp, #STACK_BASE_AES_ST + 32]             // ..................*.................................................................... // @slothy:reads=stack_2
        aesr v3.16b, v22.16b                               // ..................*....................................................................
        eor x8, x26, x20                                   // ..................*....................................................................
        ldp x23, x27, [x0, #32]                            // ..................*....................................................................
        aesr v28.16b, v23.16b                              // ...................*...................................................................
        eor x25, x25, x21                                  // ...................*...................................................................
        ldp x26, x19, [x0], #(4*16)                        // ...................*...................................................................
        aesr v3.16b, v23.16b                               // ....................*..................................................................
        stp x11, x22, [sp, #STACK_BASE_AES_ST + 48]        // ....................*.................................................................. // @slothy:writes=stack_3
        eor x22, x29, x20                                  // ....................*..................................................................
        eor x28, x28, x21                                  // ....................*..................................................................
        aesr v28.16b, v24.16b                              // .....................*.................................................................
        stp x17, x30, [sp, #STACK_BASE_AES_ST + 32]        // .....................*................................................................. // @slothy:writes=stack_2
        aesr v10.16b, v18.16b                              // ......................*................................................................
        eor x17, x23, x20                                  // ......................*................................................................
        eor x30, x27, x21                                  // ......................*................................................................
        ldp x23, x27, [x0, #-48]                           // ......................*................................................................
        aesr v28.16b, v25.16b                              // .......................*...............................................................
        eor x29, x19, x21                                  // .......................*...............................................................
        stp x22, x28, [sp, #STACK_BASE_AES_ST]             // .......................*............................................................... // @slothy:writes=stack_0
        aesr v10.16b, v19.16b                              // ........................*..............................................................
        ldp x22, x28, [x0, #-16]                           // ........................*..............................................................
        aesr v28.16b, v26.16b                              // .........................*.............................................................
        ldr q31, [sp, #STACK_BASE_AES_ST]                  // .........................*............................................................. // @slothy:reads=stack_0
        aesr v5.16b, v18.16b                               // ..........................*............................................................
        ldr q29, [sp, #STACK_BASE_AES_ST + 32]             // ..........................*............................................................ // @slothy:reads=stack_2
        stp x14, x24, [sp, #STACK_BASE_AES_ST + 16]        // ..........................*............................................................ // @slothy:writes=stack_1
        eor x14, x23, x20                                  // ..........................*............................................................
        ldr q6, [sp, #STACK_BASE_AES_ST + 48]              // ...........................*........................................................... // @slothy:reads=stack_3
        aese v28.16b, v27.16b                              // ...........................*...........................................................
        eor x24, x27, x21                                  // ...........................*...........................................................
        aesr v10.16b, v20.16b                              // ............................*..........................................................
        ldr q1, [sp, #STACK_BASE_AES_ST + 16]              // ............................*.......................................................... // @slothy:reads=stack_1
        eor x22, x22, x20                                  // ............................*..........................................................
        eor x28, x28, x21                                  // ............................*..........................................................
        aesr v3.16b, v24.16b                               // .............................*.........................................................
        eor v28.16B, v31.16B, v28.16B                      // .............................*.........................................................
        stp x11, x10, [sp, #STACK_BASE_AES_ST + 32]        // .............................*......................................................... // @slothy:writes=stack_2
        stp x8, x25, [sp, #STACK_BASE_AES_ST + 48]         // .............................*......................................................... // @slothy:writes=stack_3
        aesr v10.16b, v21.16b                              // ..............................*........................................................
        aesr v3.16b, v25.16b                               // ...............................*.......................................................
        rev64 v31.16B, v28.16B                             // ...............................*....................................................... // @slothy:late
        stp x14, x24, [sp, #STACK_BASE_AES_ST + 16]        // ...............................*....................................................... // @slothy:writes=stack_1
        ldr q4, [sp, #STACK_BASE_AES_ST + 48]              // ................................*...................................................... // @slothy:reads=stack_3
        aesr v10.16b, v22.16b                              // ................................*......................................................
        eor v31.16B, v31.16B, v30.16B                      // .................................*..................................................... // @slothy:late
        aesr v3.16b, v26.16b                               // .................................*.....................................................
        stp x22, x28, [sp, #STACK_BASE_AES_ST + 48]        // .................................*..................................................... // @slothy:writes=stack_3
        str q28, [x2], #(4*16)                             // ..................................*....................................................
        aesr v10.16b, v23.16b                              // ..................................*....................................................
        aesr v5.16b, v19.16b                               // ...................................*...................................................
        ldr q8, [sp, #STACK_BASE_AES_ST + 32]              // ...................................*................................................... // @slothy:reads=stack_2
        stp x17, x30, [sp, #STACK_BASE_AES_ST + 32]        // ...................................*................................................... // @slothy:writes=stack_2
        aese v3.16b, v27.16b                               // ....................................*..................................................
        ldr q9, [sp, #STACK_BASE_AES_ST + 48]              // ....................................*.................................................. // @slothy:reads=stack_3
        aesr v5.16b, v20.16b                               // .....................................*.................................................
        eor v28.16B, v4.16B, v3.16B                        // ......................................*................................................
        aesr v10.16b, v24.16b                              // ......................................*................................................
        aesr v5.16b, v21.16b                               // .......................................*...............................................
        aesr v10.16b, v25.16b                              // ........................................*..............................................
        rev64 v3.16B, v28.16B                              // ........................................*..............................................
        str q28, [x2, #-16]                                // .........................................*.............................................
        aesr v5.16b, v22.16b                               // .........................................*.............................................
        aesr v10.16b, v26.16b                              // ..........................................*............................................
        mov d28, v3.d[1]                                   // ..........................................*............................................
        aesr v5.16b, v23.16b                               // ...........................................*...........................................
        aese v10.16b, v27.16b                              // ............................................*..........................................
        eor v28.8B, v28.8B, v3.8B                          // ............................................*..........................................
        aesr v5.16b, v24.16b                               // .............................................*.........................................
        eor v29.16B, v29.16B, v10.16B                      // ..............................................*........................................
        pmull v4.1q, v3.1d, v12.1d                         // ..............................................*........................................
        aesr v5.16b, v25.16b                               // ...............................................*.......................................
        pmull v10.1q, v28.1d, v14.1d                       // ................................................*......................................
        rev64 v2.16B, v29.16B                              // ................................................*......................................
        str q29, [x2, #-32]                                // .................................................*.....................................
        aesr v5.16b, v26.16b                               // .................................................*.....................................
        aesr v11.16b, v18.16b                              // ..................................................*....................................
        ext v28.16B, v2.16B, v2.16B, #8                    // ..................................................*....................................
        aese v5.16b, v27.16b                               // ...................................................*...................................
        pmull2 v30.1q, v3.2d, v12.2d                       // ....................................................*..................................
        eor v28.16B, v28.16B, v2.16B                       // ....................................................*..................................
        aesr v6.16b, v18.16b                               // .....................................................*.................................
        eor v3.16B, v1.16B, v5.16B                         // .....................................................*.................................
        aesr v8.16b, v18.16b                               // ......................................................*................................
        aesr v6.16b, v19.16b                               // .......................................................*...............................
        rev64 v5.16B, v3.16B                               // .......................................................*...............................
        str q3, [x2, #-48]                                 // ........................................................*..............................
        aesr v8.16b, v19.16b                               // ........................................................*..............................
        mov d3, v5.d[1]                                    // .........................................................*.............................
        pmull2 v29.1q, v5.2d, v15.2d                       // .........................................................*.............................
        aesr v6.16b, v20.16b                               // ..........................................................*............................
        aesr v8.16b, v20.16b                               // ...........................................................*...........................
        eor v3.8B, v3.8B, v5.8B                            // ...........................................................*...........................
        aesr v6.16b, v21.16b                               // ............................................................*..........................
        aesr v8.16b, v21.16b                               // .............................................................*.........................
        aesr v6.16b, v22.16b                               // ..............................................................*........................
        aesr v8.16b, v22.16b                               // ...............................................................*.......................
        aesr v6.16b, v23.16b                               // ................................................................*......................
        aesr v8.16b, v23.16b                               // .................................................................*.....................
        aesr v6.16b, v24.16b                               // ..................................................................*....................
        pmull v1.1q, v5.1d, v15.1d                         // ...................................................................*...................
        aesr v6.16b, v25.16b                               // ....................................................................*..................
        aesr v11.16b, v19.16b                              // .....................................................................*.................
        aesr v6.16b, v26.16b                               // ......................................................................*................
        pmull v5.1q, v2.1d, v13.1d                         // .......................................................................*...............
        aese v6.16b, v27.16b                               // ........................................................................*..............
        eor v4.16B, v4.16B, v5.16B                         // .........................................................................*.............
        aesr v11.16b, v20.16b                              // .........................................................................*.............
        eor v5.16B, v9.16B, v6.16B                         // ..........................................................................*............
        aesr v8.16b, v24.16b                               // ..........................................................................*............
        eor v6.16B, v4.16B, v1.16B                         // ...........................................................................*...........
        aesr v11.16b, v21.16b                              // ...........................................................................*...........
        aesr v8.16b, v25.16b                               // ............................................................................*..........
        rev64 v1.16B, v5.16B                               // ............................................................................*..........
        aesr v11.16b, v22.16b                              // .............................................................................*.........
        pmull v4.1q, v31.1d, v16.1d                        // ..............................................................................*........ // @slothy:late
        pmull2 v9.1q, v2.2d, v13.2d                        // ...............................................................................*.......
        eor v2.16B, v6.16B, v4.16B                         // ................................................................................*...... // @slothy:late
        aesr v11.16b, v23.16b                              // ................................................................................*......
        eor v30.16B, v30.16B, v9.16B                       // .................................................................................*.....
        aesr v8.16b, v26.16b                               // .................................................................................*.....
        aesr v11.16b, v24.16b                              // ..................................................................................*....
        pmull2 v9.1q, v31.2d, v16.2d                       // ...................................................................................*... // @slothy:late
        aesr v11.16b, v25.16b                              // ....................................................................................*..
        aese v8.16b, v27.16b                               // .....................................................................................*.
        aesr v11.16b, v26.16b                              // ......................................................................................*

        // original source code
        // add W<ssa_10>, w13, #3                                         // *......................................................................................
        // rev W<ssa_13>, W<ssa_10>                                       // ..*....................................................................................
        // orr X<ssa_16>, x12, X<ssa_13>, lsl #32                         // ...*...................................................................................
        // add W<ssa_17>, w13, #2                                         // *......................................................................................
        // ldp X<ssa_19>, X<ssa_20>, [x0, #32]                            // ........*..............................................................................
        // rev W<ssa_21>, W<ssa_17>                                       // ..*....................................................................................
        // orr X<ssa_24>, x12, X<ssa_21>, lsl #32                         // ...*...................................................................................
        // add W<ssa_26>, w13, #1                                         // .*.....................................................................................
        // rev W<ssa_29>, W<ssa_26>                                       // ....*..................................................................................
        // orr X<ssa_31>, x12, X<ssa_29>, lsl #32                         // .....*.................................................................................
        // eor X<ssa_32>, X<ssa_19>, x20                                  // ............*..........................................................................
        // eor X<ssa_35>, X<ssa_20>, x21                                  // ............*..........................................................................
        // add W<ssa_36>, w13, #0                                         // *......................................................................................
        // rev W<ssa_39>, W<ssa_36>                                       // .*.....................................................................................
        // stp x11, X<ssa_16>, [sp, #STACK_BASE_AES_ST + 48]              // ....*..................................................................................
        // ldr Q<ssa_46>, [sp, #STACK_BASE_AES_ST + 48]                   // ......*................................................................................
        // ldp X<ssa_48>, X<ssa_49>, [x0, #16]                            // .........*.............................................................................
        // stp x11, X<ssa_31>, [sp, #STACK_BASE_AES_ST + 16]              // ...............*.......................................................................
        // aesr V<ssa_46>.16b, v18.16b                                    // ..........*............................................................................
        // stp x11, X<ssa_24>, [sp, #STACK_BASE_AES_ST + 32]              // .............*.........................................................................
        // eor X<ssa_57>, X<ssa_48>, x20                                  // .............*.........................................................................
        // ldr Q<ssa_58>, [sp, #STACK_BASE_AES_ST + 32]                   // ..................*....................................................................
        // aesr V<ssa_46>.16b, v19.16b                                    // ............*..........................................................................
        // eor X<ssa_59>, X<ssa_49>, x21                                  // .............*.........................................................................
        // ldp X<ssa_60>, X<ssa_61>, [x0, #48]                            // ..............*........................................................................
        // stp X<ssa_32>, X<ssa_35>, [sp, #STACK_BASE_AES_ST + 32]        // .....................*.................................................................
        // ldp X<ssa_64>, X<ssa_65>, [x0], #(4*16)                        // ................*......................................................................
        // ldr Q<ssa_67>, [sp, #STACK_BASE_AES_ST + 16]                   // .................*.....................................................................
        // aesr V<ssa_58>.16b, v18.16b                                    // ......................*................................................................
        // eor X<ssa_68>, X<ssa_60>, x20                                  // ..................*....................................................................
        // eor X<ssa_69>, X<ssa_61>, x21                                  // ...................*...................................................................
        // aesr V<ssa_46>.16b, v20.16b                                    // ..............*........................................................................
        // eor X<ssa_70>, X<ssa_65>, x21                                  // ....................*..................................................................
        // aesr V<ssa_58>.16b, v19.16b                                    // ........................*..............................................................
        // aesr V<ssa_67>.16b, v18.16b                                    // ..........................*............................................................
        // aesr V<ssa_46>.16b, v21.16b                                    // ................*......................................................................
        // aesr V<ssa_58>.16b, v20.16b                                    // ............................*..........................................................
        // stp X<ssa_68>, X<ssa_69>, [sp, #STACK_BASE_AES_ST + 48]        // .............................*.........................................................
        // aesr V<ssa_46>.16b, v22.16b                                    // ..................*....................................................................
        // aesr V<ssa_58>.16b, v21.16b                                    // ..............................*........................................................
        // ldr Q<ssa_76>, [sp, #STACK_BASE_AES_ST + 48]                   // ................................*......................................................
        // aesr V<ssa_46>.16b, v23.16b                                    // ....................*..................................................................
        // aesr V<ssa_58>.16b, v22.16b                                    // ................................*......................................................
        // stp X<ssa_57>, X<ssa_59>, [sp, #STACK_BASE_AES_ST + 16]        // ..........................*............................................................
        // aesr V<ssa_46>.16b, v24.16b                                    // .............................*.........................................................
        // aesr V<ssa_58>.16b, v23.16b                                    // ..................................*....................................................
        // aesr V<ssa_46>.16b, v25.16b                                    // ...............................*.......................................................
        // aesr V<ssa_46>.16b, v26.16b                                    // .................................*.....................................................
        // aesr V<ssa_67>.16b, v19.16b                                    // ...................................*...................................................
        // aese V<ssa_46>.16b, v27.16b                                    // ....................................*..................................................
        // aesr V<ssa_67>.16b, v20.16b                                    // .....................................*.................................................
        // aesr V<ssa_58>.16b, v24.16b                                    // ......................................*................................................
        // eor V<ssa_81>.16B, V<ssa_76>.16B, V<ssa_46>.16B                // ......................................*................................................
        // aesr V<ssa_67>.16b, v21.16b                                    // .......................................*...............................................
        // aesr V<ssa_58>.16b, v25.16b                                    // ........................................*..............................................
        // aesr V<ssa_67>.16b, v22.16b                                    // .........................................*.............................................
        // aesr V<ssa_67>.16b, v23.16b                                    // ...........................................*...........................................
        // aesr V<ssa_58>.16b, v26.16b                                    // ..........................................*............................................
        // aesr V<ssa_67>.16b, v24.16b                                    // .............................................*.........................................
        // aesr V<ssa_67>.16b, v25.16b                                    // ...............................................*.......................................
        // aese V<ssa_58>.16b, v27.16b                                    // ............................................*..........................................
        // rev64 V<ssa_93>.16B, V<ssa_81>.16B                             // ........................................*..............................................
        // aesr V<ssa_67>.16b, v26.16b                                    // .................................................*.....................................
        // mov D<ssa_95>, V<ssa_93>.d[1]                                  // ..........................................*............................................
        // eor X<ssa_96>, X<ssa_64>, x20                                  // ....................*..................................................................
        // pmull V<ssa_98>.1q, V<ssa_93>.1d, v12.1d                       // ..............................................*........................................
        // add w13, w13, #UNROLL                                          // .*.....................................................................................
        // stp X<ssa_96>, X<ssa_70>, [sp, #STACK_BASE_AES_ST]             // .......................*...............................................................
        // eor V<ssa_101>.8B, V<ssa_95>.8B, V<ssa_93>.8B                  // ............................................*..........................................
        // orr X<ssa_102>, x12, X<ssa_39>, lsl #32                        // ..*....................................................................................
        // add W<ssa_103>, w13, #3                                        // ....*..................................................................................
        // ldr Q<ssa_104>, [sp, #STACK_BASE_AES_ST]                       // .........................*.............................................................
        // rev W<ssa_106>, W<ssa_103>                                     // .....*.................................................................................
        // stp x11, X<ssa_102>, [sp, #STACK_BASE_AES_ST]                  // ...*...................................................................................
        // str Q<ssa_81>, [x2, #48]                                       // .........................................*.............................................
        // orr X<ssa_109>, x12, X<ssa_106>, lsl #32                       // ......*................................................................................
        // add W<ssa_110>, w13, #2                                        // .....*.................................................................................
        // ldr Q<ssa_111>, [sp, #STACK_BASE_AES_ST]                       // .....*.................................................................................
        // ldp X<ssa_112>, X<ssa_113>, [x0, #32]                          // ..................*....................................................................
        // rev W<ssa_114>, W<ssa_110>                                     // ......*................................................................................
        // orr X<ssa_117>, x12, X<ssa_114>, lsl #32                       // .......*...............................................................................
        // aese V<ssa_67>.16b, v27.16b                                    // ...................................................*...................................
        // add W<ssa_119>, w13, #1                                        // ......*................................................................................
        // rev W<ssa_122>, W<ssa_119>                                     // .......*...............................................................................
        // aesr V<ssa_111>.16b, v18.16b                                   // .........*.............................................................................
        // orr X<ssa_124>, x12, X<ssa_122>, lsl #32                       // ........*..............................................................................
        // eor X<ssa_125>, X<ssa_112>, x20                                // ......................*................................................................
        // eor X<ssa_128>, X<ssa_113>, x21                                // ......................*................................................................
        // aesr V<ssa_111>.16b, v19.16b                                   // ...........*...........................................................................
        // add W<ssa_129>, w13, #0                                        // .......*...............................................................................
        // rev w7, W<ssa_129>                                             // ........*..............................................................................
        // aesr V<ssa_111>.16b, v20.16b                                   // .............*.........................................................................
        // ldr Q<ssa_132>, [sp, #STACK_BASE_AES_ST + 16]                  // ............................*..........................................................
        // stp x11, X<ssa_109>, [sp, #STACK_BASE_AES_ST + 48]             // ....................*..................................................................
        // pmull v10.1q, V<ssa_101>.1d, v14.1d                            // ................................................*......................................
        // aesr V<ssa_111>.16b, v21.16b                                   // ...............*.......................................................................
        // ldr Q<ssa_135>, [sp, #STACK_BASE_AES_ST + 32]                  // ..........................*............................................................
        // ldr Q<ssa_137>, [sp, #STACK_BASE_AES_ST + 48]                  // ...........................*...........................................................
        // eor V<ssa_138>.16B, V<ssa_132>.16B, V<ssa_67>.16B              // .....................................................*.................................
        // aesr V<ssa_111>.16b, v22.16b                                   // .................*.....................................................................
        // ldp X<ssa_139>, X<ssa_140>, [x0, #16]                          // ......................*................................................................
        // pmull2 V<ssa_141>.1q, V<ssa_93>.2d, v12.2d                     // ....................................................*..................................
        // stp x11, X<ssa_124>, [sp, #STACK_BASE_AES_ST + 16]             // ..........*............................................................................
        // aesr V<ssa_111>.16b, v23.16b                                   // ...................*...................................................................
        // aesr V<ssa_137>.16b, v18.16b                                   // .....................................................*.................................
        // eor V<ssa_145>.16B, V<ssa_135>.16B, V<ssa_58>.16B              // ..............................................*........................................
        // stp x11, X<ssa_117>, [sp, #STACK_BASE_AES_ST + 32]             // .............................*.........................................................
        // rev64 V<ssa_147>.16B, V<ssa_138>.16B                           // .......................................................*...............................
        // aesr V<ssa_111>.16b, v24.16b                                   // .....................*.................................................................
        // eor X<ssa_148>, X<ssa_139>, x20                                // ..........................*............................................................
        // ldr q8, [sp, #STACK_BASE_AES_ST + 32]                          // ...................................*...................................................
        // aesr V<ssa_137>.16b, v19.16b                                   // .......................................................*...............................
        // eor X<ssa_149>, X<ssa_140>, x21                                // ...........................*...........................................................
        // ldp X<ssa_150>, X<ssa_151>, [x0, #48]                          // ........................*..............................................................
        // str Q<ssa_138>, [x2, #16]                                      // ........................................................*..............................
        // aesr V<ssa_111>.16b, v25.16b                                   // .......................*...............................................................
        // pmull2 v29.1q, V<ssa_147>.2d, v15.2d                           // .........................................................*.............................
        // stp X<ssa_125>, X<ssa_128>, [sp, #STACK_BASE_AES_ST + 32]      // ...................................*...................................................
        // ldp x26, X<ssa_152>, [x0], #(4*16)                             // ...................*...................................................................
        // aesr V<ssa_111>.16b, v26.16b                                   // .........................*.............................................................
        // ldr q11, [sp, #STACK_BASE_AES_ST + 16]                         // ............*..........................................................................
        // aesr v8.16b, v18.16b                                           // ......................................................*................................
        // aese V<ssa_111>.16b, v27.16b                                   // ...........................*...........................................................
        // eor X<ssa_154>, X<ssa_150>, x20                                // ............................*..........................................................
        // eor X<ssa_155>, X<ssa_151>, x21                                // ............................*..........................................................
        // aesr V<ssa_137>.16b, v20.16b                                   // ..........................................................*............................
        // eor x29, X<ssa_152>, x21                                       // .......................*...............................................................
        // aesr v8.16b, v19.16b                                           // ........................................................*..............................
        // eor V<ssa_156>.16B, V<ssa_104>.16B, V<ssa_111>.16B             // .............................*.........................................................
        // aesr v11.16b, v18.16b                                          // ..................................................*....................................
        // aesr V<ssa_137>.16b, v21.16b                                   // ............................................................*..........................
        // str Q<ssa_156>, [x2], #(4*16)                                  // ..................................*....................................................
        // rev64 V<ssa_158>.16B, V<ssa_156>.16B                           // ...............................*.......................................................
        // aesr v8.16b, v20.16b                                           // ...........................................................*...........................
        // stp X<ssa_154>, X<ssa_155>, [sp, #STACK_BASE_AES_ST + 48]      // .................................*.....................................................
        // rev64 V<ssa_160>.16B, V<ssa_145>.16B                           // ................................................*......................................
        // aesr V<ssa_137>.16b, v22.16b                                   // ..............................................................*........................
        // aesr v8.16b, v21.16b                                           // .............................................................*.........................
        // ldr Q<ssa_161>, [sp, #STACK_BASE_AES_ST + 48]                  // ....................................*..................................................
        // str Q<ssa_145>, [x2, #-32]                                     // .................................................*.....................................
        // aesr V<ssa_137>.16b, v23.16b                                   // ................................................................*......................
        // aesr v8.16b, v22.16b                                           // ...............................................................*.......................
        // stp X<ssa_148>, X<ssa_149>, [sp, #STACK_BASE_AES_ST + 16]      // ...............................*.......................................................
        // aesr V<ssa_137>.16b, v24.16b                                   // ..................................................................*....................
        // aesr v8.16b, v23.16b                                           // .................................................................*.....................
        // aesr V<ssa_137>.16b, v25.16b                                   // ....................................................................*..................
        // pmull V<ssa_162>.1q, V<ssa_147>.1d, v15.1d                     // ...................................................................*...................
        // aesr V<ssa_137>.16b, v26.16b                                   // ......................................................................*................
        // aesr v11.16b, v19.16b                                          // .....................................................................*.................
        // pmull V<ssa_163>.1q, V<ssa_160>.1d, v13.1d                     // .......................................................................*...............
        // aese V<ssa_137>.16b, v27.16b                                   // ........................................................................*..............
        // eor V<ssa_164>.16B, V<ssa_98>.16B, V<ssa_163>.16B              // .........................................................................*.............
        // aesr v11.16b, v20.16b                                          // .........................................................................*.............
        // aesr v8.16b, v24.16b                                           // ..........................................................................*............
        // eor v5.16B, V<ssa_161>.16B, V<ssa_137>.16B                     // ..........................................................................*............
        // aesr v11.16b, v21.16b                                          // ...........................................................................*...........
        // eor v31.16B, V<ssa_158>.16B, v30.16B                           // .................................*.....................................................
        // eor V<ssa_165>.16B, V<ssa_164>.16B, V<ssa_162>.16B             // ...........................................................................*...........
        // aesr v8.16b, v25.16b                                           // ............................................................................*..........
        // mov D<ssa_166>, V<ssa_147>.d[1]                                // .........................................................*.............................
        // aesr v11.16b, v22.16b                                          // .............................................................................*.........
        // pmull V<ssa_167>.1q, v31.1d, v16.1d                            // ..............................................................................*........
        // pmull2 V<ssa_168>.1q, V<ssa_160>.2d, v13.2d                    // ...............................................................................*.......
        // aesr v11.16b, v23.16b                                          // ................................................................................*......
        // eor v2.16B, V<ssa_165>.16B, V<ssa_167>.16B                     // ................................................................................*......
        // eor v30.16B, V<ssa_141>.16B, V<ssa_168>.16B                    // .................................................................................*.....
        // aesr v8.16b, v26.16b                                           // .................................................................................*.....
        // aesr v11.16b, v24.16b                                          // ..................................................................................*....
        // ext V<ssa_169>.16B, V<ssa_160>.16B, V<ssa_160>.16B, #8         // ..................................................*....................................
        // pmull2 v9.1q, v31.2d, v16.2d                                   // ...................................................................................*...
        // eor v3.8B, V<ssa_166>.8B, V<ssa_147>.8B                        // ...........................................................*...........................
        // eor v28.16B, V<ssa_169>.16B, V<ssa_160>.16B                    // ....................................................*..................................
        // aesr v11.16b, v25.16b                                          // ....................................................................................*..
        // aese v8.16b, v27.16b                                           // .....................................................................................*.
        // rev64 v1.16B, v5.16B                                           // ............................................................................*..........
        // aesr v11.16b, v26.16b                                          // ......................................................................................*

        sub count, count, #2
cbz count, Lloop_unrolled_start_postamble
Lloop_unrolled_start:
                                                           // Instructions:    134
                                                           // Expected cycles: 59
                                                           // Expected IPC:    2.27
                                                           // ------------------ expected cycle count ------------------>
                                                           // 0                        25                       50
                                                           // |------------------------|------------------------|--------
        pmull2 v4.1q, v28.2d, v14.2d                       // l..........................................................
        mov d28, v1.d[1]                                   // *..........................................................
        eor x26, x26, x20                                  // *..........................................................
        eor v29.16B, v30.16B, v29.16B                      // .l.........................................................
        pmull v0.1q, v1.1d, v12.1d                         // .*.........................................................
        add w13, w13, #UNROLL                              // .*.........................................................
        stp x26, x29, [sp, #STACK_BASE_AES_ST]             // .*......................................................... // @slothy:writes=stack_0
        eor v6.16B, v10.16B, v4.16B                        // ..l........................................................
        eor v28.8B, v28.8B, v1.8B                          // ..*........................................................
        orr x7, x12, x7, lsl #32                           // ..*........................................................
        add w28, w13, #3                                   // ..e........................................................
        ldr q30, [sp, #STACK_BASE_AES_ST]                  // ...*....................................................... // @slothy:reads=stack_0
        eor v9.16B, v29.16B, v9.16B                        // ...l....................................................... // @slothy:late
        rev w14, w28                                       // ...e.......................................................
        stp x11, x7, [sp, #STACK_BASE_AES_ST]              // ...*....................................................... // @slothy:writes=stack_0
        str q5, [x2, #48]                                  // ....*......................................................
        ext v5.16B, v31.16B, v31.16B, #8                   // ....l...................................................... // @slothy:late
        orr x10, x12, x14, lsl #32                         // ....e......................................................
        add w14, w13, #2                                   // ....e......................................................
        ldr q4, [sp, #STACK_BASE_AES_ST]                   // .....*..................................................... // @slothy:reads=stack_0
        ldp x30, x29, [x0, #32]                            // .....e.....................................................
        rev w22, w14                                       // .....e.....................................................
        eor v5.16B, v5.16B, v31.16B                        // ......l.................................................... // @slothy:late
        pmull v3.1q, v3.1d, v17.1d                         // ......l....................................................
        orr x25, x12, x22, lsl #32                         // ......e....................................................
        aese v11.16b, v27.16b                              // .......*...................................................
        ext v31.16B, v9.16B, v9.16B, #8                    // .......l................................................... // @slothy:late
        add w17, w13, #1                                   // .......e...................................................
        pmull2 v10.1q, v5.2d, v17.2d                       // ........l.................................................. // @slothy:late
        eor v5.16B, v6.16B, v3.16B                         // ........l..................................................
        rev w7, w17                                        // ........e..................................................
        aesr v4.16b, v18.16b                               // .........*.................................................
        eor v3.16B, v2.16B, v9.16B                         // .........l................................................. // @slothy:late
        orr x23, x12, x7, lsl #32                          // .........e.................................................
        eor x17, x30, x20                                  // .........e.................................................
        eor v6.16B, v5.16B, v10.16B                        // ..........l................................................ // @slothy:late
        pmull v5.1q, v9.1d, v7.1d                          // ..........l................................................ // @slothy:late
        eor x27, x29, x21                                  // ..........e................................................
        aesr v4.16b, v19.16b                               // ...........*...............................................
        add w7, w13, #0                                    // ...........e...............................................
        eor v10.16B, v31.16B, v5.16B                       // ............l.............................................. // @slothy:late
        eor v31.16B, v6.16B, v3.16B                        // ............l.............................................. // @slothy:late
        rev w7, w7                                         // ............e..............................................
        aesr v4.16b, v20.16b                               // .............*.............................................
        ldr q5, [sp, #STACK_BASE_AES_ST + 16]              // .............*............................................. // @slothy:reads=stack_1
        stp x11, x10, [sp, #STACK_BASE_AES_ST + 48]        // .............e............................................. // @slothy:writes=stack_3
        eor v3.16B, v31.16B, v10.16B                       // ..............l............................................ // @slothy:late
        pmull v10.1q, v28.1d, v14.1d                       // ..............*............................................
        aesr v4.16b, v21.16b                               // ...............*...........................................
        ldr q9, [sp, #STACK_BASE_AES_ST + 32]              // ...............*........................................... // @slothy:reads=stack_2
        pmull v28.1q, v3.1d, v7.1d                         // ................l.......................................... // @slothy:late
        ldr q31, [sp, #STACK_BASE_AES_ST + 48]             // ................e.......................................... // @slothy:reads=stack_3
        eor v5.16B, v5.16B, v11.16B                        // .................*.........................................
        aesr v4.16b, v22.16b                               // .................*.........................................
        ldp x22, x14, [x0, #16]                            // .................e.........................................
        pmull2 v1.1q, v1.2d, v12.2d                        // ..................*........................................
        ext v6.16B, v3.16B, v3.16B, #8                     // ..................l........................................ // @slothy:late
        stp x11, x23, [sp, #STACK_BASE_AES_ST + 16]        // ..................e........................................ // @slothy:writes=stack_1
        eor v11.16B, v2.16B, v28.16B                       // ...................l....................................... // @slothy:late
        aesr v4.16b, v23.16b                               // ...................*.......................................
        aesr v31.16b, v18.16b                              // ....................e......................................
        eor v3.16B, v9.16B, v8.16B                         // ....................*......................................
        stp x11, x25, [sp, #STACK_BASE_AES_ST + 32]        // ....................e...................................... // @slothy:writes=stack_2
        rev64 v28.16B, v5.16B                              // .....................*.....................................
        aesr v4.16b, v24.16b                               // .....................*.....................................
        eor x22, x22, x20                                  // .....................e.....................................
        ldr q8, [sp, #STACK_BASE_AES_ST + 32]              // ......................e.................................... // @slothy:reads=stack_2
        aesr v31.16b, v19.16b                              // ......................e....................................
        eor x25, x14, x21                                  // ......................e....................................
        ldp x14, x28, [x0, #48]                            // ......................e....................................
        str q5, [x2, #16]                                  // .......................*...................................
        aesr v4.16b, v25.16b                               // .......................*...................................
        pmull2 v29.1q, v28.2d, v15.2d                      // ........................*..................................
        stp x17, x27, [sp, #STACK_BASE_AES_ST + 32]        // ........................e.................................. // @slothy:writes=stack_2
        ldp x26, x17, [x0], #(4*16)                        // ........................e..................................
        eor v2.16B, v11.16B, v6.16B                        // .........................l................................. // @slothy:late
        aesr v4.16b, v26.16b                               // .........................*.................................
        ldr q11, [sp, #STACK_BASE_AES_ST + 16]             // ..........................e................................ // @slothy:reads=stack_1
        aesr v8.16b, v18.16b                               // ..........................e................................
        aese v4.16b, v27.16b                               // ...........................*...............................
        eor x8, x14, x20                                   // ...........................e...............................
        eor x14, x28, x21                                  // ...........................e...............................
        aesr v31.16b, v20.16b                              // ............................e..............................
        eor x29, x17, x21                                  // ............................e..............................
        aesr v8.16b, v19.16b                               // .............................e.............................
        eor v5.16B, v30.16B, v4.16B                        // .............................*.............................
        ext v30.16B, v2.16B, v2.16B, #8                    // ..............................l............................ // @slothy:late
        aesr v11.16b, v18.16b                              // ..............................e............................
        aesr v31.16b, v21.16b                              // ...............................e...........................
        str q5, [x2], #(4*16)                              // ...............................*...........................
        rev64 v4.16B, v5.16B                               // ................................*.......................... // @slothy:late
        aesr v8.16b, v20.16b                               // ................................e..........................
        stp x8, x14, [sp, #STACK_BASE_AES_ST + 48]         // ................................e.......................... // @slothy:writes=stack_3
        rev64 v6.16B, v3.16B                               // .................................*.........................
        aesr v31.16b, v22.16b                              // .................................e.........................
        aesr v8.16b, v21.16b                               // ..................................e........................
        ldr q2, [sp, #STACK_BASE_AES_ST + 48]              // ..................................e........................ // @slothy:reads=stack_3
        str q3, [x2, #-32]                                 // ...................................*.......................
        aesr v31.16b, v23.16b                              // ...................................e.......................
        aesr v8.16b, v22.16b                               // ....................................e......................
        stp x22, x25, [sp, #STACK_BASE_AES_ST + 16]        // ....................................e...................... // @slothy:writes=stack_1
        aesr v31.16b, v24.16b                              // .....................................e.....................
        aesr v8.16b, v23.16b                               // ......................................e....................
        aesr v31.16b, v25.16b                              // .......................................e...................
        pmull v9.1q, v28.1d, v15.1d                        // ........................................*..................
        aesr v31.16b, v26.16b                              // .........................................e.................
        aesr v11.16b, v19.16b                              // ..........................................e................
        pmull v3.1q, v6.1d, v13.1d                         // ...........................................*...............
        aese v31.16b, v27.16b                              // ............................................e..............
        eor v3.16B, v0.16B, v3.16B                         // .............................................*.............
        aesr v11.16b, v20.16b                              // .............................................e.............
        aesr v8.16b, v24.16b                               // ..............................................e............
        eor v5.16B, v2.16B, v31.16B                        // ..............................................e............
        aesr v11.16b, v21.16b                              // ...............................................e...........
        eor v31.16B, v4.16B, v30.16B                       // ...............................................*........... // @slothy:late
        eor v0.16B, v3.16B, v9.16B                         // ................................................*..........
        aesr v8.16b, v25.16b                               // ................................................e..........
        mov d4, v28.d[1]                                   // .................................................*.........
        aesr v11.16b, v22.16b                              // .................................................e.........
        pmull v9.1q, v31.1d, v16.1d                        // ..................................................*........ // @slothy:late
        pmull2 v3.1q, v6.2d, v13.2d                        // ...................................................*.......
        aesr v11.16b, v23.16b                              // ....................................................e......
        eor v2.16B, v0.16B, v9.16B                         // ....................................................*...... // @slothy:late
        eor v30.16B, v1.16B, v3.16B                        // .....................................................*.....
        aesr v8.16b, v26.16b                               // .....................................................e.....
        aesr v11.16b, v24.16b                              // ......................................................e....
        ext v1.16B, v6.16B, v6.16B, #8                     // ......................................................*....
        pmull2 v9.1q, v31.2d, v16.2d                       // .......................................................*... // @slothy:late
        eor v3.8B, v4.8B, v28.8B                           // .......................................................*...
        eor v28.16B, v1.16B, v6.16B                        // ........................................................*..
        aesr v11.16b, v25.16b                              // ........................................................e..
        aese v8.16b, v27.16b                               // .........................................................e.
        rev64 v1.16B, v5.16B                               // .........................................................e.
        aesr v11.16b, v26.16b                              // ..........................................................e

        // original source code
        // ldp x22, x23, [x0, #(3*16)]                                  // ....................e....................................'....................._.........................................................._........
        // add        w14, w13, #3                                      // e........................................................'._.........................................................._............................
        // rev        w14, w14                                          // .e.......................................................'.._.........................................................._...........................
        // orr        x14, x12, x14, lsl #32                            // ..e......................................................'..._.........................................................._..........................
        // stp        x11, x14, [sp, #(STACK_BASE_AES_ST + 3*16)]       // ...........e.............................................'............_.........................................................._.................
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 3*16)]             // ..............e..........................................'..............._.........................................................._..............
        // aesr v0.16b, v18.16b                                         // ..................e......................................'..................._.........................................................._..........
        // aesr v0.16b, v19.16b                                         // ....................e....................................'....................._.........................................................._........
        // aesr v0.16b, v20.16b                                         // ..........................e..............................'..........................._.........................................................._..
        // aesr v0.16b, v21.16b                                         // .............................e...........................'.............................._..........................................................
        // aesr v0.16b, v22.16b                                         // ...............................e.........................'................................_........................................................
        // aesr v0.16b, v23.16b                                         // .................................e.......................'.................................._......................................................
        // aesr v0.16b, v24.16b                                         // ...................................e.....................'...................................._....................................................
        // aesr v0.16b, v25.16b                                         // .....................................e...................'......................................_..................................................
        // aesr v0.16b, v26.16b                                         // .......................................e.................'........................................_................................................
        // aese v0.16b, v27.16b                                         // ..........................................e..............'..........................................._.............................................
        // eor x22, x22, x20                                            // .........................e...............................'.........................._.........................................................._...
        // eor x23, x23, x21                                            // .........................e...............................'.........................._.........................................................._...
        // stp x22, x23, [sp, #(STACK_BASE_AES_ST + 3*16)]              // ..............................e..........................'..............................._.........................................................
        // ldr q29, [sp, #(STACK_BASE_AES_ST + 3*16)]                   // ................................e........................'................................._.......................................................
        // eor v0.16b, v29.16b, v0.16b                                  // ............................................e............'............................................._...........................................
        // str q0, [x2, #(3*16)]                                        // .._......................................................'...*.........................................................._..........................
        // rev64 v0.16b, v0.16b                                         // .......................................................e.'........................................................_................................
        // pmull   v8.1q, v0.1d, v12.1d                                 // .........................................................'*.........................................................._.............................
        // pmull2  v9.1q, v0.2d, v12.2d                                 // ................_........................................'.................*.........................................................._............
        // mov     d11, v0.d[1]                                         // .........................................................*.........................................................._..............................
        // eor     v11.8b, v11.8b, v0.8b                                // _........................................................'.*.........................................................._............................
        // pmull   v10.1q, v11.1d, v14.1d                               // ............_............................................'.............*.........................................................._................
        // ldp x22, x23, [x0, #(2*16)]                                  // ...e.....................................................'...._.........................................................._.........................
        // add        w14, w13, #2                                      // ..e......................................................'..._.........................................................._..........................
        // rev        w14, w14                                          // ...e.....................................................'...._.........................................................._.........................
        // orr        x14, x12, x14, lsl #32                            // ....e....................................................'....._.........................................................._........................
        // stp        x11, x14, [sp, #(STACK_BASE_AES_ST + 2*16)]       // ..................e......................................'..................._.........................................................._..........
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 2*16)]             // ....................e....................................'....................._.........................................................._........
        // aesr v0.16b, v18.16b                                         // ........................e................................'........................._.........................................................._....
        // aesr v0.16b, v19.16b                                         // ...........................e.............................'............................_.........................................................._.
        // aesr v0.16b, v20.16b                                         // ..............................e..........................'..............................._.........................................................
        // aesr v0.16b, v21.16b                                         // ................................e........................'................................._.......................................................
        // aesr v0.16b, v22.16b                                         // ..................................e......................'..................................._.....................................................
        // aesr v0.16b, v23.16b                                         // ....................................e....................'....................................._...................................................
        // aesr v0.16b, v24.16b                                         // ............................................e............'............................................._...........................................
        // aesr v0.16b, v25.16b                                         // ..............................................e..........'..............................................._.........................................
        // aesr v0.16b, v26.16b                                         // ...................................................e.....'...................................................._....................................
        // aese v0.16b, v27.16b                                         // .......................................................e.'........................................................_................................
        // eor x22, x22, x20                                            // .......e.................................................'........_.........................................................._.....................
        // eor x23, x23, x21                                            // ........e................................................'........._.........................................................._....................
        // stp x22, x23, [sp, #(STACK_BASE_AES_ST + 2*16)]              // ......................e..................................'......................._.........................................................._......
        // ldr q29, [sp, #(STACK_BASE_AES_ST + 2*16)]                   // ............._...........................................'..............*.........................................................._...............
        // eor v0.16b, v29.16b, v0.16b                                  // .................._......................................'...................*.........................................................._..........
        // str q0, [x2, #(2*16)]                                        // ................................._.......................'..................................*......................................................
        // rev64   v0.16b, v0.16b                                       // ..............................._.........................'................................*........................................................
        // pmull   v11.1q, v0.1d, v13.1d                                // ........................................._...............'..........................................*..............................................
        // eor     v8.16b, v8.16b, v11.16b                              // ..........................................._.............'............................................*............................................
        // pmull2  v11.1q, v0.2d, v13.2d                                // ................................................._.......'..................................................*......................................
        // eor     v9.16b, v9.16b, v11.16b                              // ..................................................._.....'....................................................*....................................
        // ext     v11.16b, v0.16b, v0.16b, #8                          // ...................................................._....'.....................................................*...................................
        // eor     v11.16b, v11.16b, v0.16b                             // ......................................................_..'.......................................................*.................................
        // pmull2  v11.1q, v11.2d, v14.2d                               // ........................................................._..........................................................l..............................
        // eor     v10.16b, v10.16b, v11.16b                            // _........................................................'._..........................................................l............................
        // ldp x22, x23, [x0, #(1*16)]                                  // ...............e.........................................'................_.........................................................._.............
        // add        w14, w13, #1                                      // .....e...................................................'......_.........................................................._.......................
        // rev        w14, w14                                          // ......e..................................................'......._.........................................................._......................
        // orr        x14, x12, x14, lsl #32                            // .......e.................................................'........_.........................................................._.....................
        // stp        x11, x14, [sp, #(STACK_BASE_AES_ST + 1*16)]       // ................e........................................'................._.........................................................._............
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 1*16)]             // ........................e................................'........................._.........................................................._....
        // aesr v0.16b, v18.16b                                         // ............................e............................'............................._...........................................................
        // aesr v0.16b, v19.16b                                         // ........................................e................'........................................._...............................................
        // aesr v0.16b, v20.16b                                         // ...........................................e.............'............................................_............................................
        // aesr v0.16b, v21.16b                                         // .............................................e...........'.............................................._..........................................
        // aesr v0.16b, v22.16b                                         // ...............................................e.........'................................................_........................................
        // aesr v0.16b, v23.16b                                         // ..................................................e......'..................................................._.....................................
        // aesr v0.16b, v24.16b                                         // ....................................................e....'....................................................._...................................
        // aesr v0.16b, v25.16b                                         // ......................................................e..'......................................................._.................................
        // aesr v0.16b, v26.16b                                         // ........................................................e'........................................................._...............................
        // aese v0.16b, v27.16b                                         // ....._...................................................'......*.........................................................._.......................
        // eor x22, x22, x20                                            // ...................e.....................................'...................._.........................................................._.........
        // eor x23, x23, x21                                            // ....................e....................................'....................._.........................................................._........
        // stp x22, x23, [sp, #(STACK_BASE_AES_ST + 1*16)]              // ..................................e......................'..................................._.....................................................
        // ldr q29, [sp, #(STACK_BASE_AES_ST + 1*16)]                   // ..........._.............................................'............*.........................................................._.................
        // eor v0.16b, v29.16b, v0.16b                                  // ..............._.........................................'................*.........................................................._.............
        // str q0, [x2, #(1*16)]                                        // ....................._...................................'......................*.........................................................._.......
        // rev64   v0.16b, v0.16b                                       // ..................._.....................................'....................*.........................................................._.........
        // pmull   v11.1q, v0.1d, v15.1d                                // ......................................_..................'.......................................*.................................................
        // eor     v8.16b, v8.16b, v11.16b                              // .............................................._..........'...............................................*.........................................
        // pmull2  v11.1q, v0.2d, v15.2d                                // ......................_..................................'.......................*.........................................................._......
        // eor     v9.16b, v9.16b, v11.16b                              // .........................................................'_..........................................................l.............................
        // mov     d11, v0.d[1]                                         // ..............................................._.........'................................................*........................................
        // eor     v11.8b, v11.8b, v0.8b                                // ....................................................._...'......................................................*..................................
        // pmull   v11.1q, v11.1d, v17.1d                               // ...._....................................................'....._..........................................................l........................
        // eor     v10.16b, v10.16b, v11.16b                            // ......_..................................................'......._..........................................................l......................
        // ldp x22, x23, [x0], #(4*16)                                  // ......................e..................................'......................._.........................................................._......
        // add        w14, w13, #0                                      // .........e...............................................'.........._.........................................................._...................
        // rev        w14, w14                                          // ..........e..............................................'..........._.........................................................._..................
        // orr        x14, x12, x14, lsl #32                            // _........................................................'.*.........................................................._............................
        // stp        x11, x14, [sp, #(STACK_BASE_AES_ST + 0*16)]       // ._.......................................................'..*.........................................................._...........................
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 0*16)]             // ..._.....................................................'....*.........................................................._.........................
        // aesr v0.16b, v18.16b                                         // ......._.................................................'........*.........................................................._.....................
        // aesr v0.16b, v19.16b                                         // ........._...............................................'..........*.........................................................._...................
        // aesr v0.16b, v20.16b                                         // ..........._.............................................'............*.........................................................._.................
        // aesr v0.16b, v21.16b                                         // ............._...........................................'..............*.........................................................._...............
        // aesr v0.16b, v22.16b                                         // ..............._.........................................'................*.........................................................._.............
        // aesr v0.16b, v23.16b                                         // ................._.......................................'..................*.........................................................._...........
        // aesr v0.16b, v24.16b                                         // ..................._.....................................'....................*.........................................................._.........
        // aesr v0.16b, v25.16b                                         // ....................._...................................'......................*.........................................................._.......
        // aesr v0.16b, v26.16b                                         // ......................._.................................'........................*.........................................................._.....
        // aese v0.16b, v27.16b                                         // ........................._...............................'..........................*.........................................................._...
        // eor x22, x22, x20                                            // .........................................................*.........................................................._..............................
        // eor x23, x23, x21                                            // ..........................e..............................'..........................._.........................................................._..
        // stp x22, x23, [sp, #(STACK_BASE_AES_ST + 0*16)]              // .........................................................'*.........................................................._.............................
        // ldr q29, [sp, #(STACK_BASE_AES_ST + 0*16)]                   // ._.......................................................'..*.........................................................._...........................
        // eor v0.16b, v29.16b, v0.16b                                  // ..........................._.............................'............................*.........................................................._.
        // str q0, [x2], #(4*16)                                        // ............................._...........................'..............................*..........................................................
        // rev64   v0.16b, v0.16b                                       // .............................._..........................'...............................*.........................................................
        // eor   v0.16b, v0.16b, v30.16b                                // ............................................._...........'..............................................*..........................................
        // pmull   v11.1q, v0.1d, v16.1d                                // ................................................_........'.................................................*.......................................
        // eor     v8.16b, v8.16b, v11.16b                              // .................................................._......'...................................................*.....................................
        // pmull2  v11.1q, v0.2d, v16.2d                                // ....................................................._...'......................................................*..................................
        // eor     v9.16b, v9.16b, v11.16b                              // ._.......................................................'.._..........................................................l...........................
        // ext     v11.16b, v0.16b, v0.16b, #8                          // .._......................................................'..._..........................................................l..........................
        // eor     v11.16b, v11.16b, v0.16b                             // ...._....................................................'....._..........................................................l........................
        // pmull2  v11.1q, v11.2d, v17.2d                               // ......_..................................................'......._..........................................................l......................
        // eor     v10.16b, v10.16b, v11.16b                            // ........_................................................'........._..........................................................l....................
        // eor        v0.16b, v8.16b,  v9.16b                           // ......._.................................................'........_..........................................................l.....................
        // pmull      v1.1q,  v9.1d,   v7.1d                            // ........_................................................'........._..........................................................l....................
        // ext        v9.16b,    v9.16b,  v9.16b, #8                    // ....._...................................................'......_..........................................................l.......................
        // eor        v10.16b,   v10.16b, v0.16b                        // .........._..............................................'..........._..........................................................l..................
        // eor        v1.16b, v9.16b,  v1.16b                           // .........._..............................................'..........._..........................................................l..................
        // eor        v10.16b,   v10.16b, v1.16b                        // ............_............................................'............._..........................................................l................
        // pmull      v9.1q,     v10.1d,  v7.1d                         // .............._..........................................'..............._..........................................................l..............
        // eor        v8.16b,    v8.16b,  v9.16b                        // ................._.......................................'.................._..........................................................l...........
        // ext        v10.16b,   v10.16b, v10.16b, #8                   // ................_........................................'................._..........................................................l............
        // eor        v30.16b,     v8.16b,  v10.16b                     // ......................._.................................'........................_..........................................................l.....
        // ext        v30.16b, v30.16b, v30.16b, #8                     // ............................_............................'............................._..........................................................l
        // add w13, w13, #UNROLL                                        // .........................................................'*.........................................................._.............................

        sub count, count, #1
        cbnz count, Lloop_unrolled_start
Lloop_unrolled_start_postamble:// end of loop kernel
                                                      // Instructions:    92
                                                      // Expected cycles: 52
                                                      // Expected IPC:    1.77
                                                      // -------------- expected cycle count --------------->
                                                      // 0                        25                       50
                                                      // |------------------------|------------------------|-
        pmull2 v28.1q, v28.2d, v14.2d                 // *...................................................
        eor x17, x26, x20                             // *...................................................
        add w13, w13, #UNROLL                         // *...................................................
        orr x7, x12, x7, lsl #32                      // *...................................................
        eor v29.16B, v30.16B, v29.16B                 // .*..................................................
        str q5, [x2, #48]                             // .*..................................................
        stp x11, x7, [sp, #STACK_BASE_AES_ST]         // .*.................................................. // @slothy:writes=stack_0
        eor v28.16B, v10.16B, v28.16B                 // ..*.................................................
        pmull v3.1q, v3.1d, v17.1d                    // ..*.................................................
        eor v5.16B, v29.16B, v9.16B                   // ...*................................................ // @slothy:late
        ldr q10, [sp, #STACK_BASE_AES_ST]             // ...*................................................ // @slothy:reads=stack_0
        stp x17, x29, [sp, #STACK_BASE_AES_ST]        // ...*................................................ // @slothy:writes=stack_0
        aese v11.16b, v27.16b                         // ....*...............................................
        mov d29, v1.d[1]                              // ....*...............................................
        ext v6.16B, v31.16B, v31.16B, #8              // .....*.............................................. // @slothy:late
        pmull v4.1q, v1.1d, v12.1d                    // .....*..............................................
        eor v29.8B, v29.8B, v1.8B                     // ......*.............................................
        pmull2 v1.1q, v1.2d, v12.2d                   // ......*.............................................
        eor v31.16B, v6.16B, v31.16B                  // .......*............................................ // @slothy:late
        aesr v10.16b, v18.16b                         // .......*............................................
        ldr q6, [sp, #STACK_BASE_AES_ST + 32]         // ........*........................................... // @slothy:reads=stack_2
        pmull v9.1q, v5.1d, v7.1d                     // ........*........................................... // @slothy:late
        eor v28.16B, v28.16B, v3.16B                  // .........*..........................................
        aesr v10.16b, v19.16b                         // .........*..........................................
        pmull2 v31.1q, v31.2d, v17.2d                 // ..........*......................................... // @slothy:late
        ext v3.16B, v5.16B, v5.16B, #8                // ..........*......................................... // @slothy:late
        eor v5.16B, v2.16B, v5.16B                    // ...........*........................................ // @slothy:late
        aesr v10.16b, v20.16b                         // ...........*........................................
        eor v6.16B, v6.16B, v8.16B                    // ............*.......................................
        eor v28.16B, v28.16B, v31.16B                 // ............*....................................... // @slothy:late
        ldr q31, [sp, #STACK_BASE_AES_ST]             // .............*...................................... // @slothy:reads=stack_0
        aesr v10.16b, v21.16b                         // .............*......................................
        eor v3.16B, v3.16B, v9.16B                    // ..............*..................................... // @slothy:late
        eor v28.16B, v28.16B, v5.16B                  // ..............*..................................... // @slothy:late
        aesr v10.16b, v22.16b                         // ...............*....................................
        ldr q5, [sp, #STACK_BASE_AES_ST + 16]         // ...............*.................................... // @slothy:reads=stack_1
        eor v28.16B, v28.16B, v3.16B                  // ................*................................... // @slothy:late
        rev64 v3.16B, v6.16B                          // ................*...................................
        str q6, [x2, #32]                             // .................*..................................
        aesr v10.16b, v23.16b                         // .................*..................................
        pmull v6.1q, v28.1d, v7.1d                    // ..................*................................. // @slothy:late
        ext v28.16B, v28.16B, v28.16B, #8             // ..................*................................. // @slothy:late
        eor v5.16B, v5.16B, v11.16B                   // ...................*................................
        aesr v10.16b, v24.16b                         // ...................*................................
        eor v6.16B, v2.16B, v6.16B                    // ....................*............................... // @slothy:late
        pmull v29.1q, v29.1d, v14.1d                  // ....................*...............................
        aesr v10.16b, v25.16b                         // .....................*..............................
        rev64 v8.16B, v5.16B                          // .....................*..............................
        str q5, [x2, #16]                             // ......................*.............................
        pmull v5.1q, v3.1d, v13.1d                    // ......................*.............................
        eor v28.16B, v6.16B, v28.16B                  // .......................*............................ // @slothy:late
        aesr v10.16b, v26.16b                         // .......................*............................
        eor v5.16B, v4.16B, v5.16B                    // ........................*...........................
        pmull2 v6.1q, v8.2d, v15.2d                   // ........................*...........................
        ext v28.16B, v28.16B, v28.16B, #8             // .........................*.......................... // @slothy:late
        aese v10.16b, v27.16b                         // .........................*..........................
        pmull2 v4.1q, v3.2d, v13.2d                   // ..........................*.........................
        mov d9, v8.d[1]                               // ..........................*.........................
        eor v31.16B, v31.16B, v10.16B                 // ...........................*........................
        ext v10.16B, v3.16B, v3.16B, #8               // ...........................*........................
        eor v1.16B, v1.16B, v4.16B                    // ............................*.......................
        pmull v4.1q, v8.1d, v15.1d                    // ............................*.......................
        rev64 v2.16B, v31.16B                         // .............................*...................... // @slothy:late
        str q31, [x2], #(4*16)                        // .............................*......................
        eor v31.16B, v10.16B, v3.16B                  // ..............................*.....................
        eor v3.16B, v5.16B, v4.16B                    // ..............................*.....................
        eor v5.8B, v9.8B, v8.8B                       // ...............................*....................
        eor v28.16B, v2.16B, v28.16B                  // ...............................*.................... // @slothy:late
        eor v10.16B, v1.16B, v6.16B                   // ................................*...................
        pmull2 v31.1q, v31.2d, v14.2d                 // ................................*...................
        ext v6.16B, v28.16B, v28.16B, #8              // .................................*.................. // @slothy:late
        pmull v1.1q, v28.1d, v16.1d                   // .................................*.................. // @slothy:late
        eor v31.16B, v29.16B, v31.16B                 // ..................................*.................
        pmull2 v29.1q, v28.2d, v16.2d                 // ..................................*................. // @slothy:late
        pmull v5.1q, v5.1d, v17.1d                    // ...................................*................
        eor v28.16B, v6.16B, v28.16B                  // ...................................*................ // @slothy:late
        eor v3.16B, v3.16B, v1.16B                    // ....................................*............... // @slothy:late
        eor v10.16B, v10.16B, v29.16B                 // ....................................*............... // @slothy:late
        eor v31.16B, v31.16B, v5.16B                  // .....................................*..............
        pmull2 v28.1q, v28.2d, v17.2d                 // .....................................*.............. // @slothy:late
        ext v5.16B, v10.16B, v10.16B, #8              // ......................................*............. // @slothy:late
        eor v29.16B, v3.16B, v10.16B                  // ......................................*............. // @slothy:late
        pmull v10.1q, v10.1d, v7.1d                   // .......................................*............ // @slothy:late
        eor v28.16B, v31.16B, v28.16B                 // .......................................*............ // @slothy:late
        eor v31.16B, v5.16B, v10.16B                  // .........................................*.......... // @slothy:late
        eor v28.16B, v28.16B, v29.16B                 // .........................................*.......... // @slothy:late
        eor v28.16B, v28.16B, v31.16B                 // ...........................................*........ // @slothy:late
        pmull v31.1q, v28.1d, v7.1d                   // .............................................*...... // @slothy:late
        ext v28.16B, v28.16B, v28.16B, #8             // .............................................*...... // @slothy:late
        eor v31.16B, v3.16B, v31.16B                  // ...............................................*.... // @slothy:late
        eor v28.16B, v31.16B, v28.16B                 // .................................................*.. // @slothy:late
        ext v30.16B, v28.16B, v28.16B, #8             // ...................................................* // @slothy:late

        // original source code
        // pmull2 V<ssa_0>.1q, v28.2d, v14.2d                          // *...................................................
        // mov D<ssa_1>, v1.d[1]                                       // ....*...............................................
        // eor X<ssa_2>, x26, x20                                      // *...................................................
        // eor V<ssa_3>.16B, v30.16B, v29.16B                          // .*..................................................
        // pmull V<ssa_4>.1q, v1.1d, v12.1d                            // .....*..............................................
        // add w13, w13, #UNROLL                                       // *...................................................
        // stp X<ssa_2>, x29, [sp, #STACK_BASE_AES_ST]                 // ...*................................................
        // eor V<ssa_7>.16B, v10.16B, V<ssa_0>.16B                     // ..*.................................................
        // eor V<ssa_8>.8B, V<ssa_1>.8B, v1.8B                         // ......*.............................................
        // orr X<ssa_9>, x12, x7, lsl #32                              // *...................................................
        // ldr Q<ssa_11>, [sp, #STACK_BASE_AES_ST]                     // .............*......................................
        // eor V<ssa_12>.16B, V<ssa_3>.16B, v9.16B                     // ...*................................................
        // stp x11, X<ssa_9>, [sp, #STACK_BASE_AES_ST]                 // .*..................................................
        // str q5, [x2, #48]                                           // .*..................................................
        // ext V<ssa_15>.16B, v31.16B, v31.16B, #8                     // .....*..............................................
        // ldr Q<ssa_18>, [sp, #STACK_BASE_AES_ST]                     // ...*................................................
        // eor V<ssa_22>.16B, V<ssa_15>.16B, v31.16B                   // .......*............................................
        // pmull V<ssa_23>.1q, v3.1d, v17.1d                           // ..*.................................................
        // aese v11.16b, v27.16b                                       // ....*...............................................
        // ext V<ssa_25>.16B, V<ssa_12>.16B, V<ssa_12>.16B, #8         // ..........*.........................................
        // pmull2 V<ssa_27>.1q, V<ssa_22>.2d, v17.2d                   // ..........*.........................................
        // eor V<ssa_28>.16B, V<ssa_7>.16B, V<ssa_23>.16B              // .........*..........................................
        // aesr V<ssa_18>.16b, v18.16b                                 // .......*............................................
        // eor V<ssa_30>.16B, v2.16B, V<ssa_12>.16B                    // ...........*........................................
        // eor V<ssa_33>.16B, V<ssa_28>.16B, V<ssa_27>.16B             // ............*.......................................
        // pmull V<ssa_34>.1q, V<ssa_12>.1d, v7.1d                     // ........*...........................................
        // aesr V<ssa_18>.16b, v19.16b                                 // .........*..........................................
        // eor V<ssa_37>.16B, V<ssa_25>.16B, V<ssa_34>.16B             // ..............*.....................................
        // eor V<ssa_38>.16B, V<ssa_33>.16B, V<ssa_30>.16B             // ..............*.....................................
        // aesr V<ssa_18>.16b, v20.16b                                 // ...........*........................................
        // ldr Q<ssa_40>, [sp, #STACK_BASE_AES_ST + 16]                // ...............*....................................
        // eor V<ssa_42>.16B, V<ssa_38>.16B, V<ssa_37>.16B             // ................*...................................
        // pmull V<ssa_43>.1q, V<ssa_8>.1d, v14.1d                     // ....................*...............................
        // aesr V<ssa_18>.16b, v21.16b                                 // .............*......................................
        // ldr Q<ssa_44>, [sp, #STACK_BASE_AES_ST + 32]                // ........*...........................................
        // pmull V<ssa_45>.1q, V<ssa_42>.1d, v7.1d                     // ..................*.................................
        // eor V<ssa_47>.16B, V<ssa_40>.16B, v11.16B                   // ...................*................................
        // aesr V<ssa_18>.16b, v22.16b                                 // ...............*....................................
        // pmull2 V<ssa_50>.1q, v1.2d, v12.2d                          // ......*.............................................
        // ext V<ssa_51>.16B, V<ssa_42>.16B, V<ssa_42>.16B, #8         // ..................*.................................
        // eor V<ssa_53>.16B, v2.16B, V<ssa_45>.16B                    // ....................*...............................
        // aesr V<ssa_18>.16b, v23.16b                                 // .................*..................................
        // eor V<ssa_54>.16B, V<ssa_44>.16B, v8.16B                    // ............*.......................................
        // rev64 V<ssa_56>.16B, V<ssa_47>.16B                          // .....................*..............................
        // aesr V<ssa_18>.16b, v24.16b                                 // ...................*................................
        // str Q<ssa_47>, [x2, #16]                                    // ......................*.............................
        // aesr V<ssa_18>.16b, v25.16b                                 // .....................*..............................
        // pmull2 V<ssa_62>.1q, V<ssa_56>.2d, v15.2d                   // ........................*...........................
        // eor V<ssa_66>.16B, V<ssa_53>.16B, V<ssa_51>.16B             // .......................*............................
        // aesr V<ssa_18>.16b, v26.16b                                 // .......................*............................
        // aese V<ssa_18>.16b, v27.16b                                 // .........................*..........................
        // eor V<ssa_71>.16B, V<ssa_11>.16B, V<ssa_18>.16B             // ...........................*........................
        // ext V<ssa_72>.16B, V<ssa_66>.16B, V<ssa_66>.16B, #8         // .........................*..........................
        // str Q<ssa_71>, [x2], #(4*16)                                // .............................*......................
        // rev64 V<ssa_73>.16B, V<ssa_71>.16B                          // .............................*......................
        // rev64 V<ssa_75>.16B, V<ssa_54>.16B                          // ................*...................................
        // str Q<ssa_54>, [x2, #-32]                                   // .................*..................................
        // pmull V<ssa_78>.1q, V<ssa_56>.1d, v15.1d                    // ............................*.......................
        // pmull V<ssa_79>.1q, V<ssa_75>.1d, v13.1d                    // ......................*.............................
        // eor V<ssa_80>.16B, V<ssa_4>.16B, V<ssa_79>.16B              // ........................*...........................
        // eor V<ssa_82>.16B, V<ssa_73>.16B, V<ssa_72>.16B             // ...............................*....................
        // eor V<ssa_83>.16B, V<ssa_80>.16B, V<ssa_78>.16B             // ..............................*.....................
        // mov D<ssa_84>, V<ssa_56>.d[1]                               // ..........................*.........................
        // pmull V<ssa_85>.1q, V<ssa_82>.1d, v16.1d                    // .................................*..................
        // pmull2 V<ssa_86>.1q, V<ssa_75>.2d, v13.2d                   // ..........................*.........................
        // eor V<ssa_87>.16B, V<ssa_83>.16B, V<ssa_85>.16B             // ....................................*...............
        // eor V<ssa_88>.16B, V<ssa_50>.16B, V<ssa_86>.16B             // ............................*.......................
        // ext V<ssa_89>.16B, V<ssa_75>.16B, V<ssa_75>.16B, #8         // ...........................*........................
        // pmull2 V<ssa_90>.1q, V<ssa_82>.2d, v16.2d                   // ..................................*.................
        // eor V<ssa_91>.8B, V<ssa_84>.8B, V<ssa_56>.8B                // ...............................*....................
        // eor V<ssa_92>.16B, V<ssa_89>.16B, V<ssa_75>.16B             // ..............................*.....................
        // pmull2 V<ssa_94>.1q, V<ssa_92>.2d, v14.2d                   // ................................*...................
        // eor V<ssa_97>.16B, V<ssa_88>.16B, V<ssa_62>.16B             // ................................*...................
        // eor V<ssa_100>.16B, V<ssa_43>.16B, V<ssa_94>.16B            // ..................................*.................
        // eor V<ssa_105>.16B, V<ssa_97>.16B, V<ssa_90>.16B            // ....................................*...............
        // ext V<ssa_108>.16B, V<ssa_82>.16B, V<ssa_82>.16B, #8        // .................................*..................
        // eor V<ssa_115>.16B, V<ssa_108>.16B, V<ssa_82>.16B           // ...................................*................
        // pmull V<ssa_116>.1q, V<ssa_91>.1d, v17.1d                   // ...................................*................
        // ext V<ssa_118>.16B, V<ssa_105>.16B, V<ssa_105>.16B, #8      // ......................................*.............
        // pmull2 V<ssa_120>.1q, V<ssa_115>.2d, v17.2d                 // .....................................*..............
        // eor V<ssa_121>.16B, V<ssa_100>.16B, V<ssa_116>.16B          // .....................................*..............
        // eor V<ssa_123>.16B, V<ssa_87>.16B, V<ssa_105>.16B           // ......................................*.............
        // eor V<ssa_126>.16B, V<ssa_121>.16B, V<ssa_120>.16B          // .......................................*............
        // pmull V<ssa_127>.1q, V<ssa_105>.1d, v7.1d                   // .......................................*............
        // eor V<ssa_130>.16B, V<ssa_118>.16B, V<ssa_127>.16B          // .........................................*..........
        // eor V<ssa_131>.16B, V<ssa_126>.16B, V<ssa_123>.16B          // .........................................*..........
        // eor V<ssa_134>.16B, V<ssa_131>.16B, V<ssa_130>.16B          // ...........................................*........
        // pmull V<ssa_136>.1q, V<ssa_134>.1d, v7.1d                   // .............................................*......
        // ext V<ssa_142>.16B, V<ssa_134>.16B, V<ssa_134>.16B, #8      // .............................................*......
        // eor V<ssa_144>.16B, V<ssa_87>.16B, V<ssa_136>.16B           // ...............................................*....
        // eor V<ssa_153>.16B, V<ssa_144>.16B, V<ssa_142>.16B          // .................................................*..
        // ext v30.16B, V<ssa_153>.16B, V<ssa_153>.16B, #8             // ...................................................*

        b Lloop_unrolled_start_end
Lloop_unrolled_start_iter_1:


        ldp x22, x23, [x0, #(3*16)]
        add        w14, w13, #3
        rev        w14, w14
        orr        x14, x12, x14, lsl #32
        stp        x11, x14, [sp, #(STACK_BASE_AES_ST + 3*16)] // @slothy:writes=stack_3
        ldr        q0, [sp, #(STACK_BASE_AES_ST + 3*16)]       // @slothy:reads=stack_3
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aese v0.16b, v27.16b
        eor x22, x22, x20
        eor x23, x23, x21
        stp x22, x23, [sp, #(STACK_BASE_AES_ST + 3*16)] // @slothy:writes=stack_3
        ldr q29, [sp, #(STACK_BASE_AES_ST + 3*16)]       // @slothy:reads=stack_3
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(3*16)]

        rev64 v0.16b, v0.16b
        // Low product
        pmull   v8.1q, v0.1d, v12.1d
        // High product
        pmull2  v9.1q, v0.2d, v12.2d
        // Middle product
        mov     d11, v0.d[1]
        eor     v11.8b, v11.8b, v0.8b
        pmull   v10.1q, v11.1d, v14.1d

        ldp x22, x23, [x0, #(2*16)]
        add        w14, w13, #2
        rev        w14, w14
        orr        x14, x12, x14, lsl #32
        stp        x11, x14, [sp, #(STACK_BASE_AES_ST + 2*16)] // @slothy:writes=stack_2
        ldr        q0, [sp, #(STACK_BASE_AES_ST + 2*16)]       // @slothy:reads=stack_2
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aese v0.16b, v27.16b
        eor x22, x22, x20
        eor x23, x23, x21
        stp x22, x23, [sp, #(STACK_BASE_AES_ST + 2*16)] // @slothy:writes=stack_2
        ldr q29, [sp, #(STACK_BASE_AES_ST + 2*16)]       // @slothy:reads=stack_2
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(2*16)]

        rev64   v0.16b, v0.16b
        // Low product
        pmull   v11.1q, v0.1d, v13.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v13.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        ext     v11.16b, v0.16b, v0.16b, #8
        eor     v11.16b, v11.16b, v0.16b
        pmull2  v11.1q, v11.2d, v14.2d
        eor     v10.16b, v10.16b, v11.16b

        ldp x22, x23, [x0, #(1*16)]
        add        w14, w13, #1
        rev        w14, w14
        orr        x14, x12, x14, lsl #32
        stp        x11, x14, [sp, #(STACK_BASE_AES_ST + 1*16)] // @slothy:writes=stack_1
        ldr        q0, [sp, #(STACK_BASE_AES_ST + 1*16)]       // @slothy:reads=stack_1
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aese v0.16b, v27.16b
        eor x22, x22, x20
        eor x23, x23, x21
        stp x22, x23, [sp, #(STACK_BASE_AES_ST + 1*16)] // @slothy:writes=stack_1
        ldr q29, [sp, #(STACK_BASE_AES_ST + 1*16)]       // @slothy:reads=stack_1
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(1*16)]

        rev64   v0.16b, v0.16b
        // Low product
        pmull   v11.1q, v0.1d, v15.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v15.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        mov     d11, v0.d[1]
        eor     v11.8b, v11.8b, v0.8b
        pmull   v11.1q, v11.1d, v17.1d
        eor     v10.16b, v10.16b, v11.16b

        ldp x22, x23, [x0], #(4*16)
        add        w14, w13, #0
        rev        w14, w14
        orr        x14, x12, x14, lsl #32
        stp        x11, x14, [sp, #(STACK_BASE_AES_ST + 0*16)] // @slothy:writes=stack_0
        ldr        q0, [sp, #(STACK_BASE_AES_ST + 0*16)]       // @slothy:reads=stack_0
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aese v0.16b, v27.16b
        eor x22, x22, x20
        eor x23, x23, x21
        stp x22, x23, [sp, #(STACK_BASE_AES_ST + 0*16)] // @slothy:writes=stack_0
        ldr q29, [sp, #(STACK_BASE_AES_ST + 0*16)]       // @slothy:reads=stack_0
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2], #(4*16)

        rev64   v0.16b, v0.16b// @slothy:late
        eor   v0.16b, v0.16b, v30.16b// @slothy:late
        // Low product // @slothy:late
        pmull   v11.1q, v0.1d, v16.1d// @slothy:late
        eor     v8.16b, v8.16b, v11.16b// @slothy:late
        // High product // @slothy:late
        pmull2  v11.1q, v0.2d, v16.2d// @slothy:late
        eor     v9.16b, v9.16b, v11.16b// @slothy:late
        // Middle product // @slothy:late
        ext     v11.16b, v0.16b, v0.16b, #8// @slothy:late
        eor     v11.16b, v11.16b, v0.16b// @slothy:late
        pmull2  v11.1q, v11.2d, v17.2d// @slothy:late
        eor     v10.16b, v10.16b, v11.16b// @slothy:late
        eor        v0.16b, v8.16b,  v9.16b// @slothy:late
        pmull      v1.1q,  v9.1d,   v7.1d// @slothy:late
        ext        v9.16b,    v9.16b,  v9.16b, #8// @slothy:late
        eor        v10.16b,   v10.16b, v0.16b// @slothy:late
        eor        v1.16b, v9.16b,  v1.16b// @slothy:late
        eor        v10.16b,   v10.16b, v1.16b// @slothy:late
        pmull      v9.1q,     v10.1d,  v7.1d// @slothy:late
        eor        v8.16b,    v8.16b,  v9.16b// @slothy:late
        ext        v10.16b,   v10.16b, v10.16b, #8// @slothy:late
        eor        v30.16b,     v8.16b,  v10.16b// @slothy:late
        ext        v30.16b, v30.16b, v30.16b, #8// @slothy:late

        add w13, w13, #UNROLL
Lloop_unrolled_start_iter_1_end:
Lloop_unrolled_start_end:
Lloop_unrolled_end:

        cbz remainder, Lloop_1x_end
Lloop_1x_start:

        ldp plain_lo, plain_hi, [input], #16
        aes_full_block aes_st, plain, res, 0
        str res_q, [output], #16
        ghash_init_with_tag_0 res, Ht1, Ht12, tag

        ghash_finalize tag

        add ctr, ctr, #1
        sub remainder, remainder, #1
        cbnz remainder, Lloop_1x_start
Lloop_1x_end:

        // Return number of bytes processed
        mov x0, byte_len
        // Store new authentication tag
        rev64 tag.16b, tag.16b
        str tag_q, [tag_ptr]

        // Store updated counter
        // rev32 rtmp_ctr.16b, rtmp_ctr.16b
        // str rtmp_ctr_q, [ivec]
        rev ctr_tmp_w, ctr
        str ctr_tmp_w, [ivec, #12]

        restore_vregs
        restore_gprs

Lenc_postamble_end:
        add sp, sp, #STACK_SIZE

        ret

#endif
#endif  // !OPENSSL_NO_ASM && defined(__AARCH64EL__) && defined(__APPLE__)
#if defined(__ELF__)
// See https: // www.airs.com/blog/archives/518.
.section .note.GNU-stack,"",%progbits
#endif