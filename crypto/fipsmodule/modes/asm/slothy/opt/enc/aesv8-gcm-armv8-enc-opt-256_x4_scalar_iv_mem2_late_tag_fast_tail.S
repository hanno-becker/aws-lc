// Copyright (c) 2022, ARM Inc.

// Permission to use, copy, modify, and/or distribute this software for any
// purpose with or without fee is hereby granted, provided that the above
// copyright notice and this permission notice appear in all copies.

// THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
// WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
// MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
// SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
// WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
// OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
// CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. */

// Author: Hanno Becker <hannobecker@posteo.de>

// This file was derived from the assembly generated from aesv8-gcm-armv8.pl,
// written by Fangming Fang <fangming.fang@arm.com> for the OpenSSL project,
// and derived from https:    // github.com/ARM-software/AArch64cryptolib, original
// author Samuel Lee <Samuel.Lee@arm.com>.

// The code below is a 'clean' AArch64 implementation of AES-GCM emphasizing
// the logic of the computation. It is meant as the input to manual audits /
// formal verification, as well as automated micro-optimization such as done
// by the SLOTHY superoptimizer (https:    // github.com/slothy-optimizer/slothy).

#if !defined(__has_feature)
#define __has_feature(x) 0
#endif
#if __has_feature(memory_sanitizer) && !defined(OPENSSL_NO_ASM)
#define OPENSSL_NO_ASM
#endif

#include <openssl/asm_base.h>

#if !defined(OPENSSL_NO_ASM) && defined(__AARCH64EL__)
#if defined(__ELF__)
#include <openssl/boringssl_prefix_symbols_asm.h>
#include <openssl/arm_arch.h>
.arch   armv8-a+crypto
.text
.globl  aes_gcm_enc_kernel_slothy_base_256
.hidden aes_gcm_enc_kernel_slothy_base_256
.type   aes_gcm_enc_kernel_slothy_base_256,%function
#elif defined(__APPLE__)
#if defined(BORINGSSL_PREFIX)
#include <boringssl_prefix_symbols_asm.h>
#endif
#include <openssl/arm_arch.h>
.text
.globl	_aes_gcm_enc_kernel_slothy_base_256
.private_extern	_aes_gcm_enc_kernel_slothy_base_256
#else
#error Unknown configuration
#endif

#if __ARM_MAX_ARCH__ >= 8

// Arguments
input    .req x0
len_bits .req x1
output   .req x2
tag_ptr  .req x3
ivec     .req x4
key      .req x5
Htable   .req x6

byte_len .req x15

constant_temp .req x25

count           .req x1
full_blocks     .req x7
remainder       .req x9
unroll          .req x10

ctr_tmp   .req x14
ctr_tmp_w .req w14

ivec_0_63    .req x11
ivec_64_96   .req x12
ivec_64_96_w .req w12

ctr      .req w13
ctr_x    .req x13

aes_st    .req v0
aes_st_q  .req q0
aes_st_d  .req d0

res       .req v0
res_q     .req q0

ghash_hi    .req v9
ghash_lo    .req v8
ghash_mid   .req v10
ghash_mid_d .req d10

ghash_tmp   .req v11
ghash_tmp_d .req d11

ghash_mod   .req v7
ghash_mod_d .req d7

modulo_tmp0 .req v0
modulo_tmp1 .req v1

Ht1q    .req q12
Ht2q    .req q13
Ht12q   .req q14

Ht1    .req v12
Ht2    .req v13
Ht12   .req v14

Ht3q    .req Ht1q
Ht4q    .req Ht2q
Ht34q   .req Ht12q

Ht3    .req Ht1
Ht4    .req Ht2
Ht34   .req Ht12

Ht5q    .req Ht1q
Ht6q    .req Ht2q
Ht56q   .req Ht12q

Ht5    .req Ht1
Ht6    .req Ht2
Ht56   .req Ht12

Ht7q    .req Ht1q
Ht8q    .req Ht2q
Ht78q   .req Ht12q

Ht7    .req Ht1
Ht8    .req Ht2
Ht78   .req Ht12

rk0q   .req q18
rk1q   .req q19
rk2q   .req q20
rk3q   .req q21
rk4q   .req q22
rk5q   .req q23
rk6q   .req q24
rk7q   .req q25
rk8q   .req q26
rk9q   .req q27
rk10q  .req q28

rk11q  .req q15
rk12q  .req q16
rk13q  .req q17
rk14q  .req q2

rk0    .req v18
rk1    .req v19
rk2    .req v20
rk3    .req v21
rk4    .req v22
rk5    .req v23
rk6    .req v24
rk7    .req v25
rk8    .req v26
rk9    .req v27
rk10   .req v28

rk11   .req v15
rk12   .req v16
rk13   .req v17
rk14   .req v2

plain   .req v29
plain_q .req q29

tag    .req v30
tag_q  .req q30

#define UNROLL 4

#define STACK_SIZE_GPRS  (6*16)
#define STACK_SIZE_VREGS (4*16)
#define STACK_SIZE  (STACK_SIZE_GPRS + STACK_SIZE_VREGS + UNROLL*16)

#define STACK_BASE_GPRS  (0)
#define STACK_BASE_VREGS (STACK_SIZE_GPRS)
#define STACK_BASE_AES_ST (STACK_SIZE_GPRS + STACK_SIZE_VREGS)

/********************************************************************/
/*                 Generic preamble/postamble macros                */
/********************************************************************/

.macro save_vregs
        stp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        stp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        stp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        stp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro restore_vregs
        ldp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        ldp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        ldp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        ldp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro save_gprs
        stp x19, x20, [sp, #(STACK_BASE_GPRS + 16*0)]
        stp x21, x22, [sp, #(STACK_BASE_GPRS + 16*1)]
        stp x23, x24, [sp, #(STACK_BASE_GPRS + 16*2)]
        stp x25, x26, [sp, #(STACK_BASE_GPRS + 16*3)]
        stp x27, x28, [sp, #(STACK_BASE_GPRS + 16*4)]
        stp x29, x30, [sp, #(STACK_BASE_GPRS + 16*5)]
.endm

.macro restore_gprs
        ldp x19, x20, [sp, #(STACK_BASE_GPRS + 16*0)]
        ldp x21, x22, [sp, #(STACK_BASE_GPRS + 16*1)]
        ldp x23, x24, [sp, #(STACK_BASE_GPRS + 16*2)]
        ldp x25, x26, [sp, #(STACK_BASE_GPRS + 16*3)]
        ldp x27, x28, [sp, #(STACK_BASE_GPRS + 16*4)]
        ldp x29, x30, [sp, #(STACK_BASE_GPRS + 16*5)]
.endm

// Derive number of iterations of unrolled loop and single-block loop
.macro prepare_loop_counts
        mov  unroll, #UNROLL
        // Number of AES Blocks (16b each)
        lsr  full_blocks, byte_len, #4
        // Number of iterations of the unrolled loop
        udiv count, full_blocks, unroll
        // Number of iterations for the tail loop handling 1 block each
        msub remainder, count, unroll, full_blocks
.endm

/********************************************************************/
/*                       AES related macros                         */
/********************************************************************/

.macro load_iv
        ldp        ivec_0_63, ivec_64_96, [ivec]
        stp        ivec_0_63, ivec_64_96, [sp, #(STACK_BASE_AES_ST + 0*16)] // @slothy:writes=stack_0
        stp        ivec_0_63, ivec_64_96, [sp, #(STACK_BASE_AES_ST + 1*16)] // @slothy:writes=stack_1
        stp        ivec_0_63, ivec_64_96, [sp, #(STACK_BASE_AES_ST + 2*16)] // @slothy:writes=stack_2
        stp        ivec_0_63, ivec_64_96, [sp, #(STACK_BASE_AES_ST + 3*16)] // @slothy:writes=stack_3

        lsr        ctr_x, ivec_64_96, #32
        rev        ctr, ctr
        orr        ivec_64_96_w, ivec_64_96_w, ivec_64_96_w // clear top 32 bit
.endm

.macro next_ctr_init_aes aes_st, loc
        add        ctr_tmp_w, ctr, #\loc
        rev        ctr_tmp_w, ctr_tmp_w
        str        ctr_tmp_w, [sp, #(STACK_BASE_AES_ST + \loc*16 + 12)] // @slothy:writes=stack_\loc
        ldr        \aes_st\()_q, [sp, #(STACK_BASE_AES_ST + \loc*16)]   // @slothy:reads=stack_\loc
.endm

// A single AES round
// Prevent SLOTHY from unfolding because uArchs tend to fuse AESMC+AESE
.macro aesr data, key // @slothy:no-unfold
        aese  \data, \key
        aesmc \data, \data
.endm

.macro aesr_0_8 data, key
        aesr \data\().16b, \key\()0.16b
        aesr \data\().16b, \key\()1.16b
        aesr \data\().16b, \key\()2.16b
        aesr \data\().16b, \key\()3.16b
        aesr \data\().16b, \key\()4.16b
        aesr \data\().16b, \key\()5.16b
        aesr \data\().16b, \key\()6.16b
        aesr \data\().16b, \key\()7.16b
        aesr \data\().16b, \key\()8.16b
.endm

.macro aesr_9_10 data, key
        aesr \data\().16b, \key\()9.16b
        aesr \data\().16b, \key\()10.16b
.endm

.macro aesr_11_12 data, key
        aesr \data\().16b, \key\()11.16b
        aesr \data\().16b, \key\()12.16b
.endm

// Destructs inA
.macro eor3 out, inA, inB, inC
        eor \inA, \inA, \inB
        eor \out, \inA, \inC
.endm

.macro aesr_final aes_st, plain, out
        aese \aes_st\().16b, rk13.16b
        eor3 \out\().16b, \plain\().16b, rk14.16b, \aes_st\().16b
.endm

.macro aes_full_block aes_st, input, output, loc
        next_ctr_init_aes \aes_st, \loc
        aesr_0_8 \aes_st\(), rk
        aesr_9_10 \aes_st\(), rk
        aesr_11_12 \aes_st\(), rk
        aesr_final \aes_st, \input, \output
.endm

.macro load_round_key i
        ldr rk\i\()q, [key, #((\i)*16)]
.endm

.macro load_round_keys
        load_round_key 0
        load_round_key 1
        load_round_key 2
        load_round_key 3
        load_round_key 4
        load_round_key 5
        load_round_key 6
        load_round_key 7
        load_round_key 8
        load_round_key 9
        load_round_key 10
        load_round_key 11
        load_round_key 12
        load_round_key 13
        load_round_key 14
.endm

/********************************************************************/
/*       Loading of H-table (precomputed H-powers for GHASH)        */
/********************************************************************/

// This has to be synchronized with the H-table generation

.macro load_h1 dst, dst_q
        ldr \dst_q, [Htable]
.endm

.macro load_h2 dst, dst_q
        ldr \dst_q, [Htable, #32]
.endm

.macro load_h3 dst, dst_q
        ldr \dst_q, [Htable, #48]
.endm

.macro load_h4 dst, dst_q
        ldr \dst_q, [Htable, #80]
.endm

.macro load_h5 dst, dst_q
        ldr \dst_q, [Htable, #96]
.endm

.macro load_h6 dst, dst_q
        ldr \dst_q, [Htable, #128]
.endm

.macro load_h7 dst, dst_q
        ldr \dst_q, [Htable, #144]
.endm

.macro load_h8 dst, dst_q
        ldr \dst_q, [Htable, #176]
.endm

.macro load_h12 dst, dst_q
        ldr \dst_q, [Htable, #16]
.endm

.macro load_h34 dst, dst_q
        ldr \dst_q, [Htable, #64]
.endm

.macro load_h56 dst, dst_q
        ldr \dst_q, [Htable, #112]
.endm

.macro load_h78 dst, dst_q
        ldr \dst_q, [Htable, #160]
.endm

.macro load_full_htable
        load_h1  Ht1,  Ht1q
        load_h2  Ht2,  Ht2q
        load_h3  Ht3,  Ht3q
        load_h4  Ht4,  Ht4q
        load_h5  Ht5,  Ht5q
        load_h6  Ht6,  Ht6q
        load_h12 Ht12, Ht12q
        load_h34 Ht34, Ht34q
        load_h56 Ht56, Ht56q
.endm

.macro load_htable_12
        load_h1  Ht1,  Ht1q
        load_h2  Ht2,  Ht2q
        load_h12 Ht12, Ht12q
.endm

.macro load_htable_1
        load_h1  Ht1,  Ht1q
        load_h12 Ht12, Ht12q
.endm

.macro load_htable_34
        load_h3  Ht3,  Ht3q
        load_h4  Ht4,  Ht4q
        load_h34 Ht34, Ht34q
.endm

.macro load_htable_3
        load_h3  Ht3,  Ht3q
        load_h34 Ht34, Ht34q
.endm

/********************************************************************/
/*                    Macros for GHASH udpate                       */
/********************************************************************/

.macro ghash_init_0 input, Hk, Hk_mid
        rev64 \input\().16b, \input\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_mid.1q, ghash_tmp.1d, \Hk_mid\().1d
.endm

.macro ghash_init_1 input, Hk, Hk_mid
        rev64 \input\().16b, \input\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_mid.1q, ghash_tmp.2d, \Hk_mid\().2d
.endm

.macro ghash_acc_0 input, Hk, Hk_mid
        rev64   \input\().16b, \input\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_tmp.1q, ghash_tmp.1d, \Hk_mid\().1d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_acc_1 input, Hk, Hk_mid
        rev64   \input\().16b, \input\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_tmp.1q, ghash_tmp.2d, \Hk_mid\().2d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_init_with_tag_0 input, Hk, Hk_mid, tag
        rev64 \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_mid.1q, ghash_tmp.1d, \Hk_mid\().1d
.endm

.macro ghash_init_with_tag_1 input, Hk, Hk_mid, tag
        rev64 \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_mid.1q, ghash_tmp.2d, \Hk_mid\().2d
.endm

.macro ghash_acc_with_tag_0 input, Hk, Hk_mid, tag
        rev64   \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_tmp.1q, ghash_tmp.1d, \Hk_mid\().1d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_acc_with_tag_1 input, Hk, Hk_mid, tag
        rev64   \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_tmp.1q, ghash_tmp.2d, \Hk_mid\().2d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_finalize tag
        eor        modulo_tmp0.16b, ghash_lo.16b,  ghash_hi.16b
        pmull      modulo_tmp1.1q,  ghash_hi.1d,   ghash_mod.1d
        ext        ghash_hi.16b,    ghash_hi.16b,  ghash_hi.16b, #8
        eor        ghash_mid.16b,   ghash_mid.16b, modulo_tmp0.16b
        eor        modulo_tmp1.16b, ghash_hi.16b,  modulo_tmp1.16b
        eor        ghash_mid.16b,   ghash_mid.16b, modulo_tmp1.16b
        pmull      ghash_hi.1q,     ghash_mid.1d,  ghash_mod.1d
        eor        ghash_lo.16b,    ghash_lo.16b,  ghash_hi.16b
        ext        ghash_mid.16b,   ghash_mid.16b, ghash_mid.16b, #8
        eor        \tag\().16b,     ghash_lo.16b,  ghash_mid.16b
        ext        \tag\().16b, \tag\().16b, \tag\().16b, #8
.endm

.macro load_tag
        ldr      tag_q, [tag_ptr]
        rev64    tag.16b, tag.16b
.endm

.macro prepare_ghash
        // Prepare constant for modular reduction
        movi ghash_mod.8b, #0xc2
        shl  ghash_mod_d, ghash_mod_d, #56
.endm

/********************************************************************/
/*                            Core routine                          */
/********************************************************************/

.align        4
_aes_gcm_enc_kernel_slothy_base_256:
aes_gcm_enc_kernel_slothy_base_256:
#ifdef BORINGSSL_DISPATCH_TEST
        adrp  x9,_BORINGSSL_function_hit@PAGE
        add   x9, x9, _BORINGSSL_function_hit@PAGEOFF
        mov   w10, #1
        strb  w10, [x9,#2] // kFlag_aes_gcm_enc_kernel
#endif

        AARCH64_VALID_CALL_TARGET
        sub sp, sp, #STACK_SIZE

Lenc_preamble_start:
        save_gprs
        save_vregs

        lsr byte_len, len_bits, #3

        load_round_keys
        load_tag
        load_iv

        prepare_loop_counts
        prepare_ghash

Lenc_preamble_end:

        cbz count, Lloop_unrolled_end
        cmp count, #1
        b.eq Lloop_unrolled_start_iter_1
                                                      // Instructions:    158
                                                      // Expected cycles: 93
                                                      // Expected IPC:    1.70

                                                      // Cycle bound:     93.0
                                                      // IPC bound:       1.70

                                                      // Wall time:     12.32s
                                                      // User time:     12.32s

                                                      // ------------------------------------- cycle (expected) ------------------------------------->
                                                      // 0                        25                       50                       75
                                                      // |------------------------|------------------------|------------------------|-----------------
        ldr q5, [x6, #32]                             // *............................................................................................
        ldr q6, [x6, #64]                             // *............................................................................................
        add w12, w13, #1                              // *............................................................................................
        add w23, w13, #2                              // *............................................................................................
        ldr q10, [x0, #48]                            // .*...........................................................................................
        rev w10, w12                                  // .*...........................................................................................
        add w8, w13, #3                               // .*...........................................................................................
        rev w11, w8                                   // ..*..........................................................................................
        str w10, [sp, #STACK_BASE_AES_ST + 28]        // ..*..........................................................................................    // @slothy:writes=stack_1
        str w11, [sp, #STACK_BASE_AES_ST + 60]        // ...*.........................................................................................    // @slothy:writes=stack_3
        ldr q12, [sp, #STACK_BASE_AES_ST + 16]        // ....*........................................................................................    // @slothy:reads=stack_1
        add w26, w13, #UNROLL                         // ....*........................................................................................
        eor v4.16B, v10.16B, v2.16B                   // .....*.......................................................................................
        ldr q29, [sp, #STACK_BASE_AES_ST + 48]        // .....*.......................................................................................    // @slothy:reads=stack_3
        add w17, w26, #0                              // .....*.......................................................................................
        add w11, w13, #0                              // .....*.......................................................................................
        ldr q9, [x6, #48]                             // ......*......................................................................................
        add w24, w26, #1                              // ......*......................................................................................
        rev w25, w17                                  // ......*......................................................................................
        rev w30, w23                                  // ......*......................................................................................
        str w30, [sp, #STACK_BASE_AES_ST + 44]        // .......*.....................................................................................    // @slothy:writes=stack_2
        rev w10, w24                                  // .......*.....................................................................................
        rev w7, w11                                   // .......*.....................................................................................
        aesr v12.16b, v18.16b                         // ........*....................................................................................
        add w19, w26, #3                              // ........*....................................................................................
        str w7, [sp, #STACK_BASE_AES_ST + 12]         // ........*....................................................................................    // @slothy:writes=stack_0
        aesr v29.16b, v18.16b                         // .........*...................................................................................
        ldr q10, [sp, #STACK_BASE_AES_ST + 32]        // .........*...................................................................................    // @slothy:reads=stack_2
        rev w28, w19                                  // .........*...................................................................................
        aesr v12.16b, v19.16b                         // ..........*..................................................................................
        ldr q8, [x0, #32]                             // ..........*..................................................................................
        add w22, w26, #2                              // ..........*..................................................................................
        ldr q0, [sp, #STACK_BASE_AES_ST]              // ...........*.................................................................................    // @slothy:reads=stack_0
        aesr v29.16b, v19.16b                         // ...........*.................................................................................
        rev w27, w22                                  // ...........*.................................................................................
        aesr v12.16b, v20.16b                         // ............*................................................................................
        str w28, [sp, #STACK_BASE_AES_ST + 60]        // ............*................................................................................    // @slothy:writes=stack_3
        aesr v10.16b, v18.16b                         // .............*...............................................................................
        ldr q3, [x0, #16]                             // .............*...............................................................................
        eor v8.16B, v8.16B, v2.16B                    // ..............*..............................................................................
        aesr v29.16b, v20.16b                         // ..............*..............................................................................
        str w10, [sp, #STACK_BASE_AES_ST + 28]        // ..............*..............................................................................    // @slothy:writes=stack_1
        aesr v0.16b, v18.16b                          // ...............*.............................................................................
        aesr v29.16b, v21.16b                         // ................*............................................................................
        aesr v10.16b, v19.16b                         // .................*...........................................................................
        aesr v29.16b, v22.16b                         // ..................*..........................................................................
        aesr v12.16b, v21.16b                         // ...................*.........................................................................
        aesr v29.16b, v23.16b                         // ....................*........................................................................
        aesr v12.16b, v22.16b                         // .....................*.......................................................................
        aesr v29.16b, v24.16b                         // ......................*......................................................................
        aesr v12.16b, v23.16b                         // .......................*.....................................................................
        aesr v10.16b, v20.16b                         // ........................*....................................................................
        aesr v12.16b, v24.16b                         // .........................*...................................................................
        aesr v10.16b, v21.16b                         // ..........................*..................................................................
        aesr v12.16b, v25.16b                         // ...........................*.................................................................
        aesr v10.16b, v22.16b                         // ............................*................................................................
        aesr v12.16b, v26.16b                         // .............................*...............................................................
        aesr v10.16b, v23.16b                         // ..............................*..............................................................
        aesr v12.16b, v27.16b                         // ...............................*.............................................................
        aesr v10.16b, v24.16b                         // ................................*............................................................
        aesr v29.16b, v25.16b                         // .................................*...........................................................
        aesr v10.16b, v25.16b                         // ..................................*..........................................................
        aesr v29.16b, v26.16b                         // ...................................*.........................................................
        aesr v10.16b, v26.16b                         // ....................................*........................................................
        aesr v29.16b, v27.16b                         // .....................................*.......................................................
        aesr v10.16b, v27.16b                         // ......................................*......................................................
        aesr v29.16b, v28.16b                         // .......................................*.....................................................
        aesr v10.16b, v28.16b                         // ........................................*....................................................
        aesr v29.16b, v15.16b                         // .........................................*...................................................
        aesr v0.16b, v19.16b                          // ..........................................*..................................................
        aesr v29.16b, v16.16b                         // ...........................................*.................................................
        aesr v0.16b, v20.16b                          // ............................................*................................................
        aese v29.16b, v17.16b                         // .............................................*...............................................
        aesr v0.16b, v21.16b                          // ..............................................*..............................................
        aesr v10.16b, v15.16b                         // ...............................................*.............................................
        eor v14.16B, v4.16B, v29.16B                  // ...............................................*.............................................
        aesr v0.16b, v22.16b                          // ................................................*............................................
        ldr q4, [x0], #(4*16)                         // ................................................*............................................
        aesr v10.16b, v16.16b                         // .................................................*...........................................
        str w27, [sp, #STACK_BASE_AES_ST + 44]        // .................................................*...........................................    // @slothy:writes=stack_2
        eor v29.16B, v3.16B, v2.16B                   // ..................................................*..........................................
        aesr v0.16b, v23.16b                          // ..................................................*..........................................
        ldr q3, [x6]                                  // ...................................................*.........................................
        aesr v12.16b, v28.16b                         // ...................................................*.........................................
        aesr v0.16b, v24.16b                          // ....................................................*........................................
        aese v10.16b, v17.16b                         // .....................................................*.......................................
        aesr v12.16b, v15.16b                         // ......................................................*......................................
        aesr v0.16b, v25.16b                          // .......................................................*.....................................
        eor v13.16B, v8.16B, v10.16B                  // .......................................................*.....................................
        aesr v12.16b, v16.16b                         // ........................................................*....................................
        rev64 v10.16B, v13.16B                        // .........................................................*...................................
        aesr v0.16b, v26.16b                          // .........................................................*...................................
        rev64 v8.16B, v14.16B                         // ..........................................................*..................................
        aese v12.16b, v17.16b                         // ..........................................................*..................................
        str q13, [x2, #32]                            // ...........................................................*.................................
        pmull2 v31.1q, v10.2d, v5.2d                  // ...........................................................*.................................
        ldr q1, [sp, #STACK_BASE_AES_ST + 16]         // ............................................................*................................    // @slothy:reads=stack_1
        pmull2 v11.1q, v8.2d, v3.2d                   // ............................................................*................................
        pmull v5.1q, v10.1d, v5.1d                    // .............................................................*...............................
        eor v13.16B, v29.16B, v12.16B                 // .............................................................*...............................
        aesr v0.16b, v27.16b                          // ..............................................................*..............................
        eor v11.16B, v11.16B, v31.16B                 // ..............................................................*..............................
        pmull v29.1q, v8.1d, v3.1d                    // ...............................................................*.............................
        rev64 v12.16B, v13.16B                        // ...............................................................*.............................
        ldr q3, [sp, #STACK_BASE_AES_ST + 48]         // ................................................................*............................    // @slothy:reads=stack_3
        aesr v0.16b, v28.16b                          // ................................................................*............................
        eor v29.16B, v29.16B, v5.16B                  // .................................................................*...........................
        pmull v31.1q, v12.1d, v9.1d                   // .................................................................*...........................
        aesr v0.16b, v15.16b                          // ..................................................................*..........................
        ext v5.16B, v10.16B, v10.16B, #8              // ..................................................................*..........................
        pmull2 v9.1q, v12.2d, v9.2d                   // ...................................................................*.........................
        eor v29.16B, v29.16B, v31.16B                 // ...................................................................*.........................
        eor v5.16B, v5.16B, v10.16B                   // ....................................................................*........................
        aesr v0.16b, v16.16b                          // ....................................................................*........................
        mov d10, v12.d[1]                             // .....................................................................*.......................
        aesr v3.16b, v18.16b                          // .....................................................................*.......................
        eor v31.16B, v4.16B, v2.16B                   // ......................................................................*......................
        aese v0.16b, v17.16b                          // ......................................................................*......................
        eor v10.8B, v10.8B, v12.8B                    // .......................................................................*.....................
        aesr v3.16b, v19.16b                          // .......................................................................*.....................
        aesr v1.16b, v18.16b                          // ........................................................................*....................
        eor v0.16B, v31.16B, v0.16B                   // ........................................................................*....................
        str q13, [x2, #16]                            // .........................................................................*...................
        aesr v3.16b, v20.16b                          // .........................................................................*...................
        rev64 v4.16B, v0.16B                          // ..........................................................................*..................
        aesr v1.16b, v19.16b                          // ..........................................................................*..................
        str q0, [x2], #(4*16)                         // ...........................................................................*.................
        aesr v3.16b, v21.16b                          // ...........................................................................*.................
        eor v30.16B, v4.16B, v30.16B                  // ............................................................................*................
        aesr v1.16b, v20.16b                          // ............................................................................*................
        aesr v3.16b, v22.16b                          // .............................................................................*...............
        ldr q13, [x6, #16]                            // .............................................................................*...............
        aesr v1.16b, v21.16b                          // ..............................................................................*..............
        ext v0.16B, v30.16B, v30.16B, #8              // ..............................................................................*..............
        eor v12.16B, v11.16B, v9.16B                  // ...............................................................................*.............
        aesr v3.16b, v23.16b                          // ...............................................................................*.............
        eor v9.16B, v0.16B, v30.16B                   // ................................................................................*............
        aesr v1.16b, v22.16b                          // ................................................................................*............
        aesr v3.16b, v24.16b                          // .................................................................................*...........
        mov d0, v8.d[1]                               // .................................................................................*...........
        ldr q4, [x6, #80]                             // ..................................................................................*..........
        aesr v1.16b, v23.16b                          // ..................................................................................*..........
        eor v31.8B, v0.8B, v8.8B                      // ...................................................................................*.........
        aesr v3.16b, v25.16b                          // ...................................................................................*.........
        aesr v1.16b, v24.16b                          // ....................................................................................*........
        aesr v3.16b, v26.16b                          // .....................................................................................*.......
        pmull2 v8.1q, v30.2d, v4.2d                   // ......................................................................................*......
        aesr v3.16b, v27.16b                          // .......................................................................................*.....
        eor v8.16B, v12.16B, v8.16B                   // ........................................................................................*....
        pmull2 v0.1q, v9.2d, v6.2d                    // ........................................................................................*....
        aesr v3.16b, v28.16b                          // .........................................................................................*...
        pmull v10.1q, v10.1d, v6.1d                   // ..........................................................................................*..
        aesr v3.16b, v15.16b                          // ...........................................................................................*.
        ext v9.16B, v8.16B, v8.16B, #8                // ...........................................................................................*.
        str w25, [sp, #STACK_BASE_AES_ST + 12]        // ...........................................................................................*.    // @slothy:writes=stack_0
        pmull2 v6.1q, v5.2d, v13.2d                   // ............................................................................................*
        ldr q5, [sp, #STACK_BASE_AES_ST + 32]         // ............................................................................................*    // @slothy:reads=stack_2
        add w13, w26, #UNROLL                         // ............................................................................................*

                                                       // ------------------------------------- cycle (expected) ------------------------------------->
                                                       // 0                        25                       50                       75
                                                       // |------------------------|------------------------|------------------------|-----------------
        // add w29, w13, #3                               // .*...........................................................................................
        // add w24, w13, #0                               // .....*.......................................................................................
        // rev w27, w24                                   // .......*.....................................................................................
        // add w19, w13, #1                               // *............................................................................................
        // add w11, w13, #2                               // *............................................................................................
        // add w13, w13, #UNROLL                          // ....*........................................................................................
        // rev w11, w11                                   // ......*......................................................................................
        // rev w23, w19                                   // .*...........................................................................................
        // rev w20, w29                                   // ..*..........................................................................................
        // str w20, [sp, #STACK_BASE_AES_ST + 60]         // ...*.........................................................................................
        // str w23, [sp, #STACK_BASE_AES_ST + 28]         // ..*..........................................................................................
        // str w27, [sp, #STACK_BASE_AES_ST + 12]         // ........*....................................................................................
        // str w11, [sp, #STACK_BASE_AES_ST + 44]         // .......*.....................................................................................
        // ldr q1, [sp, #STACK_BASE_AES_ST + 16]          // ....*........................................................................................
        // ldr q3, [sp, #STACK_BASE_AES_ST + 48]          // .....*.......................................................................................
        // aesr v1.16b, v18.16b                           // ........*....................................................................................
        // aesr v3.16b, v18.16b                           // .........*...................................................................................
        // aesr v3.16b, v19.16b                           // ...........*.................................................................................
        // aesr v3.16b, v20.16b                           // ..............*..............................................................................
        // aesr v1.16b, v19.16b                           // ..........*..................................................................................
        // aesr v3.16b, v21.16b                           // ................*............................................................................
        // aesr v1.16b, v20.16b                           // ............*................................................................................
        // aesr v3.16b, v22.16b                           // ..................*..........................................................................
        // aesr v1.16b, v21.16b                           // ...................*.........................................................................
        // ldr q5, [sp, #STACK_BASE_AES_ST + 32]          // .........*...................................................................................
        // aesr v3.16b, v23.16b                           // ....................*........................................................................
        // aesr v3.16b, v24.16b                           // ......................*......................................................................
        // aesr v1.16b, v22.16b                           // .....................*.......................................................................
        // aesr v3.16b, v25.16b                           // .................................*...........................................................
        // aesr v1.16b, v23.16b                           // .......................*.....................................................................
        // aesr v3.16b, v26.16b                           // ...................................*.........................................................
        // aesr v3.16b, v27.16b                           // .....................................*.......................................................
        // aesr v3.16b, v28.16b                           // .......................................*.....................................................
        // aesr v1.16b, v24.16b                           // .........................*...................................................................
        // aesr v3.16b, v15.16b                           // .........................................*...................................................
        // aesr v1.16b, v25.16b                           // ...........................*.................................................................
        // add w29, w13, #3                               // ........*....................................................................................
        // add w24, w13, #0                               // .....*.......................................................................................
        // ldr q11, [x0, #32]                             // ..........*..................................................................................
        // rev w27, w24                                   // ......*......................................................................................
        // add w19, w13, #1                               // ......*......................................................................................
        // ldr q13, [sp, #STACK_BASE_AES_ST]              // ...........*.................................................................................
        // add w11, w13, #2                               // ..........*..................................................................................
        // add w13, w13, #UNROLL                          // ............................................................................................*
        // aesr v5.16b, v18.16b                           // .............*...............................................................................
        // rev w11, w11                                   // ...........*.................................................................................
        // rev w23, w19                                   // .......*.....................................................................................
        // rev w20, w29                                   // .........*...................................................................................
        // aesr v5.16b, v19.16b                           // .................*...........................................................................
        // str w20, [sp, #STACK_BASE_AES_ST + 60]         // ............*................................................................................
        // aesr v13.16b, v18.16b                          // ...............*.............................................................................
        // aesr v5.16b, v20.16b                           // ........................*....................................................................
        // aesr v13.16b, v19.16b                          // ..........................................*..................................................
        // ldr q12, [x6]                                  // ...................................................*.........................................
        // aesr v5.16b, v21.16b                           // ..........................*..................................................................
        // aesr v13.16b, v20.16b                          // ............................................*................................................
        // ldr q4, [x0, #16]                              // .............*...............................................................................
        // aesr v5.16b, v22.16b                           // ............................*................................................................
        // aesr v13.16b, v21.16b                          // ..............................................*..............................................
        // aesr v5.16b, v23.16b                           // ..............................*..............................................................
        // ldr q31, [x6, #64]                             // *............................................................................................
        // ldr q9, [x0, #48]                              // .*...........................................................................................
        // aesr v13.16b, v22.16b                          // ................................................*............................................
        // str w23, [sp, #STACK_BASE_AES_ST + 28]         // ..............*..............................................................................
        // aesr v5.16b, v24.16b                           // ................................*............................................................
        // str w27, [sp, #STACK_BASE_AES_ST + 12]         // ...........................................................................................*.
        // eor v6.16B, v11.16B, v2.16B                    // ..............*..............................................................................
        // aesr v13.16b, v23.16b                          // ..................................................*..........................................
        // str w11, [sp, #STACK_BASE_AES_ST + 44]         // .................................................*...........................................
        // aesr v5.16b, v25.16b                           // ..................................*..........................................................
        // ldr q11, [x0], #(4*16)                         // ................................................*............................................
        // aesr v13.16b, v24.16b                          // ....................................................*........................................
        // eor v29.16B, v9.16B, v2.16B                    // .....*.......................................................................................
        // aesr v5.16b, v26.16b                           // ....................................*........................................................
        // aesr v3.16b, v16.16b                           // ...........................................*.................................................
        // eor v9.16B, v11.16B, v2.16B                    // ......................................................................*......................
        // aesr v5.16b, v27.16b                           // ......................................*......................................................
        // aese v3.16b, v17.16b                           // .............................................*...............................................
        // aesr v5.16b, v28.16b                           // ........................................*....................................................
        // eor v14.16B, v29.16B, v3.16B                   // ...............................................*.............................................
        // aesr v1.16b, v26.16b                           // .............................*...............................................................
        // eor v3.16B, v4.16B, v2.16B                     // ..................................................*..........................................
        // aesr v5.16b, v15.16b                           // ...............................................*.............................................
        // aesr v1.16b, v27.16b                           // ...............................*.............................................................
        // rev64 v8.16B, v14.16B                          // ..........................................................*..................................
        // aesr v5.16b, v16.16b                           // .................................................*...........................................
        // ldr q4, [x6, #32]                              // *............................................................................................
        // aesr v1.16b, v28.16b                           // ...................................................*.........................................
        // aese v5.16b, v17.16b                           // .....................................................*.......................................
        // aesr v1.16b, v15.16b                           // ......................................................*......................................
        // eor v6.16B, v6.16B, v5.16B                     // .......................................................*.....................................
        // pmull2 v10.1q, v8.2d, v12.2d                   // ............................................................*................................
        // ldr q5, [x6, #48]                              // ......*......................................................................................
        // aesr v1.16b, v16.16b                           // ........................................................*....................................
        // aesr v13.16b, v25.16b                          // .......................................................*.....................................
        // rev64 v0.16B, v6.16B                           // .........................................................*...................................
        // str q6, [x2, #32]                              // ...........................................................*.................................
        // aese v1.16b, v17.16b                           // ..........................................................*..................................
        // ext v6.16B, v0.16B, v0.16B, #8                 // ..................................................................*..........................
        // pmull2 v11.1q, v0.2d, v4.2d                    // ...........................................................*.................................
        // eor v29.16B, v3.16B, v1.16B                    // .............................................................*...............................
        // pmull v3.1q, v0.1d, v4.1d                      // .............................................................*...............................
        // eor v4.16B, v10.16B, v11.16B                   // ..............................................................*..............................
        // aesr v13.16b, v26.16b                          // .........................................................*...................................
        // pmull v12.1q, v8.1d, v12.1d                    // ...............................................................*.............................
        // rev64 v10.16B, v29.16B                         // ...............................................................*.............................
        // ldr q1, [sp, #STACK_BASE_AES_ST + 16]          // ............................................................*................................
        // aesr v13.16b, v27.16b                          // ..............................................................*..............................
        // eor v12.16B, v12.16B, v3.16B                   // .................................................................*...........................
        // pmull2 v11.1q, v10.2d, v5.2d                   // ...................................................................*.........................
        // ldr q3, [sp, #STACK_BASE_AES_ST + 48]          // ................................................................*............................
        // pmull v5.1q, v10.1d, v5.1d                     // .................................................................*...........................
        // str q29, [x2, #16]                             // .........................................................................*...................
        // aesr v13.16b, v28.16b                          // ................................................................*............................
        // aesr v1.16b, v18.16b                           // ........................................................................*....................
        // eor v29.16B, v12.16B, v5.16B                   // ...................................................................*.........................
        // eor v12.16B, v6.16B, v0.16B                    // ....................................................................*........................
        // aesr v13.16b, v15.16b                          // ..................................................................*..........................
        // aesr v3.16b, v18.16b                           // .....................................................................*.......................
        // mov d0, v10.d[1]                               // .....................................................................*.......................
        // aesr v13.16b, v16.16b                          // ....................................................................*........................
        // eor v10.8B, v0.8B, v10.8B                      // .......................................................................*.....................
        // aesr v3.16b, v19.16b                           // .......................................................................*.....................
        // aese v13.16b, v17.16b                          // ......................................................................*......................
        // aesr v3.16b, v20.16b                           // .........................................................................*...................
        // eor v5.16B, v9.16B, v13.16B                    // ........................................................................*....................
        // aesr v1.16b, v19.16b                           // ..........................................................................*..................
        // ldr q13, [x6, #16]                             // .............................................................................*...............
        // aesr v3.16b, v21.16b                           // ...........................................................................*.................
        // aesr v1.16b, v20.16b                           // ............................................................................*................
        // rev64 v0.16B, v5.16B                           // ..........................................................................*..................
        // str q5, [x2], #(4*16)                          // ...........................................................................*.................
        // aesr v3.16b, v22.16b                           // .............................................................................*...............
        // eor v30.16B, v0.16B, v30.16B                   // ............................................................................*................
        // aesr v1.16b, v21.16b                           // ..............................................................................*..............
        // ldr q5, [sp, #STACK_BASE_AES_ST + 32]          // ............................................................................................*
        // aesr v3.16b, v23.16b                           // ...............................................................................*.............
        // pmull v10.1q, v10.1d, v31.1d                   // ..........................................................................................*..
        // ext v0.16B, v30.16B, v30.16B, #8               // ..............................................................................*..............
        // eor v9.16B, v4.16B, v11.16B                    // ...............................................................................*.............
        // aesr v3.16b, v24.16b                           // .................................................................................*...........
        // eor v0.16B, v0.16B, v30.16B                    // ................................................................................*............
        // aesr v1.16b, v22.16b                           // ................................................................................*............
        // aesr v3.16b, v25.16b                           // ...................................................................................*.........
        // ldr q4, [x6, #80]                              // ..................................................................................*..........
        // pmull2 v0.1q, v0.2d, v31.2d                    // ........................................................................................*....
        // mov d31, v8.d[1]                               // .................................................................................*...........
        // aesr v1.16b, v23.16b                           // ..................................................................................*..........
        // eor v31.8B, v31.8B, v8.8B                      // ...................................................................................*.........
        // aesr v3.16b, v26.16b                           // .....................................................................................*.......
        // pmull2 v11.1q, v30.2d, v4.2d                   // ......................................................................................*......
        // aesr v3.16b, v27.16b                           // .......................................................................................*.....
        // pmull2 v6.1q, v12.2d, v13.2d                   // ............................................................................................*
        // eor v8.16B, v9.16B, v11.16B                    // ........................................................................................*....
        // aesr v3.16b, v28.16b                           // .........................................................................................*...
        // aesr v1.16b, v24.16b                           // ....................................................................................*........
        // ext v9.16B, v8.16B, v8.16B, #8                 // ...........................................................................................*.
        // aesr v3.16b, v15.16b                           // ...........................................................................................*.

        sub count, count, #2
cbz count, Lloop_unrolled_start_postamble
Lloop_unrolled_start:
                                                      // Instructions:    140
                                                      // Expected cycles: 70
                                                      // Expected IPC:    2.00

                                                      // Cycle bound:     70.0
                                                      // IPC bound:       2.00

                                                      // Wall time:     1205.14s
                                                      // User time:     1205.14s

                                                      // ------------------------- cycle (expected) -------------------------->
                                                      // 0                        25                       50
                                                      // |------------------------|------------------------|-------------------
        aesr v1.16b, v25.16b                          // *.....................................................................
        str q14, [x2, #-16]                           // l.....................................................................
        add w29, w13, #3                              // e.....................................................................
        add w24, w13, #0                              // e.....................................................................
        pmull v14.1q, v31.1d, v13.1d                  // .l....................................................................
        ldr q11, [x0, #32]                            // .*....................................................................
        rev w27, w24                                  // .e....................................................................
        add w19, w13, #1                              // .e....................................................................
        pmull v31.1q, v30.1d, v4.1d                   // ..l...................................................................
        ldr q13, [sp, #STACK_BASE_AES_ST]             // ..*...................................................................    // @slothy:reads=stack_0
        add w11, w13, #2                              // ..e...................................................................
        add w13, w13, #UNROLL                         // ..e...................................................................
        eor v4.16B, v14.16B, v6.16B                   // ...l..................................................................
        aesr v5.16b, v18.16b                          // ...*..................................................................
        rev w11, w11                                  // ...e..................................................................
        rev w23, w19                                  // ...e..................................................................
        pmull v6.1q, v8.1d, v7.1d                     // ....l.................................................................
        eor v14.16B, v29.16B, v31.16B                 // ....l.................................................................
        rev w20, w29                                  // ....e.................................................................
        eor v29.16B, v4.16B, v10.16B                  // .....l................................................................
        aesr v5.16b, v19.16b                          // .....*................................................................
        str w20, [sp, #STACK_BASE_AES_ST + 60]        // .....e................................................................    // @slothy:writes=stack_3
        eor v31.16B, v14.16B, v8.16B                  // ......l...............................................................
        aesr v13.16b, v18.16b                         // ......*...............................................................
        eor v8.16B, v29.16B, v0.16B                   // .......l..............................................................
        aesr v5.16b, v20.16b                          // .......*..............................................................
        eor v6.16B, v9.16B, v6.16B                    // ........l.............................................................
        aesr v13.16b, v19.16b                         // ........*.............................................................
        ldr q12, [x6]                                 // .........*............................................................
        aesr v5.16b, v21.16b                          // .........*............................................................
        eor v31.16B, v8.16B, v31.16B                  // ..........l...........................................................
        aesr v13.16b, v20.16b                         // ..........*...........................................................
        ldr q4, [x0, #16]                             // ...........*..........................................................
        aesr v5.16b, v22.16b                          // ...........*..........................................................
        eor v0.16B, v31.16B, v6.16B                   // ............l.........................................................
        aesr v13.16b, v21.16b                         // ............*.........................................................
        aesr v5.16b, v23.16b                          // .............*........................................................
        ldr q31, [x6, #64]                            // .............*........................................................
        pmull v6.1q, v0.1d, v7.1d                     // ..............l.......................................................
        ldr q9, [x0, #48]                             // ..............*.......................................................
        aesr v13.16b, v22.16b                         // ...............*......................................................
        ext v29.16B, v0.16B, v0.16B, #8               // ...............l......................................................
        str w23, [sp, #STACK_BASE_AES_ST + 28]        // ...............e......................................................    // @slothy:writes=stack_1
        eor v8.16B, v14.16B, v6.16B                   // ................l.....................................................
        aesr v5.16b, v24.16b                          // ................*.....................................................
        str w27, [sp, #STACK_BASE_AES_ST + 12]        // ................e.....................................................    // @slothy:writes=stack_0
        eor v6.16B, v11.16B, v2.16B                   // .................*....................................................
        aesr v13.16b, v23.16b                         // .................*....................................................
        str w11, [sp, #STACK_BASE_AES_ST + 44]        // .................e....................................................    // @slothy:writes=stack_2
        aesr v5.16b, v25.16b                          // ..................*...................................................
        ldr q11, [x0], #(4*16)                        // ..................*...................................................
        eor v14.16B, v8.16B, v29.16B                  // ...................l..................................................
        aesr v13.16b, v24.16b                         // ...................*..................................................
        eor v29.16B, v9.16B, v2.16B                   // ....................*.................................................
        aesr v5.16b, v26.16b                          // ....................*.................................................
        ext v30.16B, v14.16B, v14.16B, #8             // .....................l................................................
        aesr v3.16b, v16.16b                          // .....................*................................................
        eor v9.16B, v11.16B, v2.16B                   // ......................*...............................................
        aesr v5.16b, v27.16b                          // ......................*...............................................
        aese v3.16b, v17.16b                          // .......................*..............................................
        aesr v5.16b, v28.16b                          // ........................*.............................................
        eor v14.16B, v29.16B, v3.16B                  // .........................*............................................
        aesr v1.16b, v26.16b                          // .........................*............................................
        eor v3.16B, v4.16B, v2.16B                    // ..........................*...........................................
        aesr v5.16b, v15.16b                          // ..........................*...........................................
        aesr v1.16b, v27.16b                          // ...........................*..........................................
        rev64 v8.16B, v14.16B                         // ...........................*..........................................
        aesr v5.16b, v16.16b                          // ............................*.........................................
        ldr q4, [x6, #32]                             // ............................*.........................................
        aesr v1.16b, v28.16b                          // .............................*........................................
        aese v5.16b, v17.16b                          // ..............................*.......................................
        aesr v1.16b, v15.16b                          // ...............................*......................................
        eor v6.16B, v6.16B, v5.16B                    // ................................*.....................................
        pmull2 v10.1q, v8.2d, v12.2d                  // ................................*.....................................
        ldr q5, [x6, #48]                             // .................................*....................................
        aesr v1.16b, v16.16b                          // .................................*....................................
        aesr v13.16b, v25.16b                         // ..................................*...................................
        rev64 v0.16B, v6.16B                          // ..................................*...................................
        str q6, [x2, #32]                             // ...................................*..................................
        aese v1.16b, v17.16b                          // ...................................*..................................
        ext v6.16B, v0.16B, v0.16B, #8                // ....................................*.................................
        pmull2 v11.1q, v0.2d, v4.2d                   // ....................................*.................................
        eor v29.16B, v3.16B, v1.16B                   // .....................................*................................
        pmull v3.1q, v0.1d, v4.1d                     // .....................................*................................
        eor v4.16B, v10.16B, v11.16B                  // ......................................*...............................
        aesr v13.16b, v26.16b                         // ......................................*...............................
        pmull v12.1q, v8.1d, v12.1d                   // .......................................*..............................
        rev64 v10.16B, v29.16B                        // .......................................*..............................
        ldr q1, [sp, #STACK_BASE_AES_ST + 16]         // ........................................e.............................    // @slothy:reads=stack_1
        aesr v13.16b, v27.16b                         // ........................................*.............................
        eor v12.16B, v12.16B, v3.16B                  // .........................................*............................
        pmull2 v11.1q, v10.2d, v5.2d                  // .........................................*............................
        ldr q3, [sp, #STACK_BASE_AES_ST + 48]         // ..........................................e...........................    // @slothy:reads=stack_3
        pmull v5.1q, v10.1d, v5.1d                    // ..........................................*...........................
        str q29, [x2, #16]                            // ...........................................*..........................
        aesr v13.16b, v28.16b                         // ...........................................*..........................
        aesr v1.16b, v18.16b                          // ............................................e.........................
        eor v29.16B, v12.16B, v5.16B                  // ............................................*.........................
        eor v12.16B, v6.16B, v0.16B                   // .............................................*........................
        aesr v13.16b, v15.16b                         // .............................................*........................
        aesr v3.16b, v18.16b                          // ..............................................e.......................
        mov d0, v10.d[1]                              // ..............................................*.......................
        aesr v13.16b, v16.16b                         // ...............................................*......................
        eor v10.8B, v0.8B, v10.8B                     // ................................................*.....................
        aesr v3.16b, v19.16b                          // ................................................e.....................
        aese v13.16b, v17.16b                         // .................................................*....................
        aesr v3.16b, v20.16b                          // ..................................................e...................
        eor v5.16B, v9.16B, v13.16B                   // ...................................................*..................
        aesr v1.16b, v19.16b                          // ...................................................e..................
        ldr q13, [x6, #16]                            // ....................................................*.................
        aesr v3.16b, v21.16b                          // ....................................................e.................
        aesr v1.16b, v20.16b                          // .....................................................e................
        rev64 v0.16B, v5.16B                          // .....................................................*................
        str q5, [x2], #(4*16)                         // ......................................................*...............
        aesr v3.16b, v22.16b                          // ......................................................e...............
        eor v30.16B, v0.16B, v30.16B                  // .......................................................*..............
        aesr v1.16b, v21.16b                          // .......................................................e..............
        ldr q5, [sp, #STACK_BASE_AES_ST + 32]         // ........................................................e.............    // @slothy:reads=stack_2
        aesr v3.16b, v23.16b                          // ........................................................e.............
        pmull v10.1q, v10.1d, v31.1d                  // .........................................................*............
        ext v0.16B, v30.16B, v30.16B, #8              // .........................................................*............
        eor v9.16B, v4.16B, v11.16B                   // ..........................................................*...........
        aesr v3.16b, v24.16b                          // ..........................................................e...........
        eor v0.16B, v0.16B, v30.16B                   // ...........................................................*..........
        aesr v1.16b, v22.16b                          // ...........................................................e..........
        aesr v3.16b, v25.16b                          // ............................................................e.........
        ldr q4, [x6, #80]                             // ............................................................*.........
        pmull2 v0.1q, v0.2d, v31.2d                   // .............................................................*........
        mov d31, v8.d[1]                              // .............................................................*........
        aesr v1.16b, v23.16b                          // ..............................................................e.......
        eor v31.8B, v31.8B, v8.8B                     // ...............................................................*......
        aesr v3.16b, v26.16b                          // ...............................................................e......
        pmull2 v11.1q, v30.2d, v4.2d                  // ................................................................*.....
        aesr v3.16b, v27.16b                          // .................................................................e....
        pmull2 v6.1q, v12.2d, v13.2d                  // ..................................................................*...
        eor v8.16B, v9.16B, v11.16B                   // ..................................................................*...
        aesr v3.16b, v28.16b                          // ...................................................................e..
        aesr v1.16b, v24.16b                          // ....................................................................e.
        ext v9.16B, v8.16B, v8.16B, #8                // ....................................................................*.
        aesr v3.16b, v15.16b                          // .....................................................................e

                                                                        // ----------------------------------------------------------------------- cycle (expected) ------------------------------------------------------------------------>
                                                                        // 0                        25                       50                       75                       100                      125                      150
                                                                        // |------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|-----------
        // ldr q12, [x6]                                                   // .........~............................................................'........*............................................................'........~............
        // ldr q13, [x6, #32]                                              // ............................~.........................................'...........................*.........................................'.....................
        // ldr q14, [x6, #16]                                              // ....................................................~.................'...................................................*.................'.....................
        // ldr q29, [x0, #(3*16)]                                          // ..............~.......................................................'.............*.......................................................'.............~.......
        // add        w14, w13, #3                                         // e.....................................................................~.....................................................................~.....................
        // rev        w14, w14                                             // ....e.................................................................'...~.................................................................'...~.................
        // str        w14, [sp, #(STACK_BASE_AES_ST + 3*16 + 12)]          // .....e................................................................'....~................................................................'....~................
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 3*16)]                // ..........................................e...........................'.........................................~...........................'.....................
        // aesr v0.16b, v18.16b                                            // ..............................................e.......................'.............................................~.......................'.....................
        // aesr v0.16b, v19.16b                                            // ................................................e.....................'...............................................~.....................'.....................
        // aesr v0.16b, v20.16b                                            // ..................................................e...................'.................................................~...................'.....................
        // aesr v0.16b, v21.16b                                            // ....................................................e.................'...................................................~.................'.....................
        // aesr v0.16b, v22.16b                                            // ......................................................e...............'.....................................................~...............'.....................
        // aesr v0.16b, v23.16b                                            // ........................................................e.............'.......................................................~.............'.....................
        // aesr v0.16b, v24.16b                                            // ..........................................................e...........'.........................................................~...........'.....................
        // aesr v0.16b, v25.16b                                            // ............................................................e.........'...........................................................~.........'.....................
        // aesr v0.16b, v26.16b                                            // ...............................................................e......'..............................................................~......'.....................
        // aesr v0.16b, v27.16b                                            // .................................................................e....'................................................................~....'.....................
        // aesr v0.16b, v28.16b                                            // ...................................................................e..'..................................................................~..'.....................
        // aesr v0.16b, v15.16b                                            // .....................................................................e'....................................................................~'.....................
        // aesr v0.16b, v16.16b                                            // .....................~................................................'....................*................................................'.....................
        // aese v0.16b, v17.16b                                            // .......................~..............................................'......................*..............................................'.....................
        // eor v29.16b, v29.16b, v2.16b                                    // ....................~.................................................'...................*.................................................'...................~.
        // eor v0.16b, v29.16b, v0.16b                                     // .........................~............................................'........................*............................................'.....................
        // str q0, [x2, #(3*16)]                                           // ~.....................................................................~.....................................................................l.....................
        // rev64 v0.16b, v0.16b                                            // ...........................~..........................................'..........................*..........................................'.....................
        // pmull   v8.1q, v0.1d, v12.1d                                    // .......................................~..............................'......................................*..............................'.....................
        // pmull2  v9.1q, v0.2d, v12.2d                                    // ................................~.....................................'...............................*.....................................'.....................
        // mov     d11, v0.d[1]                                            // .............................................................~........'............................................................*........'.....................
        // eor     v11.8b, v11.8b, v0.8b                                   // ...............................................................~......'..............................................................*......'.....................
        // pmull   v10.1q, v11.1d, v14.1d                                  // .~....................................................................'~....................................................................'l....................
        // ldr q29, [x0, #(2*16)]                                          // .~....................................................................'*....................................................................'~....................
        // add        w14, w13, #2                                         // ..e...................................................................'.~...................................................................'.~...................
        // rev        w14, w14                                             // ...e..................................................................'..~..................................................................'..~..................
        // str        w14, [sp, #(STACK_BASE_AES_ST + 2*16 + 12)]          // .................e....................................................'................~....................................................'................~....
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 2*16)]                // ........................................................e.............'.......................................................~.............'.....................
        // aesr v0.16b, v18.16b                                            // ...~..................................................................'..*..................................................................'..~..................
        // aesr v0.16b, v19.16b                                            // .....~................................................................'....*................................................................'....~................
        // aesr v0.16b, v20.16b                                            // .......~..............................................................'......*..............................................................'......~..............
        // aesr v0.16b, v21.16b                                            // .........~............................................................'........*............................................................'........~............
        // aesr v0.16b, v22.16b                                            // ...........~..........................................................'..........*..........................................................'..........~..........
        // aesr v0.16b, v23.16b                                            // .............~........................................................'............*........................................................'............~........
        // aesr v0.16b, v24.16b                                            // ................~.....................................................'...............*.....................................................'...............~.....
        // aesr v0.16b, v25.16b                                            // ..................~...................................................'.................*...................................................'.................~...
        // aesr v0.16b, v26.16b                                            // ....................~.................................................'...................*.................................................'...................~.
        // aesr v0.16b, v27.16b                                            // ......................~...............................................'.....................*...............................................'.....................
        // aesr v0.16b, v28.16b                                            // ........................~.............................................'.......................*.............................................'.....................
        // aesr v0.16b, v15.16b                                            // ..........................~...........................................'.........................*...........................................'.....................
        // aesr v0.16b, v16.16b                                            // ............................~.........................................'...........................*.........................................'.....................
        // aese v0.16b, v17.16b                                            // ..............................~.......................................'.............................*.......................................'.....................
        // eor v29.16b, v29.16b, v2.16b                                    // .................~....................................................'................*....................................................'................~....
        // eor v0.16b, v29.16b, v0.16b                                     // ................................~.....................................'...............................*.....................................'.....................
        // str q0, [x2, #(2*16)]                                           // ...................................~..................................'..................................*..................................'.....................
        // rev64   v0.16b, v0.16b                                          // ..................................~...................................'.................................*...................................'.....................
        // pmull   v11.1q, v0.1d, v13.1d                                   // .....................................~................................'....................................*................................'.....................
        // eor     v8.16b, v8.16b, v11.16b                                 // .........................................~............................'........................................*............................'.....................
        // pmull2  v11.1q, v0.2d, v13.2d                                   // ....................................~.................................'...................................*.................................'.....................
        // eor     v9.16b, v9.16b, v11.16b                                 // ......................................~...............................'.....................................*...............................'.....................
        // ext     v11.16b, v0.16b, v0.16b, #8                             // ....................................~.................................'...................................*.................................'.....................
        // eor     v11.16b, v11.16b, v0.16b                                // .............................................~........................'............................................*........................'.....................
        // pmull2  v11.1q, v11.2d, v14.2d                                  // ..................................................................~...'.................................................................*...'.....................
        // eor     v10.16b, v10.16b, v11.16b                               // ...~..................................................................'..~..................................................................'..l..................
        // ldr q12, [x6, #48]                                              // .................................~....................................'................................*....................................'.....................
        // ldr q13, [x6, #80]                                              // ............................................................~.........'...........................................................*.........'.....................
        // ldr q14, [x6, #64]                                              // .............~........................................................'............*........................................................'............~........
        // ldr q29, [x0, #(1*16)]                                          // ...........~..........................................................'..........*..........................................................'..........~..........
        // add        w14, w13, #1                                         // .e....................................................................'~....................................................................'~....................
        // rev        w14, w14                                             // ...e..................................................................'..~..................................................................'..~..................
        // str        w14, [sp, #(STACK_BASE_AES_ST + 1*16 + 12)]          // ...............e......................................................'..............~......................................................'..............~......
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 1*16)]                // ........................................e.............................'.......................................~.............................'.....................
        // aesr v0.16b, v18.16b                                            // ............................................e.........................'...........................................~.........................'.....................
        // aesr v0.16b, v19.16b                                            // ...................................................e..................'..................................................~..................'.....................
        // aesr v0.16b, v20.16b                                            // .....................................................e................'....................................................~................'.....................
        // aesr v0.16b, v21.16b                                            // .......................................................e..............'......................................................~..............'.....................
        // aesr v0.16b, v22.16b                                            // ...........................................................e..........'..........................................................~..........'.....................
        // aesr v0.16b, v23.16b                                            // ..............................................................e.......'.............................................................~.......'.....................
        // aesr v0.16b, v24.16b                                            // ....................................................................e.'...................................................................~.'.....................
        // aesr v0.16b, v25.16b                                            // ~.....................................................................*.....................................................................~.....................
        // aesr v0.16b, v26.16b                                            // .........................~............................................'........................*............................................'.....................
        // aesr v0.16b, v27.16b                                            // ...........................~..........................................'..........................*..........................................'.....................
        // aesr v0.16b, v28.16b                                            // .............................~........................................'............................*........................................'.....................
        // aesr v0.16b, v15.16b                                            // ...............................~......................................'..............................*......................................'.....................
        // aesr v0.16b, v16.16b                                            // .................................~....................................'................................*....................................'.....................
        // aese v0.16b, v17.16b                                            // ...................................~..................................'..................................*..................................'.....................
        // eor v29.16b, v29.16b, v2.16b                                    // ..........................~...........................................'.........................*...........................................'.....................
        // eor v0.16b, v29.16b, v0.16b                                     // .....................................~................................'....................................*................................'.....................
        // str q0, [x2, #(1*16)]                                           // ...........................................~..........................'..........................................*..........................'.....................
        // rev64   v0.16b, v0.16b                                          // .......................................~..............................'......................................*..............................'.....................
        // pmull   v11.1q, v0.1d, v12.1d                                   // ..........................................~...........................'.........................................*...........................'.....................
        // eor     v8.16b, v8.16b, v11.16b                                 // ............................................~.........................'...........................................*.........................'.....................
        // pmull2  v11.1q, v0.2d, v12.2d                                   // .........................................~............................'........................................*............................'.....................
        // eor     v9.16b, v9.16b, v11.16b                                 // ..........................................................~...........'.........................................................*...........'.....................
        // mov     d11, v0.d[1]                                            // ..............................................~.......................'.............................................*.......................'.....................
        // eor     v11.8b, v11.8b, v0.8b                                   // ................................................~.....................'...............................................*.....................'.....................
        // pmull   v11.1q, v11.1d, v14.1d                                  // .........................................................~............'........................................................*............'.....................
        // eor     v10.16b, v10.16b, v11.16b                               // .....~................................................................'....~................................................................'....l................
        // ldr q29, [x0], #(4*16)                                          // ..................~...................................................'.................*...................................................'.................~...
        // add        w14, w13, #0                                         // e.....................................................................~.....................................................................~.....................
        // rev        w14, w14                                             // .e....................................................................'~....................................................................'~....................
        // str        w14, [sp, #(STACK_BASE_AES_ST + 0*16 + 12)]          // ................e.....................................................'...............~.....................................................'...............~.....
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 0*16)]                // ..~...................................................................'.*...................................................................'.~...................
        // aesr v0.16b, v18.16b                                            // ......~...............................................................'.....*...............................................................'.....~...............
        // aesr v0.16b, v19.16b                                            // ........~.............................................................'.......*.............................................................'.......~.............
        // aesr v0.16b, v20.16b                                            // ..........~...........................................................'.........*...........................................................'.........~...........
        // aesr v0.16b, v21.16b                                            // ............~.........................................................'...........*.........................................................'...........~.........
        // aesr v0.16b, v22.16b                                            // ...............~......................................................'..............*......................................................'..............~......
        // aesr v0.16b, v23.16b                                            // .................~....................................................'................*....................................................'................~....
        // aesr v0.16b, v24.16b                                            // ...................~..................................................'..................*..................................................'..................~..
        // aesr v0.16b, v25.16b                                            // ..................................~...................................'.................................*...................................'.....................
        // aesr v0.16b, v26.16b                                            // ......................................~...............................'.....................................*...............................'.....................
        // aesr v0.16b, v27.16b                                            // ........................................~.............................'.......................................*.............................'.....................
        // aesr v0.16b, v28.16b                                            // ...........................................~..........................'..........................................*..........................'.....................
        // aesr v0.16b, v15.16b                                            // .............................................~........................'............................................*........................'.....................
        // aesr v0.16b, v16.16b                                            // ...............................................~......................'..............................................*......................'.....................
        // aese v0.16b, v17.16b                                            // .................................................~....................'................................................*....................'.....................
        // eor v29.16b, v29.16b, v2.16b                                    // ......................~...............................................'.....................*...............................................'.....................
        // eor v0.16b, v29.16b, v0.16b                                     // ...................................................~..................'..................................................*..................'.....................
        // str q0, [x2], #(4*16)                                           // ......................................................~...............'.....................................................*...............'.....................
        // rev64   v0.16b, v0.16b                                          // .....................................................~................'....................................................*................'.....................
        // eor   v0.16b, v0.16b, v30.16b                                   // .......................................................~..............'......................................................*..............'.....................
        // pmull   v11.1q, v0.1d, v13.1d                                   // ..~...................................................................'.~...................................................................'.l...................
        // eor     v8.16b, v8.16b, v11.16b                                 // ....~.................................................................'...~.................................................................'...l.................
        // pmull2  v11.1q, v0.2d, v13.2d                                   // ................................................................~.....'...............................................................*.....'.....................
        // eor     v9.16b, v9.16b, v11.16b                                 // ..................................................................~...'.................................................................*...'.....................
        // ext     v11.16b, v0.16b, v0.16b, #8                             // .........................................................~............'........................................................*............'.....................
        // eor     v11.16b, v11.16b, v0.16b                                // ...........................................................~..........'..........................................................*..........'.....................
        // pmull2  v11.1q, v11.2d, v14.2d                                  // .............................................................~........'............................................................*........'.....................
        // eor     v10.16b, v10.16b, v11.16b                               // .......~..............................................................'......~..............................................................'......l..............
        // eor        v0.16b, v8.16b,  v9.16b                              // ......~...............................................................'.....~...............................................................'.....l...............
        // pmull      v1.1q,  v9.1d,   v7.1d                               // ....~.................................................................'...~.................................................................'...l.................
        // ext        v9.16b,    v9.16b,  v9.16b, #8                       // ....................................................................~.'...................................................................*.'.....................
        // eor        v10.16b,   v10.16b, v0.16b                           // ..........~...........................................................'.........~...........................................................'.........l...........
        // eor        v1.16b, v9.16b,  v1.16b                              // ........~.............................................................'.......~.............................................................'.......l.............
        // eor        v10.16b,   v10.16b, v1.16b                           // ............~.........................................................'...........~.........................................................'...........l.........
        // pmull      v9.1q,     v10.1d,  v7.1d                            // ..............~.......................................................'.............~.......................................................'.............l.......
        // eor        v8.16b,    v8.16b,  v9.16b                           // ................~.....................................................'...............~.....................................................'...............l.....
        // ext        v10.16b,   v10.16b, v10.16b, #8                      // ...............~......................................................'..............~......................................................'..............l......
        // eor        v30.16b,     v8.16b,  v10.16b                        // ...................~..................................................'..................~..................................................'..................l..
        // ext        v30.16b, v30.16b, v30.16b, #8                        // .....................~................................................'....................~................................................'....................l
        // add w13, w13, #UNROLL                                           // ..e...................................................................'.~...................................................................'.~...................

        sub count, count, #1
        cbnz count, Lloop_unrolled_start
Lloop_unrolled_start_postamble:// end of loop kernel
                                                // Instructions:    122
                                                // Expected cycles: 69
                                                // Expected IPC:    1.77

                                                // Cycle bound:     69.0
                                                // IPC bound:       1.77

                                                // Wall time:     35.23s
                                                // User time:     35.23s

                                                // ------------------------- cycle (expected) ------------------------->
                                                // 0                        25                       50
                                                // |------------------------|------------------------|------------------
        pmull v31.1q, v31.1d, v13.1d            // *....................................................................
        ldr q13, [x0, #32]                      // *....................................................................
        pmull v11.1q, v30.1d, v4.1d             // .*...................................................................
        ldr q4, [sp, #STACK_BASE_AES_ST]        // .*...................................................................    // @slothy:reads=stack_0
        ldr q12, [x6, #80]                      // ..*..................................................................
        aesr v3.16b, v16.16b                    // ..*..................................................................
        eor v31.16B, v31.16B, v6.16B            // ...*.................................................................
        pmull v6.1q, v8.1d, v7.1d               // ...*.................................................................
        eor v29.16B, v29.16B, v11.16B           // ....*................................................................
        aesr v5.16b, v18.16b                    // ....*................................................................
        eor v10.16B, v31.16B, v10.16B           // .....*...............................................................
        aesr v4.16b, v18.16b                    // .....*...............................................................
        eor v8.16B, v29.16B, v8.16B             // ......*..............................................................
        aese v3.16b, v17.16b                    // ......*..............................................................
        aesr v4.16b, v19.16b                    // .......*.............................................................
        eor v31.16B, v9.16B, v6.16B             // .......*.............................................................
        eor v10.16B, v10.16B, v0.16B            // ........*............................................................
        aesr v5.16b, v19.16b                    // ........*............................................................
        ldr q11, [x6, #48]                      // .........*...........................................................
        aesr v4.16b, v20.16b                    // .........*...........................................................
        eor v0.16B, v10.16B, v8.16B             // ..........*..........................................................
        aesr v1.16b, v25.16b                    // ..........*..........................................................
        ldr q8, [x6, #32]                       // ...........*.........................................................
        aesr v4.16b, v21.16b                    // ...........*.........................................................
        eor v31.16B, v0.16B, v31.16B            // ............*........................................................
        aesr v5.16b, v20.16b                    // ............*........................................................
        aesr v4.16b, v22.16b                    // .............*.......................................................
        ldr q30, [x0, #48]                      // .............*.......................................................
        pmull v10.1q, v31.1d, v7.1d             // ..............*......................................................
        ldr q6, [x0, #16]                       // ..............*......................................................
        aesr v4.16b, v23.16b                    // ...............*.....................................................
        ext v9.16B, v31.16B, v31.16B, #8        // ...............*.....................................................
        eor v31.16B, v29.16B, v10.16B           // ................*....................................................
        aesr v5.16b, v21.16b                    // ................*....................................................
        aesr v4.16b, v24.16b                    // .................*...................................................
        eor v30.16B, v30.16B, v2.16B            // .................*...................................................
        eor v31.16B, v31.16B, v9.16B            // ..................*..................................................
        aesr v5.16b, v22.16b                    // ..................*..................................................
        eor v10.16B, v30.16B, v3.16B            // ...................*.................................................
        aesr v4.16b, v25.16b                    // ...................*.................................................
        ext v3.16B, v31.16B, v31.16B, #8        // ....................*................................................
        aesr v5.16b, v23.16b                    // ....................*................................................
        eor v30.16B, v6.16B, v2.16B             // .....................*...............................................
        aesr v4.16b, v26.16b                    // .....................*...............................................
        ldr q0, [x0], #(4*16)                   // ......................*..............................................
        aesr v5.16b, v24.16b                    // ......................*..............................................
        aesr v4.16b, v27.16b                    // .......................*.............................................
        ldr q31, [x6, #64]                      // ........................*............................................
        aesr v5.16b, v25.16b                    // ........................*............................................
        ldr q6, [x6]                            // .........................*...........................................
        aesr v4.16b, v28.16b                    // .........................*...........................................
        eor v9.16B, v0.16B, v2.16B              // ..........................*..........................................
        aesr v5.16b, v26.16b                    // ..........................*..........................................
        str q14, [x2, #-16]                     // ...........................*.........................................
        aesr v4.16b, v15.16b                    // ...........................*.........................................
        aesr v5.16b, v27.16b                    // ............................*........................................
        str q10, [x2, #48]                      // ............................*........................................
        rev64 v29.16B, v10.16B                  // .............................*.......................................
        aesr v4.16b, v16.16b                    // .............................*.......................................
        eor v10.16B, v13.16B, v2.16B            // ..............................*......................................
        aesr v1.16b, v26.16b                    // ..............................*......................................
        mov d0, v29.d[1]                        // ...............................*.....................................
        aese v4.16b, v17.16b                    // ...............................*.....................................
        aesr v5.16b, v28.16b                    // ................................*....................................
        aesr v1.16b, v27.16b                    // .................................*...................................
        eor v14.16B, v9.16B, v4.16B             // .................................*...................................
        eor v0.8B, v0.8B, v29.8B                // ..................................*..................................
        aesr v5.16b, v15.16b                    // ..................................*..................................
        aesr v1.16b, v28.16b                    // ...................................*.................................
        rev64 v4.16B, v14.16B                   // ...................................*.................................
        str q14, [x2], #(4*16)                  // ....................................*................................
        aesr v5.16b, v16.16b                    // ....................................*................................
        aesr v1.16b, v15.16b                    // .....................................*...............................
        eor v4.16B, v4.16B, v3.16B              // .....................................*...............................
        aese v5.16b, v17.16b                    // ......................................*..............................
        ldr q3, [x6, #16]                       // ......................................*..............................
        ext v9.16B, v4.16B, v4.16B, #8          // .......................................*.............................
        aesr v1.16b, v16.16b                    // .......................................*.............................
        pmull v13.1q, v29.1d, v6.1d             // ........................................*............................
        eor v14.16B, v10.16B, v5.16B            // ........................................*............................
        eor v9.16B, v9.16B, v4.16B              // .........................................*...........................
        aese v1.16b, v17.16b                    // .........................................*...........................
        pmull v0.1q, v0.1d, v3.1d               // ..........................................*..........................
        rev64 v5.16B, v14.16B                   // ..........................................*..........................
        eor v10.16B, v30.16B, v1.16B            // ...........................................*.........................
        pmull2 v29.1q, v29.2d, v6.2d            // ...........................................*.........................
        ext v30.16B, v5.16B, v5.16B, #8         // ............................................*........................
        pmull v6.1q, v5.1d, v8.1d               // ............................................*........................
        rev64 v1.16B, v10.16B                   // .............................................*.......................
        pmull2 v8.1q, v5.2d, v8.2d              // .............................................*.......................
        eor v13.16B, v13.16B, v6.16B            // ..............................................*......................
        eor v30.16B, v30.16B, v5.16B            // ..............................................*......................
        pmull2 v6.1q, v1.2d, v11.2d             // ...............................................*.....................
        eor v8.16B, v29.16B, v8.16B             // ...............................................*.....................
        pmull v5.1q, v1.1d, v11.1d              // ................................................*....................
        mov d29, v1.d[1]                        // ................................................*....................
        pmull v11.1q, v4.1d, v12.1d             // .................................................*...................
        eor v8.16B, v8.16B, v6.16B              // .................................................*...................
        pmull2 v30.1q, v30.2d, v3.2d            // ..................................................*..................
        eor v29.8B, v29.8B, v1.8B               // ..................................................*..................
        eor v3.16B, v13.16B, v5.16B             // ...................................................*.................
        pmull2 v1.1q, v4.2d, v12.2d             // ...................................................*.................
        eor v0.16B, v0.16B, v30.16B             // ....................................................*................
        pmull v29.1q, v29.1d, v31.1d            // ....................................................*................
        eor v6.16B, v8.16B, v1.16B              // .....................................................*...............
        eor v13.16B, v3.16B, v11.16B            // .....................................................*...............
        eor v30.16B, v0.16B, v29.16B            // ......................................................*..............
        pmull2 v5.1q, v9.2d, v31.2d             // ......................................................*..............
        pmull v29.1q, v6.1d, v7.1d              // .......................................................*.............
        eor v31.16B, v13.16B, v6.16B            // .......................................................*.............
        eor v11.16B, v30.16B, v5.16B            // ........................................................*............
        ext v0.16B, v6.16B, v6.16B, #8          // ........................................................*............
        str q10, [x2, #-48]                     // .........................................................*...........
        str q14, [x2, #-32]                     // .........................................................*...........
        eor v1.16B, v11.16B, v31.16B            // ..........................................................*..........
        eor v8.16B, v0.16B, v29.16B             // ..........................................................*..........
        eor v0.16B, v1.16B, v8.16B              // ............................................................*........
        ext v10.16B, v0.16B, v0.16B, #8         // ..............................................................*......
        pmull v3.1q, v0.1d, v7.1d               // ..............................................................*......
        eor v12.16B, v13.16B, v3.16B            // ................................................................*....
        eor v5.16B, v12.16B, v10.16B            // ..................................................................*..
        ext v30.16B, v5.16B, v5.16B, #8         // ....................................................................*

                                                  // ------------------------- cycle (expected) ------------------------->
                                                  // 0                        25                       50
                                                  // |------------------------|------------------------|------------------
        // aesr v1.16b, v25.16b                      // ..........*..........................................................
        // str q14, [x2, #-16]                       // ...........................*.........................................
        // pmull v14.1q, v31.1d, v13.1d              // *....................................................................
        // ldr q11, [x0, #32]                        // *....................................................................
        // pmull v31.1q, v30.1d, v4.1d               // .*...................................................................
        // ldr q13, [sp, #STACK_BASE_AES_ST]         // .*...................................................................
        // eor v4.16B, v14.16B, v6.16B               // ...*.................................................................
        // aesr v5.16b, v18.16b                      // ....*................................................................
        // pmull v6.1q, v8.1d, v7.1d                 // ...*.................................................................
        // eor v14.16B, v29.16B, v31.16B             // ....*................................................................
        // eor v29.16B, v4.16B, v10.16B              // .....*...............................................................
        // aesr v5.16b, v19.16b                      // ........*............................................................
        // eor v31.16B, v14.16B, v8.16B              // ......*..............................................................
        // aesr v13.16b, v18.16b                     // .....*...............................................................
        // eor v8.16B, v29.16B, v0.16B               // ........*............................................................
        // aesr v5.16b, v20.16b                      // ............*........................................................
        // eor v6.16B, v9.16B, v6.16B                // .......*.............................................................
        // aesr v13.16b, v19.16b                     // .......*.............................................................
        // ldr q12, [x6]                             // .........................*...........................................
        // aesr v5.16b, v21.16b                      // ................*....................................................
        // eor v31.16B, v8.16B, v31.16B              // ..........*..........................................................
        // aesr v13.16b, v20.16b                     // .........*...........................................................
        // ldr q4, [x0, #16]                         // ..............*......................................................
        // aesr v5.16b, v22.16b                      // ..................*..................................................
        // eor v0.16B, v31.16B, v6.16B               // ............*........................................................
        // aesr v13.16b, v21.16b                     // ...........*.........................................................
        // aesr v5.16b, v23.16b                      // ....................*................................................
        // ldr q31, [x6, #64]                        // ........................*............................................
        // pmull v6.1q, v0.1d, v7.1d                 // ..............*......................................................
        // ldr q9, [x0, #48]                         // .............*.......................................................
        // aesr v13.16b, v22.16b                     // .............*.......................................................
        // ext v29.16B, v0.16B, v0.16B, #8           // ...............*.....................................................
        // eor v8.16B, v14.16B, v6.16B               // ................*....................................................
        // aesr v5.16b, v24.16b                      // ......................*..............................................
        // eor v6.16B, v11.16B, v2.16B               // ..............................*......................................
        // aesr v13.16b, v23.16b                     // ...............*.....................................................
        // aesr v5.16b, v25.16b                      // ........................*............................................
        // ldr q11, [x0], #(4*16)                    // ......................*..............................................
        // eor v14.16B, v8.16B, v29.16B              // ..................*..................................................
        // aesr v13.16b, v24.16b                     // .................*...................................................
        // eor v29.16B, v9.16B, v2.16B               // .................*...................................................
        // aesr v5.16b, v26.16b                      // ..........................*..........................................
        // ext v30.16B, v14.16B, v14.16B, #8         // ....................*................................................
        // aesr v3.16b, v16.16b                      // ..*..................................................................
        // eor v9.16B, v11.16B, v2.16B               // ..........................*..........................................
        // aesr v5.16b, v27.16b                      // ............................*........................................
        // aese v3.16b, v17.16b                      // ......*..............................................................
        // aesr v5.16b, v28.16b                      // ................................*....................................
        // eor v14.16B, v29.16B, v3.16B              // ...................*.................................................
        // aesr v1.16b, v26.16b                      // ..............................*......................................
        // eor v3.16B, v4.16B, v2.16B                // .....................*...............................................
        // aesr v5.16b, v15.16b                      // ..................................*..................................
        // aesr v1.16b, v27.16b                      // .................................*...................................
        // rev64 v8.16B, v14.16B                     // .............................*.......................................
        // aesr v5.16b, v16.16b                      // ....................................*................................
        // ldr q4, [x6, #32]                         // ...........*.........................................................
        // aesr v1.16b, v28.16b                      // ...................................*.................................
        // aese v5.16b, v17.16b                      // ......................................*..............................
        // aesr v1.16b, v15.16b                      // .....................................*...............................
        // eor v6.16B, v6.16B, v5.16B                // ........................................*............................
        // pmull2 v10.1q, v8.2d, v12.2d              // ...........................................*.........................
        // ldr q5, [x6, #48]                         // .........*...........................................................
        // aesr v1.16b, v16.16b                      // .......................................*.............................
        // aesr v13.16b, v25.16b                     // ...................*.................................................
        // rev64 v0.16B, v6.16B                      // ..........................................*..........................
        // str q6, [x2, #32]                         // .........................................................*...........
        // aese v1.16b, v17.16b                      // .........................................*...........................
        // ext v6.16B, v0.16B, v0.16B, #8            // ............................................*........................
        // pmull2 v11.1q, v0.2d, v4.2d               // .............................................*.......................
        // eor v29.16B, v3.16B, v1.16B               // ...........................................*.........................
        // pmull v3.1q, v0.1d, v4.1d                 // ............................................*........................
        // eor v4.16B, v10.16B, v11.16B              // ...............................................*.....................
        // aesr v13.16b, v26.16b                     // .....................*...............................................
        // pmull v12.1q, v8.1d, v12.1d               // ........................................*............................
        // rev64 v10.16B, v29.16B                    // .............................................*.......................
        // aesr v13.16b, v27.16b                     // .......................*.............................................
        // eor v12.16B, v12.16B, v3.16B              // ..............................................*......................
        // pmull2 v11.1q, v10.2d, v5.2d              // ...............................................*.....................
        // pmull v5.1q, v10.1d, v5.1d                // ................................................*....................
        // str q29, [x2, #16]                        // .........................................................*...........
        // aesr v13.16b, v28.16b                     // .........................*...........................................
        // eor v29.16B, v12.16B, v5.16B              // ...................................................*.................
        // eor v12.16B, v6.16B, v0.16B               // ..............................................*......................
        // aesr v13.16b, v15.16b                     // ...........................*.........................................
        // mov d0, v10.d[1]                          // ................................................*....................
        // aesr v13.16b, v16.16b                     // .............................*.......................................
        // eor v10.8B, v0.8B, v10.8B                 // ..................................................*..................
        // aese v13.16b, v17.16b                     // ...............................*.....................................
        // eor v5.16B, v9.16B, v13.16B               // .................................*...................................
        // ldr q13, [x6, #16]                        // ......................................*..............................
        // rev64 v0.16B, v5.16B                      // ...................................*.................................
        // str q5, [x2], #(4*16)                     // ....................................*................................
        // eor v30.16B, v0.16B, v30.16B              // .....................................*...............................
        // pmull v10.1q, v10.1d, v31.1d              // ....................................................*................
        // ext v0.16B, v30.16B, v30.16B, #8          // .......................................*.............................
        // eor v9.16B, v4.16B, v11.16B               // .................................................*...................
        // eor v0.16B, v0.16B, v30.16B               // .........................................*...........................
        // ldr q4, [x6, #80]                         // ..*..................................................................
        // pmull2 v0.1q, v0.2d, v31.2d               // ......................................................*..............
        // mov d31, v8.d[1]                          // ...............................*.....................................
        // eor v31.8B, v31.8B, v8.8B                 // ..................................*..................................
        // pmull2 v11.1q, v30.2d, v4.2d              // ...................................................*.................
        // pmull2 v6.1q, v12.2d, v13.2d              // ..................................................*..................
        // eor v8.16B, v9.16B, v11.16B               // .....................................................*...............
        // ext v9.16B, v8.16B, v8.16B, #8            // ........................................................*............
        // str q14, [x2, #-16]                       // ............................*........................................
        // pmull v14.1q, v31.1d, v13.1d              // ..........................................*..........................
        // pmull v31.1q, v30.1d, v4.1d               // .................................................*...................
        // eor v4.16B, v14.16B, v6.16B               // ....................................................*................
        // pmull v6.1q, v8.1d, v7.1d                 // .......................................................*.............
        // eor v14.16B, v29.16B, v31.16B             // .....................................................*...............
        // eor v29.16B, v4.16B, v10.16B              // ......................................................*..............
        // eor v31.16B, v14.16B, v8.16B              // .......................................................*.............
        // eor v8.16B, v29.16B, v0.16B               // ........................................................*............
        // eor v6.16B, v9.16B, v6.16B                // ..........................................................*..........
        // eor v31.16B, v8.16B, v31.16B              // ..........................................................*..........
        // eor v0.16B, v31.16B, v6.16B               // ............................................................*........
        // pmull v6.1q, v0.1d, v7.1d                 // ..............................................................*......
        // ext v29.16B, v0.16B, v0.16B, #8           // ..............................................................*......
        // eor v8.16B, v14.16B, v6.16B               // ................................................................*....
        // eor v14.16B, v8.16B, v29.16B              // ..................................................................*..
        // ext v30.16B, v14.16B, v14.16B, #8         // ....................................................................*

        b Lloop_unrolled_start_end
Lloop_unrolled_start_iter_1:
                                                      // Instructions:    140
                                                      // Expected cycles: 92
                                                      // Expected IPC:    1.52

                                                      // Cycle bound:     92.0
                                                      // IPC bound:       1.52

                                                      // Wall time:     3.89s
                                                      // User time:     3.89s

                                                      // ------------------------------------ cycle (expected) ------------------------------------->
                                                      // 0                        25                       50                       75
                                                      // |------------------------|------------------------|------------------------|----------------
        ldr q6, [x6]                                  // *...........................................................................................
        add w11, w13, #0                              // *...........................................................................................
        add w24, w13, #2                              // *...........................................................................................
        add w14, w13, #3                              // *...........................................................................................
        ldr q31, [x0, #32]                            // .*..........................................................................................
        rev w11, w11                                  // .*..........................................................................................
        add w27, w13, #1                              // .*..........................................................................................
        ldr q0, [x6, #32]                             // ..*.........................................................................................
        str w11, [sp, #STACK_BASE_AES_ST + 12]        // ..*.........................................................................................    // @slothy:writes=stack_0
        rev w24, w24                                  // ..*.........................................................................................
        rev w14, w14                                  // ..*.........................................................................................
        ldr q3, [x6, #16]                             // ...*........................................................................................
        rev w19, w27                                  // ...*........................................................................................
        str w14, [sp, #STACK_BASE_AES_ST + 60]        // ...*........................................................................................    // @slothy:writes=stack_3
        ldr q10, [x0, #48]                            // ....*.......................................................................................
        ldr q29, [sp, #STACK_BASE_AES_ST]             // ....*.......................................................................................    // @slothy:reads=stack_0
        ldr q8, [sp, #STACK_BASE_AES_ST + 48]         // .....*......................................................................................    // @slothy:reads=stack_3
        str w24, [sp, #STACK_BASE_AES_ST + 44]        // .....*......................................................................................    // @slothy:writes=stack_2
        ldr q13, [x6, #80]                            // ......*.....................................................................................
        ldr q4, [x6, #48]                             // ......*.....................................................................................
        eor v31.16B, v31.16B, v2.16B                  // .......*....................................................................................
        str w19, [sp, #STACK_BASE_AES_ST + 28]        // .......*....................................................................................    // @slothy:writes=stack_1
        eor v10.16B, v10.16B, v2.16B                  // ........*...................................................................................
        aesr v29.16b, v18.16b                         // ........*...................................................................................
        aesr v8.16b, v18.16b                          // .........*..................................................................................
        ldr q9, [x6, #64]                             // .........*..................................................................................
        ldr q1, [x0], #(4*16)                         // ..........*.................................................................................
        aesr v29.16b, v19.16b                         // ..........*.................................................................................
        aesr v8.16b, v19.16b                          // ...........*................................................................................
        ldr q5, [sp, #STACK_BASE_AES_ST + 32]         // ...........*................................................................................    // @slothy:reads=stack_2
        aesr v29.16b, v20.16b                         // ............*...............................................................................
        aesr v8.16b, v20.16b                          // .............*..............................................................................
        eor v1.16B, v1.16B, v2.16B                    // ..............*.............................................................................
        aesr v29.16b, v21.16b                         // ..............*.............................................................................
        aesr v8.16b, v21.16b                          // ...............*............................................................................
        aesr v29.16b, v22.16b                         // ................*...........................................................................
        aesr v8.16b, v22.16b                          // .................*..........................................................................
        aesr v29.16b, v23.16b                         // ..................*.........................................................................
        aesr v8.16b, v23.16b                          // ...................*........................................................................
        aesr v29.16b, v24.16b                         // ....................*.......................................................................
        aesr v8.16b, v24.16b                          // .....................*......................................................................
        aesr v29.16b, v25.16b                         // ......................*.....................................................................
        aesr v8.16b, v25.16b                          // .......................*....................................................................
        aesr v29.16b, v26.16b                         // ........................*...................................................................
        aesr v8.16b, v26.16b                          // .........................*..................................................................
        aesr v29.16b, v27.16b                         // ..........................*.................................................................
        aesr v8.16b, v27.16b                          // ...........................*................................................................
        aesr v29.16b, v28.16b                         // ............................*...............................................................
        aesr v8.16b, v28.16b                          // .............................*..............................................................
        aesr v29.16b, v15.16b                         // ..............................*.............................................................
        aesr v8.16b, v15.16b                          // ...............................*............................................................
        aesr v29.16b, v16.16b                         // ................................*...........................................................
        aesr v8.16b, v16.16b                          // .................................*..........................................................
        ldr q14, [sp, #STACK_BASE_AES_ST + 16]        // ..................................*.........................................................    // @slothy:reads=stack_1
        aesr v5.16b, v18.16b                          // ..................................*.........................................................
        aese v8.16b, v17.16b                          // ...................................*........................................................
        aese v29.16b, v17.16b                         // ....................................*.......................................................
        aesr v5.16b, v19.16b                          // .....................................*......................................................
        eor v10.16B, v10.16B, v8.16B                  // .....................................*......................................................
        eor v29.16B, v1.16B, v29.16B                  // ......................................*.....................................................
        aesr v14.16b, v18.16b                         // ......................................*.....................................................
        rev64 v1.16B, v10.16B                         // .......................................*....................................................
        aesr v5.16b, v20.16b                          // .......................................*....................................................
        str q10, [x2, #48]                            // ........................................*...................................................
        aesr v14.16b, v19.16b                         // ........................................*...................................................
        aesr v5.16b, v21.16b                          // .........................................*..................................................
        rev64 v8.16B, v29.16B                         // .........................................*..................................................
        aesr v14.16b, v20.16b                         // ..........................................*.................................................
        ldr q10, [x0, #-48]                           // ..........................................*.................................................
        eor v8.16B, v8.16B, v30.16B                   // ...........................................*................................................
        aesr v5.16b, v22.16b                          // ...........................................*................................................
        mov d30, v1.d[1]                              // ............................................*...............................................
        aesr v14.16b, v21.16b                         // ............................................*...............................................
        str q29, [x2], #(4*16)                        // .............................................*..............................................
        aesr v5.16b, v23.16b                          // .............................................*..............................................
        eor v29.8B, v30.8B, v1.8B                     // ..............................................*.............................................
        aesr v14.16b, v22.16b                         // ..............................................*.............................................
        eor v11.16B, v10.16B, v2.16B                  // ...............................................*............................................
        aesr v5.16b, v24.16b                          // ...............................................*............................................
        aesr v14.16b, v23.16b                         // ................................................*...........................................
        ext v30.16B, v8.16B, v8.16B, #8               // ................................................*...........................................
        aesr v5.16b, v25.16b                          // .................................................*..........................................
        eor v30.16B, v30.16B, v8.16B                  // ..................................................*.........................................
        aesr v14.16b, v24.16b                         // ..................................................*.........................................
        aesr v5.16b, v26.16b                          // ...................................................*........................................
        aesr v14.16b, v25.16b                         // ....................................................*.......................................
        aesr v5.16b, v27.16b                          // .....................................................*......................................
        aesr v14.16b, v26.16b                         // ......................................................*.....................................
        aesr v5.16b, v28.16b                          // .......................................................*....................................
        aesr v14.16b, v27.16b                         // ........................................................*...................................
        aesr v5.16b, v15.16b                          // .........................................................*..................................
        aesr v14.16b, v28.16b                         // ..........................................................*.................................
        aesr v5.16b, v16.16b                          // ...........................................................*................................
        aesr v14.16b, v15.16b                         // ............................................................*...............................
        aese v5.16b, v17.16b                          // .............................................................*..............................
        aesr v14.16b, v16.16b                         // ..............................................................*.............................
        eor v31.16B, v31.16B, v5.16B                  // ...............................................................*............................
        pmull v5.1q, v8.1d, v13.1d                    // ...............................................................*............................
        aese v14.16b, v17.16b                         // ................................................................*...........................
        pmull2 v8.1q, v8.2d, v13.2d                   // .................................................................*..........................
        rev64 v13.16B, v31.16B                        // .................................................................*..........................
        pmull v10.1q, v1.1d, v6.1d                    // ..................................................................*.........................
        eor v11.16B, v11.16B, v14.16B                 // ..................................................................*.........................
        pmull2 v6.1q, v1.2d, v6.2d                    // ...................................................................*........................
        ext v14.16B, v13.16B, v13.16B, #8             // ...................................................................*........................
        pmull v1.1q, v13.1d, v0.1d                    // ....................................................................*.......................
        rev64 v12.16B, v11.16B                        // ....................................................................*.......................
        pmull2 v0.1q, v13.2d, v0.2d                   // .....................................................................*......................
        eor v13.16B, v14.16B, v13.16B                 // .....................................................................*......................
        pmull v29.1q, v29.1d, v3.1d                   // ......................................................................*.....................
        eor v10.16B, v10.16B, v1.16B                  // ......................................................................*.....................
        pmull2 v3.1q, v13.2d, v3.2d                   // .......................................................................*....................
        mov d1, v12.d[1]                              // .......................................................................*....................
        pmull2 v14.1q, v12.2d, v4.2d                  // ........................................................................*...................
        eor v6.16B, v6.16B, v0.16B                    // ........................................................................*...................
        pmull v0.1q, v12.1d, v4.1d                    // .........................................................................*..................
        eor v13.8B, v1.8B, v12.8B                     // .........................................................................*..................
        eor v3.16B, v29.16B, v3.16B                   // ..........................................................................*.................
        eor v6.16B, v6.16B, v14.16B                   // ..........................................................................*.................
        eor v0.16B, v10.16B, v0.16B                   // ...........................................................................*................
        pmull v10.1q, v13.1d, v9.1d                   // ...........................................................................*................
        pmull2 v29.1q, v30.2d, v9.2d                  // ............................................................................*...............
        eor v6.16B, v6.16B, v8.16B                    // ............................................................................*...............
        eor v0.16B, v0.16B, v5.16B                    // .............................................................................*..............
        eor v3.16B, v3.16B, v10.16B                   // .............................................................................*..............
        pmull v10.1q, v6.1d, v7.1d                    // ..............................................................................*.............
        ext v8.16B, v6.16B, v6.16B, #8                // ..............................................................................*.............
        eor v3.16B, v3.16B, v29.16B                   // ...............................................................................*............
        eor v6.16B, v0.16B, v6.16B                    // ...............................................................................*............
        str q31, [x2, #-32]                           // ................................................................................*...........
        eor v31.16B, v8.16B, v10.16B                  // ................................................................................*...........
        str q11, [x2, #-48]                           // .................................................................................*..........
        eor v6.16B, v3.16B, v6.16B                    // .................................................................................*..........
        eor v6.16B, v6.16B, v31.16B                   // ...................................................................................*........
        pmull v31.1q, v6.1d, v7.1d                    // .....................................................................................*......
        ext v6.16B, v6.16B, v6.16B, #8                // ......................................................................................*.....
        eor v31.16B, v0.16B, v31.16B                  // .......................................................................................*....
        eor v6.16B, v31.16B, v6.16B                   // .........................................................................................*..
        ext v30.16B, v6.16B, v6.16B, #8               // ...........................................................................................*
        add w13, w13, #UNROLL                         // ...........................................................................................*

                                                                        // ------------------------------------ cycle (expected) ------------------------------------->
                                                                        // 0                        25                       50                       75
                                                                        // |------------------------|------------------------|------------------------|----------------
        // ldr q12, [x6]                                                   // *...........................................................................................
        // ldr q13, [x6, #32]                                              // ..*.........................................................................................
        // ldr q14, [x6, #16]                                              // ...*........................................................................................
        // ldr q29, [x0, #(3*16)]                                          // ....*.......................................................................................
        // add        w14, w13, #3                                         // *...........................................................................................
        // rev        w14, w14                                             // ..*.........................................................................................
        // str        w14, [sp, #(STACK_BASE_AES_ST + 3*16 + 12)]          // ...*........................................................................................
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 3*16)]                // .....*......................................................................................
        // aesr v0.16b, v18.16b                                            // .........*..................................................................................
        // aesr v0.16b, v19.16b                                            // ...........*................................................................................
        // aesr v0.16b, v20.16b                                            // .............*..............................................................................
        // aesr v0.16b, v21.16b                                            // ...............*............................................................................
        // aesr v0.16b, v22.16b                                            // .................*..........................................................................
        // aesr v0.16b, v23.16b                                            // ...................*........................................................................
        // aesr v0.16b, v24.16b                                            // .....................*......................................................................
        // aesr v0.16b, v25.16b                                            // .......................*....................................................................
        // aesr v0.16b, v26.16b                                            // .........................*..................................................................
        // aesr v0.16b, v27.16b                                            // ...........................*................................................................
        // aesr v0.16b, v28.16b                                            // .............................*..............................................................
        // aesr v0.16b, v15.16b                                            // ...............................*............................................................
        // aesr v0.16b, v16.16b                                            // .................................*..........................................................
        // aese v0.16b, v17.16b                                            // ...................................*........................................................
        // eor v29.16b, v29.16b, v2.16b                                    // ........*...................................................................................
        // eor v0.16b, v29.16b, v0.16b                                     // .....................................*......................................................
        // str q0, [x2, #(3*16)]                                           // ........................................*...................................................
        // rev64 v0.16b, v0.16b                                            // .......................................*....................................................
        // pmull   v8.1q, v0.1d, v12.1d                                    // ..................................................................*.........................
        // pmull2  v9.1q, v0.2d, v12.2d                                    // ...................................................................*........................
        // mov     d11, v0.d[1]                                            // ............................................*...............................................
        // eor     v11.8b, v11.8b, v0.8b                                   // ..............................................*.............................................
        // pmull   v10.1q, v11.1d, v14.1d                                  // ......................................................................*.....................
        // ldr q29, [x0, #(2*16)]                                          // .*..........................................................................................
        // add        w14, w13, #2                                         // *...........................................................................................
        // rev        w14, w14                                             // ..*.........................................................................................
        // str        w14, [sp, #(STACK_BASE_AES_ST + 2*16 + 12)]          // .....*......................................................................................
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 2*16)]                // ...........*................................................................................
        // aesr v0.16b, v18.16b                                            // ..................................*.........................................................
        // aesr v0.16b, v19.16b                                            // .....................................*......................................................
        // aesr v0.16b, v20.16b                                            // .......................................*....................................................
        // aesr v0.16b, v21.16b                                            // .........................................*..................................................
        // aesr v0.16b, v22.16b                                            // ...........................................*................................................
        // aesr v0.16b, v23.16b                                            // .............................................*..............................................
        // aesr v0.16b, v24.16b                                            // ...............................................*............................................
        // aesr v0.16b, v25.16b                                            // .................................................*..........................................
        // aesr v0.16b, v26.16b                                            // ...................................................*........................................
        // aesr v0.16b, v27.16b                                            // .....................................................*......................................
        // aesr v0.16b, v28.16b                                            // .......................................................*....................................
        // aesr v0.16b, v15.16b                                            // .........................................................*..................................
        // aesr v0.16b, v16.16b                                            // ...........................................................*................................
        // aese v0.16b, v17.16b                                            // .............................................................*..............................
        // eor v29.16b, v29.16b, v2.16b                                    // .......*....................................................................................
        // eor v0.16b, v29.16b, v0.16b                                     // ...............................................................*............................
        // str q0, [x2, #(2*16)]                                           // ................................................................................*...........
        // rev64   v0.16b, v0.16b                                          // .................................................................*..........................
        // pmull   v11.1q, v0.1d, v13.1d                                   // ....................................................................*.......................
        // eor     v8.16b, v8.16b, v11.16b                                 // ......................................................................*.....................
        // pmull2  v11.1q, v0.2d, v13.2d                                   // .....................................................................*......................
        // eor     v9.16b, v9.16b, v11.16b                                 // ........................................................................*...................
        // ext     v11.16b, v0.16b, v0.16b, #8                             // ...................................................................*........................
        // eor     v11.16b, v11.16b, v0.16b                                // .....................................................................*......................
        // pmull2  v11.1q, v11.2d, v14.2d                                  // .......................................................................*....................
        // eor     v10.16b, v10.16b, v11.16b                               // ..........................................................................*.................
        // ldr q12, [x6, #48]                                              // ......*.....................................................................................
        // ldr q13, [x6, #80]                                              // ......*.....................................................................................
        // ldr q14, [x6, #64]                                              // .........*..................................................................................
        // ldr q29, [x0, #(1*16)]                                          // ..........................................*.................................................
        // add        w14, w13, #1                                         // .*..........................................................................................
        // rev        w14, w14                                             // ...*........................................................................................
        // str        w14, [sp, #(STACK_BASE_AES_ST + 1*16 + 12)]          // .......*....................................................................................
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 1*16)]                // ..................................*.........................................................
        // aesr v0.16b, v18.16b                                            // ......................................*.....................................................
        // aesr v0.16b, v19.16b                                            // ........................................*...................................................
        // aesr v0.16b, v20.16b                                            // ..........................................*.................................................
        // aesr v0.16b, v21.16b                                            // ............................................*...............................................
        // aesr v0.16b, v22.16b                                            // ..............................................*.............................................
        // aesr v0.16b, v23.16b                                            // ................................................*...........................................
        // aesr v0.16b, v24.16b                                            // ..................................................*.........................................
        // aesr v0.16b, v25.16b                                            // ....................................................*.......................................
        // aesr v0.16b, v26.16b                                            // ......................................................*.....................................
        // aesr v0.16b, v27.16b                                            // ........................................................*...................................
        // aesr v0.16b, v28.16b                                            // ..........................................................*.................................
        // aesr v0.16b, v15.16b                                            // ............................................................*...............................
        // aesr v0.16b, v16.16b                                            // ..............................................................*.............................
        // aese v0.16b, v17.16b                                            // ................................................................*...........................
        // eor v29.16b, v29.16b, v2.16b                                    // ...............................................*............................................
        // eor v0.16b, v29.16b, v0.16b                                     // ..................................................................*.........................
        // str q0, [x2, #(1*16)]                                           // .................................................................................*..........
        // rev64   v0.16b, v0.16b                                          // ....................................................................*.......................
        // pmull   v11.1q, v0.1d, v12.1d                                   // .........................................................................*..................
        // eor     v8.16b, v8.16b, v11.16b                                 // ...........................................................................*................
        // pmull2  v11.1q, v0.2d, v12.2d                                   // ........................................................................*...................
        // eor     v9.16b, v9.16b, v11.16b                                 // ..........................................................................*.................
        // mov     d11, v0.d[1]                                            // .......................................................................*....................
        // eor     v11.8b, v11.8b, v0.8b                                   // .........................................................................*..................
        // pmull   v11.1q, v11.1d, v14.1d                                  // ...........................................................................*................
        // eor     v10.16b, v10.16b, v11.16b                               // .............................................................................*..............
        // ldr q29, [x0], #(4*16)                                          // ..........*.................................................................................
        // add        w14, w13, #0                                         // *...........................................................................................
        // rev        w14, w14                                             // .*..........................................................................................
        // str        w14, [sp, #(STACK_BASE_AES_ST + 0*16 + 12)]          // ..*.........................................................................................
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 0*16)]                // ....*.......................................................................................
        // aesr v0.16b, v18.16b                                            // ........*...................................................................................
        // aesr v0.16b, v19.16b                                            // ..........*.................................................................................
        // aesr v0.16b, v20.16b                                            // ............*...............................................................................
        // aesr v0.16b, v21.16b                                            // ..............*.............................................................................
        // aesr v0.16b, v22.16b                                            // ................*...........................................................................
        // aesr v0.16b, v23.16b                                            // ..................*.........................................................................
        // aesr v0.16b, v24.16b                                            // ....................*.......................................................................
        // aesr v0.16b, v25.16b                                            // ......................*.....................................................................
        // aesr v0.16b, v26.16b                                            // ........................*...................................................................
        // aesr v0.16b, v27.16b                                            // ..........................*.................................................................
        // aesr v0.16b, v28.16b                                            // ............................*...............................................................
        // aesr v0.16b, v15.16b                                            // ..............................*.............................................................
        // aesr v0.16b, v16.16b                                            // ................................*...........................................................
        // aese v0.16b, v17.16b                                            // ....................................*.......................................................
        // eor v29.16b, v29.16b, v2.16b                                    // ..............*.............................................................................
        // eor v0.16b, v29.16b, v0.16b                                     // ......................................*.....................................................
        // str q0, [x2], #(4*16)                                           // .............................................*..............................................
        // rev64   v0.16b, v0.16b                                          // .........................................*..................................................
        // eor   v0.16b, v0.16b, v30.16b                                   // ...........................................*................................................
        // pmull   v11.1q, v0.1d, v13.1d                                   // ...............................................................*............................
        // eor     v8.16b, v8.16b, v11.16b                                 // .............................................................................*..............
        // pmull2  v11.1q, v0.2d, v13.2d                                   // .................................................................*..........................
        // eor     v9.16b, v9.16b, v11.16b                                 // ............................................................................*...............
        // ext     v11.16b, v0.16b, v0.16b, #8                             // ................................................*...........................................
        // eor     v11.16b, v11.16b, v0.16b                                // ..................................................*.........................................
        // pmull2  v11.1q, v11.2d, v14.2d                                  // ............................................................................*...............
        // eor     v10.16b, v10.16b, v11.16b                               // ...............................................................................*............
        // eor        v0.16b, v8.16b,  v9.16b                              // ...............................................................................*............
        // pmull      v1.1q,  v9.1d,   v7.1d                               // ..............................................................................*.............
        // ext        v9.16b,    v9.16b,  v9.16b, #8                       // ..............................................................................*.............
        // eor        v10.16b,   v10.16b, v0.16b                           // .................................................................................*..........
        // eor        v1.16b, v9.16b,  v1.16b                              // ................................................................................*...........
        // eor        v10.16b,   v10.16b, v1.16b                           // ...................................................................................*........
        // pmull      v9.1q,     v10.1d,  v7.1d                            // .....................................................................................*......
        // eor        v8.16b,    v8.16b,  v9.16b                           // .......................................................................................*....
        // ext        v10.16b,   v10.16b, v10.16b, #8                      // ......................................................................................*.....
        // eor        v30.16b,     v8.16b,  v10.16b                        // .........................................................................................*..
        // ext        v30.16b, v30.16b, v30.16b, #8                        // ...........................................................................................*
        // add w13, w13, #UNROLL                                           // ...........................................................................................*

Lloop_unrolled_start_iter_1_end:
Lloop_unrolled_start_end:
Lloop_unrolled_end:

        cmp remainder, #3
        b.eq Lremainder_3_start
        cmp remainder, #2
        b.eq Lremainder_2_start
        cmp remainder, #1
        b.eq Lremainder_1_start
        b Lend

        Lremainder_3_start:
                                                      // Instructions:    108
                                                      // Expected cycles: 76
                                                      // Expected IPC:    1.42

                                                      // Cycle bound:     76.0
                                                      // IPC bound:       1.42

                                                      // Wall time:     2.55s
                                                      // User time:     2.55s

                                                      // ---------------------------- cycle (expected) ----------------------------->
                                                      // 0                        25                       50                       75
                                                      // |------------------------|------------------------|------------------------|
        ldr q9, [x6]                                  // *...........................................................................
        ldr q1, [x0, #16]                             // *...........................................................................
        add w22, w13, #1                              // *...........................................................................
        add w25, w13, #2                              // *...........................................................................
        ldr q10, [x0, #32]                            // .*..........................................................................
        rev w12, w22                                  // .*..........................................................................
        rev w22, w25                                  // .*..........................................................................
        add w27, w13, #0                              // .*..........................................................................
        str w22, [sp, #STACK_BASE_AES_ST + 44]        // ..*.........................................................................   // @slothy:writes=stack_2
        rev w27, w27                                  // ..*.........................................................................
        str w12, [sp, #STACK_BASE_AES_ST + 28]        // ..*.........................................................................   // @slothy:writes=stack_1
        ldr q6, [x6, #32]                             // ...*........................................................................
        str w27, [sp, #STACK_BASE_AES_ST + 12]        // ...*........................................................................   // @slothy:writes=stack_0
        eor v1.16B, v1.16B, v2.16B                    // ....*.......................................................................
        ldr q29, [sp, #STACK_BASE_AES_ST + 16]        // ....*.......................................................................   // @slothy:reads=stack_1
        eor v4.16B, v10.16B, v2.16B                   // .....*......................................................................
        ldr q0, [sp, #STACK_BASE_AES_ST]              // .....*......................................................................   // @slothy:reads=stack_0
        ldr q13, [x6, #48]                            // ......*.....................................................................
        ldr q31, [sp, #STACK_BASE_AES_ST + 32]        // ......*.....................................................................   // @slothy:reads=stack_2
        ldr q3, [x6, #64]                             // .......*....................................................................
        add w13, w13, #3                              // .......*....................................................................
        aesr v29.16b, v18.16b                         // ........*...................................................................
        ldr q8, [x6, #16]                             // ........*...................................................................
        aesr v0.16b, v18.16b                          // .........*..................................................................
        aesr v29.16b, v19.16b                         // ..........*.................................................................
        aesr v0.16b, v19.16b                          // ...........*................................................................
        aesr v31.16b, v18.16b                         // ............*...............................................................
        aesr v0.16b, v20.16b                          // .............*..............................................................
        aesr v31.16b, v19.16b                         // ..............*.............................................................
        aesr v0.16b, v21.16b                          // ...............*............................................................
        aesr v29.16b, v20.16b                         // ................*...........................................................
        aesr v0.16b, v22.16b                          // .................*..........................................................
        aesr v29.16b, v21.16b                         // ..................*.........................................................
        aesr v0.16b, v23.16b                          // ...................*........................................................
        aesr v29.16b, v22.16b                         // ....................*.......................................................
        aesr v0.16b, v24.16b                          // .....................*......................................................
        aesr v29.16b, v23.16b                         // ......................*.....................................................
        aesr v0.16b, v25.16b                          // .......................*....................................................
        aesr v29.16b, v24.16b                         // ........................*...................................................
        aesr v31.16b, v20.16b                         // .........................*..................................................
        aesr v29.16b, v25.16b                         // ..........................*.................................................
        aesr v31.16b, v21.16b                         // ...........................*................................................
        aesr v29.16b, v26.16b                         // ............................*...............................................
        aesr v31.16b, v22.16b                         // .............................*..............................................
        aesr v29.16b, v27.16b                         // ..............................*.............................................
        aesr v31.16b, v23.16b                         // ...............................*............................................
        aesr v29.16b, v28.16b                         // ................................*...........................................
        aesr v31.16b, v24.16b                         // .................................*..........................................
        aesr v29.16b, v15.16b                         // ..................................*.........................................
        aesr v31.16b, v25.16b                         // ...................................*........................................
        aesr v29.16b, v16.16b                         // ....................................*.......................................
        aesr v31.16b, v26.16b                         // .....................................*......................................
        aese v29.16b, v17.16b                         // ......................................*.....................................
        aesr v0.16b, v26.16b                          // .......................................*....................................
        eor v1.16B, v1.16B, v29.16B                   // ........................................*...................................
        aesr v31.16b, v27.16b                         // ........................................*...................................
        aesr v0.16b, v27.16b                          // .........................................*..................................
        aesr v31.16b, v28.16b                         // ..........................................*.................................
        str q1, [x2, #16]                             // ..........................................*.................................
        rev64 v14.16B, v1.16B                         // ...........................................*................................
        aesr v0.16b, v28.16b                          // ...........................................*................................
        aesr v31.16b, v15.16b                         // ............................................*...............................
        ldr q1, [x0, #0]                              // ............................................*...............................
        aesr v0.16b, v15.16b                          // .............................................*..............................
        ext v10.16B, v14.16B, v14.16B, #8             // .............................................*..............................
        aesr v31.16b, v16.16b                         // ..............................................*.............................
        aesr v0.16b, v16.16b                          // ...............................................*............................
        eor v11.16B, v1.16B, v2.16B                   // ................................................*...........................
        aese v31.16b, v17.16b                         // ................................................*...........................
        aese v0.16b, v17.16b                          // .................................................*..........................
        eor v1.16B, v10.16B, v14.16B                  // .................................................*..........................
        pmull2 v12.1q, v14.2d, v6.2d                  // ..................................................*.........................
        eor v29.16B, v4.16B, v31.16B                  // ..................................................*.........................
        pmull v4.1q, v14.1d, v6.1d                    // ...................................................*........................
        eor v5.16B, v11.16B, v0.16B                   // ...................................................*........................
        str q29, [x2, #32]                            // ....................................................*.......................
        rev64 v29.16B, v29.16B                        // ....................................................*.......................
        pmull2 v14.1q, v1.2d, v8.2d                   // .....................................................*......................
        rev64 v1.16B, v5.16B                          // .....................................................*......................
        pmull v0.1q, v29.1d, v9.1d                    // ......................................................*.....................
        mov d6, v29.d[1]                              // ......................................................*.....................
        pmull2 v9.1q, v29.2d, v9.2d                   // .......................................................*....................
        eor v10.16B, v1.16B, v30.16B                  // .......................................................*....................
        eor v4.16B, v0.16B, v4.16B                    // ........................................................*...................
        eor v11.8B, v6.8B, v29.8B                     // ........................................................*...................
        pmull2 v1.1q, v10.2d, v13.2d                  // .........................................................*..................
        mov d29, v10.d[1]                             // .........................................................*..................
        pmull v6.1q, v11.1d, v8.1d                    // ..........................................................*.................
        eor v0.16B, v9.16B, v12.16B                   // ..........................................................*.................
        pmull v30.1q, v10.1d, v13.1d                  // ...........................................................*................
        eor v31.8B, v29.8B, v10.8B                    // ...........................................................*................
        eor v11.16B, v0.16B, v1.16B                   // ............................................................*...............
        eor v0.16B, v6.16B, v14.16B                   // ............................................................*...............
        pmull v1.1q, v31.1d, v3.1d                    // .............................................................*..............
        eor v31.16B, v4.16B, v30.16B                  // .............................................................*..............
        ext v30.16B, v11.16B, v11.16B, #8             // ..............................................................*.............
        pmull v4.1q, v11.1d, v7.1d                    // ..............................................................*.............
        eor v11.16B, v31.16B, v11.16B                 // ...............................................................*............
        eor v10.16B, v0.16B, v1.16B                   // ...............................................................*............
        str q5, [x2, #0]                              // ................................................................*...........
        eor v30.16B, v30.16B, v4.16B                  // ................................................................*...........
        eor v1.16B, v10.16B, v11.16B                  // .................................................................*..........
        eor v30.16B, v1.16B, v30.16B                  // ...................................................................*........
        ext v8.16B, v30.16B, v30.16B, #8              // .....................................................................*......
        pmull v30.1q, v30.1d, v7.1d                   // .....................................................................*......
        eor v30.16B, v31.16B, v30.16B                 // .......................................................................*....
        eor v30.16B, v30.16B, v8.16B                  // .........................................................................*..
        ext v30.16B, v30.16B, v30.16B, #8             // ...........................................................................*

                                                                        // ---------------------------- cycle (expected) ----------------------------->
                                                                        // 0                        25                       50
                                                                        // |------------------------|------------------------|-------------------------
        // ldr q12, [x6]                                                  // *...........................................................................
        // ldr q13, [x6, #32]                                             // ...*........................................................................
        // ldr q14, [x6, #16]                                             // ........*...................................................................
        // ldr q29, [x0, #(2*16)]                                         // .*..........................................................................
        // add        w14, w13, #2                                        // *...........................................................................
        // rev        w14, w14                                            // .*..........................................................................
        // str        w14, [sp, #(STACK_BASE_AES_ST + 2*16 + 12)]         // ..*.........................................................................
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 2*16)]               // ......*.....................................................................
        // aesr v0.16b, v18.16b                                           // ............*...............................................................
        // aesr v0.16b, v19.16b                                           // ..............*.............................................................
        // aesr v0.16b, v20.16b                                           // .........................*..................................................
        // aesr v0.16b, v21.16b                                           // ...........................*................................................
        // aesr v0.16b, v22.16b                                           // .............................*..............................................
        // aesr v0.16b, v23.16b                                           // ...............................*............................................
        // aesr v0.16b, v24.16b                                           // .................................*..........................................
        // aesr v0.16b, v25.16b                                           // ...................................*........................................
        // aesr v0.16b, v26.16b                                           // .....................................*......................................
        // aesr v0.16b, v27.16b                                           // ........................................*...................................
        // aesr v0.16b, v28.16b                                           // ..........................................*.................................
        // aesr v0.16b, v15.16b                                           // ............................................*...............................
        // aesr v0.16b, v16.16b                                           // ..............................................*.............................
        // aese v0.16b, v17.16b                                           // ................................................*...........................
        // eor v29.16b, v29.16b, v2.16b                                   // .....*......................................................................
        // eor v0.16b, v29.16b, v0.16b                                    // ..................................................*.........................
        // str q0, [x2, #(2*16)]                                          // ....................................................*.......................
        // rev64 v0.16b, v0.16b                                           // ....................................................*.......................
        // pmull   v8.1q, v0.1d, v12.1d                                   // ......................................................*.....................
        // pmull2  v9.1q, v0.2d, v12.2d                                   // .......................................................*....................
        // mov     d11, v0.d[1]                                           // ......................................................*.....................
        // eor     v11.8b, v11.8b, v0.8b                                  // ........................................................*...................
        // pmull   v10.1q, v11.1d, v14.1d                                 // ..........................................................*.................
        // ldr q29, [x0, #(1*16)]                                         // *...........................................................................
        // add        w14, w13, #1                                        // *...........................................................................
        // rev        w14, w14                                            // .*..........................................................................
        // str        w14, [sp, #(STACK_BASE_AES_ST + 1*16 + 12)]         // ..*.........................................................................
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 1*16)]               // ....*.......................................................................
        // aesr v0.16b, v18.16b                                           // ........*...................................................................
        // aesr v0.16b, v19.16b                                           // ..........*.................................................................
        // aesr v0.16b, v20.16b                                           // ................*...........................................................
        // aesr v0.16b, v21.16b                                           // ..................*.........................................................
        // aesr v0.16b, v22.16b                                           // ....................*.......................................................
        // aesr v0.16b, v23.16b                                           // ......................*.....................................................
        // aesr v0.16b, v24.16b                                           // ........................*...................................................
        // aesr v0.16b, v25.16b                                           // ..........................*.................................................
        // aesr v0.16b, v26.16b                                           // ............................*...............................................
        // aesr v0.16b, v27.16b                                           // ..............................*.............................................
        // aesr v0.16b, v28.16b                                           // ................................*...........................................
        // aesr v0.16b, v15.16b                                           // ..................................*.........................................
        // aesr v0.16b, v16.16b                                           // ....................................*.......................................
        // aese v0.16b, v17.16b                                           // ......................................*.....................................
        // eor v29.16b, v29.16b, v2.16b                                   // ....*.......................................................................
        // eor v0.16b, v29.16b, v0.16b                                    // ........................................*...................................
        // str q0, [x2, #(1*16)]                                          // ..........................................*.................................
        // rev64   v0.16b, v0.16b                                         // ...........................................*................................
        // pmull   v11.1q, v0.1d, v13.1d                                  // ...................................................*........................
        // eor     v8.16b, v8.16b, v11.16b                                // ........................................................*...................
        // pmull2  v11.1q, v0.2d, v13.2d                                  // ..................................................*.........................
        // eor     v9.16b, v9.16b, v11.16b                                // ..........................................................*.................
        // ext     v11.16b, v0.16b, v0.16b, #8                            // .............................................*..............................
        // eor     v11.16b, v11.16b, v0.16b                               // .................................................*..........................
        // pmull2  v11.1q, v11.2d, v14.2d                                 // .....................................................*......................
        // eor     v10.16b, v10.16b, v11.16b                              // ............................................................*...............
        // ldr q12, [x6, #48]                                             // ......*.....................................................................
        // ldr q14, [x6, #64]                                             // .......*....................................................................
        // ldr q29, [x0, #(0*16)]                                         // ............................................*...............................
        // add        w14, w13, #0                                        // .*..........................................................................
        // rev        w14, w14                                            // ..*.........................................................................
        // str        w14, [sp, #(STACK_BASE_AES_ST + 0*16 + 12)]         // ...*........................................................................
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 0*16)]               // .....*......................................................................
        // aesr v0.16b, v18.16b                                           // .........*..................................................................
        // aesr v0.16b, v19.16b                                           // ...........*................................................................
        // aesr v0.16b, v20.16b                                           // .............*..............................................................
        // aesr v0.16b, v21.16b                                           // ...............*............................................................
        // aesr v0.16b, v22.16b                                           // .................*..........................................................
        // aesr v0.16b, v23.16b                                           // ...................*........................................................
        // aesr v0.16b, v24.16b                                           // .....................*......................................................
        // aesr v0.16b, v25.16b                                           // .......................*....................................................
        // aesr v0.16b, v26.16b                                           // .......................................*....................................
        // aesr v0.16b, v27.16b                                           // .........................................*..................................
        // aesr v0.16b, v28.16b                                           // ...........................................*................................
        // aesr v0.16b, v15.16b                                           // .............................................*..............................
        // aesr v0.16b, v16.16b                                           // ...............................................*............................
        // aese v0.16b, v17.16b                                           // .................................................*..........................
        // eor v29.16b, v29.16b, v2.16b                                   // ................................................*...........................
        // eor v0.16b, v29.16b, v0.16b                                    // ...................................................*........................
        // str q0, [x2, #(0*16)]                                          // ................................................................*...........
        // rev64   v0.16b, v0.16b                                         // .....................................................*......................
        // eor   v0.16b, v0.16b, v30.16b                                  // .......................................................*....................
        // pmull   v11.1q, v0.1d, v12.1d                                  // ...........................................................*................
        // eor     v8.16b, v8.16b, v11.16b                                // .............................................................*..............
        // pmull2  v11.1q, v0.2d, v12.2d                                  // .........................................................*..................
        // eor     v9.16b, v9.16b, v11.16b                                // ............................................................*...............
        // mov     d11, v0.d[1]                                           // .........................................................*..................
        // eor     v11.8b, v11.8b, v0.8b                                  // ...........................................................*................
        // pmull   v11.1q, v11.1d, v14.1d                                 // .............................................................*..............
        // eor     v10.16b, v10.16b, v11.16b                              // ...............................................................*............
        // eor        v0.16b, v8.16b,  v9.16b                             // ...............................................................*............
        // pmull      v1.1q,  v9.1d,   v7.1d                              // ..............................................................*.............
        // ext        v9.16b,    v9.16b,  v9.16b, #8                      // ..............................................................*.............
        // eor        v10.16b,   v10.16b, v0.16b                          // .................................................................*..........
        // eor        v1.16b, v9.16b,  v1.16b                             // ................................................................*...........
        // eor        v10.16b,   v10.16b, v1.16b                          // ...................................................................*........
        // pmull      v9.1q,     v10.1d,  v7.1d                           // .....................................................................*......
        // eor        v8.16b,    v8.16b,  v9.16b                          // .......................................................................*....
        // ext        v10.16b,   v10.16b, v10.16b, #8                     // .....................................................................*......
        // eor        v30.16b,     v8.16b,  v10.16b                       // .........................................................................*..
        // ext        v30.16b, v30.16b, v30.16b, #8                       // ...........................................................................*
        // add w13, w13, #3                                               // .......*....................................................................

        Lremainder_3_end:

        b Lend

        Lremainder_2_start:
                                                      // Instructions:    75
                                                      // Expected cycles: 61
                                                      // Expected IPC:    1.23

                                                      // Cycle bound:     61.0
                                                      // IPC bound:       1.23

                                                      // Wall time:     0.63s
                                                      // User time:     0.63s

                                                      // --------------------- cycle (expected) --------------------->
                                                      // 0                        25                       50
                                                      // |------------------------|------------------------|----------
        ldr q1, [x6]                                  // *............................................................
        add w10, w13, #1                              // *............................................................
        add w22, w13, #0                              // *............................................................
        add w13, w13, #2                              // *............................................................
        ldr q6, [x6, #32]                             // .*...........................................................
        ldr q10, [x6, #16]                            // .*...........................................................
        rev w10, w10                                  // .*...........................................................
        rev w22, w22                                  // .*...........................................................
        ldr q4, [x0, #16]                             // ..*..........................................................
        str w22, [sp, #STACK_BASE_AES_ST + 12]        // ..*..........................................................  // @slothy:writes=stack_0
        ldr q13, [x0, #0]                             // ...*.........................................................
        str w10, [sp, #STACK_BASE_AES_ST + 28]        // ...*.........................................................  // @slothy:writes=stack_1
        ldr q8, [sp, #STACK_BASE_AES_ST]              // ....*........................................................  // @slothy:reads=stack_0
        ldr q3, [sp, #STACK_BASE_AES_ST + 16]         // .....*.......................................................  // @slothy:reads=stack_1
        eor v4.16B, v4.16B, v2.16B                    // ......*......................................................
        eor v13.16B, v13.16B, v2.16B                  // .......*.....................................................
        aesr v8.16b, v18.16b                          // ........*....................................................
        aesr v3.16b, v18.16b                          // .........*...................................................
        aesr v8.16b, v19.16b                          // ..........*..................................................
        aesr v3.16b, v19.16b                          // ...........*.................................................
        aesr v8.16b, v20.16b                          // ............*................................................
        aesr v3.16b, v20.16b                          // .............*...............................................
        aesr v8.16b, v21.16b                          // ..............*..............................................
        aesr v3.16b, v21.16b                          // ...............*.............................................
        aesr v8.16b, v22.16b                          // ................*............................................
        aesr v3.16b, v22.16b                          // .................*...........................................
        aesr v8.16b, v23.16b                          // ..................*..........................................
        aesr v3.16b, v23.16b                          // ...................*.........................................
        aesr v8.16b, v24.16b                          // ....................*........................................
        aesr v3.16b, v24.16b                          // .....................*.......................................
        aesr v8.16b, v25.16b                          // ......................*......................................
        aesr v3.16b, v25.16b                          // .......................*.....................................
        aesr v8.16b, v26.16b                          // ........................*....................................
        aesr v3.16b, v26.16b                          // .........................*...................................
        aesr v8.16b, v27.16b                          // ..........................*..................................
        aesr v3.16b, v27.16b                          // ...........................*.................................
        aesr v8.16b, v28.16b                          // ............................*................................
        aesr v3.16b, v28.16b                          // .............................*...............................
        aesr v8.16b, v15.16b                          // ..............................*..............................
        aesr v3.16b, v15.16b                          // ...............................*.............................
        aesr v8.16b, v16.16b                          // ................................*............................
        aesr v3.16b, v16.16b                          // .................................*...........................
        aese v8.16b, v17.16b                          // ..................................*..........................
        aese v3.16b, v17.16b                          // ...................................*.........................
        eor v13.16B, v13.16B, v8.16B                  // ....................................*........................
        eor v4.16B, v4.16B, v3.16B                    // .....................................*.......................
        rev64 v8.16B, v13.16B                         // ......................................*......................
        str q13, [x2, #0]                             // ......................................*......................
        rev64 v13.16B, v4.16B                         // .......................................*.....................
        str q4, [x2, #16]                             // .......................................*.....................
        eor v4.16B, v8.16B, v30.16B                   // ........................................*....................
        mov d8, v13.d[1]                              // .........................................*...................
        pmull v3.1q, v13.1d, v1.1d                    // .........................................*...................
        pmull2 v1.1q, v13.2d, v1.2d                   // ..........................................*..................
        ext v30.16B, v4.16B, v4.16B, #8               // ..........................................*..................
        eor v13.8B, v8.8B, v13.8B                     // ...........................................*.................
        pmull2 v8.1q, v4.2d, v6.2d                    // ...........................................*.................
        pmull v6.1q, v4.1d, v6.1d                     // ............................................*................
        eor v4.16B, v30.16B, v4.16B                   // ............................................*................
        eor v1.16B, v1.16B, v8.16B                    // .............................................*...............
        pmull v13.1q, v13.1d, v10.1d                  // .............................................*...............
        pmull2 v10.1q, v4.2d, v10.2d                  // ..............................................*..............
        eor v6.16B, v3.16B, v6.16B                    // ..............................................*..............
        pmull v4.1q, v1.1d, v7.1d                     // ...............................................*.............
        ext v8.16B, v1.16B, v1.16B, #8                // ...............................................*.............
        eor v1.16B, v6.16B, v1.16B                    // ................................................*............
        eor v10.16B, v13.16B, v10.16B                 // ................................................*............
        eor v4.16B, v8.16B, v4.16B                    // .................................................*...........
        eor v1.16B, v10.16B, v1.16B                   // ..................................................*..........
        eor v1.16B, v1.16B, v4.16B                    // ....................................................*........
        pmull v10.1q, v1.1d, v7.1d                    // ......................................................*......
        ext v1.16B, v1.16B, v1.16B, #8                // ......................................................*......
        eor v6.16B, v6.16B, v10.16B                   // ........................................................*....
        eor v1.16B, v6.16B, v1.16B                    // ..........................................................*..
        ext v30.16B, v1.16B, v1.16B, #8               // ............................................................*

                                                                        // --------------------- cycle (expected) --------------------->
                                                                        // 0                        25                       50
                                                                        // |------------------------|------------------------|----------
        // ldr q12, [x6]                                                 // *............................................................
        // ldr q13, [x6, #32]                                            // .*...........................................................
        // ldr q14, [x6, #16]                                            // .*...........................................................
        // ldr q29, [x0, #(1*16)]                                        // ..*..........................................................
        // add        w14, w13, #1                                       // *............................................................
        // rev        w14, w14                                           // .*...........................................................
        // str        w14, [sp, #(STACK_BASE_AES_ST + 1*16 + 12)]        // ...*.........................................................
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 1*16)]              // .....*.......................................................
        // aesr v0.16b, v18.16b                                          // .........*...................................................
        // aesr v0.16b, v19.16b                                          // ...........*.................................................
        // aesr v0.16b, v20.16b                                          // .............*...............................................
        // aesr v0.16b, v21.16b                                          // ...............*.............................................
        // aesr v0.16b, v22.16b                                          // .................*...........................................
        // aesr v0.16b, v23.16b                                          // ...................*.........................................
        // aesr v0.16b, v24.16b                                          // .....................*.......................................
        // aesr v0.16b, v25.16b                                          // .......................*.....................................
        // aesr v0.16b, v26.16b                                          // .........................*...................................
        // aesr v0.16b, v27.16b                                          // ...........................*.................................
        // aesr v0.16b, v28.16b                                          // .............................*...............................
        // aesr v0.16b, v15.16b                                          // ...............................*.............................
        // aesr v0.16b, v16.16b                                          // .................................*...........................
        // aese v0.16b, v17.16b                                          // ...................................*.........................
        // eor v29.16b, v29.16b, v2.16b                                  // ......*......................................................
        // eor v0.16b, v29.16b, v0.16b                                   // .....................................*.......................
        // str q0, [x2, #(1*16)]                                         // .......................................*.....................
        // rev64 v0.16b, v0.16b                                          // .......................................*.....................
        // pmull   v8.1q, v0.1d, v12.1d                                  // .........................................*...................
        // pmull2  v9.1q, v0.2d, v12.2d                                  // ..........................................*..................
        // mov     d11, v0.d[1]                                          // .........................................*...................
        // eor     v11.8b, v11.8b, v0.8b                                 // ...........................................*.................
        // pmull   v10.1q, v11.1d, v14.1d                                // .............................................*...............
        // ldr q29, [x0, #(0*16)]                                        // ...*.........................................................
        // add        w14, w13, #0                                       // *............................................................
        // rev        w14, w14                                           // .*...........................................................
        // str        w14, [sp, #(STACK_BASE_AES_ST + 0*16 + 12)]        // ..*..........................................................
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 0*16)]              // ....*........................................................
        // aesr v0.16b, v18.16b                                          // ........*....................................................
        // aesr v0.16b, v19.16b                                          // ..........*..................................................
        // aesr v0.16b, v20.16b                                          // ............*................................................
        // aesr v0.16b, v21.16b                                          // ..............*..............................................
        // aesr v0.16b, v22.16b                                          // ................*............................................
        // aesr v0.16b, v23.16b                                          // ..................*..........................................
        // aesr v0.16b, v24.16b                                          // ....................*........................................
        // aesr v0.16b, v25.16b                                          // ......................*......................................
        // aesr v0.16b, v26.16b                                          // ........................*....................................
        // aesr v0.16b, v27.16b                                          // ..........................*..................................
        // aesr v0.16b, v28.16b                                          // ............................*................................
        // aesr v0.16b, v15.16b                                          // ..............................*..............................
        // aesr v0.16b, v16.16b                                          // ................................*............................
        // aese v0.16b, v17.16b                                          // ..................................*..........................
        // eor v29.16b, v29.16b, v2.16b                                  // .......*.....................................................
        // eor v0.16b, v29.16b, v0.16b                                   // ....................................*........................
        // str q0, [x2, #(0*16)]                                         // ......................................*......................
        // rev64   v0.16b, v0.16b                                        // ......................................*......................
        // eor   v0.16b, v0.16b, v30.16b                                 // ........................................*....................
        // pmull   v11.1q, v0.1d, v13.1d                                 // ............................................*................
        // eor     v8.16b, v8.16b, v11.16b                               // ..............................................*..............
        // pmull2  v11.1q, v0.2d, v13.2d                                 // ...........................................*.................
        // eor     v9.16b, v9.16b, v11.16b                               // .............................................*...............
        // ext     v11.16b, v0.16b, v0.16b, #8                           // ..........................................*..................
        // eor     v11.16b, v11.16b, v0.16b                              // ............................................*................
        // pmull2  v11.1q, v11.2d, v14.2d                                // ..............................................*..............
        // eor     v10.16b, v10.16b, v11.16b                             // ................................................*............
        // eor        v0.16b, v8.16b,  v9.16b                            // ................................................*............
        // pmull      v1.1q,  v9.1d,   v7.1d                             // ...............................................*.............
        // ext        v9.16b,    v9.16b,  v9.16b, #8                     // ...............................................*.............
        // eor        v10.16b,   v10.16b, v0.16b                         // ..................................................*..........
        // eor        v1.16b, v9.16b,  v1.16b                            // .................................................*...........
        // eor        v10.16b,   v10.16b, v1.16b                         // ....................................................*........
        // pmull      v9.1q,     v10.1d,  v7.1d                          // ......................................................*......
        // eor        v8.16b,    v8.16b,  v9.16b                         // ........................................................*....
        // ext        v10.16b,   v10.16b, v10.16b, #8                    // ......................................................*......
        // eor        v30.16b,     v8.16b,  v10.16b                      // ..........................................................*..
        // ext        v30.16b, v30.16b, v30.16b, #8                      // ............................................................*
        // add w13, w13, #2                                              // *............................................................

        Lremainder_2_end:

        b Lend

        Lremainder_1_start:
                                                      // Instructions:    43
                                                      // Expected cycles: 59
                                                      // Expected IPC:    0.73
                                                      //
                                                      // Cycle bound:     59.0
                                                      // IPC bound:       0.73
                                                      //
                                                      // Wall time:     0.27s
                                                      // User time:     0.27s
                                                      //
                                                      // -------------------- cycle (expected) -------------------->
                                                      // 0                        25                       50
                                                      // |------------------------|------------------------|--------
        ldr q14, [x6, #16]                            // *..........................................................
        add w28, w13, #0                              // *..........................................................
        ldr q29, [x0, #0]                             // .*.........................................................
        rev w19, w28                                  // .*.........................................................
        str w19, [sp, #STACK_BASE_AES_ST + 12]        // ..*........................................................ // @slothy:writes=stack_0
        add w13, w13, #1                              // ...*.......................................................
        ldr q3, [sp, #STACK_BASE_AES_ST]              // ....*...................................................... // @slothy:reads=stack_0
        eor v12.16B, v29.16B, v2.16B                  // .....*.....................................................
        ldr q29, [x6]                                 // .....*.....................................................
        aesr v3.16b, v18.16b                          // ........*..................................................
        aesr v3.16b, v19.16b                          // ..........*................................................
        aesr v3.16b, v20.16b                          // ............*..............................................
        aesr v3.16b, v21.16b                          // ..............*............................................
        aesr v3.16b, v22.16b                          // ................*..........................................
        aesr v3.16b, v23.16b                          // ..................*........................................
        aesr v3.16b, v24.16b                          // ....................*......................................
        aesr v3.16b, v25.16b                          // ......................*....................................
        aesr v3.16b, v26.16b                          // ........................*..................................
        aesr v3.16b, v27.16b                          // ..........................*................................
        aesr v3.16b, v28.16b                          // ............................*..............................
        aesr v3.16b, v15.16b                          // ..............................*............................
        aesr v3.16b, v16.16b                          // ................................*..........................
        aese v3.16b, v17.16b                          // ..................................*........................
        eor v6.16B, v12.16B, v3.16B                   // ....................................*......................
        rev64 v4.16B, v6.16B                          // ......................................*....................
        str q6, [x2, #0]                              // ......................................*....................
        eor v30.16B, v4.16B, v30.16B                  // ........................................*..................
        mov d5, v30.d[1]                              // ..........................................*................
        pmull2 v3.1q, v30.2d, v29.2d                  // ..........................................*................
        pmull v0.1q, v30.1d, v29.1d                   // ...........................................*...............
        eor v1.8B, v5.8B, v30.8B                      // ............................................*..............
        pmull v29.1q, v3.1d, v7.1d                    // ............................................*..............
        eor v5.16B, v0.16B, v3.16B                    // .............................................*.............
        pmull v6.1q, v1.1d, v14.1d                    // ..............................................*............
        ext v1.16B, v3.16B, v3.16B, #8                // ..............................................*............
        eor v8.16B, v6.16B, v5.16B                    // ................................................*..........
        eor v12.16B, v1.16B, v29.16B                  // ................................................*..........
        eor v11.16B, v8.16B, v12.16B                  // ..................................................*........
        pmull v9.1q, v11.1d, v7.1d                    // ....................................................*......
        ext v30.16B, v11.16B, v11.16B, #8             // ....................................................*......
        eor v11.16B, v0.16B, v9.16B                   // ......................................................*....
        eor v8.16B, v11.16B, v30.16B                  // ........................................................*..
        ext v30.16B, v8.16B, v8.16B, #8               // ..........................................................*

                                                                        // -------------------- cycle (expected) -------------------->
                                                                        // 0                        25                       50
                                                                        // |------------------------|------------------------|--------
        // ldr q12, [x6]                                                // .....*.....................................................
        // ldr q14, [x6, #16]                                           // *..........................................................
        // ldr q29, [x0, #(0*16)]                                       // .*.........................................................
        // add        w14, w13, #0                                      // *..........................................................
        // rev        w14, w14                                          // .*.........................................................
        // str        w14, [sp, #(STACK_BASE_AES_ST + 0*16 + 12)]       // ..*........................................................
        // ldr        q0, [sp, #(STACK_BASE_AES_ST + 0*16)]             // ....*......................................................
        // aesr v0.16b, v18.16b                                         // ........*..................................................
        // aesr v0.16b, v19.16b                                         // ..........*................................................
        // aesr v0.16b, v20.16b                                         // ............*..............................................
        // aesr v0.16b, v21.16b                                         // ..............*............................................
        // aesr v0.16b, v22.16b                                         // ................*..........................................
        // aesr v0.16b, v23.16b                                         // ..................*........................................
        // aesr v0.16b, v24.16b                                         // ....................*......................................
        // aesr v0.16b, v25.16b                                         // ......................*....................................
        // aesr v0.16b, v26.16b                                         // ........................*..................................
        // aesr v0.16b, v27.16b                                         // ..........................*................................
        // aesr v0.16b, v28.16b                                         // ............................*..............................
        // aesr v0.16b, v15.16b                                         // ..............................*............................
        // aesr v0.16b, v16.16b                                         // ................................*..........................
        // aese v0.16b, v17.16b                                         // ..................................*........................
        // eor v29.16b, v29.16b, v2.16b                                 // .....*.....................................................
        // eor v0.16b, v29.16b, v0.16b                                  // ....................................*......................
        // str q0, [x2, #(0*16)]                                        // ......................................*....................
        // rev64 v0.16b, v0.16b                                         // ......................................*....................
        // eor   v0.16b, v0.16b, v30.16b                                // ........................................*..................
        // pmull   v8.1q, v0.1d, v12.1d                                 // ...........................................*...............
        // pmull2  v9.1q, v0.2d, v12.2d                                 // ..........................................*................
        // mov     d11, v0.d[1]                                         // ..........................................*................
        // eor     v11.8b, v11.8b, v0.8b                                // ............................................*..............
        // pmull   v10.1q, v11.1d, v14.1d                               // ..............................................*............
        // eor        v0.16b, v8.16b,  v9.16b                           // .............................................*.............
        // pmull      v1.1q,  v9.1d,   v7.1d                            // ............................................*..............
        // ext        v9.16b,    v9.16b,  v9.16b, #8                    // ..............................................*............
        // eor        v10.16b,   v10.16b, v0.16b                        // ................................................*..........
        // eor        v1.16b, v9.16b,  v1.16b                           // ................................................*..........
        // eor        v10.16b,   v10.16b, v1.16b                        // ..................................................*........
        // pmull      v9.1q,     v10.1d,  v7.1d                         // ....................................................*......
        // eor        v8.16b,    v8.16b,  v9.16b                        // ......................................................*....
        // ext        v10.16b,   v10.16b, v10.16b, #8                   // ....................................................*......
        // eor        v30.16b,     v8.16b,  v10.16b                     // ........................................................*..
        // ext        v30.16b, v30.16b, v30.16b, #8                     // ..........................................................*
        // add w13, w13, #1                                             // ...*.......................................................

        Lremainder_1_end:

Lend:

        // Return number of bytes processed
        mov x0, byte_len
        // Store new authentication tag
        rev64 tag.16b, tag.16b
        str tag_q, [tag_ptr]

        // Store updated counter
        rev ctr_tmp_w, ctr
        str ctr_tmp_w, [ivec, #12]

        restore_vregs
        restore_gprs

Lenc_postamble_end:
        add sp, sp, #STACK_SIZE

        ret

#endif
#endif  // !OPENSSL_NO_ASM && defined(__AARCH64EL__) && defined(__APPLE__)
#if defined(__ELF__)
// See https:    // www.airs.com/blog/archives/518.
.section .note.GNU-stack,"",%progbits
#endif