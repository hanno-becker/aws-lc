// Copyright (c) 2022, ARM Inc.

// Permission to use, copy, modify, and/or distribute this software for any
// purpose with or without fee is hereby granted, provided that the above
// copyright notice and this permission notice appear in all copies.

// THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
// WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
// MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
// SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
// WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
// OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
// CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. */

// Author: Hanno Becker <hannobecker@posteo.de>

// This file was derived from the assembly generated from aesv8-gcm-armv8.pl,
// written by Fangming Fang <fangming.fang@arm.com> for the OpenSSL project,
// and derived from https: // github.com/ARM-software/AArch64cryptolib, original
// author Samuel Lee <Samuel.Lee@arm.com>.

// The code below is a 'clean' AArch64 implementation of AES-GCM emphasizing
// the logic of the computation. It is meant as the input to manual audits /
// formal verification, as well as automated micro-optimization such as done
// by the SLOTHY superoptimizer (https: // github.com/slothy-optimizer/slothy).

#if !defined(__has_feature)
#define __has_feature(x) 0
#endif
#if __has_feature(memory_sanitizer) && !defined(OPENSSL_NO_ASM)
#define OPENSSL_NO_ASM
#endif

#include <openssl/asm_base.h>

#if !defined(OPENSSL_NO_ASM) && defined(__AARCH64EL__)
#if defined(__ELF__)
#include <openssl/boringssl_prefix_symbols_asm.h>
#include <openssl/arm_arch.h>
.arch   armv8-a+crypto
.text
.globl  aes_gcm_enc_kernel_slothy_base_128
.hidden aes_gcm_enc_kernel_slothy_base_128
.type   aes_gcm_enc_kernel_slothy_base_128,%function
#elif defined(__APPLE__)
#if defined(BORINGSSL_PREFIX)
#include <boringssl_prefix_symbols_asm.h>
#endif
#include <openssl/arm_arch.h>
.text
.globl	_aes_gcm_enc_kernel_slothy_base_128
.private_extern	_aes_gcm_enc_kernel_slothy_base_128
#else
#error Unknown configuration
#endif

#if __ARM_MAX_ARCH__ >= 8

// Arguments
input    .req x0
len_bits .req x1
output   .req x2
tag_ptr  .req x3
ivec     .req x4
key      .req x5
Htable   .req x6

byte_len .req x15

constant_temp .req x25

count           .req x1
full_blocks     .req x7
remainder       .req x9
unroll          .req x10

aes_st    .req v0
aes_st_q  .req q0

res       .req v0
res_q     .req q0

ghash_hi    .req v9
ghash_lo    .req v8
ghash_mid   .req v10
ghash_mid_d .req d10

ghash_tmp   .req v11
ghash_tmp_d .req d11

ghash_mod   .req v7
ghash_mod_d .req d7

modulo_tmp0 .req v0
modulo_tmp1 .req v1

Ht1q    .req q12
Ht2q    .req q13
Ht12q   .req q14

Ht1    .req v12
Ht2    .req v13
Ht12   .req v14

Ht3q    .req Ht1q
Ht4q    .req Ht2q
Ht34q   .req Ht12q

Ht3    .req Ht1
Ht4    .req Ht2
Ht34   .req Ht12

Ht5q    .req Ht1q
Ht6q    .req Ht2q
Ht56q   .req Ht12q

Ht5    .req Ht1
Ht6    .req Ht2
Ht56   .req Ht12

Ht7q    .req Ht1q
Ht8q    .req Ht2q
Ht78q   .req Ht12q

Ht7    .req Ht1
Ht8    .req Ht2
Ht78   .req Ht12

rk0q   .req q18
rk1q   .req q19
rk2q   .req q20
rk3q   .req q21
rk4q   .req q22
rk5q   .req q23
rk6q   .req q24
rk7q   .req q25
rk8q   .req q26
rk9q   .req q27
rk10q  .req q28

rk0    .req v18
rk1    .req v19
rk2    .req v20
rk3    .req v21
rk4    .req v22
rk5    .req v23
rk6    .req v24
rk7    .req v25
rk8    .req v26
rk9    .req v27
rk10   .req v28

plain   .req v29
plain_q .req q29

rctr_inc   .req v30
rtmp_ctr   .req v31
rtmp_ctr_q .req q31

tag    .req v11
tag_q  .req q11

#define UNROLL 4

#define STACK_SIZE_GPRS  (6*16)
#define STACK_SIZE_VREGS (4*16)
#define STACK_SIZE  (STACK_SIZE_GPRS + STACK_SIZE_VREGS)

#define STACK_BASE_GPRS  (0)
#define STACK_BASE_VREGS (STACK_SIZE_GPRS)

/********************************************************************/
/*                 Generic preamble/postamble macros                */
/********************************************************************/

.macro save_vregs
        stp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        stp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        stp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        stp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro restore_vregs
        ldp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        ldp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        ldp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        ldp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro save_gprs
        stp x19, x20, [sp, #(STACK_BASE_GPRS + 16*0)]
        stp x21, x22, [sp, #(STACK_BASE_GPRS + 16*1)]
        stp x23, x24, [sp, #(STACK_BASE_GPRS + 16*2)]
        stp x25, x26, [sp, #(STACK_BASE_GPRS + 16*3)]
        stp x27, x28, [sp, #(STACK_BASE_GPRS + 16*4)]
        stp x29, x30, [sp, #(STACK_BASE_GPRS + 16*5)]
.endm

.macro restore_gprs
        ldp x19, x20, [sp, #(STACK_BASE_GPRS + 16*0)]
        ldp x21, x22, [sp, #(STACK_BASE_GPRS + 16*1)]
        ldp x23, x24, [sp, #(STACK_BASE_GPRS + 16*2)]
        ldp x25, x26, [sp, #(STACK_BASE_GPRS + 16*3)]
        ldp x27, x28, [sp, #(STACK_BASE_GPRS + 16*4)]
        ldp x29, x30, [sp, #(STACK_BASE_GPRS + 16*5)]
.endm

.macro prepare_loop_counts
        mov  unroll, #UNROLL
        lsr  full_blocks, byte_len, #4
        udiv count, full_blocks, unroll
        msub remainder, count, unroll, full_blocks
.endm

/********************************************************************/
/*                       AES related macros                         */
/********************************************************************/

.macro load_iv
        ldr     rtmp_ctr_q, [ivec]

 mov	constant_temp, #0x100000000   // set up counter increment
 movi	rctr_inc.16b,  #0x0
 fmov	rctr_inc.d[1], constant_temp

        rev32   rtmp_ctr.16b, rtmp_ctr.16b
.endm

.macro aes_ctr_inc
        add    rtmp_ctr.4s, rtmp_ctr.4s, rctr_inc.4s
.endm

.macro next_ctr_init_aes aes_st
        rev32  \aes_st\().16b, rtmp_ctr.16b
        aes_ctr_inc
.endm

// A single AES round
// Prevent SLOTHY from unfolding because uArchs tend to fuse AESMC+AESE
.macro aesr data, key // @slothy:no-unfold
        aese  \data, \key
        aesmc \data, \data
.endm

.macro aesr_0_8 data, key
        aesr \data\().16b, \key\()0.16b
        aesr \data\().16b, \key\()1.16b
        aesr \data\().16b, \key\()2.16b
        aesr \data\().16b, \key\()3.16b
        aesr \data\().16b, \key\()4.16b
        aesr \data\().16b, \key\()5.16b
        aesr \data\().16b, \key\()6.16b
        aesr \data\().16b, \key\()7.16b
        aesr \data\().16b, \key\()8.16b
.endm

.macro aesr_9_10 data, key
        aesr \data\().16b, \key\()9.16b
        aesr \data\().16b, \key\()10.16b
.endm

.macro aesr_11_12 data, key
        aesr \data\().16b, \key\()11.16b
        aesr \data\().16b, \key\()12.16b
.endm

// Destructs inA
.macro eor3 out, inA, inB, inC
        eor \inA, \inA, \inB
        eor \out, \inA, \inC
.endm

.macro aesr_final aes_st, plain, out
        aese \aes_st\().16b, rk9.16b
        eor3 \out\().16b, \plain\().16b, rk10.16b, \aes_st\().16b
.endm

.macro aes_full_block aes_st, input, output
        next_ctr_init_aes \aes_st
        aesr_0_8 \aes_st\(), rk
        aesr_final \aes_st, \input, \output
.endm

.macro load_round_key i
        ldr rk\i\()q, [key, #((\i)*16)]
.endm

.macro load_round_keys
        load_round_key 0
        load_round_key 1
        load_round_key 2
        load_round_key 3
        load_round_key 4
        load_round_key 5
        load_round_key 6
        load_round_key 7
        load_round_key 8
        load_round_key 9
        load_round_key 10
.endm

/********************************************************************/
/*       Loading of H-table (precomputed H-powers for GHASH)        */
/********************************************************************/

// This has to be synchronized with the H-table generation

.macro load_h1 dst, dst_q
        ldr \dst_q, [Htable]
.endm

.macro load_h2 dst, dst_q
        ldr \dst_q, [Htable, #32]
.endm

.macro load_h3 dst, dst_q
        ldr \dst_q, [Htable, #48]
.endm

.macro load_h4 dst, dst_q
        ldr \dst_q, [Htable, #80]
.endm

.macro load_h5 dst, dst_q
        ldr \dst_q, [Htable, #96]
.endm

.macro load_h6 dst, dst_q
        ldr \dst_q, [Htable, #128]
.endm

.macro load_h7 dst, dst_q
        ldr \dst_q, [Htable, #144]
.endm

.macro load_h8 dst, dst_q
        ldr \dst_q, [Htable, #176]
.endm

.macro load_h12 dst, dst_q
        ldr \dst_q, [Htable, #16]
.endm

.macro load_h34 dst, dst_q
        ldr \dst_q, [Htable, #64]
.endm

.macro load_h56 dst, dst_q
        ldr \dst_q, [Htable, #112]
.endm

.macro load_h78 dst, dst_q
        ldr \dst_q, [Htable, #160]
.endm

.macro load_full_htable
        load_h1  Ht1,  Ht1q
        load_h2  Ht2,  Ht2q
        load_h3  Ht3,  Ht3q
        load_h4  Ht4,  Ht4q
        load_h5  Ht5,  Ht5q
        load_h6  Ht6,  Ht6q
        load_h12 Ht12, Ht12q
        load_h34 Ht34, Ht34q
        load_h56 Ht56, Ht56q
.endm

.macro load_htable_12
        load_h1  Ht1,  Ht1q
        load_h2  Ht2,  Ht2q
        load_h12 Ht12, Ht12q
.endm

.macro load_htable_34
        load_h3  Ht3,  Ht3q
        load_h4  Ht4,  Ht4q
        load_h34 Ht34, Ht34q
.endm

.macro load_htable_56
        load_h5  Ht5,  Ht5q
        load_h6  Ht6,  Ht6q
        load_h56 Ht56, Ht56q
.endm

.macro load_htable_78
        load_h7  Ht7,  Ht7q
        load_h8  Ht8,  Ht8q
        load_h78 Ht78, Ht78q
.endm

/********************************************************************/
/*                    Macros for GHASH udpate                       */
/********************************************************************/

.macro ghash_init_0 input, Hk, Hk_mid, tag
        rev64 \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_mid.1q, ghash_tmp.1d, \Hk_mid\().1d
.endm

.macro ghash_init_1 input, Hk, Hk_mid, tag
        rev64 \input\().16b, \input\().16b
        eor   \input\().16b, \input\().16b, \tag\().16b
        // Low product
        pmull   ghash_lo.1q, \input\().1d, \Hk\().1d
        // High product
        pmull2  ghash_hi.1q, \input\().2d, \Hk\().2d
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_mid.1q, ghash_tmp.2d, \Hk_mid\().2d
.endm

.macro ghash_acc_0 input, Hk, Hk_mid
        rev64   \input\().16b, \input\().16b
        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        mov     ghash_tmp_d, \input\().d[1]
        eor     ghash_tmp.8b, ghash_tmp.8b, \input\().8b
        pmull   ghash_tmp.1q, ghash_tmp.1d, \Hk_mid\().1d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_acc_1 input, Hk, Hk_mid
        rev64   \input\().16b, \input\().16b

        // Low product
        pmull   ghash_tmp.1q, \input\().1d, \Hk\().1d
        eor     ghash_lo.16b, ghash_lo.16b, ghash_tmp.16b
        // High product
        pmull2  ghash_tmp.1q, \input\().2d, \Hk\().2d
        eor     ghash_hi.16b, ghash_hi.16b, ghash_tmp.16b
        // Middle product
        ext     ghash_tmp.16b, \input\().16b, \input\().16b, #8
        eor     ghash_tmp.16b, ghash_tmp.16b, \input\().16b
        pmull2  ghash_tmp.1q, ghash_tmp.2d, \Hk_mid\().2d
        eor     ghash_mid.16b, ghash_mid.16b, ghash_tmp.16b
.endm

.macro ghash_finalize tag
        eor        modulo_tmp0.16b, ghash_lo.16b,  ghash_hi.16b
        pmull      modulo_tmp1.1q,  ghash_hi.1d,   ghash_mod.1d
        ext        ghash_hi.16b,    ghash_hi.16b,  ghash_hi.16b, #8
        eor        ghash_mid.16b,   ghash_mid.16b, modulo_tmp0.16b
        eor        modulo_tmp1.16b, ghash_hi.16b,  modulo_tmp1.16b
        eor        ghash_mid.16b,   ghash_mid.16b, modulo_tmp1.16b
        pmull      ghash_hi.1q,     ghash_mid.1d,  ghash_mod.1d
        eor        ghash_lo.16b,    ghash_lo.16b,  ghash_hi.16b
        ext        ghash_mid.16b,   ghash_mid.16b, ghash_mid.16b, #8
        eor        \tag\().16b,     ghash_lo.16b,  ghash_mid.16b
        ext        \tag\().16b, \tag\().16b, \tag\().16b, #8
.endm

.macro load_tag
        ldr      tag_q, [tag_ptr]
        rev64    tag.16b, tag.16b
.endm

.macro prepare_ghash
        // Prepare constant for modular reduction
        movi ghash_mod.8b, #0xc2
        shl  ghash_mod_d, ghash_mod_d, #56
.endm

/********************************************************************/
/*                            Core routine                          */
/********************************************************************/

.align        4
_aes_gcm_enc_kernel_slothy_base_128:
aes_gcm_enc_kernel_slothy_base_128:
#ifdef BORINGSSL_DISPATCH_TEST
        adrp  x9,_BORINGSSL_function_hit@PAGE
        add   x9, x9, _BORINGSSL_function_hit@PAGEOFF
        mov   w10, #1
        strb  w10, [x9,#2] // kFlag_aes_gcm_enc_kernel
#endif

        AARCH64_VALID_CALL_TARGET
        sub sp, sp, #STACK_SIZE

Lenc_preamble_start:
        save_gprs
        save_vregs

        lsr byte_len, len_bits, #3

        load_tag
        load_iv

        prepare_loop_counts
        prepare_ghash

Lenc_preamble_end:

        cbz count, Lloop_unrolled_end
        cmp count, #1
        b.eq Lloop_unrolled_start_iter_1
                                                 // Instructions:    142
                                                 // Expected cycles: 71
                                                 // Expected IPC:    2.00
                                                 //
                                                 // Cycle bound:     71.0
                                                 // IPC bound:       2.00
                                                 //
                                                 // Wall time:     137.96s
                                                 // User time:     137.96s
                                                 //
                                                 // -------------------------- cycle (expected) -------------------------->
                                                 // 0                        25                       50
                                                 // |------------------------|------------------------|--------------------
        ldr q20, [x0, #16]                       // *......................................................................
        add v0.4S, v31.4S, v30.4S                // *......................................................................
        ldr q1, [x5, #128]                       // .*.....................................................................
        ldr q18, [x5, #0]                        // .*.....................................................................
        rev32 v8.16B, v0.16B                     // ..*....................................................................
        add v27.4S, v0.4S, v30.4S                // ..*....................................................................
        ldr q14, [x5, #16]                       // ...*...................................................................
        rev32 v4.16B, v31.16B                    // ...*...................................................................
        rev32 v21.16B, v27.16B                   // ....*..................................................................
        ldr q28, [x5, #144]                      // ....*..................................................................
        aesr v4.16b, v18.16b                     // .....*.................................................................
        ldr q23, [x5, #32]                       // .....*.................................................................
        aesr v21.16b, v18.16b                    // ......*................................................................
        ldr q24, [x5, #48]                       // ......*................................................................
        aesr v4.16b, v14.16b                     // .......*...............................................................
        ldr q31, [x5, #160]                      // .......*...............................................................
        aesr v21.16b, v14.16b                    // ........*..............................................................
        ldr q10, [x0, #32]                       // ........*..............................................................
        ldr q22, [x5, #64]                       // .........*.............................................................
        aesr v4.16b, v23.16b                     // .........*.............................................................
        ldr q0, [x5, #80]                        // ..........*............................................................
        aesr v21.16b, v23.16b                    // ..........*............................................................
        aesr v4.16b, v24.16b                     // ...........*...........................................................
        ldr q3, [x5, #112]                       // ...........*...........................................................
        eor v15.16B, v10.16B, v31.16B            // ............*..........................................................
        aesr v21.16b, v24.16b                    // ............*..........................................................
        aesr v4.16b, v22.16b                     // .............*.........................................................
        ldr q25, [x5, #96]                       // .............*.........................................................
        ldr q13, [x0, #48]                       // ..............*........................................................
        aesr v21.16b, v22.16b                    // ..............*........................................................
        aesr v4.16b, v0.16b                      // ...............*.......................................................
        ldr q10, [x0], #(4*16)                   // ...............*.......................................................
        aesr v21.16b, v0.16b                     // ................*......................................................
        add v19.4S, v27.4S, v30.4S               // ................*......................................................
        ldr q9, [x6, #32]                        // .................*.....................................................
        aesr v4.16b, v25.16b                     // .................*.....................................................
        aesr v21.16b, v25.16b                    // ..................*....................................................
        rev32 v27.16B, v19.16B                   // ..................*....................................................
        aesr v4.16b, v3.16b                      // ...................*...................................................
        eor v12.16B, v10.16B, v31.16B            // ...................*...................................................
        eor v6.16B, v20.16B, v31.16B             // ....................*..................................................
        aesr v21.16b, v3.16b                     // ....................*..................................................
        aesr v4.16b, v1.16b                      // .....................*.................................................
        ldr q26, [x6, #80]                       // .....................*.................................................
        add v29.4S, v19.4S, v30.4S               // ......................*................................................
        aesr v21.16b, v1.16b                     // ......................*................................................
        aese v4.16b, v28.16b                     // .......................*...............................................
        ldr q17, [x5, #48]                       // .......................*...............................................
        aese v21.16b, v28.16b                    // ........................*..............................................
        add v10.4S, v29.4S, v30.4S               // ........................*..............................................
        aesr v8.16b, v18.16b                     // .........................*.............................................
        eor v16.16B, v12.16B, v4.16B             // .........................*.............................................
        aesr v27.16b, v18.16b                    // ..........................*............................................
        eor v20.16B, v15.16B, v21.16B            // ..........................*............................................
        aesr v8.16b, v14.16b                     // ...........................*...........................................
        rev64 v18.16B, v16.16B                   // ...........................*...........................................
        aesr v27.16b, v14.16b                    // ............................*..........................................
        rev64 v5.16B, v20.16B                    // ............................*..........................................
        aesr v8.16b, v23.16b                     // .............................*.........................................
        eor v19.16B, v18.16B, v11.16B            // .............................*.........................................
        ext v21.16B, v5.16B, v5.16B, #8          // ..............................*........................................
        pmull v14.1q, v5.1d, v9.1d               // ..............................*........................................
        str q16, [x2], #(4*16)                   // ...............................*.......................................
        aesr v27.16b, v23.16b                    // ...............................*.......................................
        str q20, [x2, #-32]                      // ................................*......................................
        aesr v8.16b, v24.16b                     // ................................*......................................
        aesr v27.16b, v24.16b                    // .................................*.....................................
        rev32 v4.16B, v29.16B                    // .................................*.....................................
        aesr v8.16b, v22.16b                     // ..................................*....................................
        ext v20.16B, v19.16B, v19.16B, #8        // ..................................*....................................
        aesr v27.16b, v22.16b                    // ...................................*...................................
        eor v23.16B, v13.16B, v31.16B            // ...................................*...................................
        aesr v8.16b, v0.16b                      // ....................................*..................................
        eor v20.16B, v20.16B, v19.16B            // ....................................*..................................
        aesr v27.16b, v0.16b                     // .....................................*.................................
        ldr q22, [x6, #48]                       // .....................................*.................................
        aesr v8.16b, v25.16b                     // ......................................*................................
        ldr q29, [x5, #32]                       // ......................................*................................
        ldr q18, [x6, #64]                       // .......................................*...............................
        aesr v27.16b, v25.16b                    // .......................................*...............................
        rev32 v31.16B, v10.16B                   // ........................................*..............................
        aesr v8.16b, v3.16b                      // ........................................*..............................
        aesr v27.16b, v3.16b                     // .........................................*.............................
        add v16.4S, v10.4S, v30.4S               // .........................................*.............................
        ldr q13, [x6, #16]                       // ..........................................*............................
        aesr v8.16b, v1.16b                      // ..........................................*............................
        rev32 v24.16B, v16.16B                   // ...........................................*...........................
        aesr v27.16b, v1.16b                     // ...........................................*...........................
        aese v8.16b, v28.16b                     // ............................................*..........................
        add v2.4S, v16.4S, v30.4S                // ............................................*..........................
        aese v27.16b, v28.16b                    // .............................................*.........................
        eor v1.16B, v21.16B, v5.16B              // .............................................*.........................
        eor v12.16B, v6.16B, v8.16B              // ..............................................*........................
        pmull v21.1q, v19.1d, v26.1d             // ..............................................*........................
        ldr q8, [x5, #0]                         // ...............................................*.......................
        pmull2 v10.1q, v1.2d, v13.2d             // ...............................................*.......................
        pmull2 v11.1q, v20.2d, v18.2d            // ................................................*......................
        rev64 v16.16B, v12.16B                   // ................................................*......................
        ldr q1, [x5, #16]                        // .................................................*.....................
        pmull2 v20.1q, v19.2d, v26.2d            // .................................................*.....................
        pmull v26.1q, v16.1d, v22.1d             // ..................................................*....................
        mov d19, v16.d[1]                        // ..................................................*....................
        pmull2 v15.1q, v16.2d, v22.2d            // ...................................................*...................
        ldr q6, [x5, #96]                        // ...................................................*...................
        eor v19.8B, v19.8B, v16.8B               // ....................................................*..................
        aesr v4.16b, v8.16b                      // ....................................................*..................
        eor v28.16B, v21.16B, v26.16B            // .....................................................*.................
        pmull2 v21.1q, v5.2d, v9.2d              // .....................................................*.................
        eor v26.16B, v20.16B, v15.16B            // ......................................................*................
        aesr v4.16b, v1.16b                      // ......................................................*................
        aesr v24.16b, v8.16b                     // .......................................................*...............
        ldr q5, [x5, #80]                        // .......................................................*...............
        pmull v19.1q, v19.1d, v18.1d             // ........................................................*..............
        eor v18.16B, v28.16B, v14.16B            // ........................................................*..............
        ldr q28, [x6]                            // .........................................................*.............
        aesr v24.16b, v1.16b                     // .........................................................*.............
        aesr v4.16b, v29.16b                     // ..........................................................*............
        ldr q15, [x5, #64]                       // ..........................................................*............
        ldr q9, [x5, #160]                       // ...........................................................*...........
        aesr v24.16b, v29.16b                    // ...........................................................*...........
        eor v26.16B, v26.16B, v21.16B            // ............................................................*..........
        aesr v4.16b, v17.16b                     // ............................................................*..........
        rev32 v22.16B, v2.16B                    // .............................................................*.........
        aesr v24.16b, v17.16b                    // .............................................................*.........
        eor v16.16B, v23.16B, v27.16B            // ..............................................................*........
        aesr v4.16b, v15.16b                     // ..............................................................*........
        aesr v24.16b, v15.16b                    // ...............................................................*.......
        ldr q27, [x0], #(4*16)                   // ...............................................................*.......
        aesr v4.16b, v5.16b                      // ................................................................*......
        ldr q23, [x5, #112]                      // ................................................................*......
        eor v20.16B, v11.16B, v19.16B            // .................................................................*.....
        aesr v31.16b, v8.16b                     // .................................................................*.....
        aesr v4.16b, v6.16b                      // ..................................................................*....
        ldr q3, [x5, #128]                       // ..................................................................*....
        ldr q11, [x0, #-32]                      // ...................................................................*...
        aesr v24.16b, v5.16b                     // ...................................................................*...
        eor v25.16B, v27.16B, v9.16B             // ....................................................................*..
        aesr v4.16b, v23.16b                     // ....................................................................*..
        ldr q0, [x5, #144]                       // .....................................................................*.
        aesr v24.16b, v6.16b                     // .....................................................................*.
        aesr v4.16b, v3.16b                      // ......................................................................*
        str q16, [x2, #-16]                      // ......................................................................*

                                                                       // -------------------------- cycle (expected) -------------------------->
                                                                       // 0                        25                       50
                                                                       // |------------------------|------------------------|--------------------
        // ldr Q<ssa_43>, [x5, #128]                                   // .*.....................................................................
        // rev32 V<ssa_47>.16B, v31.16B                                // ...*...................................................................
        // ldr Q<ssa_51>, [x5, #144]                                   // ....*..................................................................
        // ldr Q<ssa_57>, [x5, #0]                                     // .*.....................................................................
        // add V<ssa_58>.4S, v31.4S, v30.4S                            // *......................................................................
        // ldr Q<ssa_61>, [x5, #16]                                    // ...*...................................................................
        // add V<ssa_62>.4S, V<ssa_58>.4S, v30.4S                      // ..*....................................................................
        // rev32 V<ssa_63>.16B, V<ssa_58>.16B                          // ..*....................................................................
        // ldr Q<ssa_64>, [x5, #32]                                    // .....*.................................................................
        // aesr V<ssa_47>.16b, V<ssa_57>.16b                           // .....*.................................................................
        // ldr Q<ssa_65>, [x5, #48]                                    // ......*................................................................
        // rev32 V<ssa_66>.16B, V<ssa_62>.16B                          // ....*..................................................................
        // aesr V<ssa_47>.16b, V<ssa_61>.16b                           // .......*...............................................................
        // ldr Q<ssa_68>, [x5, #64]                                    // .........*.............................................................
        // aesr V<ssa_63>.16b, V<ssa_57>.16b                           // .........................*.............................................
        // ldr Q<ssa_69>, [x5, #112]                                   // ...........*...........................................................
        // aesr V<ssa_47>.16b, V<ssa_64>.16b                           // .........*.............................................................
        // add V<ssa_70>.4S, V<ssa_62>.4S, v30.4S                      // ................*......................................................
        // aesr V<ssa_66>.16b, V<ssa_57>.16b                           // ......*................................................................
        // ldr Q<ssa_71>, [x5, #80]                                    // ..........*............................................................
        // aesr V<ssa_47>.16b, V<ssa_65>.16b                           // ...........*...........................................................
        // aesr V<ssa_66>.16b, V<ssa_61>.16b                           // ........*..............................................................
        // ldr Q<ssa_72>, [x0, #32]                                    // ........*..............................................................
        // ldr Q<ssa_73>, [x5, #96]                                    // .............*.........................................................
        // aesr V<ssa_47>.16b, V<ssa_68>.16b                           // .............*.........................................................
        // aesr V<ssa_66>.16b, V<ssa_64>.16b                           // ..........*............................................................
        // aesr V<ssa_47>.16b, V<ssa_71>.16b                           // ...............*.......................................................
        // aesr V<ssa_66>.16b, V<ssa_65>.16b                           // ............*..........................................................
        // ldr Q<ssa_77>, [x0], #(4*16)                                // ...............*.......................................................
        // aesr V<ssa_47>.16b, V<ssa_73>.16b                           // .................*.....................................................
        // ldr Q<ssa_78>, [x5, #160]                                   // .......*...............................................................
        // aesr V<ssa_66>.16b, V<ssa_68>.16b                           // ..............*........................................................
        // aesr V<ssa_47>.16b, V<ssa_69>.16b                           // ...................*...................................................
        // rev32 V<ssa_80>.16B, V<ssa_70>.16B                          // ..................*....................................................
        // aesr V<ssa_66>.16b, V<ssa_71>.16b                           // ................*......................................................
        // aesr V<ssa_47>.16b, V<ssa_43>.16b                           // .....................*.................................................
        // aesr V<ssa_66>.16b, V<ssa_73>.16b                           // ..................*....................................................
        // eor V<ssa_81>.16B, V<ssa_77>.16B, V<ssa_78>.16B             // ...................*...................................................
        // aese V<ssa_47>.16b, V<ssa_51>.16b                           // .......................*...............................................
        // aesr V<ssa_66>.16b, V<ssa_69>.16b                           // ....................*..................................................
        // eor V<ssa_83>.16B, V<ssa_81>.16B, V<ssa_47>.16B             // .........................*.............................................
        // aesr V<ssa_63>.16b, V<ssa_61>.16b                           // ...........................*...........................................
        // ldr Q<ssa_85>, [x0, #-48]                                   // *......................................................................
        // aesr V<ssa_66>.16b, V<ssa_43>.16b                           // ......................*................................................
        // aesr V<ssa_80>.16b, V<ssa_57>.16b                           // ..........................*............................................
        // str Q<ssa_83>, [x2], #(4*16)                                // ...............................*.......................................
        // aesr V<ssa_63>.16b, V<ssa_64>.16b                           // .............................*.........................................
        // aesr V<ssa_80>.16b, V<ssa_61>.16b                           // ............................*..........................................
        // ldr Q<ssa_90>, [x6, #32]                                    // .................*.....................................................
        // aese V<ssa_66>.16b, V<ssa_51>.16b                           // ........................*..............................................
        // eor V<ssa_91>.16B, V<ssa_72>.16B, V<ssa_78>.16B             // ............*..........................................................
        // ldr Q<ssa_94>, [x6, #48]                                    // .....................................*.................................
        // aesr V<ssa_63>.16b, V<ssa_65>.16b                           // ................................*......................................
        // aesr V<ssa_80>.16b, V<ssa_64>.16b                           // ...............................*.......................................
        // eor V<ssa_96>.16B, V<ssa_91>.16B, V<ssa_66>.16B             // ..........................*............................................
        // aesr V<ssa_63>.16b, V<ssa_68>.16b                           // ..................................*....................................
        // aesr V<ssa_80>.16b, V<ssa_65>.16b                           // .................................*.....................................
        // eor V<ssa_98>.16B, V<ssa_85>.16B, V<ssa_78>.16B             // ....................*..................................................
        // aesr V<ssa_63>.16b, V<ssa_71>.16b                           // ....................................*..................................
        // aesr V<ssa_80>.16b, V<ssa_68>.16b                           // ...................................*...................................
        // rev64 V<ssa_100>.16B, V<ssa_83>.16B                         // ...........................*...........................................
        // aesr V<ssa_63>.16b, V<ssa_73>.16b                           // ......................................*................................
        // aesr V<ssa_80>.16b, V<ssa_71>.16b                           // .....................................*.................................
        // aesr V<ssa_63>.16b, V<ssa_69>.16b                           // ........................................*..............................
        // rev64 V<ssa_102>.16B, V<ssa_96>.16B                         // ............................*..........................................
        // aesr V<ssa_63>.16b, V<ssa_43>.16b                           // ..........................................*............................
        // ext V<ssa_105>.16B, V<ssa_102>.16B, V<ssa_102>.16B, #8      // ..............................*........................................
        // pmull V<ssa_107>.1q, V<ssa_102>.1d, V<ssa_90>.1d            // ..............................*........................................
        // str Q<ssa_96>, [x2, #-32]                                   // ................................*......................................
        // eor V<ssa_108>.16B, V<ssa_105>.16B, V<ssa_102>.16B          // .............................................*.........................
        // aese V<ssa_63>.16b, V<ssa_51>.16b                           // ............................................*..........................
        // aesr V<ssa_80>.16b, V<ssa_73>.16b                           // .......................................*...............................
        // ldr q13, [x6, #16]                                          // ..........................................*............................
        // eor v12.16B, V<ssa_98>.16B, V<ssa_63>.16B                   // ..............................................*........................
        // aesr V<ssa_80>.16b, V<ssa_69>.16b                           // .........................................*.............................
        // add V<ssa_111>.4S, V<ssa_70>.4S, v30.4S                     // ......................*................................................
        // rev64 V<ssa_112>.16B, v12.16B                               // ................................................*......................
        // aesr V<ssa_80>.16b, V<ssa_43>.16b                           // ...........................................*...........................
        // mov D<ssa_115>, V<ssa_112>.d[1]                             // ..................................................*....................
        // pmull2 V<ssa_116>.1q, V<ssa_112>.2d, V<ssa_94>.2d           // ...................................................*...................
        // pmull2 v10.1q, V<ssa_108>.2d, v13.2d                        // ...............................................*.......................
        // ldr Q<ssa_118>, [x6, #80]                                   // .....................*.................................................
        // pmull V<ssa_119>.1q, V<ssa_112>.1d, V<ssa_94>.1d            // ..................................................*....................
        // ldr Q<ssa_121>, [x0, #-16]                                  // ..............*........................................................
        // aese V<ssa_80>.16b, V<ssa_51>.16b                           // .............................................*.........................
        // ldr q3, [x5, #128]                                          // ..................................................................*....
        // eor V<ssa_122>.16B, V<ssa_100>.16B, v11.16B                 // .............................*.........................................
        // ldr Q<ssa_123>, [x6, #64]                                   // .......................................*...............................
        // eor V<ssa_124>.8B, V<ssa_115>.8B, V<ssa_112>.8B             // ....................................................*..................
        // rev32 v4.16B, V<ssa_111>.16B                                // .................................*.....................................
        // ext V<ssa_125>.16B, V<ssa_122>.16B, V<ssa_122>.16B, #8      // ..................................*....................................
        // pmull V<ssa_126>.1q, V<ssa_122>.1d, V<ssa_118>.1d           // ..............................................*........................
        // pmull2 V<ssa_127>.1q, V<ssa_122>.2d, V<ssa_118>.2d          // .................................................*.....................
        // ldr q0, [x5, #144]                                          // .....................................................................*.
        // eor V<ssa_128>.16B, V<ssa_126>.16B, V<ssa_119>.16B          // .....................................................*.................
        // pmull V<ssa_129>.1q, V<ssa_124>.1d, V<ssa_123>.1d           // ........................................................*..............
        // eor V<ssa_130>.16B, V<ssa_121>.16B, V<ssa_78>.16B           // ...................................*...................................
        // eor V<ssa_131>.16B, V<ssa_125>.16B, V<ssa_122>.16B          // ....................................*..................................
        // eor v18.16B, V<ssa_128>.16B, V<ssa_107>.16B                 // ........................................................*..............
        // ldr q8, [x5, #0]                                            // ...............................................*.......................
        // add V<ssa_132>.4S, V<ssa_111>.4S, v30.4S                    // ........................*..............................................
        // pmull2 V<ssa_133>.1q, V<ssa_102>.2d, V<ssa_90>.2d           // .....................................................*.................
        // pmull2 V<ssa_134>.1q, V<ssa_131>.2d, V<ssa_123>.2d          // ................................................*......................
        // ldr q1, [x5, #16]                                           // .................................................*.....................
        // add V<ssa_135>.4S, V<ssa_132>.4S, v30.4S                    // .........................................*.............................
        // rev32 v31.16B, V<ssa_132>.16B                               // ........................................*..............................
        // ldr q29, [x5, #32]                                          // ......................................*................................
        // aesr v4.16b, v8.16b                                         // ....................................................*..................
        // ldr q17, [x5, #48]                                          // .......................*...............................................
        // rev32 v24.16B, V<ssa_135>.16B                               // ...........................................*...........................
        // eor V<ssa_136>.16B, V<ssa_127>.16B, V<ssa_116>.16B          // ......................................................*................
        // aesr v4.16b, v1.16b                                         // ......................................................*................
        // ldr q15, [x5, #64]                                          // ..........................................................*............
        // aesr v31.16b, v8.16b                                        // .................................................................*.....
        // ldr q23, [x5, #112]                                         // ................................................................*......
        // aesr v4.16b, v29.16b                                        // ..........................................................*............
        // add v2.4S, V<ssa_135>.4S, v30.4S                            // ............................................*..........................
        // aesr v24.16b, v8.16b                                        // .......................................................*...............
        // ldr q5, [x5, #80]                                           // .......................................................*...............
        // aesr v4.16b, v17.16b                                        // ............................................................*..........
        // aesr v24.16b, v1.16b                                        // .........................................................*.............
        // ldr q11, [x0, #32]                                          // ...................................................................*...
        // ldr q6, [x5, #96]                                           // ...................................................*...................
        // aesr v4.16b, v15.16b                                        // ..............................................................*........
        // eor v26.16B, V<ssa_136>.16B, V<ssa_133>.16B                 // ............................................................*..........
        // aesr v24.16b, v29.16b                                       // ...........................................................*...........
        // eor v16.16B, V<ssa_130>.16B, V<ssa_80>.16B                  // ..............................................................*........
        // aesr v4.16b, v5.16b                                         // ................................................................*......
        // ldr q28, [x6]                                               // .........................................................*.............
        // aesr v24.16b, v17.16b                                       // .............................................................*.........
        // ldr Q<ssa_137>, [x0], #(4*16)                               // ...............................................................*.......
        // aesr v4.16b, v6.16b                                         // ..................................................................*....
        // ldr q9, [x5, #160]                                          // ...........................................................*...........
        // aesr v24.16b, v15.16b                                       // ...............................................................*.......
        // eor v20.16B, V<ssa_134>.16B, V<ssa_129>.16B                 // .................................................................*.....
        // aesr v4.16b, v23.16b                                        // ....................................................................*..
        // rev32 v22.16B, v2.16B                                       // .............................................................*.........
        // aesr v24.16b, v5.16b                                        // ...................................................................*...
        // str q16, [x2, #-16]                                         // ......................................................................*
        // aesr v4.16b, v3.16b                                         // ......................................................................*
        // aesr v24.16b, v6.16b                                        // .....................................................................*.
        // eor v25.16B, V<ssa_137>.16B, v9.16B                         // ....................................................................*..

        sub count, count, #2
cbz count, Lloop_unrolled_start_postamble
Lloop_unrolled_start:
                                                 // Instructions:    126
                                                 // Expected cycles: 63
                                                 // Expected IPC:    2.00
                                                 //
                                                 // Cycle bound:     54.0
                                                 // IPC bound:       2.33
                                                 //
                                                 // Wall time:     1802.13s
                                                 // User time:     1802.13s
                                                 //
                                                 // ---------------------- cycle (expected) ---------------------->
                                                 // 0                        25                       50
                                                 // |------------------------|------------------------|------------
        rev64 v14.16B, v16.16B                   // l..............................................................
        aese v4.16b, v0.16b                      // *..............................................................
        str q12, [x2, #-48]                      // .l.............................................................
        aesr v24.16b, v23.16b                    // .*.............................................................
        eor v19.16B, v25.16B, v4.16B             // ..*............................................................
        pmull2 v16.1q, v14.2d, v28.2d            // ..l............................................................
        aesr v31.16b, v1.16b                     // ...*...........................................................
        ldr q12, [x0, #-48]                      // ...*...........................................................
        mov d25, v14.d[1]                        // ....l..........................................................
        aesr v24.16b, v3.16b                     // ....*..........................................................
        aesr v22.16b, v8.16b                     // .....*.........................................................
        str q19, [x2], #(4*16)                   // .....*.........................................................
        eor v8.8B, v25.8B, v14.8B                // ......l........................................................
        aesr v31.16b, v29.16b                    // ......*........................................................
        eor v10.16B, v20.16B, v10.16B            // .......l.......................................................
        aesr v22.16b, v1.16b                     // .......*.......................................................
        pmull v1.1q, v8.1d, v13.1d               // ........l......................................................
        ldr q25, [x6, #32]                       // ........*......................................................
        aese v24.16b, v0.16b                     // .........*.....................................................
        eor v20.16B, v11.16B, v9.16B             // .........*.....................................................
        pmull v13.1q, v14.1d, v28.1d             // ..........l....................................................
        eor v1.16B, v10.16B, v1.16B              // ..........l....................................................
        ldr q21, [x6, #48]                       // ...........*...................................................
        aesr v31.16b, v17.16b                    // ...........*...................................................
        eor v8.16B, v18.16B, v13.16B             // ............l..................................................
        aesr v22.16b, v29.16b                    // ............*..................................................
        eor v11.16B, v20.16B, v24.16B            // .............*.................................................
        aesr v31.16b, v15.16b                    // .............*.................................................
        aesr v22.16b, v17.16b                    // ..............*................................................
        eor v24.16B, v26.16B, v16.16B            // ..............l................................................
        eor v16.16B, v12.16B, v9.16B             // ...............*...............................................
        aesr v31.16b, v5.16b                     // ...............*...............................................
        ext v20.16B, v24.16B, v24.16B, #8        // ................l..............................................
        aesr v22.16b, v15.16b                    // ................*..............................................
        rev64 v4.16B, v19.16B                    // .................*.............................................
        aesr v31.16b, v6.16b                     // .................*.............................................
        aesr v22.16b, v5.16b                     // ..................*............................................
        eor v26.16B, v8.16B, v24.16B             // ..................l............................................
        aesr v31.16b, v23.16b                    // ...................*...........................................
        rev64 v28.16B, v11.16B                   // ...................*...........................................
        pmull v12.1q, v24.1d, v7.1d              // ....................l..........................................
        eor v13.16B, v1.16B, v26.16B             // ....................l..........................................
        aesr v31.16b, v3.16b                     // .....................*.........................................
        ext v15.16B, v28.16B, v28.16B, #8        // .....................*.........................................
        eor v17.16B, v20.16B, v12.16B            // ......................l........................................
        pmull v18.1q, v28.1d, v25.1d             // ......................*........................................
        str q11, [x2, #-32]                      // .......................*.......................................
        eor v1.16B, v15.16B, v28.16B             // .......................*.......................................
        aese v31.16b, v0.16b                     // ........................*......................................
        eor v10.16B, v13.16B, v17.16B            // ........................l......................................
        aesr v22.16b, v6.16b                     // .........................*.....................................
        ldr q13, [x6, #16]                       // .........................*.....................................
        pmull v15.1q, v10.1d, v7.1d              // ..........................l....................................
        eor v12.16B, v16.16B, v31.16B            // ..........................*....................................
        aesr v22.16b, v23.16b                    // ...........................*...................................
        add v31.4S, v2.4S, v30.4S                // ...........................*...................................
        rev64 v26.16B, v12.16B                   // ............................*..................................
        eor v2.16B, v8.16B, v15.16B              // ............................l..................................
        ext v23.16B, v10.16B, v10.16B, #8        // .............................l.................................
        aesr v22.16b, v3.16b                     // .............................*.................................
        mov d16, v26.d[1]                        // ..............................*................................
        pmull2 v19.1q, v26.2d, v21.2d            // ..............................*................................
        eor v14.16B, v2.16B, v23.16B             // ...............................l...............................
        pmull2 v10.1q, v1.2d, v13.2d             // ...............................*...............................
        ldr q8, [x6, #80]                        // ................................*..............................
        pmull v1.1q, v26.1d, v21.1d              // ................................*..............................
        ext v11.16B, v14.16B, v14.16B, #8        // .................................l.............................
        ldr q29, [x0, #-16]                      // .................................*.............................
        aese v22.16b, v0.16b                     // ..................................*............................
        ldr q3, [x5, #128]                       // ..................................e............................
        eor v11.16B, v4.16B, v11.16B             // ...................................*...........................
        ldr q15, [x6, #64]                       // ...................................*...........................
        eor v20.8B, v16.8B, v26.8B               // ....................................*..........................
        rev32 v4.16B, v31.16B                    // ....................................e..........................
        ext v24.16B, v11.16B, v11.16B, #8        // .....................................*.........................
        pmull v23.1q, v11.1d, v8.1d              // .....................................*.........................
        pmull2 v6.1q, v11.2d, v8.2d              // ......................................*........................
        ldr q0, [x5, #144]                       // ......................................e........................
        eor v8.16B, v23.16B, v1.16B              // .......................................*.......................
        pmull v20.1q, v20.1d, v15.1d             // .......................................*.......................
        eor v21.16B, v29.16B, v9.16B             // ........................................*......................
        eor v1.16B, v24.16B, v11.16B             // ........................................*......................
        eor v18.16B, v8.16B, v18.16B             // .........................................*.....................
        ldr q8, [x5, #0]                         // .........................................e.....................
        add v16.4S, v31.4S, v30.4S               // ..........................................e....................
        pmull2 v25.1q, v28.2d, v25.2d            // ..........................................*....................
        pmull2 v14.1q, v1.2d, v15.2d             // ...........................................*...................
        ldr q1, [x5, #16]                        // ...........................................e...................
        add v2.4S, v16.4S, v30.4S                // ............................................e..................
        rev32 v31.16B, v16.16B                   // ............................................e..................
        ldr q29, [x5, #32]                       // .............................................e.................
        aesr v4.16b, v8.16b                      // .............................................e.................
        ldr q17, [x5, #48]                       // ..............................................e................
        rev32 v24.16B, v2.16B                    // ..............................................e................
        eor v26.16B, v6.16B, v19.16B             // ...............................................*...............
        aesr v4.16b, v1.16b                      // ...............................................e...............
        ldr q15, [x5, #64]                       // ................................................e..............
        aesr v31.16b, v8.16b                     // ................................................e..............
        ldr q23, [x5, #112]                      // .................................................e.............
        aesr v4.16b, v29.16b                     // .................................................e.............
        add v2.4S, v2.4S, v30.4S                 // ..................................................e............
        aesr v24.16b, v8.16b                     // ..................................................e............
        ldr q5, [x5, #80]                        // ...................................................e...........
        aesr v4.16b, v17.16b                     // ...................................................e...........
        aesr v24.16b, v1.16b                     // ....................................................e..........
        ldr q11, [x0, #32]                       // ....................................................e..........
        ldr q6, [x5, #96]                        // .....................................................e.........
        aesr v4.16b, v15.16b                     // .....................................................e.........
        eor v26.16B, v26.16B, v25.16B            // ......................................................*........
        aesr v24.16b, v29.16b                    // ......................................................e........
        eor v16.16B, v21.16B, v22.16B            // .......................................................*.......
        aesr v4.16b, v5.16b                      // .......................................................e.......
        ldr q28, [x6]                            // ........................................................*......
        aesr v24.16b, v17.16b                    // ........................................................e......
        ldr q27, [x0], #(4*16)                   // .........................................................e.....
        aesr v4.16b, v6.16b                      // .........................................................e.....
        ldr q9, [x5, #160]                       // ..........................................................e....
        aesr v24.16b, v15.16b                    // ..........................................................e....
        eor v20.16B, v14.16B, v20.16B            // ...........................................................*...
        aesr v4.16b, v23.16b                     // ...........................................................e...
        rev32 v22.16B, v2.16B                    // ............................................................e..
        aesr v24.16b, v5.16b                     // ............................................................e..
        str q16, [x2, #-16]                      // .............................................................*.
        aesr v4.16b, v3.16b                      // .............................................................e.
        aesr v24.16b, v6.16b                     // ..............................................................e
        eor v25.16B, v27.16B, v9.16B             // ..............................................................e

                                                           // ----------------------------------------------------- cycle (expected) ------------------------------------------------------>
                                                           // 0                        25                       50                       75                       100
                                                           // |------------------------|------------------------|------------------------|------------------------|-------------------------
        // ldr q18, [x5, #((0)*16)]                        // .......e.....................'........................................~.....................'.................................
        // ldr q19, [x5, #((1)*16)]                        // .........e...................'..........................................~...................'.................................
        // ldr q20, [x5, #((2)*16)]                        // ...........e.................'............................................~.................'.................................
        // ldr q21, [x5, #((3)*16)]                        // ............e................'.............................................~................'.................................
        // ldr q22, [x5, #((4)*16)]                        // ..............e..............'...............................................~..............'.................................
        // ldr q23, [x5, #((5)*16)]                        // .................e...........'..................................................~...........'.................................
        // ldr q24, [x5, #((6)*16)]                        // ...................e.........'....................................................~.........'.................................
        // ldr q25, [x5, #((7)*16)]                        // ...............e.............'................................................~.............'.................................
        // ldr q26, [x5, #((8)*16)]                        // e............................'.................................~............................'.................................
        // ldr q27, [x5, #((9)*16)]                        // ....e........................'.....................................~........................'.................................
        // ldr q28, [x5, #((10)*16)]                       // ........................e....'.........................................................~....'.................................
        // ldr q29, [x0], #(4*16)                          // .......................e.....'........................................................~.....'.................................
        // rev32  v0.16b, v31.16b                          // ..e..........................'...................................~..........................'.................................
        // add    v31.4s, v31.4s, v30.4s                   // ........e....................'.........................................~....................'.................................
        // aesr v0.16b, v18.16b                            // ...........e.................'............................................~.................'.................................
        // aesr v0.16b, v19.16b                            // .............e...............'..............................................~...............'.................................
        // aesr v0.16b, v20.16b                            // ...............e.............'................................................~.............'.................................
        // aesr v0.16b, v21.16b                            // .................e...........'..................................................~...........'.................................
        // aesr v0.16b, v22.16b                            // ...................e.........'....................................................~.........'.................................
        // aesr v0.16b, v23.16b                            // .....................e.......'......................................................~.......'.................................
        // aesr v0.16b, v24.16b                            // .......................e.....'........................................................~.....'.................................
        // aesr v0.16b, v25.16b                            // .........................e...'..........................................................~...'.................................
        // aesr v0.16b, v26.16b                            // ...........................e.'............................................................~.'.................................
        // aese v0.16b, v27.16b                            // .............................*..............................................................~.................................
        // eor v29.16b, v29.16b, v28.16b                   // ............................e'.............................................................~'.................................
        // eor v0.16b, v29.16b, v0.16b                     // .............................'.*............................................................'.~...............................
        // str q0, [x2], #(4*16)                           // .............................'....*.........................................................'....~............................
        // ldr q12, [x6, #48]                              // .............................'..........*...................................................'..........~......................
        // ldr q13, [x6, #80]                              // .............................'...............................*..............................'...............................~.
        // ldr q14, [x6, #64]                              // .~...........................'..................................*...........................'.................................
        // rev64 v0.16b, v0.16b                            // .............................'................*.............................................'................~................
        // eor   v0.16b, v0.16b, v11.16b                   // .~...........................'..................................*...........................'.................................
        // pmull   v8.1q, v0.1d, v13.1d                    // ...~.........................'....................................*.........................'.................................
        // pmull2  v9.1q, v0.2d, v13.2d                    // ....~........................'.....................................*........................'.................................
        // ext     v11.16b, v0.16b, v0.16b, #8             // ...~.........................'....................................*.........................'.................................
        // eor     v11.16b, v11.16b, v0.16b                // ......~......................'.......................................*......................'.................................
        // pmull2  v10.1q, v11.2d, v14.2d                  // .........~...................'..........................................*...................'.................................
        // ldr q29, [x0, #(-3*16)]                         // .............................'..*...........................................................'..~..............................
        // rev32  v0.16b, v31.16b                          // ..........e..................'...........................................~..................'.................................
        // add    v31.4s, v31.4s, v30.4s                   // ..........e..................'...........................................~..................'.................................
        // aesr v0.16b, v18.16b                            // ..............e..............'...............................................~..............'.................................
        // aesr v0.16b, v19.16b                            // .............................'..*...........................................................'..~..............................
        // aesr v0.16b, v20.16b                            // .............................'.....*........................................................'.....~...........................
        // aesr v0.16b, v21.16b                            // .............................'..........*...................................................'..........~......................
        // aesr v0.16b, v22.16b                            // .............................'............*.................................................'............~....................
        // aesr v0.16b, v23.16b                            // .............................'..............*...............................................'..............~..................
        // aesr v0.16b, v24.16b                            // .............................'................*.............................................'................~................
        // aesr v0.16b, v25.16b                            // .............................'..................*...........................................'..................~..............
        // aesr v0.16b, v26.16b                            // .............................'....................*.........................................'....................~............
        // aese v0.16b, v27.16b                            // .............................'.......................*......................................'.......................~.........
        // eor v29.16b, v29.16b, v28.16b                   // .............................'..............*...............................................'..............~..................
        // eor v0.16b, v29.16b, v0.16b                     // .............................'.........................*....................................'.........................~.......
        // str q0, [x2, #(-3*16)]                          // .............................'~.............................................................'l................................
        // rev64   v0.16b, v0.16b                          // .............................'...........................*..................................'...........................~.....
        // pmull   v11.1q, v0.1d, v12.1d                   // .............................'...............................*..............................'...............................~.
        // eor     v8.16b, v8.16b, v11.16b                 // .....~.......................'......................................*.......................'.................................
        // pmull2  v11.1q, v0.2d, v12.2d                   // .............................'.............................*................................'.............................~...
        // eor     v9.16b, v9.16b, v11.16b                 // .............~...............'..............................................*...............'.................................
        // mov     d11, v0.d[1]                            // .............................'.............................*................................'.............................~...
        // eor     v11.8b, v11.8b, v0.8b                   // ..~..........................'...................................*..........................'.................................
        // pmull   v11.1q, v11.1d, v14.1d                  // .....~.......................'......................................*.......................'.................................
        // eor     v10.16b, v10.16b, v11.16b               // .........................~...'..........................................................*...'.................................
        // ldr q29, [x0, #(-2*16)]                         // ..................e..........'...................................................~..........'.................................
        // rev32  v0.16b, v31.16b                          // ............e................'.............................................~................'.................................
        // add    v31.4s, v31.4s, v30.4s                   // ................e............'.................................................~............'.................................
        // aesr v0.16b, v18.16b                            // ................e............'.................................................~............'.................................
        // aesr v0.16b, v19.16b                            // ..................e..........'...................................................~..........'.................................
        // aesr v0.16b, v20.16b                            // ....................e........'.....................................................~........'.................................
        // aesr v0.16b, v21.16b                            // ......................e......'.......................................................~......'.................................
        // aesr v0.16b, v22.16b                            // ........................e....'.........................................................~....'.................................
        // aesr v0.16b, v23.16b                            // ..........................e..'...........................................................~..'.................................
        // aesr v0.16b, v24.16b                            // ............................e'.............................................................~'.................................
        // aesr v0.16b, v25.16b                            // .............................'*.............................................................'~................................
        // aesr v0.16b, v26.16b                            // .............................'...*..........................................................'...~.............................
        // aese v0.16b, v27.16b                            // .............................'........*.....................................................'........~........................
        // eor v29.16b, v29.16b, v28.16b                   // .............................'........*.....................................................'........~........................
        // eor v0.16b, v29.16b, v0.16b                     // .............................'............*.................................................'............~....................
        // str q0, [x2, #(-2*16)]                          // .............................'......................*.......................................'......................~..........
        // ldr q12, [x6]                                   // ......................~......'.......................................................*......'.................................
        // ldr q13, [x6, #32]                              // .............................'.......*......................................................'.......~.........................
        // ldr q14, [x6, #16]                              // .............................'........................*.....................................'........................~........
        // rev64   v0.16b, v0.16b                          // .............................'..................*...........................................'..................~..............
        // pmull   v11.1q, v0.1d, v13.1d                   // .............................'.....................*........................................'.....................~...........
        // eor     v8.16b, v8.16b, v11.16b                 // .......~.....................'........................................*.....................'.................................
        // pmull2  v11.1q, v0.2d, v13.2d                   // ........~....................'.........................................*....................'.................................
        // eor     v9.16b, v9.16b, v11.16b                 // ....................~........'.....................................................*........'.................................
        // ext     v11.16b, v0.16b, v0.16b, #8             // .............................'....................*.........................................'....................~............
        // eor     v11.16b, v11.16b, v0.16b                // .............................'......................*.......................................'......................~..........
        // pmull2  v11.1q, v11.2d, v14.2d                  // .............................'..............................*...............................'..............................~..
        // eor     v10.16b, v10.16b, v11.16b               // .............................'......~.......................................................'......l..........................
        // ldr q29, [x0, #(-1*16)]                         // .............................'................................*.............................'.................................
        // rev32  v0.16b, v31.16b                          // ..........................e..'...........................................................~..'.................................
        // add    v31.4s, v31.4s, v30.4s                   // .............................'..........................*...................................'..........................~......
        // aesr v0.16b, v18.16b                            // .............................'....*.........................................................'....~............................
        // aesr v0.16b, v19.16b                            // .............................'......*.......................................................'......~..........................
        // aesr v0.16b, v20.16b                            // .............................'...........*..................................................'...........~.....................
        // aesr v0.16b, v21.16b                            // .............................'.............*................................................'.............~...................
        // aesr v0.16b, v22.16b                            // .............................'...............*..............................................'...............~.................
        // aesr v0.16b, v23.16b                            // .............................'.................*............................................'.................~...............
        // aesr v0.16b, v24.16b                            // .............................'........................*.....................................'........................~........
        // aesr v0.16b, v25.16b                            // .............................'..........................*...................................'..........................~......
        // aesr v0.16b, v26.16b                            // .............................'............................*.................................'............................~....
        // aese v0.16b, v27.16b                            // ~............................'.................................*............................'.................................
        // eor v29.16b, v29.16b, v28.16b                   // ......~......................'.......................................*......................'.................................
        // eor v0.16b, v29.16b, v0.16b                     // .....................~.......'......................................................*.......'.................................
        // str q0, [x2, #(-1*16)]                          // ...........................~.'............................................................*.'.................................
        // rev64   v0.16b, v0.16b                          // .............................~..............................................................l.................................
        // pmull   v11.1q, v0.1d, v12.1d                   // .............................'.........~....................................................'.........l.......................
        // eor     v8.16b, v8.16b, v11.16b                 // .............................'...........~..................................................'...........l.....................
        // pmull2  v11.1q, v0.2d, v12.2d                   // .............................'.~............................................................'.l...............................
        // eor     v9.16b, v9.16b, v11.16b                 // .............................'.............~................................................'.............l...................
        // mov     d11, v0.d[1]                            // .............................'...~..........................................................'...l.............................
        // eor     v11.8b, v11.8b, v0.8b                   // .............................'.....~........................................................'.....l...........................
        // pmull   v11.1q, v11.1d, v14.1d                  // .............................'.......~......................................................'.......l.........................
        // eor     v10.16b, v10.16b, v11.16b               // .............................'.........~....................................................'.........l.......................
        // eor        v0.16b, v8.16b,  v9.16b              // .............................'.................~............................................'.................l...............
        // pmull      v1.1q,  v9.1d,   v7.1d               // .............................'...................~..........................................'...................l.............
        // ext        v9.16b,    v9.16b,  v9.16b, #8       // .............................'...............~..............................................'...............l.................
        // eor        v10.16b,   v10.16b, v0.16b           // .............................'...................~..........................................'...................l.............
        // eor        v1.16b, v9.16b,  v1.16b              // .............................'.....................~........................................'.....................l...........
        // eor        v10.16b,   v10.16b, v1.16b           // .............................'.......................~......................................'.......................l.........
        // pmull      v9.1q,     v10.1d,  v7.1d            // .............................'.........................~....................................'.........................l.......
        // eor        v8.16b,    v8.16b,  v9.16b           // .............................'...........................~..................................'...........................l.....
        // ext        v10.16b,   v10.16b, v10.16b, #8      // .............................'............................~.................................'............................l....
        // eor        v11.16b,     v8.16b,  v10.16b        // .............................'..............................~...............................'..............................l..
        // ext        v11.16b, v11.16b, v11.16b, #8        // .............................'................................~.............................'................................l

        sub count, count, #1
        cbnz count, Lloop_unrolled_start
Lloop_unrolled_start_postamble:// end of loop kernel
                                                // Instructions:    110
                                                // Expected cycles: 60
                                                // Expected IPC:    1.83
                                                //
                                                // Cycle bound:     60.0
                                                // IPC bound:       1.83
                                                //
                                                // Wall time:     31.70s
                                                // User time:     31.70s
                                                //
                                                // -------------------- cycle (expected) --------------------->
                                                // 0                        25                       50
                                                // |------------------------|------------------------|---------
        rev64 v16.16B, v16.16B                  // *...........................................................
        aese v4.16b, v0.16b                     // *...........................................................
        eor v27.16B, v20.16B, v10.16B           // .*..........................................................
        aesr v24.16b, v23.16b                   // .*..........................................................
        eor v25.16B, v25.16B, v4.16B            // ..*.........................................................
        aesr v31.16b, v1.16b                    // ..*.........................................................
        mov d21, v16.d[1]                       // ...*........................................................
        pmull v14.1q, v16.1d, v28.1d            // ...*........................................................
        ldr q10, [x0, #-16]                     // ....*.......................................................
        aesr v31.16b, v29.16b                   // ....*.......................................................
        pmull2 v4.1q, v16.2d, v28.2d            // .....*......................................................
        eor v21.8B, v21.8B, v16.8B              // .....*......................................................
        eor v19.16B, v18.16B, v14.16B           // ......*.....................................................
        aesr v31.16b, v17.16b                   // ......*.....................................................
        pmull v13.1q, v21.1d, v13.1d            // .......*....................................................
        ldr q28, [x6, #48]                      // .......*....................................................
        aesr v22.16b, v8.16b                    // ........*...................................................
        eor v20.16B, v26.16B, v4.16B            // ........*...................................................
        aesr v31.16b, v15.16b                   // .........*..................................................
        eor v27.16B, v27.16B, v13.16B           // .........*..................................................
        eor v8.16B, v19.16B, v20.16B            // ..........*.................................................
        aesr v22.16b, v1.16b                    // ..........*.................................................
        ext v4.16B, v20.16B, v20.16B, #8        // ...........*................................................
        pmull v18.1q, v20.1d, v7.1d             // ...........*................................................
        aesr v22.16b, v29.16b                   // ............*...............................................
        eor v20.16B, v27.16B, v8.16B            // ............*...............................................
        aesr v31.16b, v5.16b                    // .............*..............................................
        eor v13.16B, v4.16B, v18.16B            // .............*..............................................
        aesr v22.16b, v17.16b                   // ..............*.............................................
        ldr q21, [x6, #80]                      // ..............*.............................................
        eor v18.16B, v11.16B, v9.16B            // ...............*............................................
        eor v20.16B, v20.16B, v13.16B           // ...............*............................................
        aesr v22.16b, v15.16b                   // ................*...........................................
        rev64 v29.16B, v25.16B                  // ................*...........................................
        ext v8.16B, v20.16B, v20.16B, #8        // .................*..........................................
        aesr v31.16b, v6.16b                    // .................*..........................................
        ldr q11, [x6, #64]                      // ..................*.........................................
        pmull v13.1q, v20.1d, v7.1d             // ..................*.........................................
        ldr q16, [x6, #16]                      // ...................*........................................
        aesr v22.16b, v5.16b                    // ...................*........................................
        eor v15.16B, v19.16B, v13.16B           // ....................*.......................................
        aesr v31.16b, v23.16b                   // ....................*.......................................
        aesr v22.16b, v6.16b                    // .....................*......................................
        eor v10.16B, v10.16B, v9.16B            // .....................*......................................
        eor v20.16B, v15.16B, v8.16B            // ......................*.....................................
        aesr v24.16b, v3.16b                    // ......................*.....................................
        aesr v31.16b, v3.16b                    // .......................*....................................
        ldr q13, [x0, #-48]                     // .......................*....................................
        ext v1.16B, v20.16B, v20.16B, #8        // ........................*...................................
        aese v24.16b, v0.16b                    // ........................*...................................
        aesr v22.16b, v23.16b                   // .........................*..................................
        ldr q5, [x6, #32]                       // .........................*..................................
        ldr q20, [x6]                           // ..........................*.................................
        eor v17.16B, v18.16B, v24.16B           // ..........................*.................................
        eor v19.16B, v29.16B, v1.16B            // ...........................*................................
        eor v1.16B, v13.16B, v9.16B             // ...........................*................................
        aesr v22.16b, v3.16b                    // ............................*...............................
        rev64 v26.16B, v17.16B                  // ............................*...............................
        aese v31.16b, v0.16b                    // .............................*..............................
        ext v8.16B, v19.16B, v19.16B, #8        // .............................*..............................
        aese v22.16b, v0.16b                    // ..............................*.............................
        ext v0.16B, v26.16B, v26.16B, #8        // ..............................*.............................
        pmull v13.1q, v19.1d, v21.1d            // ...............................*............................
        eor v6.16B, v1.16B, v31.16B             // ...............................*............................
        eor v1.16B, v10.16B, v22.16B            // ................................*...........................
        eor v31.16B, v8.16B, v19.16B            // ................................*...........................
        pmull2 v10.1q, v19.2d, v21.2d           // .................................*..........................
        rev64 v3.16B, v6.16B                    // .................................*..........................
        rev64 v8.16B, v1.16B                    // ..................................*.........................
        eor v23.16B, v0.16B, v26.16B            // ..................................*.........................
        mov d15, v3.d[1]                        // ...................................*........................
        pmull v18.1q, v3.1d, v28.1d             // ...................................*........................
        mov d14, v8.d[1]                        // ....................................*.......................
        pmull2 v29.1q, v3.2d, v28.2d            // ....................................*.......................
        eor v21.16B, v13.16B, v18.16B           // .....................................*......................
        pmull2 v19.1q, v26.2d, v5.2d            // .....................................*......................
        eor v13.8B, v15.8B, v3.8B               // ......................................*.....................
        pmull2 v31.1q, v31.2d, v11.2d           // ......................................*.....................
        eor v28.8B, v14.8B, v8.8B               // .......................................*....................
        pmull v0.1q, v26.1d, v5.1d              // .......................................*....................
        pmull v11.1q, v13.1d, v11.1d            // ........................................*...................
        eor v13.16B, v10.16B, v29.16B           // ........................................*...................
        pmull2 v10.1q, v8.2d, v20.2d            // .........................................*..................
        eor v21.16B, v21.16B, v0.16B            // .........................................*..................
        eor v13.16B, v13.16B, v19.16B           // ..........................................*.................
        pmull v5.1q, v8.1d, v20.1d              // ..........................................*.................
        eor v8.16B, v31.16B, v11.16B            // ...........................................*................
        pmull2 v31.1q, v23.2d, v16.2d           // ...........................................*................
        eor v4.16B, v13.16B, v10.16B            // ............................................*...............
        eor v5.16B, v21.16B, v5.16B             // ............................................*...............
        pmull v9.1q, v28.1d, v16.1d             // .............................................*..............
        eor v28.16B, v8.16B, v31.16B            // .............................................*..............
        pmull v10.1q, v4.1d, v7.1d              // ..............................................*.............
        ext v22.16B, v4.16B, v4.16B, #8         // ..............................................*.............
        eor v20.16B, v5.16B, v4.16B             // ...............................................*............
        eor v9.16B, v28.16B, v9.16B             // ...............................................*............
        eor v8.16B, v22.16B, v10.16B            // ................................................*...........
        str q1, [x2, #48]                       // ................................................*...........
        str q25, [x2], #(4*16)                  // .................................................*..........
        eor v10.16B, v9.16B, v20.16B            // .................................................*..........
        str q12, [x2, #-112]                    // ..................................................*.........
        add v31.4S, v2.4S, v30.4S               // ..................................................*.........
        eor v10.16B, v10.16B, v8.16B            // ...................................................*........
        str q17, [x2, #-32]                     // ...................................................*........
        str q6, [x2, #-48]                      // ....................................................*.......
        ext v8.16B, v10.16B, v10.16B, #8        // .....................................................*......
        pmull v10.1q, v10.1d, v7.1d             // .....................................................*......
        eor v10.16B, v5.16B, v10.16B            // .......................................................*....
        eor v8.16B, v10.16B, v8.16B             // .........................................................*..
        ext v11.16B, v8.16B, v8.16B, #8         // ...........................................................*

                                                                       // -------------------- cycle (expected) --------------------->
                                                                       // 0                        25                       50
                                                                       // |------------------------|------------------------|---------
        // rev64 V<ssa_0>.16B, v16.16B                                 // *...........................................................
        // aese v4.16b, v0.16b                                         // *...........................................................
        // str q12, [x2, #-48]                                         // ..................................................*.........
        // aesr v24.16b, v23.16b                                       // .*..........................................................
        // eor V<ssa_1>.16B, v25.16B, v4.16B                           // ..*.........................................................
        // pmull2 V<ssa_2>.1q, V<ssa_0>.2d, v28.2d                     // .....*......................................................
        // aesr v31.16b, v1.16b                                        // ..*.........................................................
        // ldr Q<ssa_3>, [x0, #-48]                                    // .......................*....................................
        // mov D<ssa_4>, V<ssa_0>.d[1]                                 // ...*........................................................
        // aesr v24.16b, v3.16b                                        // ......................*.....................................
        // aesr v22.16b, v8.16b                                        // ........*...................................................
        // str Q<ssa_1>, [x2], #(4*16)                                 // .................................................*..........
        // eor V<ssa_5>.8B, V<ssa_4>.8B, V<ssa_0>.8B                   // .....*......................................................
        // aesr v31.16b, v29.16b                                       // ....*.......................................................
        // eor V<ssa_6>.16B, v20.16B, v10.16B                          // .*..........................................................
        // aesr v22.16b, v1.16b                                        // ..........*.................................................
        // pmull V<ssa_7>.1q, V<ssa_5>.1d, v13.1d                      // .......*....................................................
        // ldr Q<ssa_8>, [x6, #32]                                     // .........................*..................................
        // aese v24.16b, v0.16b                                        // ........................*...................................
        // eor V<ssa_9>.16B, v11.16B, v9.16B                           // ...............*............................................
        // pmull V<ssa_10>.1q, V<ssa_0>.1d, v28.1d                     // ...*........................................................
        // eor V<ssa_11>.16B, V<ssa_6>.16B, V<ssa_7>.16B               // .........*..................................................
        // ldr Q<ssa_12>, [x6, #48]                                    // .......*....................................................
        // aesr v31.16b, v17.16b                                       // ......*.....................................................
        // eor V<ssa_13>.16B, v18.16B, V<ssa_10>.16B                   // ......*.....................................................
        // aesr v22.16b, v29.16b                                       // ............*...............................................
        // eor V<ssa_14>.16B, V<ssa_9>.16B, v24.16B                    // ..........................*.................................
        // aesr v31.16b, v15.16b                                       // .........*..................................................
        // aesr v22.16b, v17.16b                                       // ..............*.............................................
        // eor V<ssa_15>.16B, v26.16B, V<ssa_2>.16B                    // ........*...................................................
        // eor V<ssa_16>.16B, V<ssa_3>.16B, v9.16B                     // ...........................*................................
        // aesr v31.16b, v5.16b                                        // .............*..............................................
        // ext V<ssa_17>.16B, V<ssa_15>.16B, V<ssa_15>.16B, #8         // ...........*................................................
        // aesr v22.16b, v15.16b                                       // ................*...........................................
        // rev64 V<ssa_18>.16B, V<ssa_1>.16B                           // ................*...........................................
        // aesr v31.16b, v6.16b                                        // .................*..........................................
        // aesr v22.16b, v5.16b                                        // ...................*........................................
        // eor V<ssa_19>.16B, V<ssa_13>.16B, V<ssa_15>.16B             // ..........*.................................................
        // aesr v31.16b, v23.16b                                       // ....................*.......................................
        // rev64 V<ssa_20>.16B, V<ssa_14>.16B                          // ............................*...............................
        // pmull V<ssa_21>.1q, V<ssa_15>.1d, v7.1d                     // ...........*................................................
        // eor V<ssa_22>.16B, V<ssa_11>.16B, V<ssa_19>.16B             // ............*...............................................
        // aesr v31.16b, v3.16b                                        // .......................*....................................
        // ext V<ssa_23>.16B, V<ssa_20>.16B, V<ssa_20>.16B, #8         // ..............................*.............................
        // eor V<ssa_24>.16B, V<ssa_17>.16B, V<ssa_21>.16B             // .............*..............................................
        // pmull V<ssa_25>.1q, V<ssa_20>.1d, V<ssa_8>.1d               // .......................................*....................
        // str Q<ssa_14>, [x2, #-32]                                   // ...................................................*........
        // eor V<ssa_26>.16B, V<ssa_23>.16B, V<ssa_20>.16B             // ..................................*.........................
        // aese v31.16b, v0.16b                                        // .............................*..............................
        // eor V<ssa_27>.16B, V<ssa_22>.16B, V<ssa_24>.16B             // ...............*............................................
        // aesr v22.16b, v6.16b                                        // .....................*......................................
        // ldr Q<ssa_28>, [x6, #16]                                    // ...................*........................................
        // pmull V<ssa_29>.1q, V<ssa_27>.1d, v7.1d                     // ..................*.........................................
        // eor V<ssa_30>.16B, V<ssa_16>.16B, v31.16B                   // ...............................*............................
        // aesr v22.16b, v23.16b                                       // .........................*..................................
        // add v31.4S, v2.4S, v30.4S                                   // ..................................................*.........
        // rev64 V<ssa_32>.16B, V<ssa_30>.16B                          // .................................*..........................
        // eor V<ssa_33>.16B, V<ssa_13>.16B, V<ssa_29>.16B             // ....................*.......................................
        // ext V<ssa_34>.16B, V<ssa_27>.16B, V<ssa_27>.16B, #8         // .................*..........................................
        // aesr v22.16b, v3.16b                                        // ............................*...............................
        // mov D<ssa_35>, V<ssa_32>.d[1]                               // ...................................*........................
        // pmull2 V<ssa_36>.1q, V<ssa_32>.2d, V<ssa_12>.2d             // ....................................*.......................
        // eor V<ssa_37>.16B, V<ssa_33>.16B, V<ssa_34>.16B             // ......................*.....................................
        // pmull2 V<ssa_38>.1q, V<ssa_26>.2d, V<ssa_28>.2d             // ...........................................*................
        // ldr Q<ssa_39>, [x6, #80]                                    // ..............*.............................................
        // pmull V<ssa_40>.1q, V<ssa_32>.1d, V<ssa_12>.1d              // ...................................*........................
        // ext V<ssa_41>.16B, V<ssa_37>.16B, V<ssa_37>.16B, #8         // ........................*...................................
        // ldr Q<ssa_42>, [x0, #-16]                                   // ....*.......................................................
        // aese v22.16b, v0.16b                                        // ..............................*.............................
        // eor V<ssa_44>.16B, V<ssa_18>.16B, V<ssa_41>.16B             // ...........................*................................
        // ldr Q<ssa_45>, [x6, #64]                                    // ..................*.........................................
        // eor V<ssa_46>.8B, V<ssa_35>.8B, V<ssa_32>.8B                // ......................................*.....................
        // ext V<ssa_48>.16B, V<ssa_44>.16B, V<ssa_44>.16B, #8         // .............................*..............................
        // pmull V<ssa_49>.1q, V<ssa_44>.1d, V<ssa_39>.1d              // ...............................*............................
        // pmull2 V<ssa_50>.1q, V<ssa_44>.2d, V<ssa_39>.2d             // .................................*..........................
        // eor V<ssa_52>.16B, V<ssa_49>.16B, V<ssa_40>.16B             // .....................................*......................
        // pmull V<ssa_53>.1q, V<ssa_46>.1d, V<ssa_45>.1d              // ........................................*...................
        // eor V<ssa_54>.16B, V<ssa_42>.16B, v9.16B                    // .....................*......................................
        // eor V<ssa_55>.16B, V<ssa_48>.16B, V<ssa_44>.16B             // ................................*...........................
        // eor V<ssa_56>.16B, V<ssa_52>.16B, V<ssa_25>.16B             // .........................................*..................
        // pmull2 V<ssa_59>.1q, V<ssa_20>.2d, V<ssa_8>.2d              // .....................................*......................
        // pmull2 V<ssa_60>.1q, V<ssa_55>.2d, V<ssa_45>.2d             // ......................................*.....................
        // eor V<ssa_67>.16B, V<ssa_50>.16B, V<ssa_36>.16B             // ........................................*...................
        // eor V<ssa_74>.16B, V<ssa_67>.16B, V<ssa_59>.16B             // ..........................................*.................
        // eor V<ssa_75>.16B, V<ssa_54>.16B, v22.16B                   // ................................*...........................
        // ldr Q<ssa_76>, [x6]                                         // ..........................*.................................
        // eor V<ssa_79>.16B, V<ssa_60>.16B, V<ssa_53>.16B             // ...........................................*................
        // str Q<ssa_75>, [x2, #-16]                                   // ................................................*...........
        // rev64 V<ssa_82>.16B, V<ssa_75>.16B                          // ..................................*.........................
        // str Q<ssa_30>, [x2, #-48]                                   // ....................................................*.......
        // pmull2 V<ssa_84>.1q, V<ssa_82>.2d, V<ssa_76>.2d             // .........................................*..................
        // mov D<ssa_86>, V<ssa_82>.d[1]                               // ....................................*.......................
        // eor V<ssa_87>.8B, V<ssa_86>.8B, V<ssa_82>.8B                // .......................................*....................
        // eor V<ssa_88>.16B, V<ssa_79>.16B, V<ssa_38>.16B             // .............................................*..............
        // pmull V<ssa_89>.1q, V<ssa_87>.1d, V<ssa_28>.1d              // .............................................*..............
        // pmull V<ssa_92>.1q, V<ssa_82>.1d, V<ssa_76>.1d              // ..........................................*.................
        // eor V<ssa_93>.16B, V<ssa_88>.16B, V<ssa_89>.16B             // ...............................................*............
        // eor V<ssa_95>.16B, V<ssa_56>.16B, V<ssa_92>.16B             // ............................................*...............
        // eor V<ssa_97>.16B, V<ssa_74>.16B, V<ssa_84>.16B             // ............................................*...............
        // ext V<ssa_99>.16B, V<ssa_97>.16B, V<ssa_97>.16B, #8         // ..............................................*.............
        // eor V<ssa_101>.16B, V<ssa_95>.16B, V<ssa_97>.16B            // ...............................................*............
        // pmull V<ssa_103>.1q, V<ssa_97>.1d, v7.1d                    // ..............................................*.............
        // eor V<ssa_104>.16B, V<ssa_93>.16B, V<ssa_101>.16B           // .................................................*..........
        // eor V<ssa_106>.16B, V<ssa_99>.16B, V<ssa_103>.16B           // ................................................*...........
        // eor V<ssa_109>.16B, V<ssa_104>.16B, V<ssa_106>.16B          // ...................................................*........
        // pmull V<ssa_110>.1q, V<ssa_109>.1d, v7.1d                   // .....................................................*......
        // eor V<ssa_113>.16B, V<ssa_95>.16B, V<ssa_110>.16B           // .......................................................*....
        // ext V<ssa_114>.16B, V<ssa_109>.16B, V<ssa_109>.16B, #8      // .....................................................*......
        // eor V<ssa_117>.16B, V<ssa_113>.16B, V<ssa_114>.16B          // .........................................................*..
        // ext v11.16B, V<ssa_117>.16B, V<ssa_117>.16B, #8             // ...........................................................*

        b Lloop_unrolled_start_end
Lloop_unrolled_start_iter_1:


        ldr q18, [x5, #((0)*16)]
        ldr q19, [x5, #((1)*16)]
        ldr q20, [x5, #((2)*16)]
        ldr q21, [x5, #((3)*16)]
        ldr q22, [x5, #((4)*16)]
        ldr q23, [x5, #((5)*16)]
        ldr q24, [x5, #((6)*16)]
        ldr q25, [x5, #((7)*16)]
        ldr q26, [x5, #((8)*16)]
        ldr q27, [x5, #((9)*16)]
        ldr q28, [x5, #((10)*16)]

        ldr q29, [x0], #(4*16)
        rev32  v0.16b, v31.16b
        add    v31.4s, v31.4s, v30.4s
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aese v0.16b, v27.16b
        eor v29.16b, v29.16b, v28.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2], #(4*16)

        ldr q12, [x6, #48]
        ldr q13, [x6, #80]
        ldr q14, [x6, #64]
        rev64 v0.16b, v0.16b
        eor   v0.16b, v0.16b, v11.16b
        // Low product
        pmull   v8.1q, v0.1d, v13.1d
        // High product
        pmull2  v9.1q, v0.2d, v13.2d
        // Middle product
        ext     v11.16b, v0.16b, v0.16b, #8
        eor     v11.16b, v11.16b, v0.16b
        pmull2  v10.1q, v11.2d, v14.2d

        ldr q29, [x0, #(-3*16)]
        rev32  v0.16b, v31.16b
        add    v31.4s, v31.4s, v30.4s
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aese v0.16b, v27.16b
        eor v29.16b, v29.16b, v28.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(-3*16)]

        rev64   v0.16b, v0.16b
        // Low product
        pmull   v11.1q, v0.1d, v12.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v12.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        mov     d11, v0.d[1]
        eor     v11.8b, v11.8b, v0.8b
        pmull   v11.1q, v11.1d, v14.1d
        eor     v10.16b, v10.16b, v11.16b

        ldr q29, [x0, #(-2*16)]
        rev32  v0.16b, v31.16b
        add    v31.4s, v31.4s, v30.4s
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aese v0.16b, v27.16b
        eor v29.16b, v29.16b, v28.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(-2*16)]

        ldr q12, [x6]
        ldr q13, [x6, #32]
        ldr q14, [x6, #16]
        rev64   v0.16b, v0.16b

        // Low product
        pmull   v11.1q, v0.1d, v13.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v13.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        ext     v11.16b, v0.16b, v0.16b, #8
        eor     v11.16b, v11.16b, v0.16b
        pmull2  v11.1q, v11.2d, v14.2d
        eor     v10.16b, v10.16b, v11.16b

        ldr q29, [x0, #(-1*16)]
        rev32  v0.16b, v31.16b
        add    v31.4s, v31.4s, v30.4s
        aesr v0.16b, v18.16b
        aesr v0.16b, v19.16b
        aesr v0.16b, v20.16b
        aesr v0.16b, v21.16b
        aesr v0.16b, v22.16b
        aesr v0.16b, v23.16b
        aesr v0.16b, v24.16b
        aesr v0.16b, v25.16b
        aesr v0.16b, v26.16b
        aese v0.16b, v27.16b
        eor v29.16b, v29.16b, v28.16b
        eor v0.16b, v29.16b, v0.16b
        str q0, [x2, #(-1*16)]

        rev64   v0.16b, v0.16b
        // Low product
        pmull   v11.1q, v0.1d, v12.1d
        eor     v8.16b, v8.16b, v11.16b
        // High product
        pmull2  v11.1q, v0.2d, v12.2d
        eor     v9.16b, v9.16b, v11.16b
        // Middle product
        mov     d11, v0.d[1]
        eor     v11.8b, v11.8b, v0.8b
        pmull   v11.1q, v11.1d, v14.1d
        eor     v10.16b, v10.16b, v11.16b

        eor        v0.16b, v8.16b,  v9.16b
        pmull      v1.1q,  v9.1d,   v7.1d
        ext        v9.16b,    v9.16b,  v9.16b, #8
        eor        v10.16b,   v10.16b, v0.16b
        eor        v1.16b, v9.16b,  v1.16b
        eor        v10.16b,   v10.16b, v1.16b
        pmull      v9.1q,     v10.1d,  v7.1d
        eor        v8.16b,    v8.16b,  v9.16b
        ext        v10.16b,   v10.16b, v10.16b, #8
        eor        v11.16b,     v8.16b,  v10.16b
        ext        v11.16b, v11.16b, v11.16b, #8

Lloop_unrolled_start_iter_1_end:
Lloop_unrolled_start_end:
Lloop_unrolled_end:

        load_round_keys
        load_htable_12

        cbz remainder, Lloop_1x_end
Lloop_1x_start:

        ldr plain_q, [input], #16
        aes_full_block aes_st, plain, res
        str res_q, [output], #16
        ghash_init_0 res, Ht1, Ht12, tag

        ghash_finalize tag

        sub remainder, remainder, #1
        cbnz remainder, Lloop_1x_start
Lloop_1x_end:

        // Return number of bytes processed
        mov x0, byte_len
        // Store new authentication tag
        rev64 tag.16b, tag.16b
        str tag_q, [tag_ptr]
        // Store updated counter
        rev32 rtmp_ctr.16b, rtmp_ctr.16b
        str rtmp_ctr_q, [ivec]

        restore_vregs
        restore_gprs

Lenc_postamble_end:
        add sp, sp, #STACK_SIZE

        ret

#endif
#endif  // !OPENSSL_NO_ASM && defined(__AARCH64EL__) && defined(__APPLE__)
#if defined(__ELF__)
// See https: // www.airs.com/blog/archives/518.
.section .note.GNU-stack,"",%progbits
#endif